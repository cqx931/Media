!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports={default:a("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":11}],2:[function(a,b,c){b.exports={default:a("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":12}],3:[function(a,b,c){b.exports={default:a("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":13}],4:[function(a,b,c){b.exports={default:a("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":14}],5:[function(a,b,c){b.exports={default:a("core-js/library/fn/symbol/iterator"),__esModule:!0}},{"core-js/library/fn/symbol/iterator":15}],6:[function(a,b,c){"use strict";c.__esModule=!0,c.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}},{}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}c.__esModule=!0;var e=a("../core-js/object/define-property"),f=d(e);c.default=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),(0,f.default)(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()},{"../core-js/object/define-property":2}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}c.__esModule=!0;var e=a("../core-js/object/set-prototype-of"),f=d(e),g=a("../core-js/object/create"),h=d(g),i=a("../helpers/typeof"),j=d(i);c.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":(0,j.default)(b)));a.prototype=(0,h.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(f.default?(0,f.default)(a,b):a.__proto__=b)}},{"../core-js/object/create":1,"../core-js/object/set-prototype-of":3,"../helpers/typeof":10}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}c.__esModule=!0;var e=a("../helpers/typeof"),f=d(e);c.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==("undefined"==typeof b?"undefined":(0,f.default)(b))&&"function"!=typeof b?a:b}},{"../helpers/typeof":10}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}c.__esModule=!0;var e=a("../core-js/symbol/iterator"),f=d(e),g=a("../core-js/symbol"),h=d(g),i="function"==typeof h.default&&"symbol"==typeof f.default?function(a){return typeof a}:function(a){return a&&"function"==typeof h.default&&a.constructor===h.default?"symbol":typeof a};c.default="function"==typeof h.default&&"symbol"===i(f.default)?function(a){return"undefined"==typeof a?"undefined":i(a)}:function(a){return a&&"function"==typeof h.default&&a.constructor===h.default?"symbol":"undefined"==typeof a?"undefined":i(a)}},{"../core-js/symbol":4,"../core-js/symbol/iterator":5}],11:[function(a,b,c){a("../../modules/es6.object.create");var d=a("../../modules/_core").Object;b.exports=function(a,b){return d.create(a,b)}},{"../../modules/_core":21,"../../modules/es6.object.create":74}],12:[function(a,b,c){a("../../modules/es6.object.define-property");var d=a("../../modules/_core").Object;b.exports=function(a,b,c){return d.defineProperty(a,b,c)}},{"../../modules/_core":21,"../../modules/es6.object.define-property":75}],13:[function(a,b,c){a("../../modules/es6.object.set-prototype-of"),b.exports=a("../../modules/_core").Object.setPrototypeOf},{"../../modules/_core":21,"../../modules/es6.object.set-prototype-of":76}],14:[function(a,b,c){a("../../modules/es6.symbol"),a("../../modules/es6.object.to-string"),a("../../modules/es7.symbol.async-iterator"),a("../../modules/es7.symbol.observable"),b.exports=a("../../modules/_core").Symbol},{"../../modules/_core":21,"../../modules/es6.object.to-string":77,"../../modules/es6.symbol":79,"../../modules/es7.symbol.async-iterator":80,"../../modules/es7.symbol.observable":81}],15:[function(a,b,c){a("../../modules/es6.string.iterator"),a("../../modules/web.dom.iterable"),b.exports=a("../../modules/_wks-ext").f("iterator")},{"../../modules/_wks-ext":71,"../../modules/es6.string.iterator":78,"../../modules/web.dom.iterable":82}],16:[function(a,b,c){b.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},{}],17:[function(a,b,c){b.exports=function(){}},{}],18:[function(a,b,c){var d=a("./_is-object");b.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},{"./_is-object":37}],19:[function(a,b,c){var d=a("./_to-iobject"),e=a("./_to-length"),f=a("./_to-index");b.exports=function(a){return function(b,c,g){var h,i=d(b),j=e(i.length),k=f(g,j);if(a&&c!=c){for(;j>k;)if(h=i[k++],h!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===c)return a||k||0;return!a&&-1}}},{"./_to-index":63,"./_to-iobject":65,"./_to-length":66}],20:[function(a,b,c){var d={}.toString;b.exports=function(a){return d.call(a).slice(8,-1)}},{}],21:[function(a,b,c){var d=b.exports={version:"2.4.0"};"number"==typeof __e&&(__e=d)},{}],22:[function(a,b,c){var d=a("./_a-function");b.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{"./_a-function":16}],23:[function(a,b,c){b.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}},{}],24:[function(a,b,c){b.exports=!a("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":29}],25:[function(a,b,c){var d=a("./_is-object"),e=a("./_global").document,f=d(e)&&d(e.createElement);b.exports=function(a){return f?e.createElement(a):{}}},{"./_global":30,"./_is-object":37}],26:[function(a,b,c){b.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],27:[function(a,b,c){var d=a("./_object-keys"),e=a("./_object-gops"),f=a("./_object-pie");b.exports=function(a){var b=d(a),c=e.f;if(c)for(var g,h=c(a),i=f.f,j=0;h.length>j;)i.call(a,g=h[j++])&&b.push(g);return b}},{"./_object-gops":51,"./_object-keys":54,"./_object-pie":55}],28:[function(a,b,c){var d=a("./_global"),e=a("./_core"),f=a("./_ctx"),g=a("./_hide"),h="prototype",i=function(a,b,c){var j,k,l,m=a&i.F,n=a&i.G,o=a&i.S,p=a&i.P,q=a&i.B,r=a&i.W,s=n?e:e[b]||(e[b]={}),t=s[h],u=n?d:o?d[b]:(d[b]||{})[h];n&&(c=b);for(j in c)k=!m&&u&&void 0!==u[j],k&&j in s||(l=k?u[j]:c[j],s[j]=n&&"function"!=typeof u[j]?c[j]:q&&k?f(l,d):r&&u[j]==l?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b[h]=a[h],b}(l):p&&"function"==typeof l?f(Function.call,l):l,p&&((s.virtual||(s.virtual={}))[j]=l,a&i.R&&t&&!t[j]&&g(t,j,l)))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,b.exports=i},{"./_core":21,"./_ctx":22,"./_global":30,"./_hide":32}],29:[function(a,b,c){b.exports=function(a){try{return!!a()}catch(a){return!0}}},{}],30:[function(a,b,c){var d=b.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=d)},{}],31:[function(a,b,c){var d={}.hasOwnProperty;b.exports=function(a,b){return d.call(a,b)}},{}],32:[function(a,b,c){var d=a("./_object-dp"),e=a("./_property-desc");b.exports=a("./_descriptors")?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},{"./_descriptors":24,"./_object-dp":46,"./_property-desc":56}],33:[function(a,b,c){b.exports=a("./_global").document&&document.documentElement},{"./_global":30}],34:[function(a,b,c){b.exports=!a("./_descriptors")&&!a("./_fails")(function(){return 7!=Object.defineProperty(a("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":24,"./_dom-create":25,"./_fails":29}],35:[function(a,b,c){var d=a("./_cof");b.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==d(a)?a.split(""):Object(a)}},{"./_cof":20}],36:[function(a,b,c){var d=a("./_cof");b.exports=Array.isArray||function(a){return"Array"==d(a)}},{"./_cof":20}],37:[function(a,b,c){b.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},{}],38:[function(a,b,c){"use strict";var d=a("./_object-create"),e=a("./_property-desc"),f=a("./_set-to-string-tag"),g={};a("./_hide")(g,a("./_wks")("iterator"),function(){return this}),b.exports=function(a,b,c){a.prototype=d(g,{next:e(1,c)}),f(a,b+" Iterator")}},{"./_hide":32,"./_object-create":45,"./_property-desc":56,"./_set-to-string-tag":59,"./_wks":72}],39:[function(a,b,c){"use strict";var d=a("./_library"),e=a("./_export"),f=a("./_redefine"),g=a("./_hide"),h=a("./_has"),i=a("./_iterators"),j=a("./_iter-create"),k=a("./_set-to-string-tag"),l=a("./_object-gpo"),m=a("./_wks")("iterator"),n=!([].keys&&"next"in[].keys()),o="@@iterator",p="keys",q="values",r=function(){return this};b.exports=function(a,b,c,s,t,u,v){j(c,b,s);var w,x,y,z=function(a){if(!n&&a in D)return D[a];switch(a){case p:return function(){return new c(this,a)};case q:return function(){return new c(this,a)}}return function(){return new c(this,a)}},A=b+" Iterator",B=t==q,C=!1,D=a.prototype,E=D[m]||D[o]||t&&D[t],F=E||z(t),G=t?B?z("entries"):F:void 0,H="Array"==b?D.entries||E:E;if(H&&(y=l(H.call(new a)),y!==Object.prototype&&(k(y,A,!0),d||h(y,m)||g(y,m,r))),B&&E&&E.name!==q&&(C=!0,F=function(){return E.call(this)}),d&&!v||!n&&!C&&D[m]||g(D,m,F),i[b]=F,i[A]=r,t)if(w={values:B?F:z(q),keys:u?F:z(p),entries:G},v)for(x in w)x in D||f(D,x,w[x]);else e(e.P+e.F*(n||C),b,w);return w}},{"./_export":28,"./_has":31,"./_hide":32,"./_iter-create":38,"./_iterators":41,"./_library":43,"./_object-gpo":52,"./_redefine":57,"./_set-to-string-tag":59,"./_wks":72}],40:[function(a,b,c){b.exports=function(a,b){return{value:b,done:!!a}}},{}],41:[function(a,b,c){b.exports={}},{}],42:[function(a,b,c){var d=a("./_object-keys"),e=a("./_to-iobject");b.exports=function(a,b){for(var c,f=e(a),g=d(f),h=g.length,i=0;h>i;)if(f[c=g[i++]]===b)return c}},{"./_object-keys":54,"./_to-iobject":65}],43:[function(a,b,c){b.exports=!0},{}],44:[function(a,b,c){var d=a("./_uid")("meta"),e=a("./_is-object"),f=a("./_has"),g=a("./_object-dp").f,h=0,i=Object.isExtensible||function(){return!0},j=!a("./_fails")(function(){return i(Object.preventExtensions({}))}),k=function(a){g(a,d,{value:{i:"O"+ ++h,w:{}}})},l=function(a,b){if(!e(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!f(a,d)){if(!i(a))return"F";if(!b)return"E";k(a)}return a[d].i},m=function(a,b){if(!f(a,d)){if(!i(a))return!0;if(!b)return!1;k(a)}return a[d].w},n=function(a){return j&&o.NEED&&i(a)&&!f(a,d)&&k(a),a},o=b.exports={KEY:d,NEED:!1,fastKey:l,getWeak:m,onFreeze:n}},{"./_fails":29,"./_has":31,"./_is-object":37,"./_object-dp":46,"./_uid":69}],45:[function(a,b,c){var d=a("./_an-object"),e=a("./_object-dps"),f=a("./_enum-bug-keys"),g=a("./_shared-key")("IE_PROTO"),h=function(){},i="prototype",j=function(){var b,c=a("./_dom-create")("iframe"),d=f.length,e="<",g=">";for(c.style.display="none",a("./_html").appendChild(c),c.src="javascript:",b=c.contentWindow.document,b.open(),b.write(e+"script"+g+"document.F=Object"+e+"/script"+g),b.close(),j=b.F;d--;)delete j[i][f[d]];return j()};b.exports=Object.create||function(a,b){var c;return null!==a?(h[i]=d(a),c=new h,h[i]=null,c[g]=a):c=j(),void 0===b?c:e(c,b)}},{"./_an-object":18,"./_dom-create":25,"./_enum-bug-keys":26,"./_html":33,"./_object-dps":47,"./_shared-key":60}],46:[function(a,b,c){var d=a("./_an-object"),e=a("./_ie8-dom-define"),f=a("./_to-primitive"),g=Object.defineProperty;c.f=a("./_descriptors")?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},{"./_an-object":18,"./_descriptors":24,"./_ie8-dom-define":34,"./_to-primitive":68}],47:[function(a,b,c){var d=a("./_object-dp"),e=a("./_an-object"),f=a("./_object-keys");b.exports=a("./_descriptors")?Object.defineProperties:function(a,b){e(a);for(var c,g=f(b),h=g.length,i=0;h>i;)d.f(a,c=g[i++],b[c]);return a}},{"./_an-object":18,"./_descriptors":24,"./_object-dp":46,"./_object-keys":54}],48:[function(a,b,c){var d=a("./_object-pie"),e=a("./_property-desc"),f=a("./_to-iobject"),g=a("./_to-primitive"),h=a("./_has"),i=a("./_ie8-dom-define"),j=Object.getOwnPropertyDescriptor;c.f=a("./_descriptors")?j:function(a,b){if(a=f(a),b=g(b,!0),i)try{return j(a,b)}catch(a){}if(h(a,b))return e(!d.f.call(a,b),a[b])}},{"./_descriptors":24,"./_has":31,"./_ie8-dom-define":34,"./_object-pie":55,"./_property-desc":56,"./_to-iobject":65,"./_to-primitive":68}],49:[function(a,b,c){var d=a("./_to-iobject"),e=a("./_object-gopn").f,f={}.toString,g="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],h=function(a){try{return e(a)}catch(a){return g.slice()}};b.exports.f=function(a){return g&&"[object Window]"==f.call(a)?h(a):e(d(a))}},{"./_object-gopn":50,"./_to-iobject":65}],50:[function(a,b,c){var d=a("./_object-keys-internal"),e=a("./_enum-bug-keys").concat("length","prototype");c.f=Object.getOwnPropertyNames||function(a){return d(a,e)}},{"./_enum-bug-keys":26,"./_object-keys-internal":53}],51:[function(a,b,c){c.f=Object.getOwnPropertySymbols},{}],52:[function(a,b,c){var d=a("./_has"),e=a("./_to-object"),f=a("./_shared-key")("IE_PROTO"),g=Object.prototype;b.exports=Object.getPrototypeOf||function(a){return a=e(a),d(a,f)?a[f]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?g:null}},{"./_has":31,"./_shared-key":60,"./_to-object":67}],53:[function(a,b,c){var d=a("./_has"),e=a("./_to-iobject"),f=a("./_array-includes")(!1),g=a("./_shared-key")("IE_PROTO");b.exports=function(a,b){var c,h=e(a),i=0,j=[];for(c in h)c!=g&&d(h,c)&&j.push(c);for(;b.length>i;)d(h,c=b[i++])&&(~f(j,c)||j.push(c));return j}},{"./_array-includes":19,"./_has":31,"./_shared-key":60,"./_to-iobject":65}],54:[function(a,b,c){var d=a("./_object-keys-internal"),e=a("./_enum-bug-keys");b.exports=Object.keys||function(a){return d(a,e)}},{"./_enum-bug-keys":26,"./_object-keys-internal":53}],55:[function(a,b,c){c.f={}.propertyIsEnumerable},{}],56:[function(a,b,c){b.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},{}],57:[function(a,b,c){b.exports=a("./_hide")},{"./_hide":32}],58:[function(a,b,c){var d=a("./_is-object"),e=a("./_an-object"),f=function(a,b){if(e(a),!d(b)&&null!==b)throw TypeError(b+": can't set as prototype!")};b.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(b,c,d){try{d=a("./_ctx")(Function.call,a("./_object-gopd").f(Object.prototype,"__proto__").set,2),d(b,[]),c=!(b instanceof Array)}catch(a){c=!0}return function(a,b){return f(a,b),c?a.__proto__=b:d(a,b),a}}({},!1):void 0),check:f}},{"./_an-object":18,"./_ctx":22,"./_is-object":37,"./_object-gopd":48}],59:[function(a,b,c){var d=a("./_object-dp").f,e=a("./_has"),f=a("./_wks")("toStringTag");b.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,f)&&d(a,f,{configurable:!0,value:b})}},{"./_has":31,"./_object-dp":46,"./_wks":72}],60:[function(a,b,c){var d=a("./_shared")("keys"),e=a("./_uid");b.exports=function(a){return d[a]||(d[a]=e(a))}},{"./_shared":61,"./_uid":69}],61:[function(a,b,c){var d=a("./_global"),e="__core-js_shared__",f=d[e]||(d[e]={});b.exports=function(a){return f[a]||(f[a]={})}},{"./_global":30}],62:[function(a,b,c){var d=a("./_to-integer"),e=a("./_defined");b.exports=function(a){return function(b,c){var f,g,h=String(e(b)),i=d(c),j=h.length;return i<0||i>=j?a?"":void 0:(f=h.charCodeAt(i),f<55296||f>56319||i+1===j||(g=h.charCodeAt(i+1))<56320||g>57343?a?h.charAt(i):f:a?h.slice(i,i+2):(f-55296<<10)+(g-56320)+65536)}}},{"./_defined":23,"./_to-integer":64}],63:[function(a,b,c){var d=a("./_to-integer"),e=Math.max,f=Math.min;b.exports=function(a,b){return a=d(a),a<0?e(a+b,0):f(a,b)}},{"./_to-integer":64}],64:[function(a,b,c){var d=Math.ceil,e=Math.floor;b.exports=function(a){return isNaN(a=+a)?0:(a>0?e:d)(a)}},{}],65:[function(a,b,c){var d=a("./_iobject"),e=a("./_defined");b.exports=function(a){return d(e(a))}},{"./_defined":23,"./_iobject":35}],66:[function(a,b,c){var d=a("./_to-integer"),e=Math.min;b.exports=function(a){return a>0?e(d(a),9007199254740991):0}},{"./_to-integer":64}],67:[function(a,b,c){var d=a("./_defined");b.exports=function(a){return Object(d(a))}},{"./_defined":23}],68:[function(a,b,c){var d=a("./_is-object");b.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":37}],69:[function(a,b,c){var d=0,e=Math.random();b.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++d+e).toString(36))}},{}],70:[function(a,b,c){var d=a("./_global"),e=a("./_core"),f=a("./_library"),g=a("./_wks-ext"),h=a("./_object-dp").f;b.exports=function(a){var b=e.Symbol||(e.Symbol=f?{}:d.Symbol||{});"_"==a.charAt(0)||a in b||h(b,a,{value:g.f(a)})}},{"./_core":21,"./_global":30,"./_library":43,"./_object-dp":46,"./_wks-ext":71}],71:[function(a,b,c){c.f=a("./_wks")},{"./_wks":72}],72:[function(a,b,c){var d=a("./_shared")("wks"),e=a("./_uid"),f=a("./_global").Symbol,g="function"==typeof f,h=b.exports=function(a){return d[a]||(d[a]=g&&f[a]||(g?f:e)("Symbol."+a))};h.store=d},{"./_global":30,"./_shared":61,"./_uid":69}],73:[function(a,b,c){"use strict";var d=a("./_add-to-unscopables"),e=a("./_iter-step"),f=a("./_iterators"),g=a("./_to-iobject");b.exports=a("./_iter-define")(Array,"Array",function(a,b){this._t=g(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,e(1)):"keys"==b?e(0,c):"values"==b?e(0,a[c]):e(0,[c,a[c]])},"values"),f.Arguments=f.Array,d("keys"),d("values"),d("entries")},{"./_add-to-unscopables":17,"./_iter-define":39,"./_iter-step":40,"./_iterators":41,"./_to-iobject":65}],74:[function(a,b,c){var d=a("./_export");d(d.S,"Object",{create:a("./_object-create")})},{"./_export":28,"./_object-create":45}],75:[function(a,b,c){var d=a("./_export");d(d.S+d.F*!a("./_descriptors"),"Object",{defineProperty:a("./_object-dp").f})},{"./_descriptors":24,"./_export":28,"./_object-dp":46}],76:[function(a,b,c){var d=a("./_export");d(d.S,"Object",{setPrototypeOf:a("./_set-proto").set})},{"./_export":28,"./_set-proto":58}],77:[function(a,b,c){},{}],78:[function(a,b,c){"use strict";var d=a("./_string-at")(!0);a("./_iter-define")(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=d(b,c),this._i+=a.length,{value:a,done:!1})})},{"./_iter-define":39,"./_string-at":62}],79:[function(a,b,c){"use strict";var d=a("./_global"),e=a("./_has"),f=a("./_descriptors"),g=a("./_export"),h=a("./_redefine"),i=a("./_meta").KEY,j=a("./_fails"),k=a("./_shared"),l=a("./_set-to-string-tag"),m=a("./_uid"),n=a("./_wks"),o=a("./_wks-ext"),p=a("./_wks-define"),q=a("./_keyof"),r=a("./_enum-keys"),s=a("./_is-array"),t=a("./_an-object"),u=a("./_to-iobject"),v=a("./_to-primitive"),w=a("./_property-desc"),x=a("./_object-create"),y=a("./_object-gopn-ext"),z=a("./_object-gopd"),A=a("./_object-dp"),B=a("./_object-keys"),C=z.f,D=A.f,E=y.f,F=d.Symbol,G=d.JSON,H=G&&G.stringify,I="prototype",J=n("_hidden"),K=n("toPrimitive"),L={}.propertyIsEnumerable,M=k("symbol-registry"),N=k("symbols"),O=k("op-symbols"),P=Object[I],Q="function"==typeof F,R=d.QObject,S=!R||!R[I]||!R[I].findChild,T=f&&j(function(){return 7!=x(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=C(P,b);d&&delete P[b],D(a,b,c),d&&a!==P&&D(P,b,d)}:D,U=function(a){var b=N[a]=x(F[I]);return b._k=a,b},V=Q&&"symbol"==typeof F.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof F},W=function(a,b,c){return a===P&&W(O,b,c),t(a),b=v(b,!0),t(c),e(N,b)?(c.enumerable?(e(a,J)&&a[J][b]&&(a[J][b]=!1),c=x(c,{enumerable:w(0,!1)})):(e(a,J)||D(a,J,w(1,{})),a[J][b]=!0),T(a,b,c)):D(a,b,c)},X=function(a,b){t(a);for(var c,d=r(b=u(b)),e=0,f=d.length;f>e;)W(a,c=d[e++],b[c]);return a},Y=function(a,b){return void 0===b?x(a):X(x(a),b)},Z=function(a){var b=L.call(this,a=v(a,!0));return!(this===P&&e(N,a)&&!e(O,a))&&(!(b||!e(this,a)||!e(N,a)||e(this,J)&&this[J][a])||b)},$=function(a,b){if(a=u(a),b=v(b,!0),a!==P||!e(N,b)||e(O,b)){var c=C(a,b);return!c||!e(N,b)||e(a,J)&&a[J][b]||(c.enumerable=!0),c}},_=function(a){for(var b,c=E(u(a)),d=[],f=0;c.length>f;)e(N,b=c[f++])||b==J||b==i||d.push(b);return d},aa=function(a){for(var b,c=a===P,d=E(c?O:u(a)),f=[],g=0;d.length>g;)!e(N,b=d[g++])||c&&!e(P,b)||f.push(N[b]);return f};Q||(F=function(){if(this instanceof F)throw TypeError("Symbol is not a constructor!");var a=m(arguments.length>0?arguments[0]:void 0),b=function(c){this===P&&b.call(O,c),e(this,J)&&e(this[J],a)&&(this[J][a]=!1),T(this,a,w(1,c))};return f&&S&&T(P,a,{configurable:!0,set:b}),U(a)},h(F[I],"toString",function(){return this._k}),z.f=$,A.f=W,a("./_object-gopn").f=y.f=_,a("./_object-pie").f=Z,a("./_object-gops").f=aa,f&&!a("./_library")&&h(P,"propertyIsEnumerable",Z,!0),o.f=function(a){return U(n(a))}),g(g.G+g.W+g.F*!Q,{Symbol:F});for(var ba="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ca=0;ba.length>ca;)n(ba[ca++]);for(var ba=B(n.store),ca=0;ba.length>ca;)p(ba[ca++]);g(g.S+g.F*!Q,"Symbol",{for:function(a){return e(M,a+="")?M[a]:M[a]=F(a)},keyFor:function(a){if(V(a))return q(M,a);throw TypeError(a+" is not a symbol!")},useSetter:function(){S=!0},useSimple:function(){S=!1}}),g(g.S+g.F*!Q,"Object",{create:Y,defineProperty:W,defineProperties:X,getOwnPropertyDescriptor:$,getOwnPropertyNames:_,getOwnPropertySymbols:aa}),G&&g(g.S+g.F*(!Q||j(function(){var a=F();return"[null]"!=H([a])||"{}"!=H({a:a})||"{}"!=H(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!V(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&s(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!V(b))return b}),d[1]=b,H.apply(G,d)}}}),F[I][K]||a("./_hide")(F[I],K,F[I].valueOf),l(F,"Symbol"),l(Math,"Math",!0),l(d.JSON,"JSON",!0)},{"./_an-object":18,"./_descriptors":24,"./_enum-keys":27,"./_export":28,"./_fails":29,"./_global":30,"./_has":31,"./_hide":32,"./_is-array":36,"./_keyof":42,"./_library":43,"./_meta":44,"./_object-create":45,"./_object-dp":46,"./_object-gopd":48,"./_object-gopn":50,"./_object-gopn-ext":49,"./_object-gops":51,"./_object-keys":54,"./_object-pie":55,"./_property-desc":56,"./_redefine":57,"./_set-to-string-tag":59,"./_shared":61,"./_to-iobject":65,"./_to-primitive":68,"./_uid":69,"./_wks":72,"./_wks-define":70,"./_wks-ext":71}],80:[function(a,b,c){a("./_wks-define")("asyncIterator")},{"./_wks-define":70}],81:[function(a,b,c){a("./_wks-define")("observable")},{"./_wks-define":70}],82:[function(a,b,c){a("./es6.array.iterator");for(var d=a("./_global"),e=a("./_hide"),f=a("./_iterators"),g=a("./_wks")("toStringTag"),h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],i=0;i<5;i++){var j=h[i],k=d[j],l=k&&k.prototype;l&&!l[g]&&e(l,g,j),f[j]=f.Array}},{"./_global":30,"./_hide":32,"./_iterators":41,"./_wks":72,"./es6.array.iterator":73}],83:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/possibleConstructorReturn"),h=d(g),i=a("babel-runtime/helpers/inherits"),j=d(i),k=a("./util/eventEmitter"),l=d(k),m=function(a){function b(){return(0,f.default)(this,b),(0,h.default)(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return(0,j.default)(b,a),b}(l.default);c.default=m},{"./util/eventEmitter":95,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],84:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DRM_SESSION_UPDATE_FAILED:"drm.session.update.failed",DRM_GENERATE_LICENSE_CHALLENGE_FAILED:"drm.generate.license.challenge.failed",DRM_LOAD_LICENSE_KEY_FAILED:"drm.load.license.key.failed",DRM_SESSION_KEY_ERROR:"drm.session.key.error",DRM_GENERATE_MEDIA_KEYS_FAILED:"drm.generate.media.keys.failed",LOAD_SEGMENT_ERROR:"load.segment.error",LOAD_MANIFEST_ERROR:"load.segment.manifest",PLAYBACK_ERROR:"playback.error"};c.default=d},{}],85:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ACQUIRING_LICENSE:"acquiringLicense",AD_END:"adEnd",AD_START:"adStart",AUDIO_TRACK_LIST:"audioTracks",CAN_PLAY:"canplay",CREATED:"created",DESTROY:"destroy",DRM_KEY_ERROR:"drmKeyError",DURATION:"duration",ENDED:"ended",ENCRYPTED:"encrypted",ERROR:"error",FALLBACK:"fallback",FULLSCREEN_CHANGED:"fullscreenChanged",GUI_READY:"guiReady",HEAD_TIME:"headTime",INITIALIZED:"initialized",LOAD_METADATA:"loadedmetadata",LOAD_START:"loadstart",LICENSE_ACQUIRED:"licenseAcquired",LOAD:"load",MANIFEST_LOADED:"manifestLoaded",MANIFEST_UPDATED:"manifestUpdated",MANIFEST_UPDATE_ERROR:"manifestUpdateError",METADATA:"metadata",MONITOR:"monitor",MUTED:"muted",NEW_MEDIA:"newMedia",OFFLINE:"offline",ON_LIVE:"live",ON_SOURCE:"source",ON_TIMESHIFT:"timeShift",OPEN:"open",PAUSED:"paused",PAUSE:"pause",PLAYING:"playing",PLAYLIST:"playlist",PROFILE_CHANGED:"profile",PROFILE_LIST:"profiles",PROGRESS:"progress",READY:"ready",RECONNECT:"reconnect",RENDERER_READY:"rendererReady",RESIZE:"resize",SEEK_END:"seeked",SEEK_START:"seeking",SETUP:"setup",STALLED:"stalled",STOPPED:"stopped",STYLES:"styles",TIME:"time",TIME_UPDATE:"timeupdate",UNMUTED:"unmuted",VOLUME_CHANGED:"volumeChanged",WAITING:"waiting",WAITING_END:"waitingEnd"};c.default=d},{}],86:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./player"),f=d(e),g=a("./util/url"),h=d(g),i=function(a){var b=new f.default(a);return{setup:function(){return b.setup.apply(b,arguments),b.load(),this},load:function(){return b.load.apply(b,arguments),this},play:function(){return b.play.apply(b,arguments),this},pause:function(){return b.pause.apply(b,arguments),this},seek:function(){return b.seek.apply(b,arguments),this},seekTo:function(){b.seekTo.apply(b,arguments)},seekByPercent:function(){b.seekByPercent.apply(b,arguments)},getRenderer:function(){return b.getRenderer()},stop:function(){return b.stop.apply(b,arguments),this},setVolume:function(){return b.setVolume.apply(b,arguments),this},getVolume:function(){return b.getVolume()},volumeUp:function(){return b.volumeUp.apply(b,arguments),this},volumeDown:function(){return b.volumeDown.apply(b,arguments),this},setFullscreen:function(){return b.setFullscreen(),this},on:function(){return b.on.apply(b,arguments),this},off:function(){return b.off.apply(b,arguments),this},getCurrentTime:function(){return b.getCurrentTime()},getDuration:function(){return b.getDuration()},getBufferLength:function(){return b.getBufferLength()},setMaxBufferLength:function(a){b.setMaxBufferLength(a)},getCurrentProfile:function(){return b.getCurrentProfile()},getProfiles:function(){return b.getProfiles()},restart:function(){return b.restart.apply(b,arguments),this},trigger:function(){return b.trigger.apply(b,arguments),this},getRendererElm:function(){return b.getRendererElm()},resize:function(){b.resize.apply(b,arguments)},destroy:function(){b.destroy.apply(b),b=null},getOptions:function(){return b.getOptions()},isLive:function(){return b.isLive()},formatTime:function(){return b.formatTime.apply(b,arguments)},switchProfile:function(){b.switchProfile.apply(b,arguments)},updateTimeShift:function(){b.updateTimeShift.apply(b,arguments)}}};i.VERSION="0.9.4",i.BUILD="2017-01-19 11:49:37",i.INFO="version: 0.9.4, built: 2017-01-19 11:49:37",i.Player=f.default,i.UrlUtil=h.default,i.renderers=[],i.players=[],i.modules=[],i.addPlayer=function(a){i.players.push(a)},i.removePlayer=function(a){i.players.indexOf(a)!==-1&&i.players.splice(i.players.indexOf(a),1)},i.addRenderer=function(a){i.renderers.push(a)},i.addModule=function(a){i.modules.push(a)},window.redcdnplayer=i,c.default=i},{"./player":90,"./util/url":100}],87:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(a){u.currentTime=a}function c(){t.off(),d()}function d(){t.off(),v.forEach(function(a){u.removeEventListener(a.event,a.fn)})}function e(){try{u.load()}catch(a){}}function h(){return u.paused}function i(){return u.volume}function j(a){u.volume=a}function m(a){u.src=a}function n(){var a=u.pause();a&&"undefined"!=typeof window.Promise&&a instanceof window.Promise&&a.catch(function(a){})}function o(){var a=u.play();a&&"undefined"!=typeof window.Promise&&a instanceof window.Promise&&a.catch(function(a){})}function p(a){return"currentTime"===a&&a in u?u[a]:a in u?u[a]:null}function q(){return u.duration}function r(){d(),l.forEach(function(a){var b={fn:function(b){t.trigger.call(t,a,b)},name:a};u.addEventListener(b.name,b.fn),v.push(b)})}var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=this,u=a||document.createElement("video"),v=[];return s.get("autoplay")&&u.setAttribute("autoplay","autoplay"),k.default.isMobile.any()&&(u.setAttribute("autoplay","autoplay"),u.setAttribute("controls","controls")),s.get("poster")&&u.setAttribute("poster",s.get("poster")),u.removeAttribute("controls"),r(),{on:this.on.bind(this),off:c,seek:b,load:e,getVolume:i,setVolume:j,setSource:m,pause:n,play:o,getProperty:p,getDuration:q,isPaused:h,getVideo:function(){return u},get height(){return u.offsetHeight},getCurrentTime:function(){return u.currentTime},getBufferLengthFromTime:function(a){return f(u,a)},getBufferRange:function(a,b){return g(u,a,b)},getReadyState:function(){return u.readyState},getDecodedFrameCount:function(){return HTMLVideoElement.prototype.getVideoPlaybackQuality?u.getVideoPlaybackQuality().totalVideoFrames:"webkitDecodedFrameCount"in u?u.webkitDecodedFrameCount:-1},getDroppedFrameCount:function(){return HTMLVideoElement.prototype.getVideoPlaybackQuality?u.getVideoPlaybackQuality().droppedVideoFrames:"webkitDroppedFrameCount"in u?u.webkitDroppedFrameCount:-1},hasBuffered:function(){return!!u.buffered.length},hasPlayed:function(){return!!u.played.length}}}function f(a,b){var c=0,d=void 0,e=void 0;if(a.buffered.length)for(var f=0;f<a.buffered.length;f++)d=a.buffered.start(f),e=a.buffered.end(f),d<=b&&e>=b&&(c=e-b);return c}function g(a,b,c){var d,e,f=a.buffered;if(null===f)return null;for(var g=0;g<f.length;g++)if(d=f.start(g),e=f.end(g),d>=b&&d<c)return{start:d,end:e};return null}Object.defineProperty(c,"__esModule",{value:!0}),c.VideoEvents=c.getBufferLengthFromTime=c.getBufferRange=void 0;var h=a("../util/eventEmitter"),i=d(h),j=a("../util/core"),k=d(j),l=["timeupdate","progress","seeking","playing","ended","waiting","pause","seeked","loadedmetadata","loadstart","stalled","error","canplay"];e.prototype=Object.create(i.default.prototype),c.getBufferRange=g,c.getBufferLengthFromTime=f,c.VideoEvents=l,c.default=e},{"../util/core":94,"../util/eventEmitter":95
}],88:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("../util/core"),j=d(i),k=function(){function a(b){(0,f.default)(this,a),this._sourceObj=b,this._id="mediaItem_"+j.default.generateRandomString(16),this._aspect=null,this._sources=null,this._drm=null,this._subtitle=null,this._jsonSource=this._sourceObj,this._splashscreen=null,this._thumbnail=null,this._supportedRenderers=[],"undefined"!=typeof this._sourceObj&&this.fillMediaItem(this,this._sourceObj)}return(0,h.default)(a,[{key:"getId",value:function(){return this._id}},{key:"getAspect",value:function(){return this._aspect}},{key:"setAspect",value:function(a){a.width&&a.height&&(this._aspect=parseInt(a.width)/parseInt(a.height))}},{key:"getSources",value:function(){return this._sources}},{key:"setSources",value:function(a){this._sources=a}},{key:"getSource",value:function(){return this._source}},{key:"setSource",value:function(a){this._source=a}},{key:"getSplashscreen",value:function(){return this._splashscreen}},{key:"setSplashscreen",value:function(a){this._splashscreen=a}},{key:"getThumbnail",value:function(){return this._thumbnail}},{key:"setThumbnail",value:function(a){this._thumbnail=a}},{key:"getDrm",value:function(){return this._drm}},{key:"setDrm",value:function(a){this._drm=a}},{key:"getSubtitle",value:function(){return this._subtitle}},{key:"setSubtitle",value:function(a){this._subtitle=a}},{key:"getJsonSource",value:function(){return this._jsonSource}},{key:"fillMediaItem",value:function(a,b){if("undefined"!=typeof b.sources&&a.setSources(b.sources),"undefined"!=typeof b.drm){for(var c in b.drm)b.drm.hasOwnProperty(c)&&(b.drm[c.toLowerCase()]=b.drm[c],delete b.drm[c]);a.setDrm(b.drm)}"undefined"!=typeof b.aspect&&a.setAspect(b.aspect),"undefined"!=typeof b.subtitle&&a.setSubtitle(b.subtitle),"undefined"!=typeof b.splashscreen&&a.setSplashscreen(b.splashscreen),"undefined"!=typeof b.thumbnail&&a.setThumbnail(b.thumbnail)}}]),a}();c.default=k},{"../util/core":94,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7}],89:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/typeof"),f=d(e),g=a("babel-runtime/helpers/classCallCheck"),h=d(g),i=a("babel-runtime/helpers/createClass"),j=d(i),k=a("./util/core"),l=d(k),m={debug:!1,autofocus:!0,autoAdaptation:!0,maxBufferLength:20,minBufferTime:null,startBufferLength:0,liveDelay:null,holder:null,poster:void 0,drm:null,cssPrefix:"atdsplayer",defaultBitrate:null,minAutoBitrate:null,maxAutoBitrate:null,considerDroppedFrames:!1,width:600,height:400,extra:{},name:l.default.generateRandomString(10),gstream:void 0,controls:"default",controlsLayout:"classic",rootUrl:null,reconnect:!1,bufferTime:2,firefoxMseEnabled:!0,keyboardEvents:!1,fullscreen:!0,smoothing:!0,modules:[],defaultAudioLanguage:null,renderer:{},rendererPriority:["dash","html5","silverlight","flash","audio"],timeShiftRenderers:["dash","silverlight","flash"],timeShiftEnabled:!1,volume:100,volumeType:"vertical",hideControls:!0,autoplay:!0,aspect:16/9,file:null,files:null,type:"video",timeShift:null,fallback:!0,skin:{name:"default",prefix:"atdsplayer",url:null}},n=function(){function a(){(0,h.default)(this,a),this.options=l.default.extendDeep({},m)}return(0,j.default)(a,[{key:"get",value:function(a){return a in this.options?this.options[a]:null}},{key:"set",value:function(a,b){a in this.options&&(this.options[a]=b)}},{key:"update",value:function(a){return"undefined"!=typeof a&&l.default.extend(this.options,a),this.options.skin&&("object"===(0,f.default)(this.options.skin)?(this.options.skin.prefix&&(this.options.cssPrefix=this.options.skin.prefix),this.options.skinUrl=this.options.skin.url):this.options.skin={name:this.options.skin,url:null,prefix:this.options.cssPrefix}),this.options.name="player_renderer_"+l.default.generateRandomString(10),this.options.deviceControls=!1,this.options}},{key:"getValueWithUnit",value:function(a,b){var c=a.toString().replace(/\d+/g,"");return c.length||(c=b||"px"),parseInt(a,10)+c}},{key:"getWidthWithUnit",value:function(){return this.getValueWithUnit(this.options.width)}},{key:"getHeightWithUnit",value:function(){return this.getValueWithUnit(this.options.height)}}]),a}();c.default=n},{"./util/core":94,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/typeof":10}],90:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/typeof"),f=d(e),g=a("babel-runtime/helpers/classCallCheck"),h=d(g),i=a("babel-runtime/helpers/createClass"),j=d(i),k=a("babel-runtime/helpers/possibleConstructorReturn"),l=d(k),m=a("babel-runtime/helpers/inherits"),n=d(m),o=a("./component"),p=d(o),q=a("./event/playerEvent"),r=d(q),s=a("./playlist"),t=d(s),u=a("./renderer"),v=d(u),w=a("./timeshift"),x=d(w),y=a("./util/core"),z=d(y),A=a("./options"),B=d(A),C=x.default,D=function(a){function b(a){(0,h.default)(this,b);var c=(0,l.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));switch(c.holderId=void 0,c._rendererObj=null,"undefined"==typeof a?"undefined":(0,f.default)(a)){case"object":c._rendererObj=a;break;case"string":c.holderId=a}return c.options=new B.default,c.playlist=new t.default,c.volume=c.options.get("volume"),c.renderer=null,c.timeShiftClass=C,c.timeShift=null,redcdnplayer.addPlayer(c),c}return(0,n.default)(b,a),(0,j.default)(b,[{key:"setup",value:function(a){return this.options.update(a),this.volume=this.options.get("volume"),this.trigger(r.default.SETUP),this}},{key:"_initialize",value:function(){this.registerModules(),this.timeShift=this.timeShiftFactory(),this.getPlaylist().done(this._create.bind(this)),this.trigger(r.default.INITIALIZED)}},{key:"getRendererObj",value:function(){return this._rendererObj}},{key:"getPlaylist",value:function(){return this.playlist.fetch(this.options.get("file"),this.options.get("files")).done(this.trigger.bind(this,r.default.PLAYLIST,this.playlist.list()))}},{key:"timeShiftFactory",value:function(){return new this.timeShiftClass(this)}},{key:"setTimeShiftClass",value:function(a){this.timeShiftClass=a}},{key:"_create",value:function(){var a=this.playlist.first();if(a.getDrm()&&this.options.set("drm",a.getDrm()),this.renderer=new v.default(a,this),!this.renderer.isSupported())return void this.trigger(r.default.ERROR,{code:200,type:"NO_SUPPORTED_RENDERER",renderer:null,message:"Given media file is not supported by any renderer."});this._registerEvents(),this.trigger(r.default.LOAD);var b=this.renderer.currentRenderer.mediaType,c=void 0;switch(b){case"DASH":c="DASH",b="HTML5";break;case"SS":c="SS",b="SILVERLIGHT";break;default:c=b}setTimeout(this.trigger.bind(this,r.default.RENDERER_READY,this.getRendererElm(),this.renderer.currentRenderer.url,b,c),0)}},{key:"isIndexMode",value:function(){return this.renderer.isIndexMode()}},{key:"getRendererElm",value:function(){return this.renderer.getRendererElm()}},{key:"getRenderer",value:function(){return this.renderer}},{key:"_registerEvents",value:function(){this.renderer.on(r.default.NEW_MEDIA,this.trigger.bind(this,r.default.NEW_MEDIA)),this.renderer.on(r.default.METADATA,this.trigger.bind(this,r.default.METADATA)),this.renderer.on(r.default.ERROR,this.trigger.bind(this,r.default.ERROR)),this.renderer.on(r.default.READY,this.trigger.bind(this,r.default.READY)),this.renderer.on(r.default.PLAYING,this.trigger.bind(this,r.default.PLAYING)),this.renderer.on(r.default.STOPPED,this.trigger.bind(this,r.default.STOPPED)),this.renderer.on(r.default.ENDED,this.trigger.bind(this,r.default.ENDED)),this.renderer.on(r.default.PAUSED,this.trigger.bind(this,r.default.PAUSED)),this.renderer.on(r.default.WAITING,this.trigger.bind(this,r.default.WAITING)),this.renderer.on(r.default.WAITING_END,this.trigger.bind(this,r.default.WAITING_END)),this.renderer.on(r.default.MONITOR,this.trigger.bind(this,r.default.TIME)),this.renderer.on(r.default.MONITOR,this.trigger.bind(this,r.default.MONITOR)),this.renderer.on(r.default.ON_SOURCE,this.trigger.bind(this,r.default.ON_SOURCE)),this.renderer.on(r.default.SEEK_END,this.trigger.bind(this,r.default.SEEK_END,this.getCurrentTime())),this.renderer.on(r.default.SEEK_START,this.trigger.bind(this,r.default.SEEK_START)),this.renderer.on(r.default.PROFILE_CHANGED,this.trigger.bind(this,r.default.PROFILE_CHANGED)),this.renderer.on(r.default.PROFILE_LIST,this.trigger.bind(this,r.default.PROFILE_LIST)),this.renderer.on(r.default.AUDIO_TRACK_LIST,this.trigger.bind(this,r.default.AUDIO_TRACK_LIST)),this.renderer.on(r.default.ON_LIVE,this.trigger.bind(this,r.default.ON_LIVE)),this.renderer.on(r.default.MANIFEST_LOADED,this.trigger.bind(this,r.default.MANIFEST_LOADED)),this.renderer.on(r.default.VOLUME_CHANGED,this.trigger.bind(this,r.default.VOLUME_CHANGED)),this.renderer.on(r.default.READY,this.ready.bind(this))}},{key:"registerModules",value:function(){var a=this,b=this.options.get("modules");redcdnplayer.modules.forEach(function(c){(c.enabled||b.indexOf(c.moduleId)!==-1)&&new c(a)})}},{key:"ready",value:function(){this.options.get("autoplay")&&(this.renderer.setVolume(this.options.get("volume")),this.renderer.play())}},{key:"restart",value:function(){this.renderer.restart()}},{key:"load",value:function(a){null!==this.renderer&&this.renderer.destroy(),"undefined"!=typeof a&&this.options.set("file",a),setTimeout(this._initialize.bind(this),0)}},{key:"switchProfile",value:function(a,b){b="undefined"==typeof b||!0,null!==this.renderer&&this.renderer.switchProfile(a,b)}},{key:"switchAudioTrack",value:function(a){this.renderer.switchAudioTrack(a)}},{key:"play",value:function(){this.renderer.play()}},{key:"pause",value:function(){this.renderer.pause()}},{key:"stop",value:function(){this.renderer.stop()}},{key:"isPaused",value:function(){return this.renderer.isPaused()}},{key:"resize",value:function(a,b){this.trigger(r.default.RESIZE,a,b)}},{key:"setVolume",value:function(a){this.options.set("volume",a),null!==this.renderer&&this.renderer.setVolume(a)}},{key:"getVolume",value:function(){return 100*this.renderer.getVolume()}},{key:"volumeUp",value:function(){var a=parseFloat(this.renderer.getVolume());a+=.1,a>1&&(a=1),this.renderer.setVolume(100*a)}},{key:"setDrm",value:function(a){this.options.set("drm",a)}},{key:"isStreamStarted",value:function(){return this.renderer.isStreamStarted()}},{key:"isStreamPaused",value:function(){return this.renderer.isStreamPaused()}},{key:"isLive",value:function(){return this.renderer.isLive()}},{key:"volumeDown",value:function(){var a=parseFloat(this.renderer.getVolume());a-=.1,a<0&&(a=0),this.renderer.setVolume(100*a)}},{key:"getCurrentTime",value:function(){return null===this.renderer?NaN:this.renderer.getCurrentTime()}},{key:"getDuration",value:function(){return null===this.renderer?NaN:this.renderer.getDuration()}},{key:"getBufferLength",value:function(){return null===this.renderer?NaN:this.renderer.getBufferLength()}},{key:"setMaxBufferLength",value:function(a){null!==this.renderer&&this.renderer.setMaxBufferLength(a),this.options.set("maxBufferLength",a)}},{key:"getCurrentProfile",value:function(){return null===this.renderer?0:this.renderer.getCurrentProfile()}},{key:"getProfiles",value:function(){return this.renderer.getProfiles()}},{key:"getAudioTracks",value:function(){return this.renderer.getAudioTracks()}},{key:"formatTime",value:function(a){return z.default.formatTime(a)}},{key:"seek",value:function(a){this.renderer.seek(a)}},{key:"seekByPercent",value:function(a){this.renderer.seekByPercent(a)}},{key:"seekTo",value:function(a){this.renderer.seekTo(a)}},{key:"updateTimeShift",value:function(a){this.options.set("timeShift",a),this.timeShift.update()}},{key:"getTimeShift",value:function(){return this.timeShift}},{key:"getOptions",value:function(){return this.options.options}},{key:"destroy",value:function(){this.trigger(r.default.DESTROY),this.off(),this.renderer.destroy(),redcdnplayer.removePlayer(this)}}]),b}(p.default);c.default=D},{"./component":83,"./event/playerEvent":85,"./options":89,"./playlist":91,"./renderer":92,"./timeshift":93,"./util/core":94,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9,"babel-runtime/helpers/typeof":10}],91:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/typeof"),f=d(e),g=a("babel-runtime/helpers/classCallCheck"),h=d(g),i=a("babel-runtime/helpers/createClass"),j=d(i),k=a("./util/http"),l=a("./util/redpromise"),m=d(l),n=a("./model/mediaItem"),o=d(n),p=function(){function a(){(0,h.default)(this,a),this.promise=null,this.mediaItems=[],this.mediaItemsHashMap={}}return(0,j.default)(a,[{key:"fetch",value:function(a,b){return a?this.loadFile(a):b?this.loadFiles(b):(new m.default).reject()}},{key:"list",value:function(){return this.mediaItems}},{key:"first",value:function(){return this.mediaItems[0]}},{key:"getById",value:function(a){return this.mediaItemsHashMap[a]}},{key:"loadFile",value:function(a){var b=new o.default,c={};if(this.mediaItems=[],this.mediaItemsHashMap={},this.promise=new m.default,"string"==typeof a){var d="mp4";a.indexOf("#")!==-1&&(d=a.split("#")[1]),c[d]=[{src:a}]}else for(var e in a)a.hasOwnProperty(e)&&(c[e]=[{src:a[e]}]);return b.setSources(c),this.mediaItems.push(b),this.mediaItemsHashMap[b.getId()]=b,this.promise.resolve()}},{key:"loadFiles",value:function(a){var b=this;if(this.promise=new m.default,this.mediaItems=[],this.mediaItemsHashMap={},"object"===("undefined"==typeof a?"undefined":(0,f.default)(a))){if(Array.isArray(a))for(var c=0;c<a.length;c++)this.mediaItems.push(a[c]);else this.mediaItems.push(a);return this.promise.resolve()}return k.http.get(a).done(function(a){var c,d=JSON.parse(a.data);if(Array.isArray(d))for(var e=0;e<d.length;e++)c=new o.default(d[e]),b.mediaItemsHashMap[c.getId()]=c,b.mediaItems.push(c);else c=new o.default(d),b.mediaItemsHashMap[c.getId()]=c,b.mediaItems.push(c);b.promise.resolve()}).fail(function(){b.promise.reject()}),this.promise}}]),a}();c.default=p},{"./model/mediaItem":88,"./util/http":97,"./util/redpromise":98,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/typeof":10}],92:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("babel-runtime/helpers/possibleConstructorReturn"),j=d(i),k=a("babel-runtime/helpers/inherits"),l=d(k),m=a("./index"),n=d(m),o=a("./component"),p=d(o),q=a("./event/playerEvent"),r=d(q),s=a("./util/timer"),t=d(s),u=function(a){function b(a,c){(0,f.default)(this,b);var d=(0,j.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.mediaItem=a,d.player=c,d.rendererObj=d.player.getRendererObj(),d.options=d.player.options,d.isStarted=!1,d.rendererList=d.getRendererList(d.mediaItem.getSources()),d.rendererList.length?(d.currentRenderer=d.getFirstValidRenderer(d.rendererList),d.timer=new t.default(350,d.monitor.bind(d)),null!==d.currentRenderer&&(d.create(d.currentRenderer.renderer),d.registerEvents()),d):(0,j.default)(d)}return(0,l.default)(b,a),(0,h.default)(b,[{key:"isSupported",value:function(){return"undefined"!=typeof this.currentRenderer}},{key:"monitor",value:function(){this.trigger(r.default.MONITOR,this.rendererObj.getCurrentTime(),this.rendererObj.getDuration())}},{key:"isStreamPaused",value:function(){return this.rendererObj.isPaused}},{key:"isStreamStarted",value:function(){return this.isStarted}},{key:"create",value:function(a){this.rendererObj=new a(this.player,this.rendererObj)}},{key:"setSource",value:function(a){this.isStarted=!0,this.rendererObj.setSource(a),this.timer.start()}},{key:"getRendererElm",value:function(){return this.rendererObj.getRendererElm()}},{key:"play",value:function(){this.rendererObj.isPaused=!1,this.isStarted?(this.timer.start(),this.rendererObj.play()):this.setSource(this.getUrl())}},{key:"pause",value:function(){this.rendererObj.pause()}},{key:"stop",value:function(){this.isStarted=!1,this.timer.stop(),this.rendererObj.stop()}},{key:"seek",value:function(a){this.rendererObj.seek(a),this.player.timeShift.isVod()&&(this.player.timeShift.mode="vodShifted"),this.player.timeShift.isLive()&&(this.player.timeShift.mode="liveDelayed")}},{key:"seekByPercent",value:function(a){var b=this.getCurrentTime()/this.getDuration()*100;a=a||20,b>99&&a>0||(b+=a,b>99&&(b=99),this.seek(b))}},{key:"seekTo",value:function(a){this.rendererObj.seekTo(a)}},{key:"restart",value:function(){this.isStarted=!1,this.play()}},{key:"getCurrentTime",value:function(){return this.rendererObj.getCurrentTime()}},{key:"getDuration",value:function(){return this.rendererObj.getDuration()}},{key:"getBufferLength",value:function(){return this.rendererObj.getBufferLength()}},{key:"setMaxBufferLength",value:function(a){this.rendererObj.setMaxBufferLength(a)}},{key:"getProfiles",value:function(){return this.rendererObj.getProfiles()}},{key:"getAudioTracks",value:function(){return this.rendererObj.getAudioTracks()}},{key:"getCurrentProfile",value:function(){return"function"==typeof this.rendererObj.getCurrentProfile?this.rendererObj.getCurrentProfile():0}},{key:"onEnded",value:function(){this.isStarted=!1,this.timer.stop()}},{key:"setVolume",value:function(a){a>100&&(a=100),a<0&&(a=0),this.rendererObj.setVolume(a/100)}},{key:"getVolume",value:function(){return this.rendererObj.getVolume()}},{key:"destroy",value:function(){this.timer&&(this.timer.stop(),this.timer=null),null!==this.rendererObj&&(this.rendererObj.off(),this.rendererObj.destroy(),this.rendererObj=null)}},{key:"registerEvents",value:function(){this.rendererObj.on(r.default.NEW_MEDIA,this.trigger.bind(this,r.default.NEW_MEDIA)),this.rendererObj.on(r.default.METADATA,this.trigger.bind(this,r.default.METADATA)),this.rendererObj.on(r.default.READY,this.trigger.bind(this,r.default.READY)),this.rendererObj.on(r.default.PLAYING,this.trigger.bind(this,r.default.PLAYING)),this.rendererObj.on(r.default.PAUSED,this.trigger.bind(this,r.default.PAUSED)),this.rendererObj.on(r.default.WAITING,this.trigger.bind(this,r.default.WAITING)),this.rendererObj.on(r.default.WAITING_END,this.trigger.bind(this,r.default.WAITING_END)),this.rendererObj.on(r.default.SEEK_END,this.trigger.bind(this,r.default.SEEK_END)),this.rendererObj.on(r.default.SEEK_START,this.trigger.bind(this,r.default.SEEK_START)),this.rendererObj.on(r.default.STOPPED,this.trigger.bind(this,r.default.STOPPED)),this.rendererObj.on(r.default.ENDED,this.trigger.bind(this,r.default.ENDED)),this.rendererObj.on(r.default.PROFILE_CHANGED,this.trigger.bind(this,r.default.PROFILE_CHANGED)),this.rendererObj.on(r.default.PROFILE_LIST,this.trigger.bind(this,r.default.PROFILE_LIST)),this.rendererObj.on(r.default.AUDIO_TRACK_LIST,this.trigger.bind(this,r.default.AUDIO_TRACK_LIST)),this.rendererObj.on(r.default.ON_LIVE,this.trigger.bind(this,r.default.ON_LIVE)),this.rendererObj.on(r.default.ON_SOURCE,this.trigger.bind(this,r.default.ON_SOURCE)),this.rendererObj.on(r.default.ERROR,this.trigger.bind(this,r.default.ERROR)),this.rendererObj.on(r.default.VOLUME_CHANGED,this.trigger.bind(this,r.default.VOLUME_CHANGED)),this.rendererObj.on(r.default.MANIFEST_LOADED,this.trigger.bind(this,r.default.MANIFEST_LOADED)),this.rendererObj.on(r.default.ENDED,this.onEnded.bind(this))}},{key:"getUrl",value:function(){return this.currentRenderer.url}},{key:"isLive",value:function(){return this.rendererObj.isLive()}},{key:"isPaused",value:function(){return this.rendererObj.isPaused}},{key:"isIndexMode",value:function(){return!(!this.rendererObj.isIndexMode||!this.rendererObj.isIndexMode())}},{key:"switchProfile",value:function(a,b){this.rendererObj.switchProfile(a,b)}},{key:"switchAudioTrack",value:function(a){this.rendererObj.switchAudioTrack(a)}},{key:"getFirstValidRenderer",value:function(a){return a.length?a.shift():null}},{key:"getRendererList",value:function(a){var b,c,d,e,f,g=[];for(n.default.renderers.sort(function(a,b){return a.priority>b.priority}),b=0;b<n.default.renderers.length;b++){e=n.default.renderers[b];for(c in a)if(a.hasOwnProperty(c))for(d in e.mediaTypes)e.mediaTypes.hasOwnProperty(d)&&(f=e.mediaTypes[d],c.toUpperCase()===d&&e.canPlayType(f,this.options)&&g.push({url:a[c][0].src,renderer:e,mimeType:f,mediaType:d}))}return g}}]),b}(p.default);c.default=u},{"./component":83,"./event/playerEvent":85,"./index":86,"./util/timer":99,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],93:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.TimeShiftMode=void 0;var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("./util/core"),j=d(i),k=a("./event/playerEvent"),l=d(k),m=a("./util/url"),n=d(m),o={LIVE:"live",LIVE_DELAYED:"liveDelayed",VOD:"vod",VOD_SHIFTED:"vodShifted"},p=function(){function a(b){(0,f.default)(this,a),this.player=b,this.player.on(l.default.INITIALIZED,this.update.bind(this)),this.params=this.getParams(),this.mode=null,this.hasDvrWindow=!1,this.start=-1,this.dvrWindow=-1,this.stop=-1,this.play=-1,this.head=-1,this.baseTimeStamp=9783072e5,this.headTime=-1,this.currentTime=0,this.headTimeInterval=0}return(0,h.default)(a,[{key:"update",value:function(){this.params=this.getParams(),this.player.options.get("timeShiftEnabled")&&(this.mode=o.LIVE),null!==this.params&&("undefined"!=typeof this.params.baseTimeStamp&&(this.baseTimeStamp=this.params.baseTimeStamp),this.params.dvrWindow&&(this.hasDvrWindow=!0,this.dvrWindow=this.params.dvrWindow),this.params.start&&(this.start=1e3*j.default.parseDateTime(this.params.start)),this.params.play&&(this.play=1e3*j.default.parseDateTime(this.params.play)),this.params.start&&this.params.stop&&(this.stop=1e3*j.default.parseDateTime(this.params.stop)),null===this.mode&&(this.mode=o.LIVE,this.dvrWindow>0&&(this.mode=o.LIVE),this.params.start&&(this.mode=o.LIVE,this.params.play&&(this.mode=o.LIVE_DELAYED)),this.params.start&&this.params.stop&&(this.mode=o.VOD)),setTimeout(this.player.trigger.bind(this.player,l.default.ON_TIMESHIFT),0))}},{key:"setHeadTime",value:function(a){this.headTime=a+this.getBaseTimeStamp(),this.updateHeadTime()}},{key:"setDvrWindow",value:function(a){this.isEnabled()&&(this.hasDvrWindow=!0,this.dvrWindow=a)}},{key:"updateHeadTime",value:function(){clearInterval(this.headTimeInterval),this.headTimeInterval=setInterval(function(){this.headTime+=1e3}.bind(this),1e3)}},{key:"getBaseTimeStamp",value:function(){return this.baseTimeStamp}},{key:"getDvrWindow",value:function(){return this.dvrWindow}},{key:"getStart",value:function(){return this.hasDvrWindow&&this.dvrWindow>0&&this.headTime>0?this.headTime-1e3*this.dvrWindow:this.start}},{key:"getManifestStartFrom",value:function(a){return parseInt(this.getStart()+1e3*a-this.getBaseTimeStamp())}},{key:"getPlayStart",value:function(){return this.play}},{key:"getStop",value:function(){return this.stop}},{key:"getHeadTime",value:function(){return this.headTime}},{key:"getParams",value:function(){return this.player.options.get("timeShift")}},{key:"isEnabled",value:function(){return null!==this.mode}},{key:"isLive",value:function(){return this.mode===o.LIVE||this.mode===o.LIVE_DELAYED}},{key:"isVod",value:function(){return this.mode===o.VOD||this.mode===o.VOD_SHIFTED}},{key:"setLive",value:function(){this.mode=o.LIVE}},{key:"isVodEnded",value:function(a){return a>this.stop}},{key:"reset",value:function(){this.mode===o.LIVE_DELAYED&&(this.mode=o.LIVE),this.mode===o.VOD_SHIFTED&&(this.mode=o.VOD)}},{key:"generateUrl",value:function(a,b,c){return"undefined"!=typeof c?this.generateUrlWithShift(a,c):(this.isLive()&&this.getStart()>0&&(a=n.default.removeQueryParam(a,"startTime"),a+=(a.indexOf("?")!==-1?"&":"?")+"startTime="+(this.getStart()-this.getBaseTimeStamp())),this.mode!==o.VOD&&this.mode!==o.VOD_SHIFTED||(a=n.default.removeQueryParam(a,"startTime"),a+=(a.indexOf("?")!==-1?"&":"?")+"startTime="+(this.getStart()-this.getBaseTimeStamp()),a=n.default.removeQueryParam(a,"stopTime"),a+="&stopTime="+(this.getStop()-this.getBaseTimeStamp())),this.mode===o.LIVE_DELAYED&&(a=n.default.removeQueryParam(a,"startTime"),a+=(a.indexOf("?")!==-1?"&":"?")+"startTime="+(this.getPlayStart()-this.getBaseTimeStamp())),a)}},{key:"generateUrlWithShift",value:function(a,b){var c,d,e=a;return(this.hasDvrWindow&&this.dvrWindow>=0||this.start>=0)&&(e=n.default.removeQueryParam(e,"startTime"),e=n.default.removeQueryParam(e,"stopTime"),d=parseInt(this.getStart()+1e3*b-this.getBaseTimeStamp()),c="startTime="+d,e+=(e.indexOf("?")!==-1?"&":"?")+c),e}},{key:"isEligibleToUpdate",value:function(){return this.mode===o.LIVE_DELAYED||this.mode===o.LIVE||this.mode===o.VOD||this.mode===o.VOD_SHIFTED}}]),a}();c.default=p,c.TimeShiftMode=o},{"./event/playerEvent":85,"./util/core":94,"./util/url":100,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7}],94:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/typeof"),f=d(e),g=a("../util/redpromise"),h=d(g),i={extend:function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},extendDeep:function(a,b){var c,d="[object Array]";a=a||{};for(c in b)b.hasOwnProperty(c)&&("object"===(0,f.default)(b[c])&&null!==b[c]?(a[c]=Object.prototype.toString.call(b[c])===d?[]:{},this.extendDeep(a[c],b[c])):a[c]=b[c]);return a},generateRandomString:function(a){var b,c="",d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(b=0;b<a;b++)c+=d.charAt(Math.floor(Math.random()*d.length));return c},formatTime:function(a){isNaN(a)&&(a=0);var b=Math.floor(a/3600),c=Math.floor(a/60)%60,d=Math.floor(a)%60;return(b?i.addLeadingZero(b)+":":"")+i.addLeadingZero(c)+":"+this.addLeadingZero(d)},formatDateTime:function(a){var b=i.addLeadingZero;return a.getFullYear()+"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+" "+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())},addLeadingZero:function(a){return a<10?"0"+a:""+a},parseTime:function(a){for(var b=a.split(":"),c=0,d=2;b.length>0;)c+=Math.pow(60,d)*parseInt(b.shift(),10),d--;return c},isDST:function(a){var b=new Date(a.getFullYear(),0,1),c=new Date(a.getFullYear(),6,1);return Math.min(b.getTimezoneOffset(),c.getTimezoneOffset())==a.getTimezoneOffset()},parseDate:function(a){var b=a.split("-");b[1]--;var c=i.isDST(new Date(b[0],b[1],b[2])),d=new Date(new Date(b[0],b[1],b[2]).getTime()).getTimezoneOffset()+(c?120:60);return d=60*d*1e3/1e3,new Date(b[0],b[1],b[2]).getTime()/1e3-d},parseDateTime:function(a){var b=a.split(" ");return i.parseDate(b[0])+i.parseTime(b[1])},getCssUrl:function(a,b){if(b&&b.url)return b.url;var c,d=document.createElement("a"),e="default";return b&&b.name&&(e=b.name),d.href=location.href,c=d.protocol+"//r.dcs.redcdn.pl/http/o2/web/player/redcdn/"+a+"/css/",c+e+".css"},loadCss:function(a){var b=new h.default,c=document.createElement("link"),d=document.getElementsByTagName("link"),e=void 0;for(e=0;e<d.length;e++)if(d[e].getAttribute("href")===a)return b.resolve();return c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",a),document.getElementsByTagName("head")[0].appendChild(c),c.onload=function(){return b.resolve()},c.onerror=function(){return b.reject()},b},isMobile:{match:function(a){return navigator.userAgent.match(a)},Android:function(){return i.isMobile.match(/Android/i)},BlackBerry:function(){return i.isMobile.match(/BlackBerry/i)},iOS:function(){return i.isMobile.match(/iPhone|iPad|iPod/i)},Opera:function(){return i.isMobile.match(/Opera Mini/i)},Windows:function(){return i.isMobile.match(/IEMobile/i)},any:function(){return i.isMobile.Android()||i.isMobile.BlackBerry()||i.isMobile.iOS()||i.isMobile.Opera()||i.isMobile.Windows()}},getBrowserLanguage:function(){return"undefined"!=typeof navigator.language?navigator.language:"undefined"!=typeof navigator.languages?navigator.languages[0].split("-")[0]:null},nxClickHandlerCreator:function(a,b,c){var d=0,e=0;return b||(b=1),function(f){return clearTimeout(d),++e>=b?(d=0,e=0,void a(f)):void(d=setTimeout(function(a){c&&e===b-1&&c(a),d=0,e=0},300,f))}}};c.default=i},{"../util/redpromise":98,"babel-runtime/helpers/typeof":10}],95:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=function(){function a(){(0,f.default)(this,a),this.callbacks={}}return(0,h.default)(a,[{key:"on",value:function(a,b){var c;this.callbacks=this.callbacks||{},c="string"!=typeof a?[a]:a.split(" ");for(var d=0;d<c.length;++d)this.callbacks.hasOwnProperty(c[d])||(this.callbacks[c[d]]=[]),this.callbacks[c[d]].push(b)}},{key:"off",value:function(a,b){if(this.callbacks=this.callbacks||{},null===a||void 0===a||""===a)return void(this.callbacks={});var c;c="string"!=typeof a?[a]:a.split(" ");for(var d=0;d<c.length;++d)if(b){if(this.callbacks[c[d]]&&this.callbacks[c[d]].length)for(var e;(e=this.callbacks[c[d]].indexOf(b))!==-1;)this.callbacks[c[d]].splice(e,1)}else delete this.callbacks[c[d]]}},{key:"trigger",value:function(a){var b,c=Array.prototype.slice.call(arguments);if(this.callbacks=this.callbacks||{},c.shift(),this.callbacks.hasOwnProperty(a)){b=this.callbacks[a];for(var d=0;d<b.length;d++)b[d].apply(this,c)}}}]),a}();c.default=i},{"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7}],96:[function(a,b,c){"use strict";function d(a,b){function c(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var d=i.getData(a);0===d.handlers[b].length&&(delete d.handlers[b],document.removeEventListener?a.removeEventListener(b,d.dispatcher,!1):document.detachEvent&&a.detachEvent("on"+b,d.dispatcher)),c(d.handlers)&&(delete d.handlers,delete d.dispatcher),c(d)&&i.removeData(a)}function e(a){function b(){return!0}function c(){return!1}if(!a||!a.stopPropagation){var d=a||window.event;a={};for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e]);if(a.target||(a.target=a.srcElement||document),a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement,a.preventDefault=function(){a.returnValue=!1,a.isDefaultPrevented=b},a.isDefaultPrevented=c,a.stopPropagation=function(){a.cancelBubble=!0,a.isPropagationStopped=b},a.isPropagationStopped=c,a.stopImmediatePropagation=function(){this.isImmediatePropagationStopped=b,this.stopPropagation()},a.isImmediatePropagationStopped=c,null!==a.clientX){var f=document.documentElement,g=document.body;a.pageX=a.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=a.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)}a.which=a.charCode||a.keyCode}return a}Object.defineProperty(c,"__esModule",{value:!0});var f={},g=1,h="data"+(new Date).getTime(),i=function(){};i.prototype.on=function(a,b){return this.el=this.el||document.createElement("div"),i.on(this.el,a,i.proxy(this,b)),this},i.prototype.off=function(a,b){return this.el=this.el||document.createElement("div"),i.off(this.el,a,b),this},i.prototype.fireEvent=function(a,b){this.el=this.el||document.createElement("div"),i.fireEvent(this.el,a,b)},i.getData=function(a){var b=a[h];return b||(b=a[h]=g++,f[b]={}),f[b]},i.removeData=function(a){var b=a[h];if(b){delete f[b];try{delete a[h]}catch(b){a.removeAttribute&&a.removeAttribute(h);
}}},i.on=function(a,b,c){var d=i.getData(a);d.handlers||(d.handlers={}),d.handlers[b]||(d.handlers[b]=[]),c.guid||(c.guid=g++),d.handlers[b].push(c),d.dispatcher||(d.disabled=!1,d.dispatcher=function(b){if(!d.disabled){b=e(b);var c=d.handlers[b.type];if(c)for(var f=0;f<c.length;f++)c[f].call(a,b)}}),1===d.handlers[b].length&&(document.addEventListener?a.addEventListener(b,d.dispatcher,!1):document.attachEvent&&a.attachEvent("on"+b,d.dispatcher))},i.off=function(a,b,c){var e=i.getData(a);if(e.handlers){var f=function(b){e.handlers[b]=[],d(a,b)};if(b){var g=e.handlers[b];if(g){if(!c)return void f(b);if(c.guid)for(var h=0;h<g.length;h++)g[h].guid===c.guid&&g.splice(h--,1);d(a,b)}}else for(var j in e.handlers)e.handlers.hasOwnProperty(j)&&f(j)}},i.proxy=function(a,b){b.guid||(b.guid=g++);var c=function(){return b.apply(a,arguments)};return c.guid=b.guid,c},i.fireEvent=function(a,b,c){var d=i.getData(a),f=a.parentNode||a.ownerDocument;if("string"==typeof c&&(c={type:c,target:a}),c=e(c),d.dispatcher&&d.dispatcher.call(a,c),f&&!c.isPropagationStopped())i.fireEvent(f,c);else if(!f&&!c.isDefaultPrevented()){var g=i.getData(c.target);c.target[c.type]&&(g.disabled=!0,c.target[c.type](),g.disabled=!1)}},c.default=i},{}],97:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){function c(){g=new XMLHttpRequest,b.withCredentials&&(g.withCredentials=!0),g.open(b.method,a),g.responseType=b.responseType,i=+new Date,b.responseType===l.XML&&g.overrideMimeType("text/xml"),g.onreadystatechange=function(){switch(g.readyState){case 4:if(200===g.status){var d={};if(b.getHeaders.length)for(var e=g.getAllResponseHeaders(),h=0;h<b.getHeaders.length;h++){var j=b.getHeaders[h];if(e.indexOf(j)!==-1)try{d[j]=g.getResponseHeader(j)}catch(a){}}var k=f(g,b),l=parseInt(k.length/(((new Date).getTime()-i)/1e3)*8);p.resolve({data:f(g,b),status:m.SUCCESS,url:a,responseUrl:g.responseURL,headers:d,metric:{bps:l,start:i}})}else q?p.reject(m.ABORTED,a):r>=b.retryAttempts?p.reject(m.FAILED,a):(r++,o=setTimeout(c,b.retryDelay))}},g.onprogress=function(a){n=+new Date;var b=parseInt(a.loaded/((n-i)/1e3)*8),c={event:a,bps:b,loaded:a.loaded,timestamp:n,status:m.PROGRESS};p.notify(c)},g.send(null)}function d(){q=!0,g.abort(),p.reject("abort"),clearTimeout(o)}var e=j.default.extendDeep({},k);b=j.default.extend(e,b);var g,i,n,o,p=new h.default,q=!1,r=1;return p.abort=d,c(),p}function f(a,b){switch(b.responseType){case l.XML:return a.responseXML;case l.ARRAY_BUFFER:return new Uint8Array(a.response);default:return a.responseText}}Object.defineProperty(c,"__esModule",{value:!0}),c.HttpStatus=c.HttpResponseType=c.http=void 0;var g=a("../util/redpromise"),h=d(g),i=a("../util/core"),j=d(i),k={responseType:"text",method:"GET",retryAttempts:3,retryDelay:1e3,getHeaders:[],setHeaders:[],timeout:8e3,withCredentials:!1,measureTime:!0},l={TEXT:"text",XML:"xml",JSON:"json",ARRAY_BUFFER:"arraybuffer"},m={FAILED:"failed",SUCCESS:"success",ABORTED:"aborted",PROGRESS:"progress"},n={get:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.method="GET",e(a,b)},head:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.method="HEAD",e(a,b)},getBinary:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.method="GET",b.responseType="arraybuffer",e(a,b)}};c.http=n,c.HttpResponseType=l,c.HttpStatus=m},{"../util/core":94,"../util/redpromise":98}],98:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=function(){function a(){(0,f.default)(this,a),this.result=null,this.doneCallbacks=[],this.alwaysCallbacks=[],this.failCallbacks=[],this.progressCallbacks=[],this.status=a.PENDING}return(0,h.default)(a,[{key:"resolve",value:function(){for(this.result=arguments,this.status=a.RESOLVED,this.failCallbacks=[];this.doneCallbacks.length;)this.doneCallbacks.shift().apply(null,this.result);for(;this.alwaysCallbacks.length;)this.alwaysCallbacks.shift().apply(null,this.result);return this.progressCallbacks=[],this}},{key:"progress",value:function(b){switch(this.status){case a.RESOLVED:b.apply(null,this.result);break;case a.PENDING:this.progressCallbacks.push(b)}return this}},{key:"notify",value:function(){for(var a=0;a<this.progressCallbacks.length;a++)this.progressCallbacks[a].apply(null,arguments);return this}},{key:"reject",value:function(){for(this.result=arguments,this.status=a.REJECTED,this.doneCallbacks=[];this.failCallbacks.length;)this.failCallbacks.shift().apply(null,this.result);for(;this.alwaysCallbacks.length;)this.alwaysCallbacks.shift().apply(null,this.result);return this}},{key:"done",value:function(b){switch(this.status){case a.RESOLVED:b.apply(null,this.result);break;case a.PENDING:this.doneCallbacks.push(b)}return this}},{key:"fail",value:function(b){switch(this.status){case a.REJECTED:b.apply(null,this.result);break;case a.PENDING:this.failCallbacks.push(b)}return this}},{key:"always",value:function(b){switch(this.status){case a.REJECTED:b.apply(null,this.result);break;case a.PENDING:this.alwaysCallbacks.push(b)}return this}}]),a}();i.PENDING="pending",i.RESOLVED="resolved",i.REJECTED="rejected",c.default=i},{"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7}],99:[function(a,b,c){"use strict";function d(a,b){function c(){clearInterval(f),e&&this.update(),f=setInterval(function(){g++,h()},a)}function d(){clearInterval(f)}var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a=a||250;var f=null,g=0,h=b||function(){};return{start:c,stop:d}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=d},{}],100:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={parseUrl:function(a){var b=document.createElement("a");b.href=a;var c=b.search.substr(1);return{protocol:b.protocol.slice(0,-1),hostname:b.hostname,port:b.port,pathname:b.pathname.substr(1),hash:b.hash.substr(1),queryString:c,query:d.extractQuery(a)}},extractQuery:function(a){var b=document.createElement("a");b.href=a;for(var c={},d=b.search.substr(1).split("&"),e=0,f=d.length;e<f;e++)if(d[e]){var g=d[e].split("=");c[g[0]]=!g[1]||g[1]}return c},removeQueryParam:function(a,b){var c=d.extractQuery(a),e=[];for(var f in c)c.hasOwnProperty(f)&&b!==f&&e.push(f+"="+c[f]);return a=a.split("?")[0],e.length&&(a+="?"+e.join("&")),a},isUrlAbsolute:function(a){return"http"===a.slice(0,4)||"//"===a.slice(0,2)}};c.default=d},{}],101:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c){function d(){var b=a.getDroppedFrameCount(),c=b-B;c>20&&v.length>1&&y&&(v=v.slice(1),x=v[0],y.bandwidth>x&&(h(x,!0),t.stop(),C=setTimeout(function(){t.start()},1e4))),B=b}function e(a){null!==y&&(v.length<2||(z.push(a),z.length>10&&z.shift(),g()))}function g(){var c=(new Date).getTime(),d=k(),e=!1;if(null!==y){var f;if(d>=0){f=i(d);var g=(0,m.getBufferLengthFromTime)(a.getVideo(),a.getCurrentTime());if(f!==y.bandwidth){if(f>y.bandwidth&&g<2)return void(A=0);if(f<y.bandwidth&&g>Math.max.apply(Math,[b.segmentDuration+1,4]))return void(A=0);f<y.bandwidth&&(A=0),c-A>n&&(f>y.bandwidth&&d-d/100*D>f&&(e=!0),h(f,e))}}}}function h(a,b){r.trigger(l.default.SWITCH_BANDWIDTH,a,b),z=[],A=(new Date).getTime()}function i(a){var b=v[v.length-1],c=10;return a<600&&(c=25),a-=a/100*c,w&&a<w&&(a=w),x&&a>x&&(a=x),v.forEach(function(c){a>=c&&c>b&&(b=c)}),b}function k(){var a=0;if(z.length<=o)return-1;for(var b=0;b<o;b++)a+=z[b].bps;return parseInt(a/o)}function p(a){z=[],y=a}function q(){s&&s.stop(),t&&t.stop(),clearTimeout(C),z=[]}var r=this,s=new j.default(500,g),t=new j.default(5e3,d),u=b.getVideoProfiles(),v=f(u),w=1e3*parseFloat(b.minAutoBitrate)||null,x=1e3*parseFloat(b.maxAutoBitrate)||null,y=null,z=[],A=0,B=0,C=0,D=b.isLive?80:50;return s.start(),c.get("considerDroppedFrames")&&t.start(),{on:r.on.bind(r),off:r.off.bind(r),update:g,addMetric:e,setRepresentation:p,destroy:q}}function f(a){return a.map(function(a){return a.bandwidth})}Object.defineProperty(c,"__esModule",{value:!0});var g=a("../../core/util/eventEmitter"),h=d(g),i=a("../../core/util/timer"),j=d(i),k=a("./event/dash-event"),l=d(k),m=a("../../core/model/mediaElement"),n=5e3,o=4;e.prototype=Object.create(h.default.prototype),c.default=e},{"../../core/model/mediaElement":87,"../../core/util/eventEmitter":95,"../../core/util/timer":99,"./event/dash-event":104}],102:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if(null===a)return[];for(var b=new DataView(a),c=!1,d={},e=0;!c;){var g,h,i,j,k,l=e;if(e>=b.buffer.byteLength){c=!0;break}g=b.getUint32(e),h=e+g,e+=4,1886614376===b.getUint32(e)?(e+=4,i=b.getUint8(e),0===i||1===i?(e++,e+=3,j=f(new Uint8Array(a,e,16)),e+=16,j=j.toLowerCase(),0===i&&(k=f(new Uint8Array(a,e+8,16))),b.getUint32(e),e+=4,d[j]={data:b.buffer.slice(l,h),keyId:k},e=h):e=h):e=h}return d}function f(a){var b=[],c=function(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d),b+=d}return b};return b.push(c(a.subarray(0,4))),b.push(c(a.subarray(4,6))),b.push(c(a.subarray(6,8))),b.push(c(a.subarray(8,10))),b.push(c(a.subarray(10,16))),b.join("-")}function g(a,b){for(var c=0;c<a.length;c++)if(a[c].keyId===b)return a[c];return null}function h(a,b){for(var c in a)if(a.hasOwnProperty(c)&&c===b.toLowerCase()&&a[c].keyId)return a[c].keyId;return null}function i(a,b){if("string"==typeof a)return a;for(var c in a)if(a.hasOwnProperty(c)&&B[c]===b)return a[c];return""}Object.defineProperty(c,"__esModule",{value:!0});var j=a("babel-runtime/helpers/createClass"),k=d(j),l=a("babel-runtime/helpers/possibleConstructorReturn"),m=d(l),n=a("babel-runtime/helpers/inherits"),o=d(n),p=a("babel-runtime/helpers/classCallCheck"),q=d(p),r=a("../../core/util/eventEmitter"),s=d(r),t=a("../../core/util/eventSystem"),u=d(t),v=a("../../core/util/redpromise"),w=d(v),x=a("../../core/event/playerEvent"),y=d(x),z=a("../../core/enum/playerError"),A=d(z),B={widevine:"com.widevine.alpha",playready:"com.microsoft.playready"},C={FAILED_TO_GENERATE_MEDIA_KEYS:504,FAILED_TO_GENERATE_LICENSE_CHALLENGE:505,FAILED_TO_UPDATE_SESSION:506,FAILED_TO_LOAD_KEY:507,SESSION_KEY_ERROR:508},D=function a(){(0,q.default)(this,a),this.keyId=null},E=function(a){function b(a,c,d){(0,q.default)(this,b);var e=(0,m.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return e.player=a,e.video=c,e.adaptationSet=d,e.licenseUrl=null,e.destroy(),e.storedSessions=[],e.mediaKeysPromise=void 0,e.keySystemConfig=[{initDataTypes:["cenc"],videoCapabilities:[{contentType:e.adaptationSet.mimeType+'; codecs="'+e.adaptationSet.codecs+'"'}]}],e.video.mediaKeys?e.mediaKeysPromise=Promise.resolve():e.mediaKeysPromise=e.createSupportedKeySystem().then(function(a){return this.video.setMediaKeys(a)}.bind(e)).catch(function(a){this.destroy(),this.trigger("error",{code:C.FAILED_TO_GENERATE_MEDIA_KEYS,type:"DRM_ERROR",renderer:"DASH",message:A.default.DRM_GENERATE_MEDIA_KEYS_FAILED}.bind(this))}),u.default.on(e.video,"encrypted",u.default.proxy(e,e.encryptedEventHandler)),e}return(0,o.default)(b,a),(0,k.default)(b,[{key:"createSupportedKeySystem",value:function(){var a=this.video,b=void 0,c=this.adaptationSet.contentProtections.slice(),d=function(a,b){return navigator.requestMediaKeySystemAccess(a,b).then(function(a){return a.createMediaKeys()})};return new Promise(function(e,f){c.length?(b=c.pop(),d(b.drmSystem,this.keySystemConfig).then(function(c){a.contentProtection=b,e(c)}).catch(function(){c.length?(b=c.pop(),d(b.drmSystem,this.keySystemConfig).then(function(c){a.contentProtection=b,e(c)})):f()}.bind(this))):f()}.bind(this))}},{key:"encryptedEventHandler",value:function(a){var b=this;this.player.trigger(y.default.ENCRYPTED,a),this.mediaKeysPromise.then(function(){var c=void 0,d=e(new Uint8Array(a.initData).buffer),f=b.video.contentProtection.schemeIdUri.split(":")[2],j=h(d,f);if(b.storedSessions.indexOf(j)===-1&&("undefined"==typeof b.video.pendingSessionData&&(b.video.pendingSessionData=[]),c=g(b.video.pendingSessionData,j),null===c)){var k=new D;k.keyId=j,b.video.pendingSessionData.push(k),b.licenseUrl=i(b.player.getOptions().drm,b.video.contentProtection.drmSystem),b.licenseUrl&&b.makeNewRequest(b.video.mediaKeys,a.initDataType,a.initData,j)}})}},{key:"makeNewRequest",value:function(a,b,c,d){this.session=a.createSession(),this.session.keyId=d,u.default.on(this.session,"message",u.default.proxy(this,this.messageEventHandler)),this.session.generateRequest(b,c).catch(function(){this.trigger("error",{code:C.FAILED_TO_GENERATE_LICENSE_CHALLENGE,type:"DRM_ERROR",renderer:"DASH",message:A.default.DRM_GENERATE_LICENSE_CHALLENGE_FAILED})}.bind(this))}},{key:"messageEventHandler",value:function(a){var b=a.message,c={};try{var d=new Uint16Array(b),e=String.fromCharCode.apply(null,d),f=new DOMParser,g=f.parseFromString(e,"application/xml");if(g.getElementsByTagName("Challenge")[0]){b=g.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,b&&(b=atob(b));for(var h=g.getElementsByTagName("name"),i=g.getElementsByTagName("value"),j=0;j<h.length;j++)c[h[j].childNodes[0].nodeValue]=i[j].childNodes[0].nodeValue}}catch(a){}this.getLicense(this.licenseUrl,b,c)}},{key:"getLicense",value:function(a,b,c){this.player.trigger(y.default.ACQUIRING_LICENSE,a);var d=this.session,e=new XMLHttpRequest;if(a+=(a.indexOf("?")!==-1?"&":"?")+"t="+(new Date).getTime(),e.open("POST",a,!0),e.responseType="arraybuffer",e.onload=function(){if(200===e.status){var a=e.response;this.license=a,d.update(a).then(function(a){this.player.trigger(y.default.LICENSE_ACQUIRED),this.storedSessions.push(d.keyId)}.bind(this)).catch(function(a){this.trigger("error",{code:C.FAILED_TO_UPDATE_SESSION,type:"DRM_ERROR",message:A.default.DRM_SESSION_UPDATE_FAILED,originalMessage:a})}.bind(this))}else e.onerror()}.bind(this),e.onerror=function(){this.trigger("error",{code:C.FAILED_TO_LOAD_KEY,renderer:"dash",type:"DRM_ERROR",message:A.default.DRM_LOAD_LICENSE_KEY_FAILED})}.bind(this),"undefined"!=typeof c)for(var f in c)c.hasOwnProperty(f)&&e.setRequestHeader(f,c[f]);e.send(b)}},{key:"destroy",value:function(){this.video.pendingSessionData=[],this.storedSessions=[],this.session&&(this.session.close(),u.default.off(this.session,"message",this.messageEventHandler)),u.default.off(this.video,"encrypted",this.encryptedEventHandler),this.off()}}]),b}(s.default),F=[{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",added:"mskeyadded",close:"mskeyclose"},{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",added:"keyadded",close:"keyclose"}],G="9A04F079-9840-4286-AB92-E65BE0885F95",H=function a(){(0,q.default)(this,a),this.sessionId=null,this.initData=null,this.initDataKey=null,this.license=null,this.pssh=null,this.keyId=null,this.session=null,this.drmSystem=null,this.promise=null},I=function(a){function b(a,c,d){(0,q.default)(this,b);var e=(0,m.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return e.player=a,e.video=c,e.adaptation=d,e.sessions=[],e.pendingSessions=[],e.downloadPromise=null,e.api=e.detectApi(),e.unRegisterEvents(),e.registerEvents(),e}return(0,o.default)(b,a),(0,k.default)(b,[{key:"detectApi",value:function(){for(var a=0;a<F.length;a++){var b=F[a];if(!("undefined"!=typeof b.generateKeyRequest&&"function"!=typeof this.video[b.generateKeyRequest]||"undefined"!=typeof b.setMediaKeys&&"function"!=typeof this.video[b.setMediaKeys]))return b}return null}},{key:"registerEvents",value:function(){u.default.on(this.video,this.api.needkey,u.default.proxy(this,this.onNeedKey)),u.default.on(this.video,this.api.message,u.default.proxy(this,this.onKeyMessage)),u.default.on(this.video,this.api.added,u.default.proxy(this,this.onKeyAdded)),u.default.on(this.video,this.api.error,u.default.proxy(this,this.onKeyError))}},{key:"unRegisterEvents",value:function(){u.default.off(this.video,this.api.needkey,this.onNeedKey),u.default.off(this.video,this.api.message,this.onKeyMessage),u.default.off(this.video,this.api.added,this.onKeyAdded),u.default.off(this.video,this.api.error,this.onKeyError)}},{key:"onNeedKey",value:function(a){this.player.trigger(y.default.ENCRYPTED,a);var b=new Uint8Array(a.initData),c=this.getDrmSystem(),d=new H;d.initData=b,d.initDataKey=Array.prototype.join.apply(d.initData),d.drmSystem=c,d.pssh=e(b.buffer),d.keyId=h(d.pssh,G),d.promise=new w.default,this.pendingSessions.push(d);var f,g=new window[this.api.MediaKeys](c);this.video[this.api.setMediaKeys](g),f=g.createSession(this.adaptation.mimeType+";codecs="+this.adaptation.codecs,a.initData),u.default.on(f,this.api.message,u.default.proxy(this,this.onKeyMessage)),u.default.on(f,this.api.error,u.default.proxy(this,this.onSessionError)),u.default.on(f,this.api.added,u.default.proxy(this,this.onSessionReady)),u.default.on(f,this.api.close,u.default.proxy(this,this.onSessionClose))}},{key:"onKeyMessage",value:function(a){var b,c=this.pendingSessions.shift(),d=a.message,e={};c.sessionId=a.sessionId,c.messageKey=Array.prototype.join.apply(d);var f=new Uint16Array(d.buffer),g=String.fromCharCode.apply(null,f),h=new DOMParser,j=h.parseFromString(g,"application/xml");b=i(this.player.getOptions().drm,B.playready),null===a.destinationURL||b||(b=a.destinationURL),j.getElementsByTagName("Challenge")[0]&&(d=j.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,d&&(d=atob(d)));for(var k=j.getElementsByTagName("name"),l=j.getElementsByTagName("value"),m=0;m<k.length;m++)e[k[m].childNodes[0].nodeValue]=l[m].childNodes[0].nodeValue;this.downloadPromise=this.getLicense(b,d,e).done(function(b){c.session=a.target,c.license=b,this.addKey(c),this.sessions.push(c),c.promise.resolve(c)}.bind(this)).fail(function(){this.trigger("error",{code:C.FAILED_TO_LOAD_KEY,type:"DRM_ERROR",renderer:"DASH",message:A.default.DRM_LOAD_LICENSE_KEY_FAILED}),c.promise.reject()}.bind(this))}},{key:"addKey",value:function(a){try{a.session.update(a.license)}catch(a){}u.default.off(a.session,this.api.message,this.onKeyMessage),u.default.off(a.session,this.api.error,this.onSessionError),u.default.off(a.session,this.api.added,this.onSessionReady),u.default.off(a.session,this.api.close,this.onSessionClose)}},{key:"getLicense",value:function(a,b,c){this.player.trigger(y.default.ACQUIRING_LICENSE);var d=new w.default,e=new XMLHttpRequest,f=!0;if(d.abort=function(){f=!0,e.abort()},e.open("POST",a,!0),e.responseType="arraybuffer",e.onload=function(){200===e.status?d.resolve(new Uint8Array(e.response)):f||d.reject()},"undefined"!=typeof c)for(var g in c)c.hasOwnProperty(g)&&e.setRequestHeader(g,c[g]);return e.send(b),e.onerror=function(){f||d.reject()},d}},{key:"onKeyAdded",value:function(){this.trigger("keyAdded")}},{key:"onKeyError",value:function(){this.trigger("error",{type:"DRM_ERROR",code:C.SESSION_KEY_ERROR,renderer:"DASH",message:A.default.DRM_SESSION_KEY_ERROR})}},{key:"onSessionReady",value:function(){this.player.trigger(y.default.LICENSE_ACQUIRED)}},{key:"onSessionClose",value:function(){this.trigger("sessionClose")}},{key:"onSessionError",value:function(){this.trigger("error",{type:"DRM_ERROR",code:C.SESSION_KEY_ERROR,renderer:"DASH",message:A.default.DRM_SESSION_KEY_ERROR})}},{key:"getDrmSystem",value:function(){for(var a=0;a<this.adaptation.contentProtections.length;a++){var b=this.adaptation.contentProtections[a].drmSystem;if("undefined"!=typeof b&&""!==this.video.canPlayType(this.adaptation.mimeType,b))return b}return null}},{key:"destroy",value:function(){null!==this.downloadPromise&&this.downloadPromise.abort(),this.sessions=[],this.pendingSessions=[],this.unRegisterEvents()}}]),b}(s.default);c.default="function"==typeof navigator.requestMediaKeySystemAccess&&navigator.userAgent.indexOf("Edge")===-1?E:I},{"../../core/enum/playerError":84,"../../core/event/playerEvent":85,"../../core/util/eventEmitter":95,"../../core/util/eventSystem":96,"../../core/util/redpromise":98,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],103:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={VIDEO:"video",AUDIO:"audio",SUBTITLE:"subtitle"};c.default=d},{}],104:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={SEGMENT_DOWNLOADED:"segmentDownloaded",SEGMENT_DOWNLOAD_PROGRESS:"segmentProgress",DOWNLOAD_ATTEMPTS_EXCEEDED:"attemptsExceeded",FAILED_TO_DOWNLOAD_SEGMENT:"failedToLoadSegment",FAILED_TO_DOWNLOAD_MANIFEST:"failedToLoadManifest",DEADLOCK:"deadlock",END_OF_STREAM:"endOfStream",SWITCH_BANDWIDTH:"switchBandwidth"};c.default=d},{}],105:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("babel-runtime/helpers/possibleConstructorReturn"),j=d(i),k=a("babel-runtime/helpers/inherits"),l=d(k),m=a("../../core/util/eventEmitter"),n=d(m),o=a("../../core/util/eventSystem"),p=d(o),q=a("../../core/event/playerEvent"),r=d(q),s=a("../../core/enum/playerError"),t=d(s),u=a("./event/dash-event"),v=d(u),w=a("./manifest/manifest"),x=d(w),y=a("./stream-manager"),z=d(y),A=a("./abr"),B=d(A),C=a("./drm"),D=d(C),E=a("./enum/mediaType"),F=d(E),G=a("../../core/model/mediaElement"),H=d(G),I=function(a){function b(a,c){(0,f.default)(this,b);var d=(0,j.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.player=a,d.url=null,d.baseUrl=null,d.isPaused=!1,d.timeShift=d.player.timeShift,d.options=a.options,d.mediaElement=new H.default(c,d.options),d.isAbr=d.options.get("autoAdaptation"),d.streams=[],d.abr=null,d.drmManager=null,d.lastEvent=null,d.currentBandwidth=null,d.seekingTimeout=0,d.manifestManager=new x.default(d.mediaElement.getVideo(),d.player),d.manifestManager.on(r.default.MANIFEST_UPDATED,d.onManifestUpdated.bind(d)),d.manifestManager.on(r.default.MANIFEST_UPDATE_ERROR,d.onManifestUpdateError.bind(d)),d.manifestManager.on(r.default.HEAD_TIME,d.onHeadTime.bind(d)),d.manifestManager.on(r.default.MANIFEST_LOADED,d.trigger.bind(d,r.default.MANIFEST_LOADED)),d.manifestManager.on(r.default.MANIFEST_LOADED,d.onManifestLoaded.bind(d)),d.streamManager=new z.default(d.player,d.manifestManager),d.streamManager.on(v.default.SEGMENT_DOWNLOAD_PROGRESS,function(a){d.abr.addMetric(a)}),d.streamManager.on(r.default.PROFILE_CHANGED,d.onProfileChanged.bind(d)),d.streamManager.on(r.default.RECONNECT,d.reconnect.bind(d)),d.streamManager.on(v.default.FAILED_TO_DOWNLOAD_SEGMENT,d.onFailedToLoadSegment.bind(d)),d.streamManager.on(r.default.ENDED,d.onEnded.bind(d)),d.mediaSource=null,d.reconnectTimeout=0,d.currentProfile=null,d.setVolume(d.options.get("volume")/100),setTimeout(d.trigger.bind(d,"ready"),10),d}return(0,l.default)(b,a),(0,h.default)(b,[{key:"onManifestLoaded",value:function(){this.manifestManager.isIndexMode()&&this.manifestManager.manifest.availabilityStartTime&&!this.manifestManager.manifest.availabilityEndTime&&(this.timeShift.start=this.manifestManager.manifest.availabilityStartTime)}},{key:"onProfileChanged",value:function(a){a.mediaType===F.default.VIDEO&&(this.trigger(r.default.PROFILE_CHANGED,this.getCurrentTime(),a,this.isAbr),null!==this.abr&&this.abr.setRepresentation(a),this.currentBandwidth=a.bandwidth)}},{key:"onFailedToLoadSegment",value:function(a){this.trigger(v.default.FAILED_TO_DOWNLOAD_SEGMENT,a),this.trigger("error",{code:401,renderer:"DASH",message:t.default.LOAD_SEGMENT_ERROR,url:a})}},{key:"getRendererElm",value:function(){return this.mediaElement.getVideo()}},{key:"isIndexMode",value:function(){return this.manifestManager.isIndexMode()}},{key:"getVideo",value:function(){return this.mediaElement.getVideo()}},{key:"setVolume",value:function(a){this.mediaElement.setVolume(a),this.trigger(r.default.VOLUME_CHANGED,100*a)}},{key:"getVolume",value:function(){return this.mediaElement.getVolume()}},{key:"setSource",value:function(a,b){var c=this;this.destroy(),this.url=a,null===this.baseUrl&&(this.baseUrl=this.url),this.trigger(r.default.ON_SOURCE,this.url),this.timeShift.isEnabled()&&(this.url=this.timeShift.generateUrl(this.url,!1,b)),this.manifestManager.load(this.url,b).done(function(){c.isLive()&&(c.trigger(r.default.ON_LIVE),c.timeShift.isEnabled()&&c.timeShift.getDvrWindow()<0&&null!==c.manifestManager.manifest.timeShiftBufferDepth&&c.timeShift.setDvrWindow(c.manifestManager.manifest.timeShiftBufferDepth)),c.trigger(r.default.PROFILE_LIST,c.manifestManager.getVideoProfiles()),c.trigger(r.default.AUDIO_TRACK_LIST,c.manifestManager.getAudioTracks()),c.playMedia()}).fail(function(a,b){a===v.default.FAILED_TO_DOWNLOAD_MANIFEST&&(c.isLive()?c.timeShift.isLive()?c.reconnect(4e3,c.baseUrl):c.reconnect(4e3):c.destroy(),c.trigger("error",{code:400,renderer:"DASH",message:t.default.LOAD_MANIFEST_ERROR,url:b}))})}},{key:"isLive",value:function(){return this.manifestManager.isLive}},{key:"isPaused",value:function(){return!!this.mediaElement&&this.mediaElement.isPaused()}},{key:"destroy",value:function(){null!==this.mediaSource&&(p.default.off(this.mediaSource,"sourceclose",this.onSourceClose),p.default.off(this.mediaSource,"sourceopen",this.onSourceOpen),p.default.off(this.mediaSource,"sourceended",this.onSourceEnded)),this.manifestManager.destroy(),this.streamManager.destroy(),null!==this.drmManager&&this.drmManager.destroy(),clearTimeout(this.reconnectTimeout),this.mediaSource=null,this.unRegisterEvents(),this.mediaElement.load(),this.abr&&this.abr.destroy()}},{key:"unRegisterEvents",value:function(){this.mediaElement.off()}},{key:"registerEvents",value:function(){var a=this;G.VideoEvents.forEach(function(b){var c="on"+b.charAt(0).toUpperCase()+b.slice(1);"function"==typeof a[c]&&a.mediaElement.on(b,a[c].bind(a))})}},{key:"onHeadTime",value:function(a){this.timeShift.isEnabled()&&this.timeShift.setHeadTime(a)}},{key:"onManifestUpdated",value:function(){this.streamManager.clearBuffer(0,this.mediaElement.getCurrentTime()-60)}},{key:"onManifestUpdateError",value:function(){this.reconnect()}},{key:"onPlaying",value:function(){this.lastEvent===r.default.SEEK_END&&this.trigger(r.default.WAITING_END,this.getCurrentTime()),this.lastEvent!==r.default.PLAYING&&(this.lastEvent=r.default.PLAYING,this.trigger(r.default.PLAYING,this.getCurrentTime()))}},{key:"onPause",value:function(){this.lastEvent=r.default.PAUSED,this.trigger(r.default.PAUSED,this.getCurrentTime())}},{key:"onEnded",value:function(){this.lastEvent=r.default.ENDED,this.trigger(r.default.ENDED,this.getCurrentTime()),this.destroy()}},{key:"onWaiting",value:function(){this.lastEvent=r.default.WAITING,this.trigger(r.default.WAITING,this.getCurrentTime())}},{key:"onCanplay",value:function(){this.lastEvent!==r.default.WAITING_END&&(this.lastEvent=r.default.WAITING_END,this.trigger(r.default.WAITING_END,this.getCurrentTime()))}},{key:"onSeeking",value:function(){var a=this;clearTimeout(this.seekingTimeout),this.seekingTimeout=setTimeout(function(){a.streamManager.updatePosition(a.mediaElement.getCurrentTime())},250)}},{key:"onSeeked",value:function(){this.trigger(r.default.SEEK_END,this.getCurrentTime()),this.mediaElement.isPaused()||this.lastEvent===r.default.PLAYING||this.trigger(r.default.PLAYING,this.getCurrentTime()),this.lastEvent=r.default.SEEK_END}},{key:"onError",value:function(a){this.lastEvent=r.default.ERROR,this.trigger(r.default.ERROR,{code:204,type:"PLAYBACK_ERROR",message:t.default.PLAYBACK_ERROR,renderer:"DASH",originalEvent:a})}},{key:"onSourceEnded",value:function(){}},{key:"onSourceClose",value:function(){}},{key:"onLoadedmetadata",value:function(a){this.lastEvent=r.default.METADATA,this.mediaElement.seek(this.streamManager.startTime),this.trigger(r.default.NEW_MEDIA,this.manifestManager.isLive?-1:this.manifestManager.duration),this.trigger(r.default.METADATA,{duration:this.manifestManager.duration})}},{key:"reconnect",value:function(a,b,c){var d=this;this.streamManager&&this.streamManager.getBufferLength()>1&&!c||(a=a||2e3,b=b||this.url,this.streamManager.isReconnecting=!0,this.options.autoplay=!0,clearTimeout(this.reconnectTimeout),this.trigger(r.default.WAITING,this.mediaElement.getCurrentTime()),this.timeShift.isEnabled()&&this.timeShift.isLive()&&this.timeShift.setLive(),this.reconnectTimeout=setTimeout(function(){d.setSource(b)},a))}},{key:"endOfStream",value:function(){var a=!1;if("open"===this.mediaSource.readyState)for(var b=0;b<this.activeStreams.length;b++){if(!this.activeStreams[b].isEndOfStream)return!1;a=!0}a&&this.mediaSource.endOfStream()}},{key:"switchBandwidth",value:function(a,b){var c=this.manifestManager.manifest.getRepresentationByBandwidth(parseInt(a),F.default.VIDEO);this.streamManager.switchRepresentation(c,b),this.abr.setRepresentation(c),this.currentProfile=c,isNaN(c.bandwidth)&&(this.currentBandwidth=c.bandwidth)}},{key:"switchProfile",value:function(a,b){"auto"===a?(this.isAbr=!0,this.trigger(r.default.PROFILE_CHANGED,this.getCurrentTime(),this.getCurrentProfile(),this.isAbr)):(this.isAbr=!1,this.switchBandwidth(a,b))}},{key:"switchAudioTrack",value:function(a){this.streamManager.switchAudioTrack(a)}},{key:"playMedia",value:function(a){var b=this;if(clearTimeout(this.reconnectTimeout),null===this.manifestManager.videoAdaptation)return void this.reconnect(5e3);var c=window.MediaSource.isTypeSupported(this.manifestManager.videoAdaptation.mimeType+";codecs="+this.manifestManager.videoAdaptation.codecs);return c?"undefined"!=typeof a?void this.setSource(a):(this.abr=new B.default(this.mediaElement,this.manifestManager,this.options),this.mediaSource=new window.MediaSource,this.registerEvents(),p.default.on(this.mediaSource,"sourceclose",p.default.proxy(this,this.onSourceClose)),p.default.on(this.mediaSource,"sourceopen",p.default.proxy(this,this.onSourceOpen)),p.default.on(this.mediaSource,"sourceended",p.default.proxy(this,this.onSourceEnded)),this.mediaElement.setSource(URL.createObjectURL(this.mediaSource)),this.abr.on(v.default.SWITCH_BANDWIDTH,function(a,c){setTimeout(function(){b.isAbr&&b.switchBandwidth(a,c)},0)}),null!==this.drmManager&&this.drmManager.destroy(),this.manifestManager.isDrmProtected()&&(this.drmManager=new D.default(this.player,this.mediaElement.getVideo(),this.manifestManager.videoAdaptation),this.drmManager.on(r.default.ERROR,function(a){b.trigger(r.default.ERROR,a)})),void(this.isPaused?(this.mediaElement.pause(),this.trigger(r.default.PAUSED,this.getCurrentTime())):this.mediaElement.play())):(this.destroy(),void this.trigger("fallback"))}},{key:"seekTo",value:function(a){if(this.trigger(r.default.SEEK_START,this.getCurrentTime()),this.timeShift.isEnabled()){var b=a/this.getDuration()*100;return void this.streamManager.seek(b)}this.seek(a/this.getDuration()*100)}},{key:"seek",value:function(a){this.trigger(r.default.SEEK_START,this.getCurrentTime()),this.streamManager.seek(a)}},{key:"getDuration",value:function(){return this.streamManager.getDuration()}},{key:"getCurrentTime",value:function(){return this.streamManager.getCurrentTime()}},{key:"getBufferLength",value:function(){return this.streamManager.getBufferLength()}},{key:"setMaxBufferLength",value:function(a){return this.streamManager.setMaxBufferLength(a)}},{key:"getCurrentProfile",value:function(){return this.streamManager.getCurrentProfile()}},{key:"getProfiles",value:function(){return this.streamManager.getProfiles()}},{key:"getAudioTracks",value:function(){return this.manifestManager.getAudioTracks()}},{key:"getProperty",value:function(a){return this.mediaElement?this.mediaElement.getProperty(a):null}},{key:"pause",value:function(){this.isPaused=!0,this.mediaElement.pause()}},{key:"stop",value:function(){this.trigger(r.default.STOPPED,this.mediaElement.getCurrentTime()),
this.isPaused=!1,this.destroy()}},{key:"resume",value:function(){this.isPaused=!1,this.mediaElement.play()}},{key:"play",value:function(){this.isPaused=!1,this.mediaElement.play()}},{key:"onSourceOpen",value:function(){return this.streamManager.hasActiveStreams()?void this.streamManager.sourceOpen():(this.mediaSource.duration=this.manifestManager.duration,this.timeShift.isEnabled()&&this.timeShift.isLive()&&(this.mediaSource.duration=Number.MAX_VALUE),this.streamManager.createStreams(this.mediaElement,this.mediaSource,this.manifestManager.adaptations,"dynamic"===this.manifestManager.manifest.type&&!this.timeShift.isVod()),null!==this.currentBandwidth&&this.streamManager.setInitialBandwidth(this.currentBandwidth/1e3),void this.streamManager.initStreams())}}],[{key:"canPlayType",value:function(a,b){function c(){return/^((?!chrome).)*safari/i.test(navigator.userAgent)}function d(){return navigator.userAgent.indexOf("Firefox")>-1}function e(){var a=navigator.userAgent.indexOf("Firefox");return parseFloat(navigator.userAgent.substring(a+8))}function f(){return(!d()||!(e()<47||navigator.userAgent.indexOf("Windows NT 5.1")!==-1))&&(navigator.requestMediaKeySystemAccess&&navigator.userAgent.toLowerCase().indexOf("linux")===-1)}return!c()&&(!(!b.get("firefoxMseEnabled")&&d()||!f()&&d())&&"undefined"!=typeof window.MediaSource)}}]),b}(n.default);I.id="dash",I.enabled=!0,I.priority=100,I.mediaTypes={DASH:"application/dash+xml"},window.redcdnplayer&&window.redcdnplayer.addRenderer(I),c.default=I},{"../../core/enum/playerError":84,"../../core/event/playerEvent":85,"../../core/model/mediaElement":87,"../../core/util/eventEmitter":95,"../../core/util/eventSystem":96,"./abr":101,"./drm":102,"./enum/mediaType":103,"./event/dash-event":104,"./manifest/manifest":106,"./stream-manager":112,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],106:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){}Object.defineProperty(c,"__esModule",{value:!0});var f=a("babel-runtime/helpers/classCallCheck"),g=d(f),h=a("babel-runtime/helpers/createClass"),i=d(h),j=a("babel-runtime/helpers/possibleConstructorReturn"),k=d(j),l=a("babel-runtime/helpers/inherits"),m=d(l),n=a("../../../core/util/eventEmitter"),o=d(n),p=a("../../../core/util/timer"),q=d(p),r=a("../../../core/event/playerEvent"),s=d(r),t=a("./parser"),u=d(t),v=a("../enum/mediaType"),w=d(v),x=a("../event/dash-event"),y=d(x),z=a("../../../core/util/http"),A=a("./sync"),B=d(A),C=a("../../../core/util/redpromise"),D=d(C),E="redCDN-Date",F=function(a){function b(a,c){(0,g.default)(this,b);var d=(0,k.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.video=a,d.player=c,d.isLive=!1,d.options=d.player.options,d.timeShift=d.player.timeShift,d.syncManager=new B.default,d.manifest=null,d.loadPromise=null,d.UTCTimingUrl=null,d.parser=new u.default,d.updating=!1,d.adaptations=[],d.videoAdaptation=null,d.audioAdaptation=null,d.monitorTimer=null,d.headTime=0,d.headSegmentIndex=-1,d.duration=-1,d.url=null,d.utcHeadTime=0,d}return(0,m.default)(b,a),(0,i.default)(b,[{key:"monitor",value:function(){if(this.headTime+=1,this.isIndexMode()){var a=this.syncManager.getTime();return void(a>0&&(this.manifest.updateTimeLine(a),this.utcHeadTime=a-this.parser.mpd.availabilityStartTime))}if(!this.updating&&this.videoAdaptation.segmentList.length){var b=this.videoAdaptation.segmentList[this.videoAdaptation.segmentList.length-1];this.updating=!0;var c=this.parser.mpd.responseUrl||this.url;this.timeShift.isEligibleToUpdate()&&(c=this.timeShift.generateUrl(c,!1,b.start||0)),this.update(c)}}},{key:"update",value:function(a){var b=this,c=0;return this.timeShift.isEnabled()||(c=60),this.parser.mpd.timeShiftBufferDepth&&(c=this.parser.mpd.timeShiftBufferDepth),a+=(a.indexOf("?")!==-1?"&":"?")+"t="+(new Date).getTime(),this.loadPromise=z.http.get(a,{getHeaders:[E]}).done(function(a){var d=b.getHeadTime(a),e=b.parse(a.data,b.url,a.responseUrl,d,b.manifest.presentationTimeOffset);b.trigger(s.default.MANIFEST_LOADED,a.data),b.manifest=b.parser.update(b.manifest,e,c),b.isLive="dynamic"===b.manifest.type,b.headTime=d?d:b.manifest.publishTime,b.trigger(s.default.HEAD_TIME,b.headTime),b.trigger(s.default.MANIFEST_UPDATED)}).fail(function(){b.trigger(s.default.MANIFEST_UPDATE_ERROR)}).always(function(){b.updating=!1}),this.loadPromise}},{key:"destroy",value:function(){this.monitorTimer&&this.monitorTimer.stop(),this.syncManager.stop(),this.abort()}},{key:"abort",value:function(){this.loadPromise&&"pending"===this.loadPromise.status&&this.loadPromise.abort()}},{key:"parse",value:function(a,b,c,d,e){return this.parser.parse(a,b,c,d,e)}},{key:"updateManifest",value:function(a,b,c){return this.parser.update(a,b,c)}},{key:"isDrmProtected",value:function(){return this.videoAdaptation.contentProtections.length||this.audioAdaptation&&this.audioAdaptation.contentProtections.length}},{key:"isIndexMode",value:function(){return!!this.UTCTimingUrl}},{key:"load",value:function(a){var b=this;this.url=a,this.abort(),this.updating=!0,this.monitorTimer&&this.monitorTimer.stop(),this.loadPromise=new D.default,this.loadPromise.abort=function(){c.abort()};var c=z.http.get(this.url,{getHeaders:[E]}).done(function(a){var c=b.getHeadTime(a);if(b.manifest=b.parse(a.data,a.url,a.responseUrl,c),b.UTCTimingUrl=b.manifest.UTCTiming,b.trigger(s.default.MANIFEST_LOADED,a),b.adaptations=b.manifest.getAllAdaptationSets(),b.isLive="dynamic"===b.manifest.type,b.videoAdaptation=b.manifest.getAdaptationSetByType(w.default.VIDEO),b.audioAdaptation=b.manifest.getAdaptationSetByType(w.default.AUDIO),b.headTime=c?c:b.manifest.publishTime,b.trigger(s.default.HEAD_TIME,b.headTime),b.duration=b.manifest.duration,b.updating=!1,b.isLive){var d=1e3*b.manifest.minimumUpdatePeriod||2e3;b.isIndexMode()&&(d=1e3),b.monitorTimer=new q.default(d,b.monitor.bind(b)),b.monitorTimer.start()}null!=b.UTCTimingUrl&&b.isLive?b.syncManager.init(b.UTCTimingUrl).done(function(){b.monitor(),b.loadPromise.resolve(a)}):b.loadPromise.resolve(a)}).fail(function(c){b.updating=!1,c===z.HttpStatus.FAILED&&b.loadPromise.reject(y.default.FAILED_TO_DOWNLOAD_MANIFEST,a)});return this.loadPromise}},{key:"getHeadTime",value:function(a){return E in a.headers?Number(a.headers[E]):0}},{key:"getVideoProfiles",value:function(){return this.manifest.getRepresentationsByType("video")}},{key:"getAudioAdaptations",value:function(){return this.manifest.getAdaptationsSetByType("audio")}},{key:"getAudioTracks",value:function(){var a=this.getAudioAdaptations(),b=[];return a.forEach(function(a){var c=new e;c.id=a.id,c.lang=a.lang,c.codecs=a.codecs,c.mimeType=a.mimeType,b.push(c)}),b}},{key:"presentationDelay",get:function(){return this.utcHeadTime?this.utcHeadTime-1e3*this.parser.mpd.minBufferTime:0}},{key:"minBufferTime",get:function(){return this.options.get("minBufferTime")||this.manifest.minBufferTime}},{key:"maxBufferLength",get:function(){var a=this.options.get("maxBufferLength");return this.startBufferLength>=a?this.startBufferLength+1:a},set:function(a){this.options.set("maxBufferLength",a)}},{key:"startBufferLength",get:function(){return this.options.get("startBufferLength")}},{key:"minAutoBitrate",get:function(){return this.options.get("minAutoBitrate")}},{key:"maxAutoBitrate",get:function(){return this.options.get("maxAutoBitrate")}},{key:"suggestedPresentationDelay",get:function(){return this.manifest.suggestedPresentationDelay}},{key:"segmentDuration",get:function(){return this.videoAdaptation.segmentTemplate.segmentDuration?this.videoAdaptation.segmentTemplate.segmentDuration/this.videoAdaptation.segmentTemplate.timescale:this.videoAdaptation.segmentList.length?this.videoAdaptation.segmentList[0].duration:0}}]),b}(o.default);c.default=F},{"../../../core/event/playerEvent":85,"../../../core/util/eventEmitter":95,"../../../core/util/http":97,"../../../core/util/redpromise":98,"../../../core/util/timer":99,"../enum/mediaType":103,"../event/dash-event":104,"./parser":107,"./sync":108,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],107:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){this.mpd=null}function f(a,b){var c=q(a,"BaseURL"),d=void 0,e=null;return null!==c&&(d=c.textContent,null!==d&&(e=u.default.isUrlAbsolute(d)?d:[b.slice(0,b.lastIndexOf("/")),d].join("/"))),e}function g(a){for(var b=null,c=0;c<a.periods[0].adaptationSets.length;c++)a.periods[0].adaptationSets[c].mimeType.indexOf("video")!==-1&&(b=a.periods[0].adaptationSets[c].segmentsDuration);a.duration=b}function h(){this.duration=null,this.maxSegmentDuration=0,this.minBufferTime=6,this.periods=[],this.baseUrl=null,this.type=null,this.minimumUpdatePeriod=null,this.maxSegmentDuration=null,this.publishTime=null,this.startTime=0,this.availabilityStartTime=0,this.availabilityEndTime=0,this.UTCTiming=null,this.presentationTimeOffset=0,this.timeShiftBufferDepth=null,this.publishTime=null,this.suggestedPresentationDelay=null}function i(){this.segmentList=null,this.adaptationSets=[],this.timeline=null,this.baseUrl=null}function j(){this.id=null,this.codecs=null,this.bandwidth=null,this.mediaType=null,this.width=null,this.height=null}function k(){this.timescale=1,this.presentationTimeOffset=0,this.segmentDuration=null,this.initialization=null,this.media=null,this.duration=null,this.startNumber=0,this.timeline=null}function l(){this.timePoints=[]}function m(){this.index=null,this.startTime=null,this.duration=null,this.repeat=null}function n(a){if(!a)return null;var b=/^P(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/,c=b.exec(a);if(!c)return null;var d=0,e=parseInt(c[1]);e&&(d+=86400*e);var f=parseInt(c[2]);f&&(d+=3600*f);var g=parseInt(c[3]);g&&(d+=60*g);var h=parseFloat(c[4]);return h&&(d+=h),d}function o(a){var b=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,c=b.exec(a),d=Date.UTC(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),c[6]&&(parseInt(c[6],10)||0),c[7]&&1e3*parseFloat(c[7])||0);return new Date(d).getTime()}function p(a,b){for(var c=[],d=0;d<a.childNodes.length;d++)a.childNodes[d].tagName==b&&c.push(a.childNodes[d]);return c}function q(a,b){var c=p(a,b);return c.length?c[0]:null}Object.defineProperty(c,"__esModule",{value:!0}),c.getChildren=p,c.getFirstChild=q;var r=a("../model/adaptation-set"),s=d(r),t=a("../../../core/util/url"),u=d(t);e.prototype={parse:function(a,b,c,d,e){this.mpd=new h;var m=new DOMParser,r=m.parseFromString(a,"text/xml"),t=q(r,"MPD");if(null===t)return null;c||(c=b),c=c.split("?")[0],this.mpd.presentationTimeOffset=e||0,this.mpd.responseUrl=c,this.mpd.type=t.getAttribute("type"),this.mpd.duration=n(t.getAttribute("mediaPresentationDuration")),this.mpd.mediaPresentationDuration=n(t.getAttribute("mediaPresentationDuration")),this.mpd.maxSegmentDuration=n(t.getAttribute("maxSegmentDuration")),this.mpd.minBufferTime=n(t.getAttribute("minBufferTime")),this.mpd.minimumUpdatePeriod=n(t.getAttribute("minimumUpdatePeriod")),this.mpd.maxSegmentDuration=n(t.getAttribute("maxSegmentDuration")),this.mpd.suggestedPresentationDelay=n(t.getAttribute("suggestedPresentationDelay"))||0,this.mpd.timeShiftBufferDepth=n(t.getAttribute("timeShiftBufferDepth")),this.mpd.presentationTimeOffset=e||parseInt(t.getAttribute("presentationTimeOffset")),this.mpd.periods=[],t.getAttribute("availabilityStartTime")&&(this.mpd.availabilityStartTime=o(t.getAttribute("availabilityStartTime"))),q(t,"UTCTiming")&&(this.mpd.UTCTiming=q(t,"UTCTiming").getAttribute("value")),this.mpd.headTime=d;var u=f(t,c);null===this.mpd.duration&&(this.mpd.duration=Number.MAX_VALUE),null!==this.mpd.mediaPresentationDuration&&(this.mpd.duration=this.mpd.mediaPresentationDuration),t.getAttribute("availabilityStartTime")&&(this.mpd.availabilityStartTime=o(t.getAttribute("availabilityStartTime"))),t.getAttribute("availabilityEndTime")&&(this.mpd.availabilityEndTime=o(t.getAttribute("availabilityEndTime"))),this.mpd.availabilityStartTime&&this.mpd.mediaPresentationDuration&&!this.mpd.availabilityEndTime&&(this.mpd.availabilityEndTime=this.mpd.availabilityStartTime+1e3*this.mpd.mediaPresentationDuration),this.mpd.startTime=0;var v=t.getAttribute("publishTime");null!==v&&(this.mpd.publishTime=o(v));for(var w=p(t,"Period"),x=0;x<w.length;x++){var y=w[x],z=new i,A=p(y,"AdaptationSet"),B=f(y,c);null===B&&(B=u);for(var C=0;C<A.length;C++){var D,E=A[C],F=new s.default,G=q(E,"SegmentTemplate"),H=q(G,"SegmentTimeline"),I=new k,J=p(E,"Representation");I.timeline=new l,F.publishTime=this.mpd.publishTime,F.timeShiftBufferDepth=this.mpd.timeShiftBufferDepth,F.suggestedPresentationDelay=this.mpd.suggestedPresentationDelay,F.minBufferTime=this.mpd.minBufferTime,E.getAttribute("id")&&(F.id=parseInt(E.getAttribute("id"))),E.getAttribute("codecs")&&(F.codecs=E.getAttribute("codecs")),E.getAttribute("lang")&&(F.lang=E.getAttribute("lang")),null!==H&&(D=p(H,"S"),I.timeline.parse(D)),F.mimeType=E.getAttribute("mimeType"),null!==F.mimeType&&(F.type=F.mimeType.split("/")[0].toLowerCase()),F.url=B||c;var K=p(E,"ContentProtection");F.parseContentProtections(K),I.timescale=parseInt(G.getAttribute("timescale")),I.segmentDuration=parseInt(G.getAttribute("duration")),I.startNumber=parseInt(G.getAttribute("startNumber")),I.duration=parseInt(G.getAttribute("duration")),I.presentationTimeOffset=this.mpd.presentationTimeOffset||parseInt(G.getAttribute("presentationTimeOffset"))||0,I.initialization=G.getAttribute("initialization"),I.media=G.getAttribute("media"),F.availabilityStartTime=this.mpd.availabilityStartTime,F.suggestedPresentationDelay=this.mpd.suggestedPresentationDelay,F.availabilityEndTime=this.mpd.availabilityEndTime,F.UTCTiming=this.mpd.UTCTiming,F.segmentTemplate=I,F.duration=this.mpd.duration,F.createTimeLine();for(var L=0;L<J.length;L++){var M=new j,N=J[L];M.codecs=N.getAttribute("codecs"),M.mediaType=F.type,"mp4a.40.1"===M.codecs&&(M.codecs="mp4a.40.2"),M.id=N.getAttribute("id"),M.bandwidth=parseInt(N.getAttribute("bandwidth")),M.width=parseInt(N.getAttribute("width")),M.height=parseInt(N.getAttribute("height")),F.representations.push(M)}"undefined"!=typeof M&&M.codecs&&(F.codecs=M.codecs),F.representations.sort(this.sortFn),z.adaptationSets.push(F)}this.mpd.periods.push(z)}return null===this.mpd.duration&&g(this.mpd),this.mpd},sortFn:function(a,b){return b.bandwidth-a.bandwidth},update:function(a,b,c){var d,e,f=0;a.publishTime=b.publishTime;for(var g=0;g<b.periods[0].adaptationSets.length;g++)d=a.periods[0].adaptationSets[g].segmentList,e=b.periods[0].adaptationSets[g].segmentList,a.baseUrl=b.baseUrl,a.periods[0].adaptationSets[g].baseUrl=b.baseUrl,a.periods[0].adaptationSets[g].segmentList=this.merge(d,e,c);return a.duration=f,a},merge:function(a,b){var c,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=[],f=b[0].index,g=b[0].start,h=0;a=a.filter(function(a){return a.start<g}),a.length&&(f=a[0].index),c=a.concat(b);var i=c[c.length-1];return h=i.start-d,c.forEach(function(a){a.index>f&&(f=a.index),a.index=f,a.start>h&&(a.index=f,e.push(a),f++)}),e}},h.prototype={updateTimeLine:function(a){this.getAllAdaptationSets().forEach(function(b){b.updateTimeLine(a)})},getPeriod:function(a){var b="undefined"!=typeof a?a:0;return this.periods[b]},getRepresentationsByType:function(a,b){var c=this.getAdaptationSetByType(a,b);return null===c?[]:c.representations},getAdaptationsSetByType:function(a,b){var c=this.getPeriod(b).adaptationSets;return c.filter(function(b){return null!==b.type&&b.type===a})},getAdaptationSetByType:function(a,b){var c=this.getAdaptationsSetByType(a,b);return c.length?c[0]:null},getAllAdaptationSets:function(){return this.getPeriod().adaptationSets},getAverageBandwidthRepresentation:function(a,b){for(var c,d=this.getRepresentationsByType(a,b),e=[],f=0;f<d.length;f++)e.push(d[f].bandwidth);return c=e.length>1?e[Math.ceil(e.length/2)]:e[0],this.getRepresentationByBandwidth(c,a,b)},getRepresentationByBandwidth:function(a,b,c){var d,e="undefined"==typeof b?"video":b,f=this.getAdaptationSetByType(e,c);if(null===f)return null;d=f.representations;for(var g=0;g<d.length;g++)if(d[g].bandwidth===parseInt(a))return d[g];return null}},l.prototype.parse=function(a){for(var b,c,d=0;d<a.length;d++)c=a[d],b=new m,b.index=d,b.duration=parseInt(c.getAttribute("d")),b.startTime=parseInt(c.getAttribute("t")),b.repeat=parseInt(c.getAttribute("r")),this.timePoints.push(b)},c.default=e},{"../../../core/util/url":100,"../model/adaptation-set":109}],108:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){function a(a){return l.start(),c(a)}function b(){l.stop()}function c(a){return g||(g=a),a.indexOf("http:")!==-1&&(a=a.replace("http:","")),f.http.head(a,{getHeaders:["Date"]}).done(function(a){var b=new Date(a.headers.Date).getTime();j=new Date(b).getTime(),k=(new Date).getTime()-j})}function d(){c(g)}function e(){return j<0?-1:(new Date).getTime()-k}var g,j=-1,k=0,l=new h.default(i,d,(!1));return{init:a,stop:b,getTime:e}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("../../../core/util/http"),g=a("../../../core/util/timer"),h=d(g),i=6e4;c.default=e},{"../../../core/util/http":97,"../../../core/util/timer":99}],109:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(){this.pssh=null,this.value=null,this.schemeIdUri=null,this.drmSystem=null,this.cencPssh=null}function f(){this.startTime=null,this.start=null,this.duration=null,this.index=null,this.bufferStart=null}Object.defineProperty(c,"__esModule",{value:!0});var g=a("babel-runtime/helpers/classCallCheck"),h=d(g),i=a("babel-runtime/helpers/createClass"),j=d(i),k=a("../manifest/parser"),l={"URN:UUID:9A04F079-9840-4286-AB92-E65BE0885F95":"com.microsoft.playready","URN:UUID:EDEF8BA9-79D6-4ACE-A3C8-27DCD51D21ED":"com.widevine.alpha"},m=function(){function a(){(0,h.default)(this,a),this.url=null,this.minBufferTime=null,this.baseUrl=null,this.duration=0,this.publishTime=null,this.suggestedPresentationDelay=null,this.presentationTimeOffset=0,this.timeShiftBufferDepth=null,this.segmentTemplate=null,this.codecs=null,this.mimeType=null,this.type=null,this.segmentList=null,this.lang=null,this.representations=[],this.contentProtections=[],this.availabilityStartTime=null,this.UTCTiming=null}return(0,j.default)(a,[{key:"getRepresentation",value:function(a){var b;a=a||this.getAverageBandwidth();for(var c=0;c<this.representations.length;c++)if(b=this.representations[c],b.bandwidth===parseInt(a))return b;return null}},{key:"getAverageBandwidth",value:function(){var a,b=[];return this.representations.forEach(function(a){b.push(a.bandwidth)}),a=b.length>1?3===b.length?b[1]:b[Math.ceil(b.length/2)]:b[0]}},{key:"parseContentProtections",value:function(a){for(var b,c=0;c<a.length;c++)b=new e,b.schemeIdUri=a[c].getAttribute("schemeIdUri"),b.drmSystem=l[b.schemeIdUri.toUpperCase()],b.drmSystem&&(b.value=a[c].getAttribute("value"),b.cencPssh=(0,k.getFirstChild)(a[c],"cenc:pssh"),b.msproPro=(0,k.getFirstChild)(a[c],"mspr:pro"),this.contentProtections.push(b))}},{key:"updateTimeLine",value:function(a){var b,c=this.segmentTemplate.startNumber,d=this.availabilityStartTime-(this.segmentTemplate.presentationTimeOffset||0),e=this.segmentTemplate&&!isNaN(this.segmentTemplate.segmentDuration)?this.segmentTemplate.segmentDuration:null;this.lastSegment?(b=this.lastSegment.startTime+e+this.segmentTemplate.presentationTimeOffset,c=this.lastSegment.index+1):(b=this.segmentTemplate.presentationTimeOffset,this.segmentTemplate.presentationTimeOffset||(b=a-d-3*this.timeShiftBufferDepth*1e3,c+=Math.floor(b/this.segmentTemplate.duration)));for(var g,h=this.segmentTemplate.timescale;b+d<a;)g=new f,g.startTime=b-this.segmentTemplate.presentationTimeOffset,g.start=g.startTime/h,g.durationTime=e,g.duration=e/h,g.index=c,b+=e,this.segmentList.push(g),c++}},{key:"createTimeLine",value:function(){var a,b,c,d,e=this.segmentTemplate&&this.segmentTemplate.timeline?this.segmentTemplate.timeline.timePoints:null,g=this.segmentTemplate.timescale,h=0,i=-1,j=this.segmentTemplate&&!isNaN(this.segmentTemplate.segmentDuration)?this.segmentTemplate.segmentDuration:null,k=0,l=0;if(this.UTCTiming&&this.availabilityStartTime)this.segmentList=[],this.segmentDuration=j,this.availabilityEndTime&&this.updateTimeLine(this.availabilityEndTime);else if(null!==j){this.segmentList=[],this.segmentTemplate.startNumber&&(l=this.segmentTemplate.startNumber);var m=this.duration;for(this.segmentTemplate.presentationTimeOffset&&(h=this.segmentTemplate.presentationTimeOffset,m=+h);h/this.segmentTemplate.timescale<m;)a=new f,a.startTime=h,a.start=h/g,a.durationTime=j,a.duration=j/g,a.index=l,h+=j,this.segmentList.push(a),l++}else if(null!==e)for(this.segmentList=[],c=0,d=e.length;c<d;c++){b=e[c].repeat||0,b++;for(var n=0;n<b;n++)e[c].startTime&&0===n&&0===c?(h=e[c].startTime,k=h):h=e[c].startTime&&0===n?e[c].startTime:0===c&&0===n?0:i,k+=e[c].duration,i=h+e[c].duration,a=new f,a.index=l,a.startTime=h,a.start=(h-this.segmentTemplate.presentationTimeOffset)/g,a.durationTime=e[c].duration,a.duration=a.durationTime/g,this.segmentList.push(a),l++}this.segmentsDuration=k/g}},{key:"lastSegment",get:function(){return null!==this.segmentList&&this.segmentList.length?this.segmentList[this.segmentList.length-1]:null}},{key:"endTime",get:function(){var a=this.lastSegment;if(null!==a)return a.start+a.duration}},{key:"startTime",get:function(){return null!=this.segmentList&&this.segmentList.length?this.segmentList[0].start:0}}]),a}();c.default=m},{"../manifest/parser":107,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7}],110:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("babel-runtime/helpers/possibleConstructorReturn"),j=d(i),k=a("babel-runtime/helpers/inherits"),l=d(k),m=a("../../core/util/eventEmitter"),n=d(m),o=a("./event/dash-event"),p=d(o),q=a("../../core/util/http"),r=function(a){function b(a,c){(0,f.default)(this,b);var d=(0,j.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.adaptation=a,d.manifest=c,d.timescale=d.adaptation.segmentTemplate.timescale,d.representation=null,d.lastSegment=null,d.queue=[],d.cached={},d.isProcessingRequest=!1,d.isInitialized=!1,d.requestPromise=null,d.mediaType=null,d.paused=!1,d.stopped=!1,d.presentationTimeOffset=0,d.setAdaptation(a),d.updating=!1,d}return(0,l.default)(b,a),(0,h.default)(b,[{key:"setAdaptation",value:function(a){this.pause(),this.abort(),this.representation=null,this.adaptation=a,this.timescale=this.adaptation.segmentTemplate.timescale,this.presentationTimeOffset=this.adaptation.segmentTemplate.presentationTimeOffset,this.mediaType=this.adaptation.type,this.lastSegment=null,this.queue=[],this.isInitialized=!1,this.requestPromise=null,this.stopped=!1}},{key:"setRepresentation",value:function(a){this.representation=a,this.trigger("representation: ",a)}},{key:"start",value:function(a){var b=this;if(!this.stopped&&(this.representation=a,!this.isProcessingRequest)){var c;this.isInitialized=!1,this.isProcessingRequest=!0;var d=this.cached[this.representation.id];if("undefined"!=typeof d)return this.queue.push(d),this.isInitialized=!0,void(this.isProcessingRequest=!1);c=this.buildInitializationUrl(),this.requestPromise=q.http.getBinary(c).done(function(a){b.isInitialized=!0;var c={representationId:b.representation.id,index:-1,type:"initialization",bandwidth:b.representation.bandwidth,duration:0,data:a.data};b.queue.push(c),b.cached[b.representation.id]=c,b.isProcessingRequest=!1,b.trigger(p.default.SEGMENT_DOWNLOADED)}).fail(function(a){a===q.HttpStatus.FAILED&&(b.isProcessingRequest=!1,b.trigger(p.default.FAILED_TO_DOWNLOAD_SEGMENT,c))})}}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1,this.isInitialized||this.isProcessingRequest||this.start(this.representation)}},{key:"next",value:function(a,b){var c=this;if(!this.paused&&!this.stopped&&this.isInitialized&&!this.isProcessingRequest){var d,e=null,f=this.getBuffered(a),g=a+(f>b?f:b);null===this.lastSegment&&"audio"===this.mediaType&&(g=a),null!==this.lastSegment&&g<=this.lastSegment.start+this.lastSegment.duration&&(g=this.lastSegment.start+this.lastSegment.duration+.01),g-a>this.manifest.maxBufferLength+1||(e=this.findSegmentByPosition(g),null!==e&&(null!==this.lastSegment&&this.lastSegment.start>=e.start||this.manifest.presentationDelay&&e.startTime>this.manifest.presentationDelay||(d=this.buildSegmentUrl(e),this.isProcessingRequest=!0,this.requestPromise=q.http.getBinary(d).done(function(a){c.queue.push({representationId:c.representation.id,index:e.index,bandwidth:c.representation.bandwidth,start:e.start,duration:e.duration,data:a.data,segment:e}),c.updating||(c.lastSegment=e),c.updating=!1,c.isProcessingRequest=!1,c.trigger(p.default.SEGMENT_DOWNLOADED,a.metric)}).progress(function(a){a.bps>0&&a.loaded>5e3&&c.trigger(p.default.SEGMENT_DOWNLOAD_PROGRESS,{bps:a.bps,loaded:a.loaded,status:q.HttpStatus.PROGRESS,buffer:b})}).fail(function(a){a===q.HttpStatus.FAILED&&c.trigger(p.default.FAILED_TO_DOWNLOAD_SEGMENT,d),c.updating=!1,c.isProcessingRequest=!1}))))}}},{key:"update",value:function(a,b){0===b&&this.abort(),this.updating=!0,this.flush(!1),this.lastSegment=null,this.next(a)}},{key:"flush",value:function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(a)this.queue=[];else{var b=[];this.queue.forEach(function(a){a.index===-1&&b.push(a)}),this.queue=b}}},{key:"abort",value:function(){null!==this.requestPromise&&this.requestPromise.abort(),this.isProcessingRequest=!1}},{key:"stop",value:function(){this.stopped=!0,this.abort(),this.lastSegment=null,this.queue=[],this.isInitialized=!1,this.updating=!1}},{key:"getAllSegments",value:function(){return this.adaptation.segmentList}},{key:"getSegmentInternalByIndex",value:function(a){for(var b=0;b<this.queue.length;b++){var c=this.queue[b];if(parseInt(c.index)===parseInt(a))return c}return null}},{key:"buildInitializationUrl",value:function(){var a=[this.adaptation.url,this.adaptation.segmentTemplate.initialization].join("");return a=a.replace("$RepresentationID$",this.representation.id.toString()),a=a.replace("$Bandwidth$",this.representation.bandwidth.toString())}},{key:"buildSegmentUrl",value:function(a){var b=[this.adaptation.url,this.adaptation.segmentTemplate.media].join("");return b=b.replace("$Number$",a.index.toString()),b=b.replace("$Time$",a.startTime.toString()),b=b.replace("$RepresentationID$",this.representation.id.toString()),b=b.replace("$Bandwidth$",this.representation.bandwidth.toString())}},{key:"getBuffered",value:function(a){var b=0;return this.queue.forEach(function(c){c.start>=a&&(b+=c.duration)}),b}},{key:"getQueueStart",value:function(){return this.queue.length?this.queue[0].start:null}},{key:"findSegmentByIndex",value:function(a){var b=this.getAllSegments();return a>=b.length-1?b[b.length-1]:b[a]}},{key:"findSegmentByPosition",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(isNaN(a))return null;var c=this.getAllSegments();if(!c.length)return null;if(b&&a<c[0].start)return null;(0===a||a<c[0].start)&&(a=c[0].start);for(var d=0;d<c.length;d++){var e=c[d],f=e.start;if(a>=f&&a<f+e.duration)return e}return null}},{key:"getNextSegmentToSwitch",value:function(a){var b,c=Math.round(a),d=this.findSegmentByPosition(c),e=0,f=0;if(null===d)return null;for(;e<1&&f<4;)b=this.findSegmentByIndex(d.index+1),e=b.start-a,d=b,f++;return b}}]),b}(n.default);c.default=r},{"../../core/util/eventEmitter":95,"../../core/util/http":97,"./event/dash-event":104,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],111:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){function c(a){try{o.appendBuffer(a)}catch(a){"QuotaExceededError"===a.message&&(k(),j())}}function d(a){o.timestampOffset=a}function e(){return o.timestampOffset}function f(a){var b=0,c=g(a);return null!==c?b=c.end-a:b}function g(a){var b,c,d=i();if(null===d)return null;for(var e=0;e<d.length;e++)if(b=d.start(e),c=d.end(e),a>=b&&a<c)return{start:b,end:c};return null}function i(){try{return o.buffered}catch(a){return null}}function j(b,c){b=b||0,c=c||a.duration||Number.MAX_VALUE;try{o.remove(b,c)}catch(a){}}function k(){try{o.abort()}catch(a){}}function l(){o.removeEventListener(h.UPDATE_END,n)}function m(){o.addEventListener(h.UPDATE_END,n)}function n(){p.trigger(h.UPDATE_END)}var o=a.addSourceBuffer(b.mimeType+";codecs="+b.codecs),p=this;return b.presentationTimeOffset&&(o.timestampOffset=-(b.presentationTimeOffset/b.timescale)),m(),{on:this.on.bind(this),off:this.off.bind(this),trigger:this.trigger.bind(this),abort:k,clear:j,destroy:l,appendBuffer:c,getBufferRange:g,getBufferLength:f,setTimestampOffset:d,getTimestampOffset:e,getAllBufferRanges:i,get:function(){return o},isUpdating:function(){return o.updating}}}Object.defineProperty(c,"__esModule",{value:!0}),c.SourceBufferEvent=void 0;var f=a("../../core/util/eventEmitter"),g=d(f),h={ABORT:"abort",UPDATE_END:"updateend",ERROR:"error"};e.prototype=Object.create(g.default.prototype),c.default=e,c.SourceBufferEvent=h},{"../../core/util/eventEmitter":95}],112:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("babel-runtime/helpers/possibleConstructorReturn"),j=d(i),k=a("babel-runtime/helpers/inherits"),l=d(k),m=a("../../core/util/eventEmitter"),n=d(m),o=a("./stream"),p=d(o),q=a("../../core/event/playerEvent"),r=d(q),s=a("./event/dash-event"),t=d(s),u=a("./enum/mediaType"),v=d(u),w=a("../../core/timeshift"),x=a("../../core/util/core"),y=d(x),z=a("../../core/util/timer"),A=d(z),B=250,C=function(a){function b(a,c){(0,f.default)(this,b);var d=(0,j.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.player=a,d.timeShift=d.player.timeShift,d.video=null,d.mediaElement=null,d.mediaSource=null,d.adaptations=null,d.isLive=!1,d.manifest=c,d.options=d.player.options,d.startTime=0,d.activeStreams=[],d.availabilityStartTime=null,d.lastPosition=-1,d.deadlockTimeout=0,d.hasDeadlockTimeout=!1,d.hasFrameDeadlockTimeout=!1,d.frameDeadlockTimeout=null,d.decodedFrameCount=-1,d.videoStream=null,d.audioStream=null,d.defaultAudioLanguage=d.options.get("defaultAudioLanguage"),d.isReconnecting=!1,d.timer=new A.default(B,d.update.bind(d)),d.timer.immediateUpdate=!1,d.updateCounter=0,d.sessionState={},d}return(0,l.default)(b,a),(0,h.default)(b,[{key:"update",value:function(){var a=this.mediaElement.getBufferLengthFromTime(this.mediaElement.getCurrentTime());if(this.mediaElement.hasBuffered()&&1==this.mediaElement.getReadyState()&&0===a){var b=this.mediaElement.getBufferRange(this.mediaElement.getCurrentTime(),this.mediaElement.getCurrentTime()+this.videoStream.getSegmentDuration());if(b){var c=b.start;this.updateCounter>5&&(c+=.1,this.updateCounter=0),this.mediaElement.seek(c),this.updateCounter++}}else this.updateCounter=0;this.detectDeadlock()}},{key:"createStreams",value:function(a,b,c,d){this.mediaElement=a,this.video=this.mediaElement.getVideo(),this.mediaSource=b,this.adaptations=c,this.isLive=d,this.isReconnecting=!1,this.createVideoStream(),this.createAudioStream()}},{key:"initStreams",value:function(){this.updateStartTime(),this.activeStreams.forEach(function(a){return a.init()}),this.sessionState={lastChange:(new Date).getTime(),
time:0,bufferLength:0,decodedFrameCount:0},this.timer.start()}},{key:"setTimestampOffset",value:function(a){this.activeStreams.forEach(function(b){b.sourceBuffer.setTimestampOffset(a)})}},{key:"getTimestampOffset",value:function(){return this.videoStream.sourceBuffer.getTimestampOffset()}},{key:"getSourceBuffer",value:function(){return this.videoStream.sourceBuffer.get()}},{key:"createStream",value:function(a){var b=this,c=new p.default(this.mediaElement,a,this.mediaSource,this.manifest);return this.availabilityStartTime=a.availabilityStartTime||0,c.on(t.default.END_OF_STREAM,this.endOfStream.bind(this)),c.on(t.default.SEGMENT_DOWNLOAD_PROGRESS,function(a){b.trigger(t.default.SEGMENT_DOWNLOAD_PROGRESS,a)}),c.on(r.default.PROFILE_CHANGED,function(a){b.trigger(r.default.PROFILE_CHANGED,a)}),c.on(t.default.FAILED_TO_DOWNLOAD_SEGMENT,function(a){b.isReconnecting||(b.isLive&&b.getBufferLength()<1&&b.reconnect(2e3),b.trigger(t.default.FAILED_TO_DOWNLOAD_SEGMENT,a))}),c}},{key:"switchRepresentation",value:function(a,b){null!==this.videoStream&&this.videoStream.switchRepresentation(a,b)}},{key:"switchAudioTrack",value:function(a){var b="string"==typeof a?this.getAudioAdaptation(a):this.getAudioAdaptationById(a);this.audioStream.switchTrack(b)}},{key:"hasActiveStreams",value:function(){return this.activeStreams.length}},{key:"sourceOpen",value:function(){this.activeStreams.forEach(function(a){a.isEndOfStream=!1})}},{key:"endOfStream",value:function(){var a=!1;if("open"===this.mediaSource.readyState)for(var b=0;b<this.activeStreams.length;b++){if(!this.activeStreams[b].isEndOfStream)return!1;a=!0}a&&this.mediaSource.endOfStream()}},{key:"detectDeadlock",value:function(){var a=this;if(!this.mediaElement.isPaused()){for(var b=this.mediaElement.getCurrentTime(),c=this.mediaElement.getBufferLengthFromTime(b),d=this.mediaElement.getDecodedFrameCount(),e=(new Date).getTime(),f=!1,g=0;g<this.activeStreams.length;g++){var h=this.activeStreams[g];if(h.isProcessingRequest()){f=!0;break}}if(1===this.mediaElement.getReadyState()&&this.startTime>this.mediaElement.getCurrentTime()&&Math.abs(this.startTime-this.mediaElement.getCurrentTime())<2&&this.mediaElement.seek(this.startTime),b>this.startTime&&b<this.startTime+2&&1===this.mediaElement.getReadyState()){var i=this.mediaElement.getBufferRange(this.mediaElement.getCurrentTime(),this.mediaElement.getCurrentTime()+2),j=this.mediaElement.getCurrentTime()+.01;i&&(j=i.start+.01),this.mediaElement.seek(j)}if(!this.hasFrameDeadlockTimeout&&c>0&&this.decodedFrameCount>0&&this.mediaElement.getDecodedFrameCount()===this.decodedFrameCount&&b!==this.lastPosition?(this.decodedFrameCount=d,this.hasFrameDeadlockTimeout=!0,this.frameDeadlockTimeout=setTimeout(function(){a.hasFrameDeadlockTimeout=!1,a.mediaElement.seek(a.mediaElement.getCurrentTime()+.1)},2e3)):clearTimeout(this.frameDeadlockTimeout),this.mediaElement.getReadyState()>1&&!f&&(this.lastPosition>0&&this.lastPosition===b||0===c)?!this.hasDeadlockTimeout&&this.isLive&&(this.hasDeadlockTimeout=!0,this.deadlockTimeout=setTimeout(function(){a.reconnect(0),a.hasDeadlockTimeout=!1},3e3)):(clearTimeout(this.deadlockTimeout),this.hasDeadlockTimeout=!1,this.decodedFrameCount=d),this.mediaElement.getReadyState()<=2)if(this.sessionState.time!==b||this.sessionState.bufferLength!==c||this.sessionState.decodedFrameCount!==d)this.sessionState.lastChange=(new Date).getTime(),this.sessionState.time=b,this.sessionState.bufferLength=c,this.sessionState.decodedFrameCount=d;else{var k=(e-this.sessionState.lastChange)/1e3;k>2&&this.isStreamsStarted()&&(this.sessionState.lastChange=(new Date).getTime(),c>0&&this.mediaElement.seek(b+.1))}this.lastPosition=b}}},{key:"reconnect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;this.trigger(r.default.RECONNECT,a)}},{key:"destroy",value:function(){this.timer.stop(),this.lastPosition=0,this.hasDeadlockTimeout=!1,clearTimeout(this.deadlockTimeout),this.activeStreams.forEach(function(a){a.stop(),a=null}),this.activeStreams=[]}},{key:"clearBuffer",value:function(a,b){this.activeStreams.forEach(function(c){try{c.clearBuffer(a,b)}catch(a){}})}},{key:"seek",value:function(a){var b,c;null!==this.videoStream&&(b=this.getDuration()/100*a,this.timeShift.getDvrWindow()>0&&(b=(this.timeShift.getStart()-this.timeShift.getBaseTimeStamp()+1e3*this.getDuration()/100*a)/1e3),c=this.videoStream.getNearestSegmentPosition(b),c>=0&&this.mediaElement.seek(c))}},{key:"updatePosition",value:function(a){this.activeStreams.forEach(function(b){return b.updatePosition(a)})}},{key:"pauseStreamsUpdate",value:function(){this.activeStreams.forEach(function(a){return a.pause()})}},{key:"resumeStreamsUpdate",value:function(){this.activeStreams.forEach(function(a){return a.resume()})}},{key:"getDuration",value:function(){return this.timeShift.getDvrWindow()>=0?this.timeShift.getDvrWindow():this.timeShift.getStart()>=0&&this.timeShift.getStop()<0?this.timeShift.getHeadTime()<0?0:(this.timeShift.getHeadTime()-this.timeShift.getStart())/1e3:this.timeShift.getStart()>=0&&this.timeShift.getStop()>=0?(this.timeShift.getStop()-this.timeShift.getStart())/1e3:this.mediaElement?this.mediaElement.getDuration():0}},{key:"getCurrentTime",value:function(){if(null===this.mediaElement||0===this.mediaElement.getCurrentTime())return 0;var a=this.mediaElement.getCurrentTime();return this.player.isIndexMode()?a:this.timeShift.isEnabled()&&this.timeShift.isVod()?a:this.isLive&&!this.timeShift.isEnabled()&&a>0?a+this.availabilityStartTime/1e3:a}},{key:"getBufferLength",value:function(){var a=this.mediaElement?this.mediaElement.getBufferLengthFromTime(this.mediaElement.getCurrentTime()):0;return this.isStreamsStarted()||(a=this.getQueueLength()),a}},{key:"getQueueLength",value:function(a){var b=this.activeStreams.map(function(b){return b.getTotalBuffer(a)});return b.length?Math.min.apply(Math,b):0}},{key:"isStreamsStarted",value:function a(){var a=!0;return this.activeStreams.forEach(function(b){b.isStreamStarted||(a=!1)}),a}},{key:"setMaxBufferLength",value:function(a){this.maxMaxBufferLength=a,this.activeStreams.forEach(function(b){b.setMaxBufferLength(a)})}},{key:"updateStartTime",value:function(){var a=this,b=10,c=this.options.get("startTime")||0;return c?(this.options.set("startTime",null),void(this.startTime=c)):(!this.isLive||this.timeShift.isEnabled()&&this.timeShift.mode!==w.TimeShiftMode.LIVE?!function(){var b=[];a.activeStreams.forEach(function(a){var c=a.getNearestSegmentPosition(a.adaptation.startTime);a.setStartTime(c),b.push(c)}),c=Math.max.apply(Math,b)}():!function(){var d=a.manifest.suggestedPresentationDelay||a.manifest.minBufferTime;d<b&&(d=b),a.manifest.startBufferLength&&(d=a.manifest.startBufferLength),a.options.get("liveDelay")&&(d=a.options.get("liveDelay")),d+=a.manifest.segmentDuration;var e=[];a.activeStreams.forEach(function(a){var b=a.adaptation.endTime,c=b-d,f=a.getNearestSegmentPosition(c);a.setStartTime(f),e.push(f)}),c=Math.max.apply(Math,e)}(),void(this.startTime=c))}},{key:"getCurrentProfile",value:function(){return this.videoStream.representation}},{key:"getProfiles",value:function(){return this.videoStream.getRepresentations()}},{key:"setInitialBandwidth",value:function(a){null!==this.videoStream&&this.videoStream.setBandwidth(a)}},{key:"createVideoStream",value:function(){var a=this.getAdaptationByType(v.default.VIDEO),b=this.createStream(a);null!==this.options.get("defaultBitrate")&&b.setBandwidth(this.options.get("defaultBitrate")),this.activeStreams.push(b),this.videoStream=b}},{key:"createAudioStream",value:function(){var a=this.defaultAudioLanguage||y.default.getBrowserLanguage(),b=this.getAdaptationByType(v.default.AUDIO,a);null!==b&&(this.audioStream=this.createStream(b),this.activeStreams.push(this.audioStream))}},{key:"getAdaptationByType",value:function(a,b){var c=this.adaptations.filter(function(b){return b.type===a});if(b){var d=c.filter(function(a){return a.lang===b});d.length&&(c=d)}return c.length?c[0]:null}},{key:"getAudioAdaptation",value:function(a){var b=this.adaptations.filter(function(b){return b.lang===a});return b[0]}},{key:"getAudioAdaptationById",value:function(a){var b=this.adaptations.filter(function(b){return b.id===a});return b[0]}},{key:"getAudioStream",value:function(a){var b=this.streams.filter(function(a){return a.mediaType===v.default.AUDIO});if(b.length){var c=b.filter(function(b){return b.adaptation.lang===a});return c.length?c[0]:b[0]}}}]),b}(n.default);c.default=C},{"../../core/event/playerEvent":85,"../../core/timeshift":93,"../../core/util/core":94,"../../core/util/eventEmitter":95,"../../core/util/timer":99,"./enum/mediaType":103,"./event/dash-event":104,"./stream":113,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}],113:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("babel-runtime/helpers/classCallCheck"),f=d(e),g=a("babel-runtime/helpers/createClass"),h=d(g),i=a("babel-runtime/helpers/possibleConstructorReturn"),j=d(i),k=a("babel-runtime/helpers/inherits"),l=d(k),m=a("../../core/util/eventEmitter"),n=d(m),o=a("../../core/util/timer"),p=d(o),q=a("./source-buffer"),r=d(q),s=a("./segment"),t=d(s),u=a("../../core/event/playerEvent"),v=d(u),w=a("./event/dash-event"),x=d(w),y=a("./enum/mediaType"),z=d(y),A=500,B=function(a){function b(a,c,d,e){(0,f.default)(this,b);var g=(0,j.default)(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return g.mediaElement=a,g.adaptation=c,g.mediaSource=d,g.manifest=e,g.representation=g.adaptation.getRepresentation(),g.mediaType=g.adaptation.type,g.sourceBufferLength=0,g.isSwitching=!1,g.switchingTime=-1,g.isEndOfStream=!1,g.sourceBuffer=null,g.isStreamStarted=!1,g.startTime=0,g.paused=!1,g.segmentManager=new t.default(g.adaptation,g.manifest),g.segmentManager.setRepresentation(g.representation),g.segmentManager.on(x.default.FAILED_TO_DOWNLOAD_SEGMENT,function(a){g.trigger(x.default.FAILED_TO_DOWNLOAD_SEGMENT,a)}),g.segmentManager.on(x.default.SEGMENT_DOWNLOADED,g.update.bind(g)),g.mediaType===z.default.VIDEO&&g.segmentManager.on(x.default.SEGMENT_DOWNLOAD_PROGRESS,function(a){g.trigger(x.default.SEGMENT_DOWNLOAD_PROGRESS,a)}),g.timer=new p.default(A,g.update.bind(g)),g}return(0,l.default)(b,a),(0,h.default)(b,[{key:"init",value:function(){this.sourceBuffer=this.createSourceBuffer(),this.registerEvents(),this.timer.start(),this.segmentManager.start(this.representation),this.trigger(v.default.PROFILE_CHANGED,this.representation)}},{key:"setStartTime",value:function(a){this.startTime=a}},{key:"setBandwidth",value:function(a){var b=null;a=1e3*a;for(var c=0;c<this.adaptation.representations.length;c++){var d=this.adaptation.representations[c];if(b=d,a>=d.bandwidth)break}null!==b&&(this.representation=b)}},{key:"switchTrack",value:function(a){this.adaptation=a,this.representation=this.adaptation.getRepresentation(),this.segmentManager.setAdaptation(this.adaptation),this.segmentManager.setRepresentation(this.representation);var b=this.sourceBuffer.getBufferLength(this.mediaElement.getCurrentTime()),c=this.segmentManager.getNextSegmentToSwitch(this.mediaElement.getCurrentTime());this.clearBuffer(0,this.mediaElement.getCurrentTime()),b>2&&this.clearBuffer(c.start),this.segmentManager.start(this.representation)}},{key:"switchRepresentation",value:function(a,b){if(this.representation=a,this.trigger(v.default.PROFILE_CHANGED,this.representation),this.abort(),this.isSwitching=!1,this.segmentManager.setRepresentation(this.representation),b&&(this.switchingTime=-1,this.isSwitching=!0,null!==this.sourceBuffer)){this.segmentManager.queue=[],this.segmentManager.lastSegment=null;var c=this.segmentManager.getNextSegmentToSwitch(this.mediaElement.getCurrentTime());if(null!==c){var d=c.start;d<5&&(d=5),this.clearBuffer(d+1)}}this.segmentManager.start(this.representation)}},{key:"setRepresentation",value:function(a){this.representation=a}},{key:"setMaxBufferLength",value:function(a){this.manifest.maxBufferLength=a}},{key:"getRepresentations",value:function(){return this.adaptation.representations}},{key:"getSegmentDuration",value:function(){return this.adaptation.segmentTemplate.segmentDuration/this.adaptation.segmentTemplate.timescale}},{key:"abort",value:function(){this.segmentManager.abort()}},{key:"clearBuffer",value:function(a,b){b<a||("open"===this.mediaSource.readyState&&this.sourceBuffer.abort(),this.sourceBuffer.clear(a,b))}},{key:"updatePosition",value:function(a){this.startTime=a,this.segmentManager.update(a,this.sourceBuffer.getBufferLength(a)),this.update()}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"update",value:function(){if(null!==this.sourceBuffer&&!this.paused){var a=this.mediaElement.getCurrentTime();this.sourceBufferLength=this.sourceBuffer.getBufferLength(a),0===this.mediaElement.getReadyState()&&(a=this.startTime),this.sourceBufferLength>this.manifest.maxBufferLength?this.segmentManager.pause():this.segmentManager.resume(),this.detectEndOfStream(a),this.segmentManager.next(a,this.sourceBufferLength);var b=0;if(!this.isStreamStarted&&this.manifest.startBufferLength&&(b=this.manifest.startBufferLength),!(b-1>this.getQueueLength(a)&&this.mediaType===z.default.VIDEO)){if(this.isStreamStarted=!0,!this.sourceBuffer.isUpdating()&&this.isSwitching&&this.switchingTime>=0&&a>this.switchingTime&&this.mediaType===z.default.VIDEO){this.isSwitching=!1,this.isEndOfStream=!1;var c=this.switchingTime-4;return c>0&&this.clearBuffer(0,c),void(this.switchingTime=-1)}if(this.segmentManager.queue.length&&this.sourceBufferLength<this.manifest.maxBufferLength&&!this.sourceBuffer.isUpdating()){var d=this.segmentManager.queue.shift();this.mediaType===z.default.VIDEO&&this.isSwitching&&d.index>=0&&this.switchingTime===-1&&(this.switchingTime=d.start),this.sourceBuffer.appendBuffer(d.data)}}}}},{key:"isProcessingRequest",value:function(){return this.segmentManager.isProcessingRequest}},{key:"getQueueLength",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.mediaElement.getReadyState()<3&&(a=this.startTime),this.segmentManager.getBuffered(a)}},{key:"getTotalBuffer",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.mediaElement.getReadyState()<3&&(a=this.startTime),this.getQueueLength(a)+this.sourceBuffer.getBufferLength(a)}},{key:"getNearestSegmentPosition",value:function(a,b){var c=this.segmentManager.findSegmentByPosition(a,b);return null!==c?c.start:-1}},{key:"detectEndOfStream",value:function(a){if(!this.manifest.isLive&&!this.isEndOfStream){var b=this.segmentManager.getAllSegments(),c=b[b.length-1].start+b[b.length-1].duration;(this.sourceBuffer.getBufferRange(a)&&this.sourceBuffer.getBufferRange(a).end>=c-.1||this.mediaElement.getReadyState()>=c)&&(this.isEndOfStream=!0,this.trigger(x.default.END_OF_STREAM))}}},{key:"stop",value:function(){if(this.isSwitching=!1,clearTimeout(this.deadlockTimeout),this.timer.stop(),this.abort(),"open"===this.mediaSource.readyState)try{this.mediaSource.endOfStream()}catch(a){}if(this.segmentManager.stop(),null!==this.mediaSource&&null!==this.sourceBuffer){try{this.sourceBuffer.abort(),this.removeSourceBuffer()}catch(a){}this.sourceBuffer=null}}},{key:"sourceOpen",value:function(){this.isEndOfStream=!1}},{key:"registerEvents",value:function(){var a=this;this.sourceBuffer.on(q.SourceBufferEvent.UPDATE_END,function(){return a.update()})}},{key:"removeSourceBuffer",value:function(){this.mediaSource.removeSourceBuffer(this.sourceBuffer.get())}},{key:"createSourceBuffer",value:function(){return new r.default(this.mediaSource,{timescale:this.adaptation.segmentTemplate.timescale,codecs:this.adaptation.codecs,mimeType:this.adaptation.mimeType,presentationTimeOffset:this.adaptation.segmentTemplate.presentationTimeOffset})}}]),b}(n.default);c.default=B},{"../../core/event/playerEvent":85,"../../core/util/eventEmitter":95,"../../core/util/timer":99,"./enum/mediaType":103,"./event/dash-event":104,"./segment":110,"./source-buffer":111,"babel-runtime/helpers/classCallCheck":6,"babel-runtime/helpers/createClass":7,"babel-runtime/helpers/inherits":8,"babel-runtime/helpers/possibleConstructorReturn":9}]},{},[86,105]);
function _handleMultipleEvents(a,b,c,d){vjs.arr.forEach(c,function(c){a(b,c,d)})}function _logType(a,b){var c,d,e;c=Array.prototype.slice.call(b),d=function(){},e=window.console||{log:d,warn:d,error:d},a?c.unshift(a.toUpperCase()+":"):a="log",vjs.log.history.push(c),c.unshift("VIDEOJS:"),e[a].apply?e[a].apply(e,c):e[a](c.join(" "))}function secondsToHms(a,b){a=Number(a);var c=Math.floor(a/3600),d=Math.floor(a%3600/60),e=Math.floor(a%3600%60);return"object"==typeof b&&b.length>=2?(c>0?c+b[0]:"")+(d>0?(c>0&&d<10?"0":"")+d+b[1]:"0:")+(e<10?"0":"")+e+(b.length>2?b[2]:""):("undefined"!=typeof b&&"string"==typeof b||(b=":"),(c>0?c+b:"")+(d>0?(c>0&&d<10?"0":"")+d+b:"0:")+(e<10?"0":"")+e)}function vjsCallFromWebview(a){"Desktop"===window.uDevice?"Windows"===window.uOS&&window.external&&"notify"in window.external?window.external.notify(JSON.stringify(a)):console.log("--- calling from webview:",JSON.stringify(a)):("Android"===window.uOS&&window.tvnexternal.notify(JSON.stringify(a)),"Windows"===window.uOS&&window.external.notify(JSON.stringify(a)),"MacOS"===window.uOS&&(document.location.hash="notify://"+encodeURI(JSON.stringify(a))))}function getAttribs(a){var b={};if("undefined"!=typeof a)for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c].nodeName,e=a.attributes[c].value;b[d]=e}return b}function lVar(){this.item=null,this.watch=function(a){},this.set=function(a){this.item!==a&&(this.item=a,this.watch(a))},this.get=function(){return this.item}}function extractCdata(a,b){var c="",d="";if("undefined"==typeof a||null===a)return c;if("object"==typeof a.childNodes){var e;for(e=0;e<a.childNodes.length;e++)"#cdata-section"===a.childNodes.item(e).nodeName&&(c+=a.childNodes.item(e).data),"#text"===a.childNodes.item(e).nodeName&&(d+=a.childNodes.item(e).data)}var f=(d+c).trim();return f=0===f.indexOf("http")?f.replace(/ /g,"%20").replace(/<\\\\br>|<\/\/br>|<br\\\\>|<br\/\/>|<\/br>|<\\br>|<br\/>|<br\\>|<br>/g,""):"undefined"!=typeof b&&b===!0?"":f.replace(/<\\\\br>|<\/\/br>|<br\\\\>|<br\/\/>|<\/br>|<\\br>|<br\/>|<br\\>|<br>|\\\\n|\/n|\\n|\/\/n/g,"<br/>")}function extractCdataArray(a,b){var c,d,e={};for(c=0;c<a.length;c++)d=extractCdata(a[c],b),""!==d&&(e[c]=d);return e}function vjsGetStyle(a,b){var c="";if(window.getComputedStyle)c=getComputedStyle(a).getPropertyValue(b);else if(a.currentStyle)try{c=a.currentStyle[b]}catch(d){}return c}function extractTrackingEvents(a){var b={};if(a.length>0)for(var c=a[0].getElementsByTagName("Tracking"),d=0;d<c.length;d++){var e=getAttribs(c[d]).event,f=extractCdata(c[d]);void 0===b[e]&&(b[e]=[]),""!==f&&b[e].push(f)}return b}function hexToRGBA(a){var b,c,d,e,f="";return"undefined"==typeof a?f="":7==a.length?(f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a),f?(b=parseInt(f[1],16),c=parseInt(f[2],16),d=parseInt(f[3],16),f="rgb("+b+","+c+","+d+")"):f=""):(f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a),f?(e=parseInt(f[1],16)/255,b=parseInt(f[2],16),c=parseInt(f[3],16),d=parseInt(f[4],16),f="rgba("+b+","+c+","+d+","+e+")"):f=""),f}function hexToRGB_MA(a,b){var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);if(c){var d=parseInt(c[1],16),e=parseInt(c[2],16),f=parseInt(c[3],16);return"rgba("+d+","+e+","+f+","+b+")"}return c=""}function rgbaToRgb(a){if(a.search("rgba")!==-1){var b=a.split(",");return b.pop(),b[0]=b[0].replace("rgba","rgb"),b.join(",")+")"}return a}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}function md5cycle(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];c=ff(c,d,e,f,b[0],7,-680876936),f=ff(f,c,d,e,b[1],12,-389564586),e=ff(e,f,c,d,b[2],17,606105819),d=ff(d,e,f,c,b[3],22,-1044525330),c=ff(c,d,e,f,b[4],7,-176418897),f=ff(f,c,d,e,b[5],12,1200080426),e=ff(e,f,c,d,b[6],17,-1473231341),d=ff(d,e,f,c,b[7],22,-45705983),c=ff(c,d,e,f,b[8],7,1770035416),f=ff(f,c,d,e,b[9],12,-1958414417),e=ff(e,f,c,d,b[10],17,-42063),d=ff(d,e,f,c,b[11],22,-1990404162),c=ff(c,d,e,f,b[12],7,1804603682),f=ff(f,c,d,e,b[13],12,-40341101),e=ff(e,f,c,d,b[14],17,-1502002290),d=ff(d,e,f,c,b[15],22,1236535329),c=gg(c,d,e,f,b[1],5,-165796510),f=gg(f,c,d,e,b[6],9,-1069501632),e=gg(e,f,c,d,b[11],14,643717713),d=gg(d,e,f,c,b[0],20,-373897302),c=gg(c,d,e,f,b[5],5,-701558691),f=gg(f,c,d,e,b[10],9,38016083),e=gg(e,f,c,d,b[15],14,-660478335),d=gg(d,e,f,c,b[4],20,-405537848),c=gg(c,d,e,f,b[9],5,568446438),f=gg(f,c,d,e,b[14],9,-1019803690),e=gg(e,f,c,d,b[3],14,-187363961),d=gg(d,e,f,c,b[8],20,1163531501),c=gg(c,d,e,f,b[13],5,-1444681467),f=gg(f,c,d,e,b[2],9,-51403784),e=gg(e,f,c,d,b[7],14,1735328473),d=gg(d,e,f,c,b[12],20,-1926607734),c=hh(c,d,e,f,b[5],4,-378558),f=hh(f,c,d,e,b[8],11,-2022574463),e=hh(e,f,c,d,b[11],16,1839030562),d=hh(d,e,f,c,b[14],23,-35309556),c=hh(c,d,e,f,b[1],4,-1530992060),f=hh(f,c,d,e,b[4],11,1272893353),e=hh(e,f,c,d,b[7],16,-155497632),d=hh(d,e,f,c,b[10],23,-1094730640),c=hh(c,d,e,f,b[13],4,681279174),f=hh(f,c,d,e,b[0],11,-358537222),e=hh(e,f,c,d,b[3],16,-722521979),d=hh(d,e,f,c,b[6],23,76029189),c=hh(c,d,e,f,b[9],4,-640364487),f=hh(f,c,d,e,b[12],11,-421815835),e=hh(e,f,c,d,b[15],16,530742520),d=hh(d,e,f,c,b[2],23,-995338651),c=ii(c,d,e,f,b[0],6,-198630844),f=ii(f,c,d,e,b[7],10,1126891415),e=ii(e,f,c,d,b[14],15,-1416354905),d=ii(d,e,f,c,b[5],21,-57434055),c=ii(c,d,e,f,b[12],6,1700485571),f=ii(f,c,d,e,b[3],10,-1894986606),e=ii(e,f,c,d,b[10],15,-1051523),d=ii(d,e,f,c,b[1],21,-2054922799),c=ii(c,d,e,f,b[8],6,1873313359),f=ii(f,c,d,e,b[15],10,-30611744),e=ii(e,f,c,d,b[6],15,-1560198380),d=ii(d,e,f,c,b[13],21,1309151649),c=ii(c,d,e,f,b[4],6,-145523070),f=ii(f,c,d,e,b[11],10,-1120210379),e=ii(e,f,c,d,b[2],15,718787259),d=ii(d,e,f,c,b[9],21,-343485551),a[0]=add32(c,a[0]),a[1]=add32(d,a[1]),a[2]=add32(e,a[2]),a[3]=add32(f,a[3])}function cmn(a,b,c,d,e,f){return b=add32(add32(b,a),add32(d,f)),add32(b<<e|b>>>32-e,c)}function ff(a,b,c,d,e,f,g){return cmn(b&c|~b&d,a,b,e,f,g)}function gg(a,b,c,d,e,f,g){return cmn(b&d|c&~d,a,b,e,f,g)}function hh(a,b,c,d,e,f,g){return cmn(b^c^d,a,b,e,f,g)}function ii(a,b,c,d,e,f,g){return cmn(c^(b|~d),a,b,e,f,g)}function md51(a){txt="";var b,c=a.length,d=[1732584193,-271733879,-1732584194,271733878];for(b=64;b<=a.length;b+=64)md5cycle(d,md5blk(a.substring(b-64,b)));a=a.substring(b-64);var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<a.length;b++)e[b>>2]|=a.charCodeAt(b)<<(b%4<<3);if(e[b>>2]|=128<<(b%4<<3),b>55)for(md5cycle(d,e),b=0;b<16;b++)e[b]=0;return e[14]=8*c,md5cycle(d,e),d}function md5blk(a){var b,c=[];for(b=0;b<64;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function rhex(a){for(var b="",c=0;c<4;c++)b+=hex_chr[a>>8*c+4&15]+hex_chr[a>>8*c&15];return b}function hex(a){for(var b=0;b<a.length;b++)a[b]=rhex(a[b]);return a.join("")}function md5(a){return hex(md51(a))}function makeSeconds(a){if("number"==typeof a)return a;if(isDefined(a)&&a){var b=a.split(":");return 3==b.length?60*+b[0]*60+60*+b[1]+ +b[2]:60*+b[0]+ +b[1]}}function makeMilliSeconds(a){var b,c,d=!1;return isDefined(a)&&(b=a.split("."),2==b.length)?(c=b[0].split(":"),d=3==c.length?60*+c[0]*60+60*+c[1]+ +c[2]:60*+c[0]+ +c[1],1e3*d+parseInt(b[1],10)):d}function toHHMMSS(a){var b=parseInt(a,10),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d;return c<10&&(c="0"+c),d<10&&(d="0"+d),e<10&&(e="0"+e),c+":"+d+":"+e}function fixTimeShifts(a){return a.sort(function(a,b){return a.attribs.timeStart-b.attribs.timeStart})}function sortRollVideo(a){if(a.length>0)for(var b=0;b<a.length;b++)a[b].items=fixAdOrder(a[b].items);return a}function deactivateAdsAfterLastIma(a){if(a.length&&"object"==typeof a[0]&&"pre-roll"===a[0].type&&a[0].items&&a[0].items.length){var b=0,c=getLastImaAdIndex(a);for(a[0].lastIMAadIndex=c,b=0;b<a[0].items.length;b++)c>-1&&b>c&&(a[0].items[b].active=!1,a[0].items[b].external=!0)}return a}function getLastImaAdIndex(a){var b=0,c=-1;if(a.length&&"object"==typeof a[0]&&"pre-roll"===a[0].type&&a[0].items&&a[0].items.length)for(b=0;b<a[0].items.length;b++)"object"==typeof a[0].items[b].fullObj&&a[0].items[b].fullObj.isIMA&&(c=b);return c}function fixAdOrder(a){if(a.length<=1)return a;for(var b=[],c=[],d=[],e=a.length,f=0,g=[],h=0;h<e;h++)if(a[h].fullObj.position=~~a[h].fullObj.position,0===a[h].fullObj.position)c.push(a[h]);else if(f=a[h].fullObj.position>f?a[h].fullObj.position:f,isDefined(b[a[h].fullObj.position])){var i=a[h].fullObj.position;b[i].push(a[h])}else b[a[h].fullObj.position]=[],b[a[h].fullObj.position].push(a[h]);for(var j=1;j<=f;j++)if(isDefined(b[j]))for(var k in b[j])d.push(b[j][k]);else{var l=c.shift();isDefined(l)&&d.push(l)}for(var m in d)"object"==typeof d[m]&&g.push(d[m]);for(j=0;j<c.length;j++)g.push(c[j]);return g}function getParamBreakNames(){return{Preroll:"predur",Midroll_1:"mid1dur",Midroll_2:"mid2dur",Midroll_3:"mid3dur",Postroll:"postdur",Overlay:"overdur"}}function isDefined(a){return"undefined"!=typeof a}function isNotDefined(a){return"undefined"==typeof a}function parsePercentage(a){var b=PLAYER_DEFAULT_OPACITY;if("string"==typeof a&&a.indexOf("%")!=-1){var c=parseFloat(a.replace("%",""));b=c/100}return b}function isNumeric(a){return!isNaN(parseFloat(a))&&isFinite(a)}function getBoolean(a){return("string"!=typeof a||"false"!==a.toLowerCase())&&"0"!==a&&!!a}function getExtensionByUrl(a){var b=a.split("?")[0];return b.substr(b.lastIndexOf(".")+1)}function adjustVastUrl(a,b){var c="",d=a.split("?"),e=["predur"];c+=d[0]+"?";for(var f in b.ad_breaks)makeSeconds(b.ad_breaks[f])<~~b.time&&e.push("mid"+(~~f+1)+"dur");if(isDefined(d[1]))for(var g=d[1].split("/"),h=0;h<g.length;h++){var i=g[h],j=i.split("="),k=j[0],l=j[1];-1===e.indexOf(k)&&(c+="/"+k+"="+l)}return c}function buildImgOrSWF(a,b,c){var d,e,f=/[\.\/\w-%]+\.swf/i,g=/[\.\/\w-%]+\.mp4/i;return"undefined"!=typeof c?(d=isDefined(c.width)?' width="'+c.width+'"':"",e=isDefined(c.height)?' height="'+c.height+'"':""):(d="",e=""),a.match(f)?'<object id="'+b+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+d+e+'><param name="movie" value="'+a+'" /><param name="wmode" value="transparent"><param name="scale" value="default">'+("undefined"!=typeof c&&isDefined(c.clickTags)?'<param name="flashvars" value="'+c.clickTags+'">':"")+'<!--[if !IE]>--><object type="application/x-shockwave-flash" wmode="transparent" data="'+a+'"'+(""!==d?d:' width="100%"')+(""!==e?e:' height="100%"')+' scale="default" '+("undefined"!=typeof c&&isDefined(c.clickTags)?'flashvars="'+c.clickTags.replace(";","&")+'"':"")+'><!--<![endif]--><!--[if !IE]>--></object><!--<![endif]--></object><script>swfobject.registerObject("'+b+'", "", PLAYER_DEFAULT_HOST + "expressInstall.swf")</script>':("undefined"!=typeof c&&(d=isDefined(c.width)?" width:"+c.width+"px;":"",e=isDefined(c.height)?" height:"+c.height+"px;":""),a.match(g)?'<video src="'+a+'" autoplay mute loop style="'+d+e+'" ></video>':'<img src="'+a+'" alt="" style="'+d+e+'" />')}function isBrowserPlayer5Ready(){var a=!1,b=!!window.MSInputMethodContext&&"Edge"===window.uBrowser&&"10"==window.uOSversion&&"Windows"==window.uOS,c=!(!window.MSInputMethodContext||!document.documentMode||"8.1"!=window.uOSversion&&"10"!=window.uOSversion||"Windows"!=window.uOS);try{if(detectIE()){var d=new ActiveXObject("AgControl.AgControl"),e=this.loop(0,100,function(b){a=d.isVersionSupported(b+".0")}),f=this.loop(0,99999,function(b){a=d.isVersionSupported(e+"."+b)}),g=this.loop(0,99999,function(b){a=d.isVersionSupported(e+"."+f+"."+b)}),h=this.loop(0,99999,function(b){a=d.isVersionSupported(e+"."+f+"."+g)});silverlightVersion=e+"."+f+"."+g+"."+h}else a=navigator.plugins["Silverlight Plug-In"].description}catch(i){a=!1}var j=navigator.platform.toUpperCase().indexOf("MAC")>=0;return c||b||"Desktop"!==window.uDevice||"Chrome"===window.uBrowser&&"Desktop"===window.uDevice&&(window.uVersion>=42&&a===!1||window.uVersion>=41&&(j||"function"==typeof $.fn.player5&&"undefined"!=typeof localStorage&&1===localStorage.getItem("player5")))||"Opera"==window.uBrowser&&window.uVersion>=36||"Firefox"==window.uBrowser&&parseInt(window.uVersion)>=48&&["XP","2000"].indexOf(window.uOSversion)===-1}function objectToStringRecursive(a,b){var c="";if("undefined"==typeof b&&(b=[]),"object"!=typeof a){var d=new Date;return md5(d.toUTCString())}for(var e in a)"__proto__"!=e&&b.indexOf(e)==-1&&(b.push(e),"function"!=typeof a[e]&&(c+="object"==typeof a[e]?objectToStringRecursive(a[e],b):String(a[e]).valueOf()));return c}function detectIE(){var a=window.navigator.userAgent,b=a.indexOf("MSIE ");if(b>0)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);var c=a.indexOf("Trident/");if(c>0){var d=a.indexOf("rv:");return parseInt(a.substring(d+3,a.indexOf(".",d)),10)}var e=a.indexOf("Edge/");if(e>0)return parseInt(a.substring(e+5,a.indexOf(".",e)),10);var f=!!window.ActiveXObject&&+/IEMobile\/(\d+\.?(\d+)?)/.exec(navigator.userAgent)[1]||NaN;return!!f&&parseInt(f,10)}function enforcePrecision(a,b){return+a.toFixed(b)}function roundToHalf(a){return(2*a|0)/2}function getPlayerSizeType(a){var b="";switch(!0){case a<=336:b=" vjs-player-size-xsmall ";break;case a<=480:b=" vjs-player-size-small ";break;case a<=680:b=" vjs-player-size-medium ";break;case a>=1100:b=" vjs-player-size-large "}return b}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function createEmbedIframeTag(a,b,c){if(!isDefined(a.id)||!isDefined(a.embed_hash))return!1;var d=location.host.match(/\w+\.?[\w\-]+$/),e=Object.keys(a).map(function(b){return[b,a[b]].map(encodeURIComponent).join("=")}).join("&");b="undefined"==typeof b?640:b,c="undefined"==typeof c?340:c;var f='<iframe width="'+b+'" height="'+c+'" src="http://embed.'+d+"/index.php?"+e+'" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen allowtransparency="true"></iframe>';return f}function getSupportedTransform(){for(var a="transform WebkitTransform MozTransform OTransform msTransform".split(" "),b=document.createElement("div"),c=0;c<a.length;c++)if(b&&void 0!==b.style[a[c]])return a[c];return!1}function VJSescapeRegExp(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function VJSreplaceAll(a,b,c){return a.replace(new RegExp(VJSescapeRegExp(b),"g"),c)}function uniqueId(){var a=Math.floor(11*Math.random()),b=Math.floor(1e6*Math.random());return String.fromCharCode(a)+b}function string_to_slug_msn(a){return a=a.replace(/^\/+/,""),a=a.replace(/^\s+|\s+$/g,""),a=a.toLowerCase(),a=a.replace("?",""),a=a.replace(/[^a-z0-9 _]/g,"_").replace(/\s+/g,"_").replace(/-+/g,"_")}function jsonRedirectRedcdn(a){return/^(.*)x-link.pl/.exec(a)&&a.indexOf("videoredir.php")!=-1?($.ajax({url:a+"&json=1",dataType:"json",async:!1,success:function(b){a=b.result}}),a=a.replace(a.substr(0,a.indexOf(".pl/")+4),"http://json.redir.redcdn.pl/"),$.ajax({url:a,dataType:"json",async:!1,success:function(b){a=b.redirectURL}})):(/^(.*).atmcdn.pl/.exec(a)||/^(.*).dcs.redcdn.pl/.exec(a))&&$.ajax({url:a.replace(a.substr(0,a.indexOf(".pl/")+4),"http://json.redir.redcdn.pl/"),dataType:"json",async:!1,success:function(b){a=b.redirectURL}}),a}function PlayersCollection(){}function tvn24ScrollTvnCheck(){if(window.tvnUserHash&&"5dd1a279fa45f623b1f846f789c9df94"==window.tvnUserHash&&window.tvnLogin&&"yes"==window.tvnLogin)return!0;if("undefined"!=typeof Sso&&"object"==typeof Sso.getLoggedUser&&null!==Sso.getLoggedUser){var a=Sso.getLoggedUser&&Sso.getLoggedUser.isAuthenticated&&Sso.getLoggedUser.isAuthenticated();if(a&&2007594===Sso.getLoggedUser.getId())return!0}return!1}function isAdblockEnabledAlternative(){var a=!1,b=$("#slAbCheck");return b.length&&("undefined"==typeof ADBLOCK_DETECTED||"undefined"!=typeof ADBLOCK_DETECTED&&ADBLOCK_DETECTED===!0)&&(a=!0),!window.adBlockEnabled&&a&&(window.adBlockEnabled=a),a}function render(a,b,c){return"function"==typeof adsTemplates[a]&&("object"!=typeof b&&(b={}),"undefined"==typeof c&&(c=!1),adsTemplates[a](b))}function userUtilsTvn(){var a=this;a.isUserLogged=function(){if("undefined"!=typeof Sso&&Sso.isLoggedUser){var a=Sso.getLoggedUser;if(a&&a.isAuthenticated)return a.isAuthenticated()}return!1},a.getUserHash=function(){return"undefined"!=typeof Sso&&Sso.getStorageUserHash?Sso.getStorageUserHash():""},a.isTmplHashAndLifeInCookie=function(){return"undefined"!=typeof $.cookie&&!(!$.cookie("tmpl_hash")||!$.cookie("tmpl_hash_life")||$.cookie("tmpl_hash")!=$.cookie("tmpl_hash_life"))},a.isTmobileUser=function(){if("undefined"!=typeof TvnUserUtils&&TvnUserUtils.getUser){var b=TvnUserUtils.getUser();if(b&&"undefined"!=typeof b.isTmplVerified&&b.isTmplVerified()&&"undefined"!=typeof b.getId&&b.getId())return 1}return a.isTmplHashAndLifeInCookie()?2:0},a.loggedUserCache=a.isUserLogged(),a.isTmobileUserCache=a.isTmobileUser()}function playerUtilsTvn(){var a=this,b=a.el();"undefined"!=typeof document.hidden?(a.tabHidden="hidden",a.tabVisibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(a.tabHidden="mozHidden",a.tabVisibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(a.tabHidden="msHidden",a.tabVisibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(a.tabHidden="webkitHidden",a.tabVisibilityChange="webkitvisibilitychange"),(videojs.TOUCH_ENABLED||a.options().isMobile)&&a.options().nativeControlsForTouch===!0&&$(b).find(".vjs-control-bar-wrapper,video").on("click",function(b){if(a.advertInProgress&&!a.fakePlayToggle){var c=$(this).offset(),d=$(this).height(),e=(b.pageY-c.top-d)*-1;e>35&&(a.paused()?a.play():a.pause())}}),a.refreshPlayerSizeType=function(){$(b).removeClass("vjs-player-size-small vjs-player-size-xsmall vjs-player-size-medium vjs-player-size-large"),$(b).addClass(getPlayerSizeType(a.getAdsRescaleInfo({}).currentWidth)),$(b).width()<=480&&$(b).find(".vjs-shareboard-container").removeClass("vjs-visible"),a.refreshButtonAds(),"undefined"!=typeof a.ima&&"undefined"!=typeof a.ima.onFullscreenChange_&&a.ima.onFullscreenChange_()},a.refreshBrandingSize=function(){setBrandingSize(a,a.node)},a.refreshButtonAds=function(){var c=a.getAdsRescaleInfo({baseWidth:800,scale_up:"true",scale_down:"true"}),d=54,e=69,f=b.getElementsByClassName("vjs-ad-legal"),g=b.getElementsByClassName("vjs-click-through-button vjs-mobile-ctb")[0],h=b.getElementsByClassName("vjs-watermark")[0],i=0;uVersion<11&&"MSIE"==uBrowser&&"Desktop"==uDevice&&(c.verticalOffset=0);for(var j=0;j<f.length;j++)if(f[j]){var k=f[j].getAttribute("data-base-left"),l=f[j].getAttribute("data-base-right");i+=f[j].offsetWidth,f[j].style.top=~~c.verticalOffset+"px",isNumeric(k)&&(f[j].style.left=~~f[j].getAttribute("data-base-left")+c.horizontalOffset+"px"),isNumeric(l)&&(f[j].style.right=~~f[j].getAttribute("data-base-right")+c.horizontalOffset+"px",i>c.currentWidth?f[j].style.visibility="hidden":f[j].style.visibility="visible")}if(h){var m=h.getElementsByTagName("img")[0];h.style.top=~~c.verticalOffset+"px",m&&(m.style.width=~~(m.getAttribute("data-base-width")*c.ratio)+"px")}if(g){if(g.getAttribute("data-base-left")||g.setAttribute("data-base-left",parseInt(vjsGetStyle(g,"left"),10)||0),g.hasAttribute("data-cta-image-scale")&&(c.ratio*=g.getAttribute("data-cta-image-scale")),g.hasAttribute("data-cta-image-src")){var n=g.getAttribute("data-cta-image-src");g.style.backgroundImage="url("+n+")"}else g.style.backgroundImage=null;g.style.top=~~c.verticalOffset+30+"px",g.style.left=~~g.getAttribute("data-base-left")+c.horizontalOffset+"px",g.style.width=~~(d*c.ratio)+"px",g.style.height=~~(e*c.ratio)+"px"}},getSupportedTransform()||$(b).addClass("vjs-no-transition"),a.setPlaylistUrl=function(b){a.playlistUrl=b},a.setPreviousAction=function(b){a.previousAction!==b&&(a.previousAction=b)},a.getPreviousAction=function(b){return"undefined"!=typeof b?a.previousAction===b:a.previousAction},a.remove=function(){if(!a.removed_removed&&(a.removed_removed=!0,$(a.node).removeClass("player-initialized"),$(a.node).data("player",""),setTimeout(function(){a.dispose()},0),"undefined"!=typeof playersCollection))for(var b in playersCollection.players)playersCollection.players[b].playerId==a.playerId&&playersCollection.players.splice(b,1)},a.runTracking=function(b){function c(b){var c,d=new Date;b=b.replace("tvn.hit.gemius.pl/redot.gif","tvn.hit.gemius.pl/_"+d.getTime()+"/redot.gif"),b=b.replace("[TIMESTAMP]",d.getTime()),b=b.replace("_AONOVTMVALUE_",parseInt(a.currentTime(),10)),a.currentAdItemIndex!==!1&&(b=b.replace("{POSITION}",a.currentAdItemIndex+1),b=b.replace("_POSITION_",a.currentAdItemIndex+1)),c=new Image(1,1),c.src=b}if("undefined"!==b&&!$.isEmptyObject(b))if("string"==typeof b)c(b);else for(var d in b)"undefined"!=typeof b[d]&&c(b[d])},a.runTrackingFromWebview=function(b){function c(b){var c=new Date;b=b.replace("tvn.hit.gemius.pl/redot.gif","tvn.hit.gemius.pl/_"+c.getTime()+"/redot.gif"),b=b.replace("[TIMESTAMP]",c.getTime()),b=b.replace("_AONOVTMVALUE_",parseInt(a.currentTime(),10)),a.currentAdItemIndex!==!1&&(b=b.replace("{POSITION}",a.currentAdItemIndex+1),b=b.replace("_POSITION_",a.currentAdItemIndex+1)),a.callFromWebview("sendImpression",b)}if("undefined"!==b&&!$.isEmptyObject(b))if("string"==typeof b)c(b);else for(var d in b)"undefined"!=typeof b[d]&&c(b[d])},a.turnTransition=function(b){b=!0;var c=$(a.node).find(".vjs-seek-handle, .vjs-progress-holder .vjs-play-progress");b?c.addClass("vjs-transition"):c.removeClass("vjs-transition")},a.checkIsLive=function(){a.options().isLive&&$(a.el()).addClass("vjs-live-video")},a.getAdsRescaleInfo=function(b){"undefined"==typeof b.base_width&&"undefined"==typeof b.baseWidth&&(b.baseWidth="960");var c=$(a.el()),d=parseInt(c.height(),10),e=parseInt(c.width(),10),f=0,g=0,h=1,i=parseInt(b.base_width||b.baseWidth,10),j=parseInt(b.base_height||b.baseHeight,10),k=typeof b.scale_up&&"true"==b.scale_up,l=typeof b.scale_down&&"true"==b.scale_down,m=$("#vjs-cfullscreen-test");if(a.isFullscreen()&&!videojs.IS_IPAD){if(d=window.screen.height,"undefined"!=typeof window.uDevice&&"Desktop"!==window.uDevice){d=window.outerWidth>window.outerHeight?window.screen.width:window.screen.height;var n=this.checkOrientation();n&&(d=n.height,e=n.width)}("tablet"===uDevice.toLowerCase()&&m.length||"desktop"===uDevice.toLowerCase()&&detectIE()&&detectIE()<11)&&(e=m.width(),d=m.height()),"desktop"===uDevice.toLowerCase()&&detectIE()&&11==detectIE()&&a.isEmbed()&&(e=m.width(),d=m.height())}var o=d,p=e,q=e/d-16/9;if(Math.abs(q)>.01){var r=e/d<16/9;r?(o=.5625*e,f=(d-o)/2):(p=d/.5625,g=(e-p)/2)}var s=i-p,t=100*s/i;return h-=t/100,!k&&h>1&&(h=1),!l&&h<1&&(h=1),{currentWidth:e,currentHeight:d,verticalOffset:f,horizontalOffset:g,ratio:h,allowScaleUp:k,allowScaleDown:l,trueWidth:p,trueHeight:o,baseWidth:i,baseHeight:j}},a.checkOrientation=function(){var a=0,b=0,c=window.screen.width,d=window.screen.height,e=0;switch(e="undefined"!=typeof screenOrientation?screenOrientation:window.orientation){case 0:case 180:c<d?(a=c,b=d):(a=d,b=c);break;case 90:case-90:c>d?(a=c,b=d):(a=d,b=c)}if(0!==a&&0!==b)return{width:a,height:b}},a.setInitalPlayerSize=function(){$(b).css({width:"100%",height:"100%"});var c=a.getAdsRescaleInfo({baseWidth:960,baseHeight:540});c.horizontalOffset?$(b).css({width:c.trueWidth,left:0,right:0,margin:"0 auto"}):$(b).css({width:"100%"})},a.setBrandingWidth=function(){},a.setBrandingHeight=function(){},a.setTrafficTags=function(b){if(a.meetTagCzarnyCriteria()&&""!==b)if(b.indexOf("?")===-1&&(b+="?"),b.indexOf("tvn_traffic_tags")===-1)b+="/tvn_traffic_tags=czarny"+a.getTagCzarnySuffix();else{var c=!1;"/"!==b[b.length-1]&&(b+="/",c=!0);var d=/(tvn_traffic_tags=)[^]{1,}\//,e=b.match(d),f=e[0].split("/")[0];b=b.replace(f,f+"_czarny"+a.getTagCzarnySuffix()),c&&(b=b.slice(0,-1))}return b},a.isIOSMeetTagCzarnyCriteria=function(){return videojs.IS_IPHONE||videojs.IS_IPAD&&uVersion<6},a.isWPMeetTagCzarnyCriteria=function(){return(detectIE()||"MSIE"==uBrowser)&&"Desktop"!==uDevice},a.isAndroidMeetTagCzarnyCriteria=function(){var a="Android"==detector.detectOS()&&detector.detectOSversion()<4.2&&detector.getWebkitVersion()<=534.3&&navigator.userAgent.indexOf("Chrome")==-1;return a&&"undefined"!=typeof PLAYER5_ID&&"veedo"==PLAYER5_ID},a.meetTagCzarnyCriteria=function(){return a.isIOSMeetTagCzarnyCriteria()||a.isWPMeetTagCzarnyCriteria()||a.isAndroidMeetTagCzarnyCriteria()},a.getTagCzarnySuffix=function(){var b="";return a.isIOSMeetTagCzarnyCriteria()&&(b="-ios"),a.isWPMeetTagCzarnyCriteria()&&(b="-wp"),b},a.getFixedCurrentTime=function(){return a.advertInProgress?parseInt(a.currentTime(),10):a.options().isLive&&parseInt(a.currentTime(),10)-a.initialCurrentTime>1e4?0:parseInt(a.currentTime(),10)-a.initialCurrentTime},a.isEmbed=function(){return"undefined"!=typeof a.options().embed&&a.options().embed===!0},a.isAdvertiseMode=function(){return"undefined"!=typeof a.options().advertiseMode&&a.options().advertiseMode===!0},a.isWebviewMode=function(){return"undefined"!=typeof a.options().webviewMode&&a.options().webviewMode===!0},a.isExternalAdsMode=function(){return"undefined"!=typeof a.options().externalAdsMode&&a.options().externalAdsMode===!0},a.isUserGestureNeededToCallAdvert=function(){return"undefined"!=typeof a.options().isMobile&&"undefined"!=typeof a.options().isTablet?a.options().isMobile||a.options().isTablet:(PLAYER_DEBUG&&console.warn("Undefined some options variables."),!1)},a.updateImaGoogleLibLoaded=function(){return window.google&&"object"==typeof window.google&&"object"==typeof window.google.ima&&(a.imaGoogleLibLoaded=!0),a.imaGoogleLibLoaded},a.callFromWebview=function(){if(a.isWebviewMode()){var b=[];if(arguments.length>0){for(var c=1;arguments.length>c;c++)"object"==typeof arguments[c]?b.push(arguments[c]):b.push(arguments[c].toString());var d={method:arguments[0],parameters:b};vjsCallFromWebview(d)}}},a.sendPostMessage=function(b){a.isEmbed()&&parent.postMessage(JSON.stringify({type:b,t:a.getFixedCurrentTime()}),"*")},detectIE()&&detectIE()<11&&a.isEmbed&&(a.options().shareUrl?$(a.node).find(".vjs-control-bar .vjs-share-button-control").addClass("vjs-margin"):$(a.node).find(".vjs-control-bar .vjs-resolutions-button").addClass("vjs-margin")),a.isAdBlockEnabledAgain=function(b,c){var d="//s1-player5.cdntvn.pl/adscript.js";d.indexOf("tvwisla.com.pl")!==-1&&(d=d.replace("player5","s1.player5"),d=d.replace(".stage.online",".cdntvn.stage.online")),$.ajax({url:d,type:"GET",cache:!1,async:!1,success:function(){return"function"==typeof b&&b(),!1},error:function(){return"undefined"==typeof $(a.node).data("disable-adblock")||!!$(a.node).data("disable-adblock")==!1&&!tvn24ScrollTvnCheck()?"function"==typeof c&&c():"function"==typeof b&&b(),!0}})},a.buildWatermark=function(){var c=a.options().watermark;if(c){var d=document.createElement("img"),e=document.createElement("div"),f=a.getAdsRescaleInfo({baseWidth:960,scale_up:"true",scale_down:"true"});d.src=c,d.crossOrigin="anonymous",e.className="vjs-watermark vjs-hidden",e.appendChild(d),b.appendChild(e),d.onload=function(){d.setAttribute("data-base-width",d.naturalWidth),d.style.width=d.naturalWidth*f.ratio+"px"}}},a.video360start=function(){if(a.video360isAllowed()){var b=$(a.el()).find(".vjs-video-360-canvas");a.video360inProgress=!0,"undefined"!=typeof a.usingNativeControls()&&a.usingNativeControls()&&"Android"==window.uOS&&(a.usingNativeControls(!1),a.wasUsingNativeControls=!0),b.length?(b.css("display","block"),$(a.el()).find(".vjs-tech").css("display","none")):(a.blockInteraction=!0,a.pause(),a.blockInteraction=!1,a.panorama({clickAndDrag:!0,showNotice:!1,callback:function(){a.play()}})),a.trigger("start360")}else a.video360stop(),a.hasClass("vjs-360-not-supported")||(a.video360showNotSupported(),setTimeout(function(){a.pause()},250))},a.video360stop=function(){var b=$(a.el()).find(".vjs-video-360-canvas"),c=a.controlBar.getNestedChild("vrButton"),d=a.controlBar.getNestedChild("gyroButton");a.video360inProgress=!1,b.length&&(a.trigger("stop360"),b.css("display","none"),$(a.el()).find(".vjs-tech").css("display","block")),"undefined"!=typeof a.wasUsingNativeControls&&a.wasUsingNativeControls&&(a.wasUsingNativeControls=!1,a.usingNativeControls(!0)),c&&c.hide(),d&&d.hide()},a.video360isAllowed=function(){var a=detectIE()>=12;return"Desktop"==window.uDevice?"Safari"!=window.uBrowser&&(!detectIE()||a):"Android"==window.uOS?window.uOSversion>=5:"MacOS"==window.uOS?"iPhone"!=window.uBrowser&&"iPad"!=window.uBrowser&&"iPod"!=window.uBrowser&&"Safari"!=window.uBrowser:!detectIE()||a},a.video360showNotSupported=function(){$(b).find(".vjs-restboard-container").remove(),$(b).append(errorMovie360notSupported()),a.addClass("vjs-360-not-supported")},a.video360getOffsetX=function(){if(a.video360inProgress&&"undefined"!=typeof a.panoramaPlugin.controls)return a.panoramaPlugin.controls.getAzimuthalAngleInDegrees()},a.video360setOffsetX=function(b){if(a.video360inProgress&&"undefined"!=typeof a.panoramaPlugin.controls)return a.panoramaPlugin.controls.setAzimuthalAngleInDegrees(b)},a.video360enableZoom=function(){var c=function(b){var c=b.originalEvent.wheelDelta,d=a.panoramaPlugin.camera.zoom;c>0?d+=.1:d-=.1,d>=.5&&d<=1.7&&(a.panoramaPlugin.camera.zoom=parseFloat(d.toFixed(2)),a.panoramaPlugin.camera.updateProjectionMatrix())};if(isDefined(a.panoramaPlugin)){var d=$(b).find(".vjs-video-360-canvas");d.on("mousewheel",c),d.on("MozMousePixelScroll",c)}},a.video360disableZoom=function(){if(isDefined(a.panoramaPlugin)){var c=$(b).find(".vjs-video-360-canvas");c.off("mousewheel"),c.off("MozMousePixelScroll")}},a.video360setZoom=function(b){isDefined(a.panoramaPlugin)&&(a.panoramaPlugin.camera.zoom=b,a.panoramaPlugin.camera.updateProjectionMatrix())},a.video360getZoom=function(){return!!isDefined(a.panoramaPlugin)&&a.panoramaPlugin.camera.zoom},a.one("loadedmetadata",function(){if(a.options().playlistData!==!1&&isDefined(a.watchedTimePresent)&&a.watchedTimePresent===!0){if(0!==a.options().activeMovie.time){var b=a.options().activeMovie.time;a.one("canplay",function(){a.currentTime(b)})}a.watchedTimePresent=!1}}),a.setVideoTitleForIOS=function(){if("MacOS"===window.uOS&&$.inArray(window.uBrowser,["iPad","iPod","iPhone"])>-1){var b,c=a.options();if(a.node.attr("data-video-title")&&a.node.attr("data-video-title").match(/\S/))b=a.node.attr("data-video-title");else{if(!("object"==typeof c&&"undefined"!=typeof c.activeMovie&&c.activeMovie.title&&c.activeMovie.title.length>0))return;b=c.activeMovie.title,c.activeMovie.episode&&c.activeMovie.episode.match(/\S/)&&(b+=" Odc. "+c.activeMovie.episode),c.activeMovie.episode&&c.activeMovie.episode_name.match(/\S/)&&(b+=" "+c.activeMovie.episode_name)}a.el_.getElementsByTagName("video")[0].setAttribute("title",b)}},a.forcePauseIfMobileAndHidden=function(){isDefined(a.tabHidden)&&"Desktop"!==window.uDevice&&document[a.tabHidden]&&a.previousAction&&"pause"!==a.previousAction&&a.pause()},a.detectAspectRatio=function(){var b=a.node.find("video")[0];return b&&isNumeric(b.videoWidth)&&isNumeric(b.videoHeight)&&0!==b.videoWidth&&0!==b.videoHeight?b.videoWidth/b.videoHeight:16/9}}function spawnEntityTvn(){var a=this,b=$(a.el());a.spawnEntity=function(c,d,e){var f=a.entitySpace[c],g=f.items[d],h=1;if(a.isFullscreen()?(g=f.items[d].fullscreen,h=1.66667):g=f.items[d],"productPlacement"===c&&(h=1),"undefined"==typeof g)return!1;if("object"==typeof e){var i;for(i in e)g[i]=Math.round(parseInt(e[i],10)*h)+"px"}var j,k=c+"_"+d+"_"+Math.floor(1e4*Math.random()+1001);if("sprite"===f.type){var l="undefined"!=typeof g.backgroundSize?"; background-size:"+g.backgroundSize:"";b.append('<div id="'+k+'" class="vjs-onTopEntity vjs-'+c+'" style="background-image: url('+PLAYER_DEFAULT_HOST+f.url+");background-position:"+g.backgroundPosition+l+"; width: "+g.width+"; height: "+g.height+"; top: "+g.y+"; left: "+g.x+';"></div>'),j=$("#"+k),j.fadeIn("fast")}return"image"===f.type,"flash"===f.type,j},a.spawnEntityFullScreen=function(c,d,e){var f,g=a.entitySpace[c],h=1;if(a.isFullscreen()?(f=g.items[d].fullscreen,h=1.66667):f=g.items[d],"undefined"==typeof f)return!1;if("object"==typeof e){var i;for(i in e)f[i]=Math.round(parseInt(e[i],10)*h)+"px"}var j=c+"_"+d+"_",k=b.find('[id^="'+j+'"].vjs-onTopEntity.vjs-'+c);
if("sprite"===g.type){var l="undefined"!=typeof f.backgroundSize?"; background-size:"+f.backgroundSize:"";k.attr("style","background-image: url("+PLAYER_DEFAULT_HOST+g.url+");background-position:"+f.backgroundPosition+l+"; width: "+f.width+"; height: "+f.height+"; top: "+f.y+"; left: "+f.x),k.fadeIn("fast")}},a.handleProductPlacement=function(b){if("undefined"!=typeof a.productPlacement&&a.advertInProgress===!1){var c=parseInt(a.productPlacement.afterStart.offset,10),d=c+parseInt(a.productPlacement.afterStart.duration,10);c<b&&b<d?a.prPlHolder===!1?a.prPlHolder=a.spawnEntity("productPlacement","1",a.productPlacement.afterStart):a.prPlHolder.is(":visible")||a.prPlHolder.fadeIn("fast"):a.prPlHolder!==!1&&a.prPlHolder.is(":visible")&&a.prPlHolder.fadeOut();var e=a.duration()-parseInt(a.productPlacement.beforeEnd.offset,10),f=e+parseInt(a.productPlacement.beforeEnd.duration,10);e<b&&b<f?a.prPlEndingHolder===!1?a.prPlEndingHolder=a.spawnEntity("productPlacement","0",a.productPlacement.beforeEnd):a.prPlEndingHolder.is(":visible")||a.prPlEndingHolder.fadeIn("fast"):a.prPlEndingHolder!==!1&&a.prPlEndingHolder.is(":visible")&&a.prPlEndingHolder.fadeOut()}},a.spawnEntityOnFullScreen=function(){""!==a.parentalRating&&a.spawnEntityFullScreen("parentalRating",a.parentalRating,{x:"46px",y:"46px"}),"undefined"!=typeof a.productPlacement&&a.advertInProgress===!1&&(a.spawnEntityFullScreen("productPlacement","1",a.productPlacement.afterStart),a.spawnEntityFullScreen("productPlacement","0",a.productPlacement.beforeEnd))}}function eventsTvn(a){var b=this,c=!1,d=$(b.el()),e=b.controlBar.getNestedChild("progressControl");b.off("fullscreenchange2"),b.on("fullscreenchange2",b.onFullscreenChange),b.materialStarted=!1,b.previousAction=!1,b.adPlayedAfterSeeking=!1,b.allowSeekEvent=!1,b.firstStart=!1,b.blockInteraction=!1,b.lastGemiusEvent={playerId:null,materialId:null,type:null,time:null,beforeAdTime:null},b.bufferHandler={time:0,buffering:!1,interval:null},b.on("play",function(c){b.advertInProgress||(b.debug("[DM] previousAction",b.getPreviousAction()),b.dashManager.licenseRenew(a.hasOwnProperty("activeMovie")&&"object"==typeof a.activeMovie&&1==a.activeMovie["protected"])),b.firstStart&&(i(c),b.startBufferListener&&(!b.advertInProgress||b.video360ad&&b.video360ad.video360adInProgress)&&b.startBufferListener())}),b.on("pause",function(a){i(a),"undefined"!=typeof b.stopBufferListener&&b.stopBufferListener()}),b.on("seeked",function(a){i(a)}),b.on("materialEnded",function(a){h(a)}),b.on("timeupdate",function(){f()}),b.on("loadedmetadata",function(a){b.paused()&&"Tablet"===window.uDevice&&("iPad"===window.uBrowser||"Safari"===window.uBrowser)&&window.uVersion>=9&&(b.iOs10needsUserGesture=!0,b.removeClass("vjs-playing"),b.addClass("vjs-paused"),b.addClass("vjs-has-started"),b.bigPlayButton.removeClass("vjs-hidden")),b.paused()&&"Smartfon"===window.uDevice&&("iPhone"===window.uBrowser||"Safari"===window.uBrowser)&&window.uVersion>9&&(b.iOs10needsUserGesture=!0,b.bigPlayButton.removeClass("vjs-hidden")),g(a)}),b.on("loadedImaAd",function(a){g(a)}),$(window).on("resize orientationchange onorientationchange",function(){window.screenOrientation=$(window).width()>$(window).height()?90:0,b.video360ad&&b.video360ad.video360adInProgress&&b.video360ad.rescale(),b.interactive&&b.interactive.rescale(),b.interactive2&&b.interactive2.rescale(),b.textTrackDisplay.updateDisplay(),b.overlayHandler&&b.overlayHandler.rescale(),b.sequential&&b.sequential.rescale(),b.refreshPlayerSizeType(),b.tapGoManager&&b.tapGoManager.enabled&&b.tapGoManager.rescale()}),(videojs.TOUCH_ENABLED||b.options().isMobile)&&b.options().nativeControlsForTouch===!0&&d.on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(a){a.isFullScreen=b.isFullscreen(),a.AdActualTime=b.getAdsInformation().playbackTime,a.getMovieWatchingTime=b.getInformation().watchingTime,$(b.node).trigger("video.fullScreen",a),b.trigger("videoFullScreen",a),b.isFullscreen_=!b.isFullscreen_,$(b.el()).toggleClass("vjs-fullscreen"),b.spawnEntityOnFullScreen(),b.video360ad&&b.video360ad.video360adInProgress&&b.video360ad.rescale(),b.interactive&&b.interactive.rescale(),b.interactive2&&b.interactive2.rescale(),b.overlayHandler&&b.overlayHandler.rescale(),b.sequential&&b.sequential.rescale(),b.refreshPlayerSizeType(),b.tapGoManager&&b.tapGoManager.enabled&&b.tapGoManager.rescale()}),b.onFullscreenChangeCustom=function(a){"undefined"==typeof a.currentTarget&&(a.isFullScreen=b.isFullscreen(),a.AdActualTime=b.getAdsInformation().playbackTime,a.getMovieWatchingTime=b.getInformation().watchingTime,$(b.node).trigger("video.fullScreen",a),b.trigger("videoFullScreen",a),b.spawnEntityOnFullScreen(),b.video360ad&&b.video360ad.video360adInProgress&&b.video360ad.rescale(),b.interactive&&b.interactive.rescale(),b.interactive2&&b.interactive2.rescale(),b.overlayHandler&&b.overlayHandler.rescale(),b.sequential&&b.sequential.rescale(),b.textTrackDisplay.updateDisplay(),b.refreshPlayerSizeType(),b.tapGoManager&&b.tapGoManager.enabled&&b.tapGoManager.rescale())},b.on("fullscreenchange2",function(a){b.onFullscreenChangeCustom(a)}),b.on("fakefullscreenchange",function(a){window.screenOrientation=$(window).width()>$(window).height()?90:0,"undefined"==typeof a.currentTarget&&(a.isFullScreen=b.isFullscreen(),a.AdActualTime=b.getAdsInformation().playbackTime,a.getMovieWatchingTime=b.getInformation().watchingTime,$(b.node).trigger("video.fullScreen",a),b.trigger("videoFullScreen",a),b.spawnEntityOnFullScreen(),b.video360ad&&b.video360ad.video360adInProgress&&b.video360ad.rescale(),b.interactive&&b.interactive.rescale(),b.interactive2&&b.interactive2.rescale(),b.tapGoManager&&b.tapGoManager.rescale(),b.overlayHandler&&b.overlayHandler.rescale(),b.sequential&&b.sequential.rescale(),b.refreshButtonAds())}),b.on("ended",function(){b.firstStart=!1}),b.on("stopped",function(a){i(a)}),b.on("videoStopped",function(){b.sendStopEventStats(),b.resetPlayerAds(),$(b.node).trigger("video.stopped",b.getInformation())}),b.on("tracking.start",function(){b.trackingEventHandler("start")}),b.on("tracking.midpoint",function(){b.trackingEventHandler("midpoint")}),b.on("tracking.firstQuartile",function(){b.trackingEventHandler("firstQuartile")}),b.on("tracking.thirdQuartile",function(){b.trackingEventHandler("thirdQuartile")}),b.on("tracking.skip",function(){b.trackingEventHandler("skip")}),b.on("videoCompleteAd",function(){b.sendCompleteTrackingEvent()}),b.on("sendImpression",function(){var a={};b.getThisItemForEventTracking?a.fullObj=b.getThisItemForEventTracking:b.currentAdGroupIndex!==!1&&(a=b.newAdStock[b.currentAdGroupIndex].items[b.currentAdItemIndex]),"undefined"!=typeof a.fullObj&&"object"==typeof a.fullObj.Impression&&(b.isWebviewMode()?b.runTrackingFromWebview(a.fullObj.Impression):b.runTracking(a.fullObj.Impression),b.debug("ads","sendImpression",a.fullObj.Impression))}),$(document).on(b.tabVisibilityChange,function(){b.isWebviewMode()?"MSIE"==uBrowser?("undefined"!=typeof document.visibilityState&&"visible"==document.visibilityState||"undefined"!=typeof document.msVisibilityState&&"visible"==document.msVisibilityState)&&b.playAdAfterVisibilityChange():b.playAdAfterVisibilityChange():(b.playAdAfterVisibilityChange(),b.forcePauseIfMobileAndHidden())}),b.on("useractive",function(){if(b.advertInProgress||d.find(".vjs-active-movie-info").removeClass("vjs-hidden"),(videojs.TOUCH_ENABLED||b.options().isMobile)&&b.options().nativeControlsForTouch===!0||b.options().isTablet){if(b.isFullscreen()){var a=$("#vjs-cfullscreen-test"),c=parseInt(d.find(".vjs-overlay-y-bottom").css("bottom"),10);c<=d.find(".vjs-control-bar").outerHeight(!0)?d.find(".vjs-overlay-y-bottom").css("bottom",d.find(".vjs-control-bar").outerHeight(!0)+"px"):a.width()>a.height()&&d.find(".vjs-overlay-y-bottom").css("bottom","0px")}}else d.find(".vjs-overlay-y-bottom").css("bottom",d.find(".vjs-control-bar").outerHeight(!0)+"px")}),b.on("userinactive",function(){if(b.advertInProgress||d.find(".vjs-active-movie-info").addClass("vjs-hidden"),!d.hasClass("vjs-paused"))if(!videojs.TOUCH_ENABLED&&!b.options().isMobile||b.options().nativeControlsForTouch!==!0&&!b.options().isTablet)d.find(".vjs-overlay-y-bottom").css("bottom","0px");else{var a=$("#vjs-cfullscreen-test");if(b.isFullscreen()){var c=parseInt(d.find(".vjs-overlay-y-bottom").css("bottom"),10);"desktop"===uDevice.toLowerCase()&&c<=d.find(".vjs-control-bar").outerHeight(!0)?d.find(".vjs-overlay-y-bottom").css("bottom","0px"):a.width()>a.height()&&d.find(".vjs-overlay-y-bottom").css("bottom","0px")}}}),b.progressControllTimeout="",e.on("mouseenter",function(){clearTimeout(b.progressControllTimeout),b.controlBar.addClass("vjs-progressbar-active"),b.overlayHandler&&b.overlayHandler.rescale();var a=parseInt(d.find(".vjs-overlay-y-bottom").css("bottom"),10);a<=d.find(".vjs-control-bar").outerHeight(!0)&&d.find(".vjs-overlay-y-bottom").css("bottom",d.find(".vjs-control-bar").outerHeight(!0)+"px")}),e.on("mouseleave",function(){b.progressControllTimeout=setTimeout(function(){b.controlBar.removeClass("vjs-progressbar-active"),b.overlayHandler&&b.overlayHandler.rescale();var a=parseInt(d.find(".vjs-overlay-y-bottom").css("bottom"),10);b.userActive()&&a<=d.find(".vjs-control-bar").outerHeight(!0)&&d.find(".vjs-overlay-y-bottom").css("bottom",d.find(".vjs-control-bar").outerHeight(!0)+"px")},b.options().progressControlInactivityTimeout||3257)}),b.sendCompleteTrackingEvent=function(){"undefined"!==b.trackingFlags.thirdQuartile&&b.trackingFlags.thirdQuartile===!0&&b.trackingEventHandler("complete")},b.trackingEventHandler=function(a){PLAYER_DEBUG&&console.log(a);var c={};b.getThisItemForEventTracking?c.fullObj=b.getThisItemForEventTracking:b.currentAdGroupIndex!==!1&&(c=b.newAdStock[b.currentAdGroupIndex].items[b.currentAdItemIndex]),"undefined"==typeof c||"undefined"==typeof c.fullObj||c.fullObj.isIMA||"undefined"==typeof c.fullObj.TrackingEvents||"object"!=typeof c.fullObj.TrackingEvents[a]||(b.runTracking(c.fullObj.TrackingEvents[a]),b.debug("ads","tracking."+a,c.fullObj.TrackingEvents[a]))},isDefined(b.mediaPlayer)&&b.mediaPlayer.on("error",function(a){switch(a.code){case 504:case 505:case 506:case 507:if(b.currentTime()>2)return;"undefined"!=typeof userLicenseError&&userLicenseError.errorMessage(),"undefined"!=typeof widevineError&&widevineError.errorMessage()}}),b.on("error",function(a){b.onError(a)});var f=function(){b.advertInProgress?$(b.node).trigger("video.progressAd",b.getInformation()):b.materialStarted&&b.trigger("videoProgress",b.getInformation())},g=function(a){function c(a){$(b.node).trigger("video.begin",a),$(b.node).trigger("video.playing",a),b.trigger("videoBegin",a),b.trigger("videoPlaying",a),b.sendPostMessage("videoBegin")}b.firstStart=!0;var d=a;b.options().force360&&!b.advertInProgress?b.video360start():b.video360ad&&b.video360ad.video360adInProgress||b.video360stop(),b.advertInProgress||b.materialStarted||(b.materialStarted=!0,b.iOs10needsUserGesture?b.one("playAfterIOs10userGesture",function(){c(d)}):c(d),b.options().enabledRestboard||b.bigPlayButton.removeClass("vjs-visible").addClass("vjs-hidden"),b.setPreviousAction("firstplay"),PLAYER_EVENTS_DEBUG&&console.log("begin"))},h=function(a){b.firstStart=!1,b.advertInProgress?(PLAYER_EVENTS_DEBUG&&console.log("endedAd"),b.currentAdGroupIndex!==!1&&$(b.node).trigger("video.completeAd",b.newAdStock[b.currentAdGroupIndex].typeName),b.trackingFlags.complete=!0,b.trigger("videoCompleteAd",a),b.setPreviousAction("endedAd")):(PLAYER_EVENTS_DEBUG&&console.log("ended"),b.trigger("videoMainComplete",a),$(b.node).trigger("video.mainComplete",a),b.materialStarted=!1,b.setPreviousAction("ended"))},i=function(a){var d=a.type,e=b.currentTime();if(b.advertInProgress)switch(b.debug("[DM] ustawiam false, previous = ",b.getPreviousAction()),b.dashManager.licenseRenew(!1),d){case"pause":b.sequentialInProgress&&b.trigger("seqPause"),(a.currentTarget.duration-a.currentTarget.currentTime>.05&&!b.blockInteraction&&!b.blockIpadFullscreenEvent||b.isIma&&b.currentTime()>0&&b.duration()-b.currentTime()>.05)&&(b.interactive2BoardVisible&&"undefined"!=typeof b.interactive2BoardVisible||(b.bigPlayButton.removeClass("vjs-hidden"),b.bigPlayButton.show()),b.currentAdGroupIndex!==!1&&$(b.node).trigger("video.pausedAd",b.newAdStock[b.currentAdGroupIndex].typeName),b.trigger("videoPausedAd",a),PLAYER_EVENTS_DEBUG&&console.log("pauseAd"),b.setPreviousAction(d+"Ad"));break;case"play":b.iOs10needsUserGesture&&(b.trigger("playAdAfterIOs10userGesture"),b.iOs10needsUserGesture=!1),b.sequentialInProgress&&b.trigger("seqPlaying"),b.interactive2BoardVisible&&"undefined"!=typeof b.interactive2BoardVisible||(b.bigPlayButton.addClass("vjs-hidden"),b.bigPlayButton.hide()),b.blockInteraction||b.blockIpadFullscreenEvent||b.currentAdGroupIndex===!1?b.blockIpadFullscreenEvent&&(b.blockIpadFullscreenEvent=!1):$(b.node).trigger("video.playingAd",b.newAdStock[b.currentAdGroupIndex].typeName),b.trigger("videoPlayingAd",a),PLAYER_EVENTS_DEBUG&&console.log("playAd"),b.setPreviousAction(d+"Ad");break;case"seeked":PLAYER_EVENTS_DEBUG&&console.log("seekedAd"),b.setPreviousAction(d+"Ad")}else switch(d){case"play":b.options().hidePlayButtonOnPause&&$(b.el()).removeClass("vjs-hide-controls-on-pause"),b.materialStarted&&(b.iOs10needsUserGesture&&(b.trigger("playAfterIOs10userGesture"),b.iOs10needsUserGesture=!1),!c||b.blockInteraction||b.blockIpadFullscreenEvent?b.getPreviousAction("endedAd")||b.seeking()||b.getPreviousAction("seek-ended")||b.getPreviousAction("play")||b.blockInteraction||b.blockIpadFullscreenEvent?b.blockIpadFullscreenEvent&&(b.blockIpadFullscreenEvent=!1,b.bigPlayButton.removeClass("vjs-visible").addClass("vjs-hidden")):($(b.node).trigger("video.playing",a),b.trigger("videoPlaying",a),b.options().enabledRestboard||b.bigPlayButton.removeClass("vjs-visible").addClass("vjs-hidden"),PLAYER_EVENTS_DEBUG&&console.log("play",e),b.setPreviousAction(d)):(PLAYER_EVENTS_DEBUG&&console.log("play",e,"playEventAfterSeekPause"),$(b.node).trigger("video.playing",a),b.trigger("videoPlaying",a),b.options().enabledRestboard||b.bigPlayButton.removeClass("vjs-visible").addClass("vjs-hidden"),c=!1,b.setPreviousAction(d)));break;case"pause":b.options().hidePlayButtonOnPause&&$(b.el()).addClass("vjs-hide-controls-on-pause"),b.seeking()||b.scrubbing||!b.materialStarted||a.currentTarget.duration-a.currentTarget.currentTime>.05&&!b.blockInteraction&&!b.blockIpadFullscreenEvent&&(PLAYER_EVENTS_DEBUG&&console.log("pause",e),$(b.node).trigger("video.paused",a),b.trigger("videoPaused",a),b.options().enabledRestboard||b.bigPlayButton.removeClass("vjs-hidden").addClass("vjs-visible"),b.setPreviousAction(d)),b.getPreviousAction("seek-ended")||b.getPreviousAction("seek-started")||(b.debug("[DM] ustawiam false, previous = ",b.getPreviousAction()),b.dashManager.licenseRenew(!1,d));break;case"seeked":b.getPreviousAction("firstplay")?b.setPreviousAction("play"):!b.getPreviousAction("endedAd")&&b.materialStarted&&b.allowSeekEvent&&(b.allowSeekEvent=!1,$(b.node).trigger("video.seek",a),b.trigger("videoSeek",a),b.setPreviousAction(d),b.videoWasPlaying?PLAYER_EVENTS_DEBUG&&console.log("seeked + play",e):(PLAYER_EVENTS_DEBUG&&console.log("seeked",e),c=!0));break;case"stopped":b.materialStarted=!1,b.setPreviousAction("ended"),b.trigger("videoStopped"),b.firstStart=!1,PLAYER_EVENTS_DEBUG&&console.log("stopped"),b.debug("[DM] ustawiam false, previous = ",b.getPreviousAction()),b.dashManager.licenseRenew(!1,d)}}}function statsTvn(a){var b=this;b.materialId=a.videoMaterialId||"",b.additionalPackage=a.videoAdditionalPackage||[],b.customPackage=a.videoCustomPackage||[],b.playerId="player_"+Math.round(1e6*Math.random()),b.treeId=[],b.isMagazineFullVideo=!1,function(){if("string"==typeof b.customPackage){var a=[],c=b.customPackage.split("&");for(var d in c)if(""!==c){var e=c[d].split("=");2==e.length&&a.push({name:e[0],value:e[1]})}b.customPackage=a}}(),b.on("videoPlaying",function(){b.blockSendStats||g("playing")}),b.on("videoPaused",function(){i("play_pause","video_time="+~~b.currentTime()),g("paused")}),b.on("videoSeek",function(){g("seekingStarted"),i("play_seek","video_time="+~~b.currentTime()),b.videoWasPlaying&&g("playing")}),b.on("videoBegin",function(){b.blockSendStats||(c(),f(),b.options().playlistData?i("play_long","video_time="+~~b.duration()):i("play_short","video_time="+~~b.duration()))}),b.on("videoMainComplete",function(){g("complete"),i("play_end","video_time="+~~b.currentTime())}),b.on("videoProgress",function(a){j(a)}),b.on("videoAllFirstStart",function(){b.blockSendStats||i("player_load")}),b.on("bufferingStart",function(){g("buffering")}),b.on("bufferingEnd",function(){g(b.paused()?"paused":"playing")}),b.part=[],b.pix2params=[],b.pix2params.asset_id=b.materialId,b.sendStopEventStats=function(){b.blockSendStats||(g("stopped"),i("play_stop","video_time="+~~b.currentTime()),h())},b.sendCloseEventStats=function(){i("play_stop","video_time="+~~b.currentTime()),h()},b.sendBreakStats=function(a){"undefined"!=typeof a&&("changePlaylist"==a&&(g("paused"),i("play_pause","video_time="+~~b.currentTime())),"playing"==a&&g("playing"),"complete"==a&&(g("complete"),i("play_end","video_time="+~~b.currentTime())))};var c=function(){for(var a=!1,c=!1,f=0;f<b.customPackage.length;f++)"undefined"!=typeof b.customPackage[f]&&"tvn_login"==b.customPackage[f].name&&b.isUserLogged()?b.customPackage[f].value="yes":b.isTmobileUser()&&"tvn_tmobile_user"==b.customPackage[f].name?b.customPackage[f].value=b.isTmobileUser().toString():b.isUserLogged()&&"tvn_svod_user"==b.customPackage[f].name&&"object"==typeof TvnUserUtils&&TvnUserUtils.getUserPackages&&TvnUserUtils.getUserPackages().length>0&&(b.customPackage[f].value="1"),"undefined"!=typeof b.customPackage[f]&&"tvn_adbl"==b.customPackage[f].name&&(b.customPackage[f].value=d(),c=!0),"undefined"!=typeof b.customPackage[f]&&"id_p"==b.customPackage[f].name&&"undefined"!=typeof __pix2&&"function"==typeof __pix2.getUUID&&(b.customPackage[f].value=__pix2.getUUID()),"undefined"!=typeof b.customPackage[f]&&"tvn_vod_trailer"==b.customPackage[f].name&&"0"===b.customPackage[f].value&&(b.isMagazineFullVideo=!0);"undefined"!=typeof window.userPackage&&(b.isUserLogged()||b.isTmobileUser())&&b.customPackage.push({name:"tvn_user_package",value:window.userPackage});for(var g in b.customPackage)"undefined"!=typeof b.customPackage[g]&&"tvn_id"==b.customPackage[g].name&&(a=!0),"undefined"!=typeof b.customPackage[g]&&"tvn_adbl"==b.customPackage[g].name&&(c=!0);if(c||b.customPackage.push({name:"tvn_adbl",value:d()}),a===!1){var h=b.getUserHash();h&&b.customPackage.push({name:"tvn_id",value:h})}if("function"==typeof getAdditionalParamsPix2){var i=getAdditionalParamsPix2();i&&"object"==typeof i&&(b.customPackage.push({name:"ob",value:""+i.ob}),b.customPackage.push({name:"at",value:""+i.at}))}var j=e();j.length>0&&b.customPackage.push({name:"other",value:j})},d=function(){var a,b=isAdBlockEnabled()?"1":"0";return"undefined"!=typeof TvnTools_BrowserPrivateMode&&TvnTools_BrowserPrivateMode?a="2,"+b:b},e=function(){var a="";return b.video360inProgress&&(a+="360"),a},f=function(){var a;a=b.options().isLive?-1:Math.round(b.duration()),"undefined"!=typeof gemiusStream&&(gemiusStream.newStream(b.playerId,b.materialId,a,k(b.customPackage),b.additionalPackage,b.options().gStreamAccount,HITCOLLECTOR,b.treeId),PLAYER_STATS_DEBUG&&console.log("gSmSendNewStream",a),b.debug("gemiusStream","gSmSendNewStream",[b.playerId,b.materialId,a,k(b.customPackage),b.additionalPackage,b.options().gStreamAccount,HITCOLLECTOR,b.treeId]))},g=function(a){if("undefined"!=typeof gemiusStream){var c=b.getFixedCurrentTime(),d=b.lastGemiusEvent,e=d.playerId===b.playerId&&d.materialId===b.materialId&&d.type===a;d.beforeAdTime&&("setTime"===d.beforeAdTime?(PLAYER_STATS_DEBUG&&console.log("ads group start event"),d.beforeAdTime=c):(PLAYER_STATS_DEBUG&&console.log("ads group finish event"),c=d.beforeAdTime,d.beforeAdTime=null)),"buffering"!==a&&(e=e&&d.time===c),e=!e,e&&(b.lastGemiusEvent={playerId:b.playerId,materialId:b.materialId,type:a,time:c,beforeAdTime:d.beforeAdTime},gemiusStream.event(b.playerId,b.materialId,c,a),PLAYER_STATS_DEBUG&&console.log("gSmSendEvent",a,c),b.debug("gemiusStream","gSmSendEvent-"+a,[b.materialId]))}},h=function(){if("undefined"!=typeof gemiusStream){var a=b.getFixedCurrentTime();gemiusStream.closeStream(b.playerId,b.materialId,a),b.playerId="player_"+Math.round(1e6*Math.random()),PLAYER_STATS_DEBUG&&console.log("gSmSendEvent","closeStream",a),b.debug("gemiusStream","closeStream",[b.materialId])}},i=function(a,c){if("undefined"!=typeof __pix2&&"function"==typeof __pix2.event&&"undefined"!=typeof PIX2_HITCOLLECTOR){var d=$.extend({},b.pix2params);"undefined"!=typeof c&&(d.ap=c),__pix2.event(a,d),b.debug("PIX2","action-"+a,d)}};b.adsPotential=function(a){if(b.advertInProgress){var c=b.currentAdGroupIndex!==!1&&b.newAdStock[b.currentAdGroupIndex];if("undefined"!=typeof c.items){if(!b.adStockData){var d;b.adStockData={midrollsCount:0,hasPreroll:0,hasPostroll:0};for(var e=0;e<b.newAdStock.length;e++)d=b.newAdStock[e].typeName,"Preroll"===d&&(b.adStockData.hasPreroll=1),"Postroll"===d&&(b.adStockData.hasPostroll=1),d.indexOf("Midroll")!=-1&&b.adStockData.midrollsCount++}var f=[];f.push("break="+c.typeName),f.push("advert_id="+(b.currentAdItemIndex+1)),f.push("advert_pos="+a),f.push("adverts_count="+c.items.length),f.push("video_time="+enforcePrecision(~~b.pauseTime,1)),f.push("midrolls_count="+b.adStockData.midrollsCount),f.push("has_preroll="+b.adStockData.hasPreroll),f.push("has_postroll="+b.adStockData.hasPostroll),i("break_event",f.join())}}};var j=function(){var a=parseInt(b.getInformation().watchingTime,10),c=60;b.lastProgress!==a&&(b.lastProgress=a,$(b.node).trigger("video.progress",b.getInformation()),0!==a&&a%c===0&&i("play_"+a+"s","video_time="+~~b.currentTime()))},k=function(a){return a.slice(0)}}function VideoAdsHandler(a,b){var c=this;c.player=a,c.advertSuffixDefault="Dzięki reklamie oglądasz za darmo ",c.defaultOptions={ads:{adLegalLabel:{suffix:{enabled:1,text:c.advertSuffixDefault,content:"",href:""}}}},c.options=$.extend(!0,{},c.defaultOptions,b),c.video_wrapper=$(c.player.el()),c.oldAdvertLabel="Reklama",this.getSimpleAdObj=function(b){if("object"!=typeof b)return a.debug("Invalid ad object"),!1;var c={source:b.MediaFile,active:!0,ClickThrough:b.ClickThrough,fullObj:b};return"undefined"!=typeof b.TapGo&&(c.tapGoTime=0),c}}function coreTvn(a){function b(){p.newAdStock.overlay.length&&(p.overlayHandler=new adHandlers.overlay(n,p,o))}function c(){p.restboardHandler=new adHandlers.restboard(n,p,a),p.restboardHandler.build()}function d(){return p.isIma=!1,p.currentAdGroupIndex=!1,p.currentAdType=!1,p.currentAdTime=0,p.currentMidrollIndex=!1,p.adPlayedAfterSeeking&&p.setPreviousAction("seeked"),p.isAdvertiseMode()?(p.src(null),p.cache_.src="",m.find("video").removeAttr("src"),void m.removeClass("vjs-switching")):(e(),p.skipAllowed=!1,f(!1),p.turnTransition(!1),p.on("canplay",function(){m.removeClass("vjs-switching"),p.currentTime(enforcePrecision(~~p.pauseTime,1)),p.play(),p.off("canplay"),p.pauseTime=!1,setTimeout(function(){p.turnTransition(!0)},50)}),p.advertInProgress=!1,void p.playingCallback())}function e(){if("MPEG-DASH"===p.isTypeMovieDashOrHLS())p.pause(),p.dashManager.init();else if("HLS"===p.isTypeMovieDashOrHLS())p.src(p.playbackOrigin);else if(p.options().forceFlv&&p.loadTech("Flash"),"function"==typeof p.changeResolutionDefault&&p.supportQuality())p.changeResolutionDefault(parseInt(p.pauseTime,10));else{var a=p.playbackOrigin.replace("redir.atmcdn.pl","r.dcs.redcdn.pl");"Chrome"==uBrowser&&uVersion>=45&&(a=jsonRedirectRedcdn(a)),p.src(a)}p.turnTransition(!0)}function f(a){var b,c=p.controlBar.getNestedChild("playNextButton"),d=p.controlBar.getNestedChild("playPrevButton"),e=p.controlBar.getNestedChild("qualityButton"),f=p.controlBar.getNestedChild("cogButton"),g=p.controlBar.getNestedChild("stopButton"),h=p.controlBar.getNestedChild("shareButton"),i=p.controlBar.getNestedChild("progressControl"),j=p.controlBar.getNestedChild("playToggle"),k=p.controlBar.getNestedChild("movieInfo"),l=p.controlBar.getNestedChild("multiAudioButton"),n=p.controlBar.getNestedChild("captionsButton");a?(p.seekLocked=!0,p.advertInProgress=!0,m.find(".vjs-play-progress").addClass("vjs-ad-progress"),m.find(".vjs-progress-control").addClass("vjs-ad-progress"),m.find(".vjs-play-progress").addClass("vjs-cursor-default"),m.find(".vjs-load-progress").addClass("vjs-cursor-default"),m.find(".vjs-mute-control").addClass("vjs-hidden"),k&&k.hide(),g&&g.hide(),h&&h.close(),c&&c.hide(),d&&d.hide(),e&&e.hide(),f&&f.hide(),n&&n.hide(),isDefined(p.qualityWarningButton)&&p.qualityWarningButton.hide(),m.find(".vjs-play-control").show(),m.find(".vjs-current-time,.vjs-time-divider,.vjs-duration").addClass("vjs-hidden"),m.find(".vjs-control-content").hide(),m.find(".vjs-multiaudio-button").hide(),m.find(".vjs-resolutions-button").hide(),m.find(".vjs-text-track-display").hide(),m.find(".vjs-parentalRating").remove(),p.adProgressBar===!1?i.hide():p.turnTransition(!0),j.show(),(videojs.TOUCH_ENABLED||p.options().isMobile)&&p.options().nativeControlsForTouch===!0&&(b=$(m).find(".vjs-control-bar-wrapper"),b.length&&b.show(),m.find("video").removeAttr("controls")),p.options().watermark&&m.find(".vjs-watermark").addClass("vjs-hidden")):(p.options().controls||(m.find("video").removeAttr("controls"),m.find(".vjs-control-bar").css("display","none")),f&&f.show(),k&&k.show(),""!==p.parentalRating&&p.spawnEntity("parentalRating",p.parentalRating,{x:"46px",y:"46px"}),m.find(".vjs-pause-overlay").length&&m.find(".vjs-pause-overlay").addClass("vjs-hidden"),p.options().isLive&&m.find(".vjs-play-control").hide(),p.seekLocked=!1,m.find(".vjs-ad-legal").hide(),m.find(".vjs-click-through-button").hide(),m.find(".vjs-play-progress").removeClass("vjs-ad-progress"),m.find(".vjs-progress-control").removeClass("vjs-ad-progress"),m.find(".vjs-play-progress").removeClass("vjs-cursor-default"),m.find(".vjs-load-progress").removeClass("vjs-cursor-default"),m.find(".vjs-mute-control").removeClass("vjs-hidden"),m.removeClass("vjs-ad-playing"),g&&(g.requestStopButton||p.options().isLive?g.show():g.hide()),h&&(h.requestShareButton||!p.options().isLive?h.show():h.hide()),c&&(c.requestPlayNextButton?c.show():c.hide()),d&&(d.requestPlayPrevButton?d.show():d.hide()),l&&p.multiAudio.isInitialized&&l.show(),e&&p.dashManager.QS.show(),n&&p.textTracks().length&&(n.show(),m.find(".vjs-text-track-display").show()),p.isTypeMovieDashOrHLS()||m.find(".vjs-control-content").show(),m.find(".vjs-current-time,.vjs-time-divider,.vjs-duration").removeClass("vjs-hidden"),i.show(),j&&j.show(),p.bigPlayButton.addClass("vjs-hidden"),p.options().watermark&&m.find(".vjs-watermark").removeClass("vjs-hidden"),m.find(".vjs-resolutions-button").show(),(videojs.TOUCH_ENABLED||p.options().isMobile)&&p.options().nativeControlsForTouch===!0&&(b=$(m).find(".vjs-control-bar-wrapper"),b.length&&b.hide(),m.find("video")[0].setAttribute("controls","")))}function g(){var b=parseInt(p.currentTime(),10);if(m.hasClass("vjs-waiting")&&m.removeClass("vjs-waiting"),p.options().isLive&&0===p.initialCurrentTime&&(p.initialCurrentTime=parseInt(p.currentTime(),10)),p.nextAdGroupIndex!==!1){var c=p.currentTime(),d=p.newAdStock[p.nextAdGroupIndex].timeStart;"end"!==d&&c>=d&&p.advertInProgress===!1&&mouseDown===!1&&(p.getPreviousAction("seek-ended")&&(p.adPlayedAfterSeeking=!0),p.videoAdsHandler.checkForJoinedBlocks(c),p.currentAdGroupIndex=p.nextAdGroupIndex,p.nextAdGroupIndex=!1,l())}if(p.advertInProgress){if(p.tapGoManager&&p.tapGoManager.enabled&&p.endOfClip)return;p.remainingWrap.html(p.videoAdsHandler.getRemainingTime()),p.videoAdsHandler.handleSkipButton(a),p.videoAdsHandler.handleTracking()}p.lastTimeupdate!==b&&(p.lastTimeupdate=b,p.callFromWebview("timeupdate",b),p.handleProductPlacement(b)),p.playlistManager.enabled&&p.playlistManager.checkBreakTime()}function h(){if(p.endOfClip=!0,p.tapGoManager&&p.tapGoManager.isAdvertInProgress)return!1;if(!p.handlingPassback){var a=p.getCurrentAd();a&&(a.active=!1)}if(p.trigger("seqEnded"),p.sequentialInProgress)return!1;if(p.stopBufferListener(),p.video360ad&&p.video360ad.video360adInProgress&&(p.video360ad.clear(),p.video360stop()),p.interactive&&p.interactive.clear(),p.interactive2&&p.interactive2.clear(),p.sequential&&(p.sequential.clear(),delete p.sequential),p.handlingPassback||p.trigger("materialEnded"),p.advertInProgress){if(p.handlingPassback||p.adsPotential("end"),"false"!==p.currentAdGroupIndex){var b=p.getAdsInformation();parseInt(b.totalTime,10)-parseInt(b.watchingTime,10)>.2*b.totalTime&&p.trigger("tracking.skip")}p.trigger("videoAdEnded")}else p.endReached=!0,p.currentAdGroupIndex=p.videoAdsHandler.getAdGroupIndex("end"),p.destroyMediaPlayer();if(!p.endReached)return void l();if(p.endReached&&p.currentAdGroupIndex!==!1&&p.videoAdsHandler.getFirstActiveItemIndex()!==!1)l();else{if(m.find(".vjs-ad-legal").hide(),"object"==typeof p.options().activeMovie){var c=p.playlistManager.current;if("object"==typeof p.options().nextMovie&&"standard"==c){var d=m.find(".vjs-restboard-container");p.restboardHandler&&(p.restboardHandler.showElHandler(d),p.restboardHandler.handleTimer(d))}p.options().nextMovie===!1&&"standard"==c&&(p.resetPlayerAds(),$(p.node).trigger("video.playlistEnd")),p.playlistManager.enabled&&p.playlistManager.handleVideoComplete()}"object"!=typeof p.options().activeMovie&&(p.exitFullscreenOnEnd(),$(p.node).trigger("video.complete"),p.sendPostMessage("videoComplete"),p.callFromWebview("videoComplete"),p.resetPlayerAds())}}function i(){m.addClass("vjs-switching"),p.checkIsLive(),p.defaultPoster=p.options().defaultPoster,p.buildWatermark(),p.options().isMobile||(m.find("video").attr("poster",""),m.find(".vjs-poster").addClass("vjs-hidden")),p.remainingWrap=m.find(".vjs-ad-legal .vjs-ad-legal-remaining"),$(p.node).trigger("video.allFirstStart"),p.trigger("videoAllFirstStart"),p.lastTimeupdate=0,p.on("timeupdate",function(){g()}),p.on("ended",function(){p.forcedImaError&&(p.forcedImaError=!1),h()}),p.on("customended",function(){p.skipAllowed&&(p.isIma?(p.ima.resetIMA_(),p.ima.onContentResumeRequested_(),p.ima.onAdComplete_()):h())}),p.on("adstart",function(){p.setPreviousAction("playAd"),p.advertInProgress=!0}),m.on("click",".vjs-impression-action",function(){var a=$(this).data("impression");a&&p.runTracking(a)}),p.one("canplay",function(){m.removeClass("vjs-switching")}),m.on("dragstart",".vjs-click-through-button",function(){return!1}),k()}function j(){p.isUserGestureNeededToCallAdvert()&&(p.blockInteraction=!0,p.pause()),p.one("adstart",function(){m.hasClass("vjs-waiting")&&m.removeClass("vjs-waiting"),p.clearForceImaErrorTimeout(),p.trigger("canplay"),p.blockInteraction=!1,p.setPreviousAction("playAd"),p.advertInProgress=!0,m.find(".vjs-active-movie-info").addClass("vjs-hidden"),p.currentImaAdData.impressionTracked||p.runTracking(p.currentImaAdData.Impression),p.currentImaAdData.impressionTracked=!0,p.adsPotential("begin"),p.play()}),p.one("adend",function(){p.forcedImaError&&(p.forcedImaError=!1),m.removeClass("vjs-ima-active"),m.removeClass("vjs-switching"),p.advertInProgress&&h()}),p.one("adserror",function(a){p.clearForceImaErrorTimeout(),p.onImaAdsError(p.currentImaAdData)}),p.one("pause",function(){"undefined"!=typeof p.ima&&p.isIma&&"function"==typeof p.ima.pauseAd&&p.ima.pauseAd()}),p.one("play",function(){"undefined"!=typeof p.ima&&p.isIma&&"function"==typeof p.ima.resumeAd&&p.ima.resumeAd()})}function k(){return p.isAdvertiseMode()?(f(!0),void m.removeClass("vjs-switching")):(p.currentAdGroupIndex=p.videoAdsHandler.getAdGroupIndex(0),void(p.currentAdGroupIndex!==!1?l():(p.nextAdGroupIndex=p.videoAdsHandler.getFirstActiveGroupIndex(),p.startBufferListener(),e(),f(!1))))}function l(){p.isWebviewMode()&&m.find("video").attr("poster","../img/blackDot2.png"),m.addClass("vjs-switching"),m.find(".vjs-click-through-button").hide();var a=m.find(".vjs-pause-overlay");
a.length&&a.addClass("vjs-hidden");var b=!1,c=p.getCurrentAdGroup(),e=m.find(".vjs-ad-legal .vjs-ad-legal-remaining");p.turnTransition(!1),c&&(p.currentAdItemIndex=p.videoAdsHandler.getFirstActiveItemIndex(),p.currentAdItemIndex!==!1?b=c.items[p.currentAdItemIndex]:c.active=!1),b!==!1?(null!==p.lastGemiusEvent.type&&"paused"!==p.lastGemiusEvent.type&&(p.lastGemiusEvent.beforeAdTime="setTime",p.trigger("videoPaused")),document[p.tabHidden]||p.appActivated===!1?(p.tabHiddenOnAdEnd=!0,p.paused()||(p.blockInteraction=!0,p.pause())):(p.stopBufferListener(),p.playSingleAd())):p.videoAdsHandler.checkIsActiveJoinedBlocks()?(p.currentAdGroupIndex=p.videoAdsHandler.getFirstActiveJoinedBlocks(),l()):($(p.node).trigger("video.completeAdsBlock"),p.nextAdGroupIndex=p.videoAdsHandler.getFirstActiveGroupIndex(),e.text(""),p.startBufferListener(),d())}a="undefined"!=typeof a?a:{};var m=$(this.el()),n=m,o="undefined"!=typeof a&&"undefined"!=typeof a.ads&&"undefined"!=typeof a.ads.midBrakes?a.ads.midBrakes:[],p=this;p.playbackOrigin=this.src(),m.find(".vjs-control-bar-wrapper").length&&(n=m.find(".vjs-control-bar-wrapper")),p.parentalRating="undefined"!=typeof a&&"undefined"!=typeof a.parentalRating?a.parentalRating:"","undefined"!=typeof a&&"object"==typeof a.productPlacement&&(p.productPlacement=a.productPlacement,p.productPlacement.active=!0),p.setVastInitialVars=function(){p.debugMode=!1,p.pauseTime=0,p.currentAdTime=0,p.currentAdGroupIndex=!1,p.currentAdItemIndex=!1,p.currentMidrollIndex=!1,p.nextAdGroupIndex=!1,p.currentAdType=!1,p.skipAllowed=!1,p.advertInProgress=!1,p.sequentialInProgress=!1,p.sequentialStage=!1,p.vastInitialised=!1,p.vastDelay=50,p.newAdStock=[],p.newAdStock.overlay=[],p.newAdStock.joinedBlocksToPlay=[],p.newAdStock.restboard=!1,p.seekLocked=!1,p.trackingFlags={},p.adType=!1,p.adSlot=!1,p.endReached=!1,p.endOfClip=!1,p.sequential=!1,p.restboardHandler=!1,p.prPlHolder=!1,p.prPlEndingHolder=!1,p.overlayHandler=!1,p.interactive=!1,p.interactive2=!1,p.videoAdsHandler=new VideoAdsHandler(p,a),p.blockIpadFullscreenEvent=!1,p.isIma=!1,p.previousAdWasIma=!1,p.lastProgress=!1,p.initialCurrentTime=0,p.tabHiddenOnAdEnd=!1,p.imaGoogleLibLoaded=!1,p.forceImaErrorTimeoutId=!1,p.forcedImaError=!1,p.imaContainerInitialized=!1,p.currentImaAdData={},p.currentImaAdData.impressionTracked=!1,p.video360ad=!1,p.video360inProgress=!1,p.adStockData=!1,p.eventsBoundForSingleAd=!1,p.adsBlockStarted=!1,p.appActivated=!0,p.iOs10needsUserGesture=!1,p.multiAudio.isInitialized=!1,p.blockSendStats=p.options().force360&&!p.video360isAllowed()},p.setVastInitialVars(),p.playbackOrigin=m.parent().data("src"),(p.options().isLive||p.options().playlistData!==!1)&&(p.playbackOrigin=jsonRedirectRedcdn(p.playbackOrigin));var q="",r="";"undefined"!=typeof a.ads&&(q=a.ads.servers[0].apiAddress,r=a.ads.servers[0].provider),p.debug=function(){(p.debugMode||"undefined"!=typeof PLAYER_DEBUG&&PLAYER_DEBUG)&&console.log(arguments)},p.isTypeMovieDashOrHLS=function(){return"undefined"==typeof p.playbackOrigin?"MPEG-DASH":vjsIsTypeMovieDashOrHLS(p.playbackOrigin)},p.loggedUserCache&&q&&(q=q.replace("tvn_login=no","tvn_login=yes"));var s="",t="",u=p.options().force360===!0,v=p.video360isAllowed()?",360":"";if(q&&"function"==typeof setExtraAdParams&&(t=setExtraAdParams(),"string"==typeof t&&t.length&&(s="/"+t)),q&&"undefined"!=typeof tvnHawkEye&&"function"==typeof tvnHawkEye.getExtraHawkEyeVideoParams&&(t=tvnHawkEye.getExtraHawkEyeVideoParams(),"string"==typeof t&&t.length&&(s+=t)),q&&"string"==typeof uDevice&&(s=s+"/tvn_device_type="+uDevice),q&&"undefined"!=typeof screen&&(s=s+"/x="+screen.width+"/y="+screen.height),q&&window.innerWidth&&window.innerHeight&&(s=s+"/w="+window.innerWidth+"/h="+window.innerHeight),"undefined"!=typeof adoVarsMeteo)for(var w in adoVarsMeteo)s=s+"/"+w+"="+adoVarsMeteo[w];if(q){var x=$(p.el()).width(),y=$(p.el()).height(),z=x;x/y>16/9&&(z=Math.round(y*(16/9))),s=s+"/tvn_player_size="+z,q=q.replace("tvn_player_type=kinowy","tvn_player_type=kinowy_player5"+v),q=q.replace("tvn_player_type=zwykly","tvn_player_type=zwykly_player5"+v),q=q.replace("tvn_player_type=970","tvn_player_type=970_player5"+v)}q&&q.indexOf("tvn_player_type")===-1&&(s+="/tvn_player_type=player5"+v),q&&q.indexOf("tvn_content_category")===-1?u&&(s+="/tvn_content_category=video360"):u&&(q=q.replace("tvn_content_category=wideo","tvn_content_category=video360"),q=q.replace("tvn_content_category=video","tvn_content_category=video360")),q&&q.indexOf("?")===-1&&(s=s.replace("/","?")),p.entitySpace=entitySpace,q&&q.indexOf("tvn_player_type=kinowy_player5")!==-1&&m.addClass("vjs-kinowy"),q&&(q=p.setTrafficTags(q)),p.initContinueWatching=function(){if(isDefined(p.options().activeMovie)&&isDefined(p.options().activeMovie.time)&&p.options().continueWatchingEnabled){var a=render("continue_watching_screen",p.options().activeMovie);n.append(a),m.find(".vjs-cw-button.vjs-yes").on("click",function(){q=adjustVastUrl(q,p.options().activeMovie);try{var a=p.options().activeMovie.id;$.post("/player-sl/kontynuuj-ogladanie-usun.json",{itemToRemove:a})}catch(b){}p.watchedTimePresent=!0,m.find(".vjs-continue-watching-screen").hide(),p.initVast()}),m.find(".vjs-cw-button.vjs-no").on("click",function(){m.find(".vjs-continue-watching-screen").hide();var a=p.options().activeMovie.id;$.post("/player-sl/kontynuuj-ogladanie-usun.json",{itemToRemove:a}),p.initVast()})}else p.initVast()},p.initVast=function(d){var e=function(){if(!p.vastInitialised){if(p.vastInitialised=!0,p.bigPlayButton.addClass("vjs-hidden"),p.autoplay(!0),p.callFromWebview("playerLoaded"),p.isAdvertiseMode()&&!q||p.isExternalAdsMode()){if(!d)return;q=d,r="tvn"}if(!q||!r)return i(),c(),PLAYER_DEBUG&&console.error("Brak adresu lub providera VAST"),!1;$.ajax({url:q+s,type:"GET",xhrFields:{withCredentials:!0},async:!0,success:function(d){for(var e=vastParserProviders[r](d),f=0;f<e.length;f++){var g=e[f];if("Preroll"===g.type)p.advertInProgress=!0,p.videoAdsHandler.addGroup(0,g);else if(/Midroll/.test(g.type)){var h=parseInt(g.type.replace("Midroll_",""),10)-1;if("undefined"!=typeof o[h]){var j=makeSeconds(o[h].time);g.breakNumber=h,p.videoAdsHandler.addGroup(j,g)}}else"Postroll"===g.type?p.videoAdsHandler.addGroup("end",g):"Overlay"===g.type?p.newAdStock.overlay.push(g):"Restboard"===g.type&&(p.newAdStock.restboard=g)}m.trigger("video.adReceived",[d]),p.newAdStock=sortRollVideo(p.newAdStock),p.newAdStock.overlay=fixTimeShifts(p.newAdStock.overlay),p.videoAdsHandler.buildAdInfoBlock(a),i(),b(),c()},error:function(a){var b=function(){i(),c()},d=function(){p.options().adBlockBanner="http://s.tvn.pl/bc/ab/960x540_AdBlock-SplashScreen2.jpg",p.isExternalAdsMode()?$(p.node).prepend(TvnAdBlockBoardUtils.generateBoardHTML(p.options())):$(p.node).append(TvnAdBlockBoardUtils.generateBoardHTML(p.options())),TvnAdBlockBoardUtils.adBlockBoardCallback(p.node),p.remove()};p.options().adbBannerOnVastError&&p.options().adBlock&&!tvn24ScrollTvnCheck()?d():!p.options().adbBannerOnVastError||"undefined"!=typeof $(p.node).data("disable-adblock")&&!!$(p.node).data("disable-adblock")!=!1||tvn24ScrollTvnCheck()?(p.options().adBlockSendHit=!0,window.isAdBlockEnabled=function(){return!0},b()):d()}})}};if("undefined"!=typeof tvnHawkEyeDelayAllowed&&tvnHawkEyeDelayAllowed&&"undefined"!=typeof tvnHawkEye&&"function"==typeof tvnHawkEye.getAllowedVideoPlacements){var f=tvnHawkEye.getAllowedVideoPlacements();"string"==typeof f&&"false"==f?setTimeout(function(){e()},p.vastDelay):e()}else e()},p.options().autoplay!==!0||p.isUserGestureNeededToCallAdvert()||p.bigPlayButton.onClick(!0),p.onError=function(a){if(null!==p.error_){if("undefined"!=typeof window.uBrowser&&"Safari"===window.uBrowser&&p.advertInProgress)return m.removeClass("vjs-error"),p.currentAdGroupIndex=!1,p.nextAdGroupIndex=!1,p.newAdStock=[],f(!1),d(),void m.find("video").removeAttr("style");var b=function(){p.options().adBlockBanner="http://s.tvn.pl/bc/ab/960x540_AdBlock-SplashScreen2.jpg",p.isExternalAdsMode()?$(p.node).prepend(TvnAdBlockBoardUtils.generateBoardHTML(p.options())):$(p.node).append(TvnAdBlockBoardUtils.generateBoardHTML(p.options())),TvnAdBlockBoardUtils.adBlockBoardCallback(p.node),p.remove()},c=function(){var b=a.target,c=window.location.href;c.indexOf("#")!==-1&&(c=c.split("#")[0]),$(b).hasClass("video-js")&&""!==p.src()&&p.src()!==c&&(p.callFromWebview("adError",p.error_.code,p.error_.message),p.errorLoadMovie())};p.isAdBlockEnabledAgain(c,b)}},p.preventImaContextMenu=function(){if(!p.isUserGestureNeededToCallAdvert()){var a=$(m).find(".ima-ad-container iframe").first().parent();a.length&&(a.off("mousedown"),a.on("mousedown",function(a){if(3===a.which){var b=$(".ima-ad-container").find("#ima-context-menu-layer");b.length?b.show():(b=$('<div id="ima-context-menu-layer"></div>'),$(b).insertBefore($(this))),setTimeout(function(){b.hide()},500)}}))}},p.startBufferListener=function(){function a(){if(null!==p.el()&&!p.paused()){var a=p.currentTime();b.buffering||b.time!==a?b.buffering&&b.time!==a&&(b.buffering=!1,p.video360ad&&p.video360ad.video360adInProgress?p.trigger("bufferingAd360End"):p.trigger("bufferingEnd")):(b.buffering=!0,p.video360ad&&p.video360ad.video360adInProgress?p.trigger("bufferingAd360Start"):p.trigger("bufferingStart")),b.time=a}}var b=p.bufferHandler;return b.time=p.currentTime(),null!==p.lastGemiusEvent.beforeAdTime&&"paused"===p.lastGemiusEvent.type&&p.trigger("videoPlaying"),!b.interval&&void(b.interval=setInterval(function(){a()},500))},p.stopBufferListener=function(){p.bufferHandler.interval&&(clearInterval(p.bufferHandler.interval),p.bufferHandler.interval=null,p.bufferHandler.buffering&&(p.video360ad&&p.video360ad.video360adInProgress?p.trigger("bufferingAd360End"):p.trigger("bufferingEnd")),p.bufferHandler.buffering=!1)},p.exitFullscreenOnEnd=function(){if(p.isFullscreen()){var a=$(p.el());videojs.IS_IPAD||p.options().isTablet||$("html").hasClass("vjs-video-on-fullscreen")?(a.removeClass("vjs-ipad-fullscreen vjs-fullscreen vjs-ie-fullscreen vjs-tablet-fullscreen"),a.parent().removeClass("vjs-fullscreen-parent"),p.isFullscreen_=!p.isFullscreen_,a.find(".vjs-tech").attr("style",""),$(p.videoParentElement).prepend(p.node[0]),$(window).off("resize.vjsfullscreen")):p.options().isTablet||p.options().isMobile||($("html").removeClass("vjs-video-on-fullscreen"),a.removeClass("vjs-ie-fullscreen"),a.parent().removeClass("vjs-fullscreen-parent"),p.exitFullscreen())}},p.destroyMediaPlayer=function(){if("undefined"!=typeof p.mediaPlayer){try{p.dashManager.QS.bitrateInfoUpdate.stop()}catch(a){PLAYER_DEBUG&&console.warn(a.message)}try{"undefined"!=typeof p.mediaPlayer.destroy?p.mediaPlayer.destroy():"undefined"!=typeof p.mediaPlayer.reset?p.mediaPlayer.reset():"undefined"!=typeof p.mediaPlayer.unload&&p.mediaPlayer.unload(),delete p.mediaPlayer}catch(a){PLAYER_DEBUG&&console.warn(a.message)}}},p.resetPlayerAds=function(){p.autoplay(!1),p.overlayHandler&&p.overlayHandler.clear(),p.isShowedOverlay=!1,p.video360ad&&p.video360ad.video360adInProgress&&p.video360ad.clear(),p.interactive&&p.interactive.clear(),p.interactive2&&p.interactive2.clear(),p.video360stop(),m.find(".vjs-video-360-canvas").length&&m.find(".vjs-video-360-canvas").remove(),m.find(".vjs-watermark").length&&m.find(".vjs-watermark").remove(),p.ads&&(p.ads.contentSrc="","undefined"!=typeof p.ads.snapshot&&(p.ads.snapshot.src="")),p.ima&&"function"==typeof p.ima.resetIMA_&&(p.ima.resetIMA_(),m.removeClass("vjs-switching")),"undefined"!=typeof p.ima&&(p.off("readyforpreroll"),p.off("adserror"),p.off("adstart"),p.off("fullscreenchange2"),p.on("fullscreenchange2",p.onFullscreenChange),p.on("fullscreenchange2",function(a){p.onFullscreenChangeCustom(a)}),"undefined"!=typeof p.ima.contentComplete&&(p.ima.contentComplete=!0)),m.find(".vjs-multiaudio-button").hide(),m.find(".vjs-ad-legal,.vjs-click-through-button,.vjs-parentalRating,.vjs-productPlacement").remove(),m.find(".vjs-text-track-display").hide(),p.restboardHandler&&p.restboardHandler.clear();var a=p.controlBar.getNestedChild("shareButton");a&&a.close(),p.qualityWarningButton&&p.qualityWarningButton.hide(),clearTimeout(p.progressControllTimeout),m.find(".vjs-tip").remove(),m.find("video").removeAttr("poster"),p.exitFullscreenOnEnd(),m.find("video").attr("poster",p.defaultPoster),m.find(".vjs-poster").removeClass("vjs-hidden"),p.bigPlayButton.removeClass("vjs-hidden"),p.setVastInitialVars(),p.paused()||p.pause(),p.hasStarted_||(p.hasStarted_=!0);var b=$(m).find(".vjs-control-bar-wrapper");b.length&&b.show(),p.destroyMediaPlayer(),(videojs.TOUCH_ENABLED||p.options().isMobile)&&p.options().nativeControlsForTouch===!0&&m.find("video").removeAttr("controls"),p.turnTransition(!1),p.hasStarted(!1),p.src(null),p.cache_.src="",m.find("video").removeAttr("src"),m.addClass("first-request"),p.off("ended"),p.on("ended",p.onEnded)},p.errorLoadMovie=function(){"undefined"!=typeof p.dashManager.QS&&p.dashManager.QS.isBuffering||(m.find(".vjs-error-load-wrapper").remove(),m.append(errorLoadMovie()),m.find(".vjs-poster").removeClass("vjs-hidden"),m.addClass("vjs-error-load"),p.seekLocked=!0)},p.errorTransferDegradation=function(){p.resetPlayerAds(),m.find(".vjs-big-play-button").removeClass("vjs-visible").addClass("vjs-hidden"),m.find(".vjs-error-load-wrapper").remove(),m.append(errorTransferDegradation()),m.find(".vjs-poster").removeClass("vjs-hidden"),m.addClass("vjs-error-load")},p.setOutsourceData=function(a){var b,c=m.find(".vjs-dummy-data"),d=p.tapGoManager.shakeBlow?p.tapGoManager.shakeBlow.length:0;for(c.length||(c='<div class="vjs-dummy-data" style="transform: translateZ(0); position: absolute; bottom: 15px; right: 15px; background: #fff; padding:5px 10px; color: #000; z-index:2147483647 !important;">0</div>',m.append(c),c=m.find(".vjs-dummy-data"),"Windows"==window.uOS&&window.isMobileDevice&&c.css("background","#FF778F")),$(c).html(a);d--;)b=p.tapGoManager.shakeBlow[d],b.runData.active&&b.setOutsourceData(a)},p.setAdsFromUrl=function(a){p.resetPlayerAds(),o=JSON.parse('{"midBrakes":[{"time":"00:00:15"},{"time":"00:00:25"},{"time":"00:00:35"}]}').midBrakes,p.vastInitialised=!1,p.initVast(a)},p.startAdsByGroupName=function(b){p.videoAdsHandler.setJoinedBlocksByGroupType(b),p.eventsBoundForSingleAd===!1&&(p.videoAdsHandler.buildAdInfoBlock(a),p.eventsBoundForSingleAd=!0),p.newAdStock=sortRollVideo(p.newAdStock),p.currentAdGroupIndex=p.newAdStock.joinedBlocksToPlay[0],l()},p.parseAdsBlock=function(b){var d=vastParserProviders.tvn(b);p.adsBlockStarted=!1,p.newAdStock=[],p.nextAdGroupIndex=!1;for(var e=0;e<d.length;e++){var f=d[e];if("Preroll"===f.type||"Postroll"===f.type)p.advertInProgress=!0,p.videoAdsHandler.addGroup(0,f);else if(/Midroll/.test(f.type)){var g=parseInt(f.type.replace("Midroll_",""),10)-1,h=g+1;f.breakNumber=g,p.videoAdsHandler.addGroup(h,f)}else"Postroll"===f.type&&p.videoAdsHandler.addGroup("end",f)}p.newAdStock=sortRollVideo(p.newAdStock),p.isExternalAdsMode()&&(p.newAdStock=deactivateAdsAfterLastIma(p.newAdStock)),p.eventsBoundForSingleAd===!1&&(p.videoAdsHandler.buildAdInfoBlock(a),i(),p.isExternalAdsMode()||c(),p.eventsBoundForSingleAd=!0),p.videoAdsHandler.setJoinedBlocksAll(),p.currentAdGroupIndex=p.videoAdsHandler.getFirstActiveGroupIndex(),l()},p.parseSingleAd=function(b){var d=vastParserProviders.tvn(b);p.newAdStock=[],p.nextAdGroupIndex=!1,p.videoAdsHandler.addGroup(0,d[0]),p.eventsBoundForSingleAd===!1&&(p.videoAdsHandler.buildAdInfoBlock(a),i(),c(),p.eventsBoundForSingleAd=!0,n.find(".vjs-ad-legal").length>0&&n.find(".vjs-ad-legal").addClass("vjs-hidden")),p.currentAdGroupIndex=p.videoAdsHandler.getFirstActiveGroupIndex(),l()},p.setAppActivation=function(a){p.appActivated=a,a?(p.callFromWebview("appActivated"),p.tabHiddenOnAdEnd?p.playAdAfterVisibilityChange():p.tapGoManager&&p.tapGoManager.enabled?p.tapGoManager.tapGoAppActivated():p.play(),m.removeClass("vjs-app-deactivated").addClass("vjs-app-activated")):(p.pause(),p.tapGoManager&&p.tapGoManager.enabled&&p.tapGoManager.tapGoAppDeactivated(),m.addClass("vjs-app-deactivated").removeClass("vjs-app-activated"),p.callFromWebview("appDectivated"))},p.playAdAfterVisibilityChange=function(){p.tabHiddenOnAdEnd&&(p.playSingleAd(),p.tabHiddenOnAdEnd=!1);var a=m.find(".vjs-click-through-button");a.length&&a.removeAttr("href")},p.adsBlockStartedCallback=function(){p.tapGoManager.debug("adsBlockStartedCallback"),p.adsBlockStarted||($(p.node).trigger("video.startedAdsBlock"),p.adsBlockStarted=!0)},p.playImaAd=function(a){if(p.imaGoogleLibLoaded||p.onImaAdsError(a),p.isIma=!0,p.src(null),p.cache_.src="",m.find(" > video").removeAttr("src"),m.find(" > video > source").removeAttr("src"),p.load(),p.ads.state="content-set",p.currentImaAdData=a,p.off("adserror"),p.off("adstart"),p.off("adend"),j(),"object"==typeof p.hawkEye){var b=p.hawkEye.prepareHawkUrl(a);b&&(a.urlToRedirect=b)}p.imaContainerInitialized?p.ima.setContent(null,a.urlToRedirect,!0):p.initializeImaAdContainer(),p.ima.requestAds(a.urlToRedirect),isNumeric(a.Passback.Time)&&(p.forceImaErrorTimeoutId=setTimeout(function(){p.forceImaError(a)},1e3*a.Passback.Time))},p.initializeImaAdContainer=function(){var a={id:m.attr("id"),showCountdown:!1,locale:"pl",autoPlayAdBreaks:!1};p.isUserGestureNeededToCallAdvert()&&(a.vpaidMode=!1),p.ima(a),p.ima.initializeAdDisplayContainer(),p.imaContainerInitialized=!0,p.preventImaContextMenu()},p.clearForceImaErrorTimeout=function(){p.forceImaErrorTimeoutId&&(clearTimeout(p.forceImaErrorTimeoutId),p.forceImaErrorTimeoutId=!1)},p.onImaAdsError=function(a){m.removeClass("vjs-ima-active"),p.isUserGestureNeededToCallAdvert()&&(m.parent().data("video-playlist")||($(m).find(".ima-ad-container").remove(),p.imaContainerInitialized=!1)),"object"==typeof a&&a.Passback&&a.Passback.Link?(p.src(null),p.ads.state="content-set",p.handlePassback(a),a.Passback.fireTimeError&&"object"==typeof a.Passback.timeError&&(p.runTracking(a.Passback.timeError),a.errorTracked=!0)):(p.handlingPassback=!0,p.videoAdsHandler.onFailedCurrentIMAad(),h(),p.handlingPassback=!1),a.errorTracked||p.runTracking(a.Error),a.errorTracked=!0},p.forceImaError=function(a){p.forcedImaError=!0,p.ima&&"function"==typeof p.ima.resetIMA_&&p.ima.resetIMA_(),p.onImaAdsError(a)},p.handlePassback=function(a){if(p.handlingPassback||isNotDefined(a.Passback.Link)||isDefined(a.passbackHandled)&&a.passbackHandled)return!1;a.passbackHandled=!0;var b=a.Passback.Link;p.handlingPassback=!0,p.off("canplay"),function(){for(var c in getParamBreakNames()){var d="0";a.type==c&&(d="46");var e=getParamBreakNames()[c],f=new RegExp(e+"=\\d+","g");b=b.replace(f,e+"="+d)}isDefined(a.Passback.ID)&&a.Passback.ID.length&&(b=b.replace(/\/id=[a-zA-Z\.0-9_\-]+/g,"/id="+a.Passback.ID),b=b.replace(/\?id=[a-zA-Z\.0-9_\-]+/g,"?id="+a.Passback.ID))}(),$.ajax({url:b,type:"GET",xhrFields:{withCredentials:!0},async:!0,success:function(a){var b,c=vastParserProviders[r](a);c.length&&(b=c[0],m.trigger("video.adReceived",[a])),p.videoAdsHandler.onFailedCurrentIMAad(b),p.ads.state="content-set",h(),p.handlingPassback=!1},error:function(){p.src(null),p.ads.state="content-set",p.videoAdsHandler.onFailedCurrentIMAad(),h(),p.handlingPassback=!1}})},p.playSingleAd=function(){function a(){p.isIma||(p.trigger("tracking.start"),p.trigger("sendImpression"))}function b(){if(p.adsBlockStartedCallback(),$(p.node).trigger("video.startedAd"),p.blockInteraction=!1,p.currentAdGroupIndex!==!1){if(p.isIma||p.adsPotential("begin"),m.find(".vjs-ad-legal").show(),m.removeClass("vjs-switching"),!p.isIma){p.videoAdsHandler.setCTAButton(d);var b=m.find(".vjs-pause-overlay");b.length&&b.removeClass("vjs-hidden")}p.interactive||(p.interactive=new adHandlers.interactive(m,p)),p.interactive.build(d),p.video360ad||(p.video360ad=new adHandlers.video360ad(m,p)),p.video360ad.build(d),p.interactive2||(p.interactive2=new adHandlers.interactive2(m,p)),p.interactive2.build(d),p.trackingFlags.start=!0,p.iOs10needsUserGesture?p.one("playAdAfterIOs10userGesture",function(){a()}):a(),"MacOS"!==window.uOS||p.isIma||p.one("timeupdate",function(){m.css({display:"none"}).hide(0,function(){m.show().css({display:"block"})})})}}var c=p.getCurrentAdGroup(),d=!!c&&c.items[p.currentAdItemIndex],e=m.find(".vjs-ad-legal .vjs-ad-legal-remaining");if(p.trackingFlags={},p.advertInProgress=!0,p.skipAllowed=!1,p.endOfClip=!1,p.currentImaAdData={},m.find(".vjs-black-video-cover").removeClass("vjs-visible"),d&&"360"===d.fullObj.adType){if("undefined"!=typeof d.fullObj.panoramaXML&&p.isWebviewMode())return p.video360ad=p.video360ad||new adHandlers.video360ad(m,p),p.video360ad.send360AdXmlToApp(c.items,d.fullObj.panoramaXML);p.startBufferListener(),m.find(".vjs-black-video-cover").addClass("vjs-visible")}e.removeClass("vjs-hidden"),p.videoAdsHandler.changeAdvertLabelFromVast(d),f(!0),p.playingAdCallback(c.type),"mid-roll"!==c.type||p.pauseTime||(p.pauseTime=p.currentTime()),p.currentAdType=c.type,p.currentAdTime=makeSeconds(d.fullObj.Duration),e.text()||e.text(secondsToHms(c.totalDuration)+" ");try{if(m.find(".vjs-overlay-container").hide(),p.isShowedOverlay=!1,"undefined"!=typeof d.fullObj.Sequential&&(p.sequential=new adHandlers.sequential(m,p),p.sequential.build(d)),p.previousAdWasIma=p.isIma,p.isIma="undefined"!=typeof d.fullObj.isIMA&&d.fullObj.isIMA===!0,"undefined"==typeof d.fullObj.TapGo)p.tapGoManager.enabled=!1;else try{if(p.tapGoManager.vastItem&&p.tapGoManager.vastItem.level>0){if(!p.tapGoManager.hasSpot)return p.tapGoManager.tapGoCanPlay(b),!0}else p.tapGoManager.init(),p.tapGoManager.buildAd(d.fullObj.TapGo)}catch(g){}"undefined"!=typeof d.fullObj.Sequential&&"undefined"!=typeof d.fullObj.Sequential.attribs.skipMainVideo&&"true"===d.fullObj.Sequential.attribs.skipMainVideo?(m.find(".vjs-ad-legal").show(),m.removeClass("vjs-switching"),"undefined"!=typeof d.fullObj.Sequential&&(p.sequential.skipMainVideo=!0,p.sequential.showSplashScreen())):p.isIma?(p.forcedImaError&&(p.forcedImaError=!1),"mid-roll"==c.type&&(p.blockInteraction=!0,p.pause(),m.addClass("vjs-switching")),p.updateImaGoogleLibLoaded()||p.isUserGestureNeededToCallAdvert()?p.playImaAd(d.fullObj):nuvi.require(["imaGoogle"],function(){p.imaGoogleLibLoaded=!0,p.playImaAd(d.fullObj)},function(){PLAYER_DEBUG&&console.error("Could not load IMA SDK"),p.trigger("adserror")})):("Html5"!==p.techName&&(p.currentVolume=p.volume(),p.isMuted=p.muted(),p.pause(),p.destroyMediaPlayer(),p.loadTech("Html5"),p.volume(p.currentVolume),p.muted(p.isMuted)),(p.options().isLive||p.options().playlistData!==!1||"Chrome"==uBrowser&&uVersion>=45)&&(d.source=jsonRedirectRedcdn(d.source)),p.src(d.source),setTimeout(function(){isDefined(p)&&(p.src()!==d.source&&p.src(d.source),p.paused()&&p.play())},100),p.load(),p.isAdvertiseMode()&&p.play()),p.off("canplay").one("canplay",function(){p.tapGoManager&&p.tapGoManager.enabled?p.tapGoManager.tapGoCanPlay(b):b()})}catch(g){"undefined"!=typeof p.tapGoManager.debug&&(p.tapGoManager.debug("playSingleAd error:"),p.tapGoManager.debug(JSON.stringify(g))),PLAYER_DEBUG&&(console.log("showSlot Exception"),console.log(g))}},p.stop=function(){p.trigger("stopped")},p.playingCallback=function(){TvnAdBlockBoardUtils.checkCookie()&&TvnAdBlockBoardUtils.track(["Adblock","StartAsset"],{gemius:{player_action:"Plansza Adblock Start assetu"},GA:{category:"Plansza Adblok",action:"Start assetu"},pix2:{event:"Plansza Adblock Start assetu"}})},p.playingAdCallback=function(a){a=a.replace("-",""),TvnAdBlockBoardUtils.checkCookie()&&TvnAdBlockBoardUtils.track(["Adblock","StartAd"],{gemius:{player_action:"Plansza Adblock Start reklamy"},GA:{category:"Plansza Adblok",action:"Start reklamy",label:a},pix2:{event:"Plansza Adblock Start reklamy",params:{breakName:a}}})},$(p.node).on("changePlayer",function(a,b){var c=function(){setTimeout(function(){$(p.node).trigger("video.completeAdsBlock")},2e3)};if("undefined"!=typeof b)try{p.parseAdsBlock(b)}catch(d){c()}else c()}),p.getCurrentPlayingTime=function(){return Math.round(p.currentTime())},p.jumpToMoment=function(a){a<p.duration()?p.currentTime(a):p.currentTime(0)},p.getCurrentAdGroup=function(){return p.currentAdGroupIndex!==!1&&p.newAdStock[p.currentAdGroupIndex]},p.getCurrentAd=function(){var a=p.getCurrentAdGroup();return!(!a||p.currentAdItemIndex===!1)&&a.items[p.currentAdItemIndex]},p.getAdType=function(){var a=p.getCurrentAd();return!(!a||!p.advertInProgress)&&a.fullObj.adType}}Function.prototype.bind=Function.prototype.bind||function(a){var b=Array.prototype.splice.call(arguments,1),c=this,d=function(){var e=b.concat(Array.prototype.splice.call(arguments,0));return this instanceof d?void c.apply(this,e):c.apply(a,e)};return d.prototype=c.prototype,d};var Detector=function(){this.browser="Unknown",this.version="Unknown",this.webkitversion=void 0,this.device="Desktop",this.parameters=window.navigator.userAgent||window.navigator.vendor||window.opera||navigator.userAgent,this.patternMobileNowe=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,this.patternTablety=/android|ipad|tablet|playbook|silk/i,this.patternMobileStare=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,this.detectDevice=function(){return this.detectWebkitVersion(),this.patternMobileNowe.test(this.parameters)?this.device="Smartfon":this.patternTablety.test(this.parameters)?this.device="Tablet":this.patternMobileStare.test(this.parameters.substr(0,4))&&(this.device="Telefon"),/Tablet PC 2\.0/.test(this.parameters)&&screen.width>=961&&(this.device="Desktop"),this},this.detectWebkitVersion=function(){if(/AppleWebKit/.test(this.parameters)){var a=this.parameters.match(/AppleWebKit\/([0-9]+)\./);"undefined"!=typeof a&&a&&"undefined"!=typeof a[1]&&(this.webkitversion=parseFloat(a[1]))}},this.detectBrowser=function(){return/IEMobile\/(\d+\.\d+);/.test(navigator.userAgent)&&(this.browser="MSIE",this.version=Number(RegExp.$1)),/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)?this.browser="Opera":/OPR[\/\s](\d+\.\d+)/.test(navigator.userAgent)?this.browser="Opera":/MSIE (\d+\.\d+);/.test(navigator.userAgent)?this.browser="MSIE":/Navigator[\/\s](\d+\.\d+)/.test(navigator.userAgent)?this.browser="Netscape":/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent)?this.browser="Chrome":/Safari[\/\s](\d+\.\d+)/.test(navigator.userAgent)?(this.browser="Safari",/Version[\/\s](\d+\.\d+)/.test(navigator.userAgent),this.version=Number(RegExp.$1)):/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(this.browser="Firefox"),"Unknown"==this.version&&(this.version=parseFloat(Number(RegExp.$1))),this},this.detectBrowserNewMethod=function(){function a(a){var c=b.match(a);return c&&c.length>1&&c[1]||""}var b=this.parameters,c=a(/(ipod|iphone|ipad)/i).toLowerCase(),d=/like android/i.test(b),e=!d&&/android/i.test(b),f=/CrOS/.test(b),g=/silk/i.test(b),h=/sailfish/i.test(b),i=/tizen/i.test(b),j=/(web|hpw)os/i.test(b),k=/windows phone/i.test(b),l=(!k&&/windows/i.test(b),!c&&!g&&/macintosh/i.test(b),!e&&!h&&!i&&!j&&/linux/i.test(b),a(/edge\/(\d+(\.\d+)?)/i)),m=a(/version\/(\d+(\.\d+)?)/i),n=/tablet/i.test(b);!n&&/[^-]mobi/i.test(b);return/opera|opr/i.test(b)?(this.browser="Opera",this.version=m||a(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)):/yabrowser/i.test(b)?(this.browser="Yandex",this.version=m||a(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)):k?(this.browser="MSIE",l?(this.browser="Edge",this.version=l):this.version=a(/iemobile\/(\d+(\.\d+)?)/i)):/msie|trident/i.test(b)?(this.browser="MSIE",this.version=a(/(?:msie |rv:)(\d+(\.\d+)?)/i)):f?(this.browser="Chrome",this.version=a(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)):/chrome.+? edge/i.test(b)?(this.browser="Edge",this.version=l):/chrome|crios|crmo/i.test(b)?(this.browser="Chrome",this.version=a(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)):c?(this.browser="iphone"==c?"iPhone":"ipad"==c?"iPad":"iPod",m&&(this.version=m)):h?(this.browser="Sailfish",this.version=a(/sailfish\s?browser\/(\d+(\.\d+)?)/i)):/seamonkey\//i.test(b)?(this.browser="SeaMonkey",this.version=a(/seamonkey\/(\d+(\.\d+)?)/i)):/firefox|iceweasel/i.test(b)?(this.browser="Firefox",this.version=a(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)):g?(this.browser="Amazon Silk",this.version=a(/silk\/(\d+(\.\d+)?)/i)):e?(this.browser="Android",this.version=m):/phantom/i.test(b)?(this.browser="PhantomJS",this.version=a(/phantomjs\/(\d+(\.\d+)?)/i)):/blackberry|\bbb\d+/i.test(b)||/rim\stablet/i.test(b)?(this.browser="BlackBerry",this.version=m||a(/blackberry[\d]+\/(\d+(\.\d+)?)/i)):j?(this.browser="WebOS",this.version=m||a(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)):/bada/i.test(b)?(this.browser="Bada",this.version=a(/dolfin\/(\d+(\.\d+)?)/i)):i?(this.browser="Tizen",this.version=a(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||m):/safari/i.test(b)&&(this.browser="Safari",this.version=m),this},this.getBrowser=function(){return this.browser},this.getVersion=function(){return this.version},this.getDevice=function(){return this.device},this.getWebkitVersion=function(){return this.webkitversion},this.detectOS=function(){return this.OS="Unknown",navigator.appVersion.indexOf("Win")!=-1&&(this.OS="Windows"),navigator.appVersion.indexOf("Mac")!=-1&&(this.OS="MacOS"),navigator.appVersion.indexOf("X11")!=-1&&(this.OS="UNIX"),navigator.appVersion.indexOf("Linux")!=-1&&(this.OS="Linux"),navigator.userAgent.indexOf("Android")!=-1&&(this.OS="Android"),/Windows\s{1}Phone\s{1}\d+/i.test(navigator.userAgent)&&(this.OS="Windows"),this.OS},this.detectOSversion=function(){this.OSversion="Unknown";var a=navigator.userAgent;return a.indexOf("Windows NT 5.0")!=-1&&(this.OSversion="2000"),a.indexOf("Windows NT 5.1")==-1&&a.indexOf("Windows NT 5.2")==-1||(this.OSversion="XP"),a.indexOf("Windows NT 6.0")!=-1&&(this.OSversion="Vista"),a.indexOf("Windows NT 6.1")!=-1&&(this.OSversion="7"),a.indexOf("Windows NT 6.2")!=-1&&(this.OSversion="8"),a.indexOf("Windows NT 6.3")!=-1&&(this.OSversion="8.1"),a.indexOf("Windows NT 6.4")==-1&&a.indexOf("Windows NT 10")==-1||(this.OSversion="10"),a.indexOf("Android")>=0&&(this.OSversion=parseFloat(a.slice(a.indexOf("Android")+8))),this.OSversion}};detector=new Detector,window.uDevice=detector.detectDevice().getDevice(),window.uBrowser=detector.detectBrowserNewMethod().getBrowser(),window.uVersion=detector.getVersion(),window.uOS=detector.detectOS(),window.uOSversion=detector.detectOSversion(),window.isMobileDevice="Smartfon"==uDevice||"Telefon"==uDevice,
function(a){var b={init:function(b){return this.each(function(){var c=a(this),d=c.data("eraser");if(!d){var e=function(){b.eventId=b.wipe.eventId+b.btnId;var e=b.videoWrapper.find(".vjs-tapgo"),f=a("<canvas/>"),g=f.get(0),h=g.getContext("2d"),i=b.btnId,j=window.devicePixelRatio||1,k=h.webkitBackingStorePixelRatio||h.mozBackingStorePixelRatio||h.msBackingStorePixelRatio||h.oBackingStorePixelRatio||h.backingStorePixelRatio||1,l=j/k,m=c.width(),n=c.height(),o=m*l,p=n*l,q=c.offset(),r=!b||b.enabled!==!1,s=b.wipe.tgManager.getRescaleRatio()||1,t=b.wipe.brushSize*l*s,u=b&&b.completeRatio?b.completeRatio:.8,v=b&&b.completeFunction?b.completeFunction:null,w=b&&b.progressFunction?b.progressFunction:null,x=b&&b.readyFunction?b.readyFunction:null,y="auto"==c.css("z-index")?1:c.css("z-index"),z=[],A=2*Math.floor(o/t),B=A*Math.floor(p/t),C=B,D=c[0],E=c.data("x")||0,F=c.data("y")||0,G=E*s,H=F*s;for(f.hide(),c.after(f),g.id=D.id,g.className=D.className,g.width=o,g.height=p,g.style.width=m.toString()+"px",g.style.height=n.toString()+"px",g.style.left=G+"px",g.style.top=H+"px",g.style.msTouchAction="none",g.style.zIndex=y,g.setAttribute("data-width",c.data("width")),g.setAttribute("data-height",c.data("height")),g.setAttribute("data-x",E),g.setAttribute("data-y",F),i&&g.setAttribute("data-button-index",i),h.drawImage(D,0,0,o,p),c.remove(),h.globalCompositeOperation="destination-out",h.strokeStyle="rgba(255,0,0,255)",h.lineWidth=t,h.lineCap="round";C--;)z.push(1);if(b.actionsIds)for(C=b.actionsIds.length;C--;)b.actionsIds[C]=parseInt(b.actionsIds[C],10);else b.actionsIds=[];d={posX:q.left,posY:q.top,touchDown:!1,touchID:-999,touchX:0,touchY:0,canvas:f,ctx:h,w:o,h:p,scaleRatio:l,source:D,size:t,parts:z,colParts:A,numParts:B,ratio:0,enabled:r,complete:!1,completeRatio:u,completeFunction:v,progressFunction:w,readyFunction:x,zIndex:y,progressArea:{},progress:0,eventId:b.eventId,completeFired:!1,tapGoWrapper:e,btnId:i,actionsIds:b.actionsIds,wipe:b.wipe,eventsBinded:!1},f.data("eraser",d),a(window).resize(function(){var a=f.offset();d.posX=a.left,d.posY=a.top}),d.readyFunction&&d.readyFunction()};c.load(e)}})},bindEraserEvents:function(c){c.tapGoWrapper.on(c.wipe.tgManager.getEventToHandleIt("down",c.eventId),function(a){c.wipe.tgManager.preventEventAction(a),b.cursorDownEvent(a,c||!1)}),c.tapGoWrapper.on(c.wipe.tgManager.getEventToHandleIt("move",c.eventId),function(a){c.wipe.tgManager.preventEventAction(a),b.cursorMoveEvent(a,c||!1)}),a(document).on(c.wipe.tgManager.getEventToHandleIt("up",c.eventId),function(a){c.wipe.tgManager.preventEventAction(a),b.cursorUpEvent(a,c||!1)})},calculateEventData:function(a,b){a.x-=b.posX,a.y-=b.posY,a.x*=b.scaleRatio,a.y*=b.scaleRatio},cursorDownEvent:function(a,c){if(!c||c.touchDown||!c.enabled)return!1;var d=c.wipe.tgManager.getEventData(a)[0];b.calculateEventData(d,c),a.type=d.upEvent,a.originalEvent.type=d.upEvent,a.eventIndex=d.id,delete a.handleObj.namespace,c.wipe.upEvent=a,b.evaluatePoint(c,d.x,d.y),c.ctx.beginPath(),c.ctx.moveTo(d.x-1,d.y),c.ctx.lineTo(d.x,d.y),c.ctx.stroke(),c.touchDown=!0,c.touchID=d.id,c.touchX=d.x,c.touchY=d.y},cursorMoveEvent:function(a,c){if(!c||!c.touchDown||!c.enabled)return!1;var d=c.wipe.tgManager.getEventData(a)[0];return d.id===c.touchID&&(b.calculateEventData(d,c),b.evaluatePoint(c,d.x,d.y),c.ctx.beginPath(),c.ctx.moveTo(c.touchX,c.touchY),c.touchX=d.x,c.touchY=d.y,c.ctx.lineTo(c.touchX,c.touchY),void c.ctx.stroke())},cursorUpEvent:function(a,b){if(!b||!b.touchDown)return!1;var c=b.wipe.tgManager.getEventData(a)[0];return c.id===b.touchID&&(b.touchDown=!1,void(b.wipe.upEvent=!1))},evaluatePoint:function(a,b,c){if(a.enabled){for(var d=Math.round(100*(b-a.size/2)/a.w),e=Math.round(100*(b+a.size/2)/a.w),f=Math.round(100*(c-a.size/2)/a.h),g=Math.round(100*(c+a.size/2)/a.h),h=0;h<e-d+1;h++){var i=d+h;if(i>=0&&i<=100){"undefined"==typeof a.progressArea["x"+i]&&(a.progressArea["x"+i]={});for(var j=0;j<g-f+1;j++){var k=f+j;k>=0&&k<=100&&"undefined"==typeof a.progressArea["x"+i]["y"+k]&&(a.progressArea["x"+i]["y"+k]=!0,a.progress++)}}}var l=a.progress/100;l>=a.completeRatio?(a.complete=!0,a.completeFired===!1&&(null!==a.completeFunction&&a.completeFunction(a),a.completeFired=!0)):null!==a.progressFunction&&a.progressFunction(l)}},initEvents:function(){var c=a(this).data("eraser");c&&!c.eventsBinded&&(b.bindEraserEvents(c),c.eventsBinded=!0)},clear:function(){var b=a(this),c=b.data("eraser");if(c){c.ctx.clearRect(0,0,c.w,c.h);for(var d=c.numParts;d--;)c.parts[d]=0;c.ratio=c.numParts,c.complete=!0,null!==c.completeFunction&&c.completeFunction()}},enabled:function(){var b=a(this),c=b.data("eraser");return!(!c||!c.enabled)},enable:function(){var b=a(this),c=b.data("eraser");c&&(c.enabled=!0)},disable:function(){var b=a(this),c=b.data("eraser");c&&(c.enabled=!1)},destroy:function(){var b=a(this),c=b.data("eraser");c&&(c.tapGoWrapper.off(c.wipe.tgManager.getEventToHandleIt("down",c.eventId)),c.tapGoWrapper.off(c.wipe.tgManager.getEventToHandleIt("move",c.eventId)),a(document).off(c.wipe.tgManager.getEventToHandleIt("up",c.eventId)),c.enabled=!1,c.touchDown=!1,b.removeData("eraser"))},size:function(b){var c=a(this),d=c.data("eraser");d&&b&&(d.size=b,d.ctx.lineWidth=b)},reset:function(){var b=a(this),c=b.data("eraser");if(c){c.ctx.globalCompositeOperation="source-over",c.ctx.drawImage(c.source,0,0,c.w,c.h),c.ctx.globalCompositeOperation="destination-out";for(var d=c.numParts;d--;)c.parts[d]=1;c.ratio=0,c.complete=!1,c.touchDown=!1}},progress:function(){var b=a(this),c=b.data("eraser");return c?c.ratio/c.numParts:0}};a.fn.eraser=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not yet exist on jQuery.eraser"):b.init.apply(this,arguments)}}(jQuery),function(a){var b=function(b,c,d,e){var f=this;this.cb=e,this.$container=b,this.$selectarea=this.$container.find("[data-selectarea]"),this.canvas=this.$container.find("canvas")[0],this.$list=this.$container.find("[data-list]").eq(0),this.$items=this.$list.children(),this.draw=this.canvas.getContext("2d"),this.settings={lineColor:"#000000",lineWidth:5,editableClass:"editable",drawingClass:"drawing",selectedClass:"selected",selectToggle:!1,touchMode:"auto",multiTouch:!1,clearOnCancel:!0},this.actions={},a.extend(this.settings,c),a.extend(this.actions,d),this.draw=this.canvas.getContext("2d"),this.itemBoxes=[],this.selectedItems=[],"undefined"!=typeof window.ontouchstart&&(this.touchSupport=!0),window.navigator.msPointerEnabled&&(this.msTouchSupport=!0),this.touchSupport||(this.settings.multiTouch=!1),this.drawEnabled=!this.touchSupport||"auto"===this.settings.touchMode,this.drawInProgress=!1,this.events={start:"mousedown",move:"mousemove",end:"mouseup mouseout"},this.touchSupport&&(this.events.start+=" touchstart",this.events.move+=" touchmove",this.events.end+=" touchcancel touchend touchleave"),this.msTouchSupport&&(this.events.start+=" MSPointerDown",this.events.move+=" MSPointerMove",this.events.end+=" MSPointerUp MSPointerOut"),this.sizeCanvas(),a(window).on("resize",function(){f.sizeCanvas()}),this.$container.find("[data-clear]").on("click",function(){return f.deselectAll(),!1}),this.$container.find("[data-all]").on("click",function(){return f.selectAll(),!1});var g=this.$container.find("[data-edit]");if(g.length>0?(this.drawEnabled=!1,g.on("click",function(){f.drawEnabled=!f.drawEnabled,!f.drawEnabled&&f.settings.clearOnCancel&&f.deselectAll(),f.$container.toggleClass(f.settings.editableClass);var b=a(this).attr("data-alttext");"undefined"!=typeof b&&(a(this).attr("data-alttext",a(this).text()),a(this).text(b))})):this.$container.addClass(this.settings.editableClass),this.$container.find("[data-action]").on("click",function(){var b=a(this).attr("data-action");if(f.actions.hasOwnProperty(b)){var c=f.actions[b].call(f,a(f.selectedItems));c===!1&&f.deselectAll(),f.sizeCanvas()}else console.warn('Your markup is referencing an undefined action, "'+b+'"')}),this.$container.find("[data-count]").each(function(){var a=this;a.innerHTML="0 items selected",f.$container.on("wrangle.countchange",function(){a.innerHTML=f.selectedItems.length+" item"+(1!==f.selectedItems.length?"s":"")+" selected"})}),this.$selectarea.on(this.events.start,function(a){(f.drawEnabled||!f.settings.multiTouch&&!f.drawInProgress)&&f.startDrawing(a)}),this.$selectarea.on(this.events.end,function(){f.stopDrawing()}),"double-tap"===this.settings.touchMode){var h,i=!0;this.$selectarea.on("touchstart",function(a){if(i)i=!1,h=Date.now();else{if(Date.now()-h<=300)return i=!0,f.drawEnabled=!0,f.startDrawing(a),!1;i=!0}})}else"2fscroll"===this.settings.touchMode&&this.$selectarea.on("touchstart",function(b){if(!f.drawEnabled){var c=Date.now();a(this).on("touchmove",function(a){if(!f.drawEnabled&&1===a.originalEvent.targetTouches.length)return!(Date.now()-c<100)&&(f.drawEnabled=!0,f.startDrawing(a),!1)})}})};b.prototype.sizeCanvas=function(){this.canvas.width=this.$list.outerWidth(),this.canvas.height=this.$list.outerHeight()},b.prototype.getBoxes=function(){var b=[];return this.$items.each(function(){var d=a(this).position().left+parseInt(a(this).css("margin-left")),e=a(this).position().top+parseInt(a(this).css("margin-top")),f=a(this).outerWidth(),g=a(this).outerHeight();b.push(new c(d,e,f,g))}),b},b.prototype.getCoords=function(b){var c=this,d=[],e=c.$container.offset();return b.type.match(/MS/)?d.push={x:b.originalEvent.pageX-e.left,y:b.originalEvent.pageY-e.top}:b.type.match(/mouse/)?d.push({x:b.pageX-e.left,y:b.pageY-e.top}):a.each(b.originalEvent.targetTouches,function(){d.push({x:this.pageX-e.left,y:this.pageY-e.top})}),this.settings.multiTouch||(d=d.slice(0,1)),d},b.prototype.checkCollision=function(b,c){var d=this,e=[];return a.each(d.itemBoxes,function(f){if(this!==window){var g=this;a.each(b,function(a){if(g.intersects(this.x,this.y)){var b=d.$items.eq(f);d.settings.selectToggle?c[a]!==b[0]&&(b.hasClass(d.settings.selectedClass)?d.deselect(b):d.select(b)):d.select(b,f),e[a]=b[0]}})}}),e},b.prototype.startDrawing=function(b){if(!this.settings.multiTouch&&this.drawInProgress)return!1;var c=this,d=[];this.drawInProgress||(this.itemBoxes=this.getBoxes(),this.$container.addClass(this.settings.drawingClass));var e=this.getCoords(b);return d=this.checkCollision(e,d),this.touchSupport&&a(b.target).one("mousedown mousemove mouseup",function(){return!1}),this.$selectarea.on(this.events.move,function(a){c.drawInProgress=!0;var b=(a.originalEvent,c.getCoords(a));return c.multiDrawLine(e,b,c.draw),d=c.checkCollision(b,d),e=b,!1}),!1},b.prototype.stopDrawing=function(){var a=this;return this.drawInProgress=!1,window.drawTimeout=window.setTimeout(function(){a.drawInProgress||(a.draw.clearRect(0,0,a.canvas.width,a.canvas.height),a.$selectarea.off(a.events.move),a.$container.removeClass(a.settings.drawingClass),a.touchSupport&&"auto"!==a.settings.touchMode&&(a.drawEnabled=!1))},50),!1},b.prototype.drawLine=function(a,b,c){c.strokeStyle=this.settings.lineColor,c.lineWidth=this.settings.lineWidth,c.lineJoin="round",c.lineCap="round",c.beginPath(),c.moveTo(a.x,a.y),c.lineTo(b.x,b.y),c.closePath(),c.stroke()},b.prototype.multiDrawLine=function(b,c,d){var e=this;a.each(b,function(a){"object"==typeof c[a]&&e.drawLine(b[a],c[a],d)})},b.prototype.select=function(b,c){this.cb(b),this.selectedItems.push(b),"number"==typeof c&&delete this.itemBoxes[c],a(b).addClass(this.settings.selectedClass),this.$container.trigger("wrangle.countchange")},b.prototype.selectAll=function(){var a=this;this.selectedItems=[],this.$items.each(function(){a.select(this)})},b.prototype.deselect=function(b){var c=this;a.each(this.selectedItems,function(a){this===b[0]&&(c.selectedItems.splice(a,1),b.removeClass("selected"),c.$container.trigger("wrangle.countchange"))})},b.prototype.deselectAll=function(){this.selectedItems=[],this.$items.removeClass("selected"),this.$container.trigger("wrangle.countchange")};var c=function(a,b,c,d){this.top=b,this.bottom=b+d,this.left=a,this.right=a+c};c.prototype.intersects=function(a,b){return a>=this.left&&a<=this.right&&b>=this.top&&b<=this.bottom},a.fn.wrangle=function(c,d,e){return a(this).find("[data-wrangle]").addBack("[data-wrangle]").each(function(){new b(a(this),c,d,e)}).end()}}(window.Zepto||window.jQuery);var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(b){return}R=!0;for(var c=N.length,d=0;d<c;d++)N[d]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(d<10)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;b<a;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;o<n;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;f<e;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(c){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),e=c?/mac/.test(c):/mac/.test(b),f=!!/webkit/.test(b)&&parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();(function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){if(!R)return/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))})(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;b<a;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;d<c;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(U.w3)return g(a)},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();$(document).ready(function(){!function(a){a.fn.timerCountDown=function(b){var c=a.extend({timerElement:'[data-tvn-timer="counter"]',startTime:10,callback:null,endCallback:null},b),d=this;return formatTimer=function(a){return a<10&&(a="0"+a),a},startTimer=function(){switch(d.d1=new Date,d.state){case"pause":d.t1=d.d1.getTime()-d.td;break;default:d.t1=d.d1.getTime(),d.t1+=1e3*parseInt(c.startTime)}d.state="alive",loopTimer()},pauseTimer=function(){d.dp=new Date,d.tp=d.dp.getTime(),d.td=d.tp-d.t1,d.state="pause"},stopTimer=function(){d.state="stop"},resetTimer=function(){a(c.timerElement).html(c.startTime),d.state="reset"},endTimer=function(a){d.state="end","function"==typeof a&&a()},loopTimer=function(){var b,e,f,g=0,h=0,i=0,j=0;if("alive"!==d.state)return clearTimeout(d.t),!0;e=new Date,f=e.getTime(),b=d.t1-f,b<=0&&endTimer(function(){resetTimer(),"function"==typeof c.endCallback&&c.endCallback()}),g=b%1e3,g<1&&(g=0),h=(b-g)/1e3,h<1&&(h=0);var i=(h-h%60)/60;i<1&&(i=0);var j=(i-i%60)/60;j<1&&(j=0),g=Math.round(g/100),h-=60*i,i-=60*j;var k=parseInt(a(c.timerElement).html(),10);a(c.timerElement).html(h),"function"==typeof c.callback&&k!==h&&c.callback(h),d.t=setTimeout(loopTimer,1)},a('[data-tvn-timer="start"]').on("click",function(){startTimer()}),a('[data-tvn-timer="stop"]').on("click",function(){stopTimer()}),a('[data-tvn-timer="reset"]').on("click",function(){resetTimer()}),a('[data-tvn-timer="pause"]').on("click",function(){pauseTimer()}),{start:startTimer,stop:stopTimer,reset:resetTimer,pause:pauseTimer}}}(jQuery)}),function(a,b){function c(a,b,c){return[parseInt(a[0],10)*(n.test(a[0])?b/100:1),parseInt(a[1],10)*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow?"":b.element.css("overflow-x"),d=b.isWindow?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:e?a.position.scrollbarWidth():0,height:f?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]);return{element:c,isWindow:d,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:d<0?"left":c>0?"right":"center",vertical:f<0?"top":e>0?"bottom":"middle"};n<l&&h(c+d)<n&&(i.horizontal="center"),p<m&&h(e+f)<p&&(i.vertical="middle"),g(h(c),h(d))>g(h(e),h(f))?i.important="horizontal":i.important="vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&j<=0?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):j>0&&i<=0?a.left=e:i>j?a.left=e+f-b.collisionWidth:a.left=e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&j<=0?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):j>0&&i<=0?a.top=e:i>j?a.top=e+f-b.collisionHeight:a.top=e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];k<0?(c=a.left+m+n+o+b.collisionWidth-g-f,(c<0||c<h(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||h(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];k<0?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(d<0||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&e<11,b.innerHTML="",c.removeChild(b)}()}(jQuery),function(a,b){function c(a){for(var b,c=a.split(/\s+/),d=[],e=0;b=c[e];e++)b=b.charAt(0).toUpperCase(),d.push(b);return d}function d(b){return b.id&&a('label[for="'+b.id+'"]').val()||b.name}function e(c,f,g){return g||(g=0),f.each(function(){var f,h,i=a(this),j=this,k=this.nodeName.toLowerCase();switch("label"==k&&i.find("input, textarea, select").length&&(f=i.text(),i=i.children().first(),j=i.get(0),k=j.nodeName.toLowerCase()),k){case"menu":h={name:i.attr("label"),items:{}},g=e(h.items,i.children(),g);break;case"a":case"button":h={name:i.text(),disabled:!!i.attr("disabled"),callback:function(){return function(){i.click()}}()};break;case"menuitem":case"command":switch(i.attr("type")){case b:case"command":case"menuitem":h={name:i.attr("label"),disabled:!!i.attr("disabled"),callback:function(){return function(){i.click()}}()};break;case"checkbox":h={type:"checkbox",disabled:!!i.attr("disabled"),name:i.attr("label"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",disabled:!!i.attr("disabled"),name:i.attr("label"),radio:i.attr("radiogroup"),value:i.attr("id"),selected:!!i.attr("checked")};break;default:h=b}break;case"hr":h="-------";break;case"input":switch(i.attr("type")){case"text":h={type:"text",name:f||d(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"checkbox":h={type:"checkbox",name:f||d(j),disabled:!!i.attr("disabled"),selected:!!i.attr("checked")};break;case"radio":h={type:"radio",name:f||d(j),disabled:!!i.attr("disabled"),radio:!!i.attr("name"),value:i.val(),selected:!!i.attr("checked")};break;default:h=b}break;case"select":h={type:"select",name:f||d(j),disabled:!!i.attr("disabled"),selected:i.val(),options:{}},i.children().each(function(){h.options[this.value]=a(this).text()});break;case"textarea":h={type:"textarea",name:f||d(j),disabled:!!i.attr("disabled"),value:i.val()};break;case"label":break;default:h={type:"html",html:i.clone(!0)}}h&&(g++,c["key"+g]=h)}),g}if(a.support.htmlMenuitem="HTMLMenuItemElement"in window,a.support.htmlCommand="HTMLCommandElement"in window,a.support.eventSelectstart="onselectstart"in document.documentElement,!a.ui||!a.ui.widget){var f=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(e){}f(b)}}var g=null,h=!1,i=a(window),j=0,k={},l={},m={},n={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var c=this.offset();c.top+=this.outerHeight(),c.left+=this.outerWidth()/2-b.outerWidth()/2,b.css(c)}},position:function(a,b,c){var d;if(!b&&!c)return void a.determinePosition.call(this,a.$menu);d="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b};var e=i.scrollTop()+i.height(),f=i.scrollLeft()+i.width(),g=a.$menu.height(),h=a.$menu.width();
d.top+g>e&&(d.top-=g),d.top<0&&(d.top=0),d.left+h>f&&(d.left-=h),a.$menu.css(d)},positionSubmenu:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var c={top:0,left:this.outerWidth()};b.css(c)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop},callback:null,items:{}},o={timer:null,pageX:null,pageY:null},p=function(a){for(var b=0,c=a;;)if(b=Math.max(b,parseInt(c.css("z-index"),10)||0),c=c.parent(),!c||!c.length||"html body".indexOf(c.prop("nodeName").toLowerCase())>-1)break;return b},q={abortevent:function(a){a.preventDefault(),a.stopImmediatePropagation()},contextmenu:function(b){var c=a(this);if("right"==b.data.trigger&&(b.preventDefault(),b.stopImmediatePropagation()),!("right"!=b.data.trigger&&b.originalEvent||c.hasClass("context-menu-active")||c.hasClass("context-menu-disabled"))){if(g=c,b.data.build){var d=b.data.build(g,b);if(d===!1)return;if(b.data=a.extend(!0,{},n,b.data,d||{}),!b.data.items||a.isEmptyObject(b.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");b.data.$trigger=g,r.create(b.data)}r.show.call(c,b.data,b.pageX,b.pageY)}},click:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))},mousedown:function(b){var c=a(this);g&&g.length&&!g.is(c)&&g.data("contextMenu").$menu.trigger("contextmenu:hide"),2==b.button&&(g=c.data("contextMenuActive",!0))},mouseup:function(b){var c=a(this);c.data("contextMenuActive")&&g&&g.length&&g.is(c)&&!c.hasClass("context-menu-disabled")&&(b.preventDefault(),b.stopImmediatePropagation(),g=c,c.trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))),c.removeData("contextMenuActive")},mouseenter:function(b){var c=a(this),d=a(b.relatedTarget),e=a(document);d.is(".context-menu-list")||d.closest(".context-menu-list").length||g&&g.length||(o.pageX=b.pageX,o.pageY=b.pageY,o.data=b.data,e.on("mousemove.contextMenuShow",q.mousemove),o.timer=setTimeout(function(){o.timer=null,e.off("mousemove.contextMenuShow"),g=c,c.trigger(a.Event("contextmenu",{data:o.data,pageX:o.pageX,pageY:o.pageY}))},b.data.delay))},mousemove:function(a){o.pageX=a.pageX,o.pageY=a.pageY},mouseleave:function(b){var c=a(b.relatedTarget);if(!c.is(".context-menu-list")&&!c.closest(".context-menu-list").length){try{clearTimeout(o.timer)}catch(b){}o.timer=null}},layerClick:function(b){var c,d,e=a(this),f=e.data("contextMenuRoot"),g=b.button,h=b.pageX,j=b.pageY;b.preventDefault(),b.stopImmediatePropagation(),setTimeout(function(){var e,k="left"==f.trigger&&0===g||"right"==f.trigger&&2===g;if(document.elementFromPoint&&(f.$layer.hide(),c=document.elementFromPoint(h-i.scrollLeft(),j-i.scrollTop()),f.$layer.show()),f.reposition&&k)if(document.elementFromPoint){if(f.$trigger.is(c)||f.$trigger.has(c).length)return void f.position.call(f.$trigger,f,h,j)}else if(d=f.$trigger.offset(),e=a(window),d.top+=e.scrollTop(),d.top<=b.pageY&&(d.left+=e.scrollLeft(),d.left<=b.pageX&&(d.bottom=d.top+f.$trigger.outerHeight(),d.bottom>=b.pageY&&(d.right=d.left+f.$trigger.outerWidth(),d.right>=b.pageX))))return void f.position.call(f.$trigger,f,h,j);c&&k&&f.$trigger.one("contextmenu:hidden",function(){a(c).contextMenu({x:h,y:j})}),f.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault(),a.stopPropagation()},key:function(a){var b={};switch(g&&(b=g.data("contextMenu")||{}),a.keyCode){case 9:case 38:if(q.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),void b.$menu.trigger("prevcommand");if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault()}else if(9!=a.keyCode||a.shiftKey)return void b.$menu.trigger("prevcommand");case 40:if(q.keyStop(a,b),!b.isInput)return void b.$menu.trigger("nextcommand");if(9==a.keyCode)return a.preventDefault(),b.$selected&&b.$selected.find("input, textarea, select").blur(),void b.$menu.trigger("nextcommand");if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault();break;case 37:if(q.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){var c=b.$selected.parent().parent();return b.$selected.trigger("contextmenu:blur"),void(b.$selected=c)}break;case 39:if(q.keyStop(a,b),b.isInput||!b.$selected||!b.$selected.length)break;var d=b.$selected.data("contextMenu")||{};if(d.$menu&&b.$selected.hasClass("context-menu-submenu"))return b.$selected=null,d.$selected=null,void d.$menu.trigger("nextcommand");break;case 35:case 36:return b.$selected&&b.$selected.find("input, textarea, select").length?void 0:((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==a.keyCode?"first":"last"]().trigger("contextmenu:focus"),void a.preventDefault());case 13:if(q.keyStop(a,b),b.isInput){if(b.$selected&&!b.$selected.is("textarea, select"))return void a.preventDefault();break}return void(b.$selected&&b.$selected.trigger("mouseup"));case 32:case 33:case 34:return void q.keyStop(a,b);case 27:return q.keyStop(a,b),void b.$menu.trigger("contextmenu:hide");default:var e=String.fromCharCode(a.keyCode).toUpperCase();if(b.accesskeys&&b.accesskeys[e])return void b.accesskeys[e].$node.trigger(b.accesskeys[e].$menu?"contextmenu:focus":"mouseup")}a.stopPropagation(),b.$selected&&b.$selected.trigger(a)},prevItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected;c=c.$selected.parent().data("contextMenu")||{},c.$selected=d}for(var e=c.$menu.children(),f=c.$selected&&c.$selected.prev().length?c.$selected.prev():e.last(),g=f;f.hasClass("disabled")||f.hasClass("not-selectable");)if(f=f.prev().length?f.prev():e.last(),f.is(g))return;c.$selected&&q.itemMouseleave.call(c.$selected.get(0),b),q.itemMouseenter.call(f.get(0),b);var h=f.find("input, textarea, select");h.length&&h.focus()},nextItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{};if(c.$selected){var d=c.$selected;c=c.$selected.parent().data("contextMenu")||{},c.$selected=d}for(var e=c.$menu.children(),f=c.$selected&&c.$selected.next().length?c.$selected.next():e.first(),g=f;f.hasClass("disabled")||f.hasClass("not-selectable");)if(f=f.next().length?f.next():e.first(),f.is(g))return;c.$selected&&q.itemMouseleave.call(c.$selected.get(0),b),q.itemMouseenter.call(f.get(0),b);var h=f.find("input, textarea, select");h.length&&h.focus()},focusInput:function(b){var c=a(this).closest(".context-menu-item"),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;f.$selected=e.$selected=c,f.isInput=e.isInput=!0},blurInput:function(b){var c=a(this).closest(".context-menu-item"),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;f.isInput=e.isInput=!1},menuMouseenter:function(b){var c=a(this).data().contextMenuRoot;c.hovering=!0},menuMouseleave:function(b){var c=a(this).data().contextMenuRoot;c.$layer&&c.$layer.is(b.relatedTarget)&&(c.hovering=!1)},itemMouseenter:function(b){var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;return f.hovering=!0,b&&f.$layer&&f.$layer.is(b.relatedTarget)&&(b.preventDefault(),b.stopImmediatePropagation()),(e.$menu?e:f).$menu.children(".hover").trigger("contextmenu:blur"),c.hasClass("disabled")||c.hasClass("not-selectable")?void(e.$selected=null):void c.trigger("contextmenu:focus")},itemMouseleave:function(b){var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;return f!==e&&f.$layer&&f.$layer.is(b.relatedTarget)?(f.$selected&&f.$selected.trigger("contextmenu:blur"),b.preventDefault(),b.stopImmediatePropagation(),void(f.$selected=e.$selected=e.$node)):void c.trigger("contextmenu:blur")},itemClick:function(b){var c,d=a(this),e=d.data(),f=e.contextMenu,g=e.contextMenuRoot,h=e.contextMenuKey;if(f.items[h]&&!d.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){if(b.preventDefault(),b.stopImmediatePropagation(),a.isFunction(g.callbacks[h])&&Object.prototype.hasOwnProperty.call(g.callbacks,h))c=g.callbacks[h];else{if(!a.isFunction(g.callback))return;c=g.callback}c.call(g.$trigger,h,g)!==!1?g.$menu.trigger("contextmenu:hide"):g.$menu.parent().length&&r.update.call(g.$trigger,g)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(b,c){var d=a(this).data("contextMenuRoot");r.hide.call(d.$trigger,d,c&&c.force)},focusItem:function(b){b.stopPropagation();var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;c.addClass("hover").siblings(".hover").trigger("contextmenu:blur"),e.$selected=f.$selected=c,e.$node&&f.positionSubmenu.call(e.$node,e.$menu)},blurItem:function(b){b.stopPropagation();var c=a(this),d=c.data(),e=d.contextMenu;c.removeClass("hover"),e.$selected=null}},r={show:function(b,c,d){var e=a(this),f={};return a("#context-menu-layer").trigger("mousedown"),b.$trigger=e,b.events.show.call(e,b)===!1?void(g=null):(r.update.call(e,b),b.position.call(e,b,c,d),b.zIndex&&(f.zIndex=p(e)+b.zIndex),r.layer.call(b.$menu,b,f.zIndex),b.$menu.find("ul").css("zIndex",f.zIndex+1),b.$menu.css(f)[b.animation.show](b.animation.duration,function(){e.trigger("contextmenu:visible")}),e.data("contextMenu",b).addClass("context-menu-active"),a(document).off("keydown.contextMenu").on("keydown.contextMenu",q.key),void(b.autoHide&&a(document).on("mousemove.contextMenuAutoHide",function(a){var c=e.offset();c.right=c.left+e.outerWidth(),c.bottom=c.top+e.outerHeight(),!b.$layer||b.hovering||a.pageX>=c.left&&a.pageX<=c.right&&a.pageY>=c.top&&a.pageY<=c.bottom||b.$menu.trigger("contextmenu:hide")})))},hide:function(c,d){var e=a(this);if(c||(c=e.data("contextMenu")||{}),d||!c.events||c.events.hide.call(e,c)!==!1){if(e.removeData("contextMenu").removeClass("context-menu-active"),c.$layer){setTimeout(function(a){return function(){a.remove()}}(c.$layer),10);try{delete c.$layer}catch(f){c.$layer=null}}g=null,c.$menu.find(".hover").trigger("contextmenu:blur"),c.$selected=null,a(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),c.$menu&&c.$menu[c.animation.hide](c.animation.duration,function(){c.build&&(c.$menu.remove(),a.each(c,function(a,d){switch(a){case"ns":case"selector":case"build":case"trigger":return!0;default:c[a]=b;try{delete c[a]}catch(e){}return!0}})),setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(d,e){e===b&&(e=d),d.$menu=a('<ul class="context-menu-list"></ul>').addClass(d.className||"").data({contextMenu:d,contextMenuRoot:e}),a.each(["callbacks","commands","inputs"],function(a,b){d[b]={},e[b]||(e[b]={})}),e.accesskeys||(e.accesskeys={}),a.each(d.items,function(b,f){var g=a('<li class="context-menu-item"></li>').addClass(f.className||""),h=null,i=null;if(g.on("click",a.noop),f.$node=g.data({contextMenu:d,contextMenuRoot:e,contextMenuKey:b}),f.accesskey)for(var j,k=c(f.accesskey),l=0;j=k[l];l++)if(!e.accesskeys[j]){e.accesskeys[j]=f,f._name=f.name.replace(new RegExp("("+j+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof f)g.addClass("context-menu-separator not-selectable");else if(f.type&&m[f.type])m[f.type].call(g,f,d,e),a.each([d,e],function(c,d){d.commands[b]=f,a.isFunction(f.callback)&&(d.callbacks[b]=f.callback)});else{switch("html"==f.type?g.addClass("context-menu-html not-selectable"):f.type?(h=a("<label></label>").appendTo(g),a("<span></span>").text(f._name||f.name).appendTo(h),g.addClass("context-menu-input"),d.hasTypes=!0,a.each([d,e],function(a,c){c.commands[b]=f,c.inputs[b]=f})):f.items&&(f.type="sub"),f.type){case"text":i=a('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(f.value||"").appendTo(h);break;case"textarea":i=a('<textarea name=""></textarea>').attr("name","context-menu-input-"+b).val(f.value||"").appendTo(h),f.height&&i.height(f.height);break;case"checkbox":i=a('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+b).val(f.value||"").prop("checked",!!f.selected).prependTo(h);break;case"radio":i=a('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",!!f.selected).prependTo(h);break;case"select":i=a('<select name="">').attr("name","context-menu-input-"+b).appendTo(h),f.options&&(a.each(f.options,function(b,c){a("<option></option>").val(b).text(c).appendTo(i)}),i.val(f.selected));break;case"sub":a("<span></span>").text(f._name||f.name).appendTo(g),f.appendTo=f.$node,r.create(f,e),g.data("contextMenu",f).addClass("context-menu-submenu"),f.callback=null;break;case"html":a(f.html).appendTo(g);break;default:a.each([d,e],function(c,d){d.commands[b]=f,a.isFunction(f.callback)&&(d.callbacks[b]=f.callback)}),a("<span></span>").text(f._name||f.name||"").appendTo(g)}f.type&&"sub"!=f.type&&"html"!=f.type&&(i.on("focus",q.focusInput).on("blur",q.blurInput),f.events&&i.on(f.events,d)),f.icon&&g.addClass("icon icon-"+f.icon)}f.$input=i,f.$label=h,g.appendTo(d.$menu),!d.hasTypes&&a.support.eventSelectstart&&g.on("selectstart.disableTextSelect",q.abortevent)}),d.$node||d.$menu.css("display","none").addClass("context-menu-root"),d.$menu.appendTo(d.appendTo||document.body)},resize:function(b,c){b.css({position:"absolute",display:"block"}),b.data("width",Math.ceil(b.width())+1),b.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),b.find("> li > ul").each(function(){r.resize(a(this),!0)}),a.fn.addBack&&(c||b.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return a(this).data("width")}))},update:function(c,d){var e=this;d===b&&(d=c,r.resize(c.$menu)),c.$menu.children().each(function(){var b=a(this),f=b.data("contextMenuKey"),g=c.items[f],h=a.isFunction(g.disabled)&&g.disabled.call(e,f,d)||g.disabled===!0;if(b[h?"addClass":"removeClass"]("disabled"),g.type)switch(b.find("input, select, textarea").prop("disabled",h),g.type){case"text":case"textarea":g.$input.val(g.value||"");break;case"checkbox":case"radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case"select":g.$input.val(g.selected||"")}g.$menu&&r.update.call(e,g,d)})},layer:function(c,d){var e=c.$layer=a('<div id="context-menu-layer" style="position:fixed; z-index:'+d+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:i.height(),width:i.width(),display:"block"}).data("contextMenuRoot",c).insertBefore(this).on("contextmenu",q.abortevent).on("mousedown",q.layerClick);return document.body.style.maxWidth===b&&e.css({position:"absolute",height:a(document).height()}),e}};a.fn.contextMenu=function(c){if(c===b)this.first().trigger("contextmenu");else if(c.x&&c.y)this.first().trigger(a.Event("contextmenu",{pageX:c.x,pageY:c.y}));else if("hide"===c){var d=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;d&&d.trigger("contextmenu:hide")}else"destroy"===c?a.contextMenu("destroy",{context:this}):a.isPlainObject(c)?(c.context=this,a.contextMenu("create",c)):c?this.removeClass("context-menu-disabled"):c||this.addClass("context-menu-disabled");return this},a.contextMenu=function(c,d){"string"!=typeof c&&(d=c,c="create"),"string"==typeof d?d={selector:d}:d===b&&(d={});var e=a.extend(!0,{},n,d||{}),f=a(document),g=f,i=!1;switch(e.context&&e.context.length?(g=a(e.context).first(),e.context=g.get(0),i=e.context!==document):e.context=document,c){case"create":if(!e.selector)throw new Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||a.isEmptyObject(e.items)))throw new Error("No Items specified");switch(j++,e.ns=".contextMenu"+j,i||(k[e.selector]=e.ns),l[e.ns]=e,e.trigger||(e.trigger="right"),h||(f.on({"contextmenu:hide.contextMenu":q.hideMenu,"prevcommand.contextMenu":q.prevItem,"nextcommand.contextMenu":q.nextItem,"contextmenu.contextMenu":q.abortevent,"mouseenter.contextMenu":q.menuMouseenter,"mouseleave.contextMenu":q.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",q.inputClick).on({"mouseup.contextMenu":q.itemClick,"contextmenu:focus.contextMenu":q.focusItem,"contextmenu:blur.contextMenu":q.blurItem,"contextmenu.contextMenu":q.abortevent,"mouseenter.contextMenu":q.itemMouseenter,"mouseleave.contextMenu":q.itemMouseleave},".context-menu-item"),h=!0),g.on("contextmenu"+e.ns,e.selector,e,q.contextmenu),i&&g.on("remove"+e.ns,function(){a(this).contextMenu("destroy")}),e.trigger){case"hover":g.on("mouseenter"+e.ns,e.selector,e,q.mouseenter).on("mouseleave"+e.ns,e.selector,e,q.mouseleave);break;case"left":g.on("click"+e.ns,e.selector,e,q.click)}e.build||r.create(e);break;case"destroy":var m;if(i){var o=e.context;a.each(l,function(b,c){if(c.context!==o)return!0;m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(a(c.context).find(c.selector))&&m.trigger("contextmenu:hide",{force:!0});try{l[c.ns].$menu&&l[c.ns].$menu.remove(),delete l[c.ns]}catch(d){l[c.ns]=null}return a(c.context).off(c.ns),!0})}else if(e.selector){if(k[e.selector]){m=a(".context-menu-list").filter(":visible"),m.length&&m.data().contextMenuRoot.$trigger.is(e.selector)&&m.trigger("contextmenu:hide",{force:!0});try{l[k[e.selector]].$menu&&l[k[e.selector]].$menu.remove(),delete l[k[e.selector]]}catch(p){l[k[e.selector]]=null}f.off(k[e.selector])}}else f.off(".contextMenu .contextMenuAutoHide"),a.each(l,function(b,c){a(c.context).off(c.ns)}),k={},l={},j=0,h=!1,a("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!a.support.htmlCommand&&!a.support.htmlMenuitem||"boolean"==typeof d&&d)&&a('menu[type="context"]').each(function(){this.id&&a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+c+'"')}return this},a.contextMenu.setInputValues=function(c,d){d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":b.value=d[a]||"";break;case"checkbox":b.selected=!!d[a];break;case"radio":b.selected=(d[b.radio]||"")==b.value;break;case"select":b.selected=d[a]||""}})},a.contextMenu.getInputValues=function(c,d){return d===b&&(d={}),a.each(c.inputs,function(a,b){switch(b.type){case"text":case"textarea":case"select":d[a]=b.$input.val();break;case"checkbox":d[a]=b.$input.prop("checked");break;case"radio":b.$input.prop("checked")&&(d[b.radio]=b.value)}}),d},a.contextMenu.fromMenu=function(b){var c=a(b),d={};return e(d,c.children()),d},a.contextMenu.defaults=n,a.contextMenu.types=m,a.contextMenu.handle=q,a.contextMenu.op=r,a.contextMenu.menus=l}(jQuery),document.createElement("video"),document.createElement("audio"),document.createElement("track");var vjs=function(a,b,c){var d;if("string"==typeof a){if(0===a.indexOf("#")&&(a=a.slice(1)),vjs.players[a])return b&&vjs.log.warn('Player "'+a+'" is already initialised. Options will not be applied.'),c&&vjs.players[a].ready(c),vjs.players[a];d=vjs.el(a)}else d=a;if(!d||!d.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return d.player||new vjs.Player(d,b,c)},videojs=window.videojs=vjs;vjs.CDN_VERSION="4.12",vjs.ACCESS_PROTOCOL="https:"==document.location.protocol?"https://":"http://",vjs.VERSION="4.12.7",vjs.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,playbackRates:[],inactivityTimeout:2e3,children:{mediaLoader:{},posterImage:{},loadingSpinner:{},textTrackDisplay:{},bigPlayButton:{},controlBar:{},errorDisplay:{},textTrackSettings:{}},language:document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."},"GENERATED_CDN_VSN"!==vjs.CDN_VERSION&&(videojs.options.flash.swf=vjs.ACCESS_PROTOCOL+"vjs.zencdn.net/"+vjs.CDN_VERSION+"/video-js.swf"),vjs.addLanguage=function(a,b){return void 0!==vjs.options.languages[a]?vjs.options.languages[a]=vjs.util.mergeOptions(vjs.options.languages[a],b):vjs.options.languages[a]=b,vjs.options.languages},vjs.players={},"function"==typeof define&&define.amd?define("videojs",[],function(){return videojs}):"object"==typeof exports&&"object"==typeof module&&(module.exports=videojs),vjs.CoreObject=vjs.CoreObject=function(){},vjs.CoreObject.extend=function(a){var b,c;a=a||{},b=a.init||a.init||this.prototype.init||this.prototype.init||function(){},c=function(){b.apply(this,arguments)},c.prototype=vjs.obj.create(this.prototype),c.prototype.constructor=c,c.extend=vjs.CoreObject.extend,c.create=vjs.CoreObject.create;for(var d in a)a.hasOwnProperty(d)&&(c.prototype[d]=a[d]);return c},vjs.CoreObject.create=function(){var a=vjs.obj.create(this.prototype);return this.apply(a,arguments),a},vjs.on=function(a,b,c){if(vjs.obj.isArray(b))return _handleMultipleEvents(vjs.on,a,b,c);var d=vjs.getData(a);d.handlers||(d.handlers={}),d.handlers[b]||(d.handlers[b]=[]),c.guid||(c.guid=vjs.guid++),d.handlers[b].push(c),d.dispatcher||(d.disabled=!1,d.dispatcher=function(b){if(!d.disabled){b=vjs.fixEvent(b);var c=d.handlers[b.type];if(c)for(var e=c.slice(0),f=0,g=e.length;f<g&&!b.isImmediatePropagationStopped();f++)e[f].call(a,b)}}),1==d.handlers[b].length&&(a.addEventListener?a.addEventListener(b,d.dispatcher,!1):a.attachEvent&&a.attachEvent("on"+b,d.dispatcher))},vjs.off=function(a,b,c){if(vjs.hasData(a)){var d=vjs.getData(a);if(d.handlers){if(vjs.obj.isArray(b))return _handleMultipleEvents(vjs.off,a,b,c);var e=function(b){d.handlers[b]=[],vjs.cleanUpEvents(a,b)};if(b){var f=d.handlers[b];if(f){if(!c)return void e(b);if(c.guid)for(var g=0;g<f.length;g++)f[g].guid===c.guid&&f.splice(g--,1);vjs.cleanUpEvents(a,b)}}else for(var h in d.handlers)e(h)}}},vjs.cleanUpEvents=function(a,b){var c=vjs.getData(a);0===c.handlers[b].length&&(delete c.handlers[b],a.removeEventListener?a.removeEventListener(b,c.dispatcher,!1):a.detachEvent&&a.detachEvent("on"+b,c.dispatcher)),vjs.isEmpty(c.handlers)&&(delete c.handlers,delete c.dispatcher,delete c.disabled),vjs.isEmpty(c)&&vjs.removeData(a)},vjs.fixEvent=function(a){function b(){return!0}function c(){return!1}if(!a||!a.isPropagationStopped){var d=a||window.event;a={};for(var e in d)"layerX"!==e&&"layerY"!==e&&"keyLocation"!==e&&("returnValue"==e&&d.preventDefault||(a[e]=d[e]));if(a.target||(a.target=a.srcElement||document),a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement,a.preventDefault=function(){d.preventDefault&&d.preventDefault(),a.returnValue=!1,a.isDefaultPrevented=b,a.defaultPrevented=!0},a.isDefaultPrevented=c,a.defaultPrevented=!1,a.stopPropagation=function(){d.stopPropagation&&d.stopPropagation(),a.cancelBubble=!0,a.isPropagationStopped=b},a.isPropagationStopped=c,a.stopImmediatePropagation=function(){d.stopImmediatePropagation&&d.stopImmediatePropagation(),a.isImmediatePropagationStopped=b,a.stopPropagation()},a.isImmediatePropagationStopped=c,null!=a.clientX){var f=document.documentElement,g=document.body;a.pageX=a.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=a.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)}a.which=a.charCode||a.keyCode,null!=a.button&&(a.button=1&a.button?0:4&a.button?1:2&a.button?2:0)}return a},vjs.trigger=function(a,b){var c=vjs.hasData(a)?vjs.getData(a):{},d=a.parentNode||a.ownerDocument;if("string"==typeof b&&(b={type:b,target:a}),b=vjs.fixEvent(b),c.dispatcher&&c.dispatcher.call(a,b),d&&!b.isPropagationStopped()&&b.bubbles!==!1)vjs.trigger(d,b);else if(!d&&!b.defaultPrevented){var e=vjs.getData(b.target);b.target[b.type]&&(e.disabled=!0,"function"==typeof b.target[b.type]&&b.target[b.type](),e.disabled=!1)}return!b.defaultPrevented},vjs.one=function(a,b,c){if(vjs.obj.isArray(b))return _handleMultipleEvents(vjs.one,a,b,c);var d=function(){vjs.off(a,b,d),c.apply(this,arguments)};d.guid=c.guid=c.guid||vjs.guid++,vjs.on(a,b,d)};var hasOwnProp=Object.prototype.hasOwnProperty;vjs.createEl=function(a,b){var c;return a=a||"div",b=b||{},c=document.createElement(a),vjs.obj.each(b,function(a,b){a.indexOf("aria-")!==-1||"role"==a?c.setAttribute(a,b):c[a]=b}),c},vjs.capitalize=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},vjs.obj={},vjs.obj.create=Object.create||function(a){function b(){}return b.prototype=a,new b},vjs.obj.each=function(a,b,c){for(var d in a)hasOwnProp.call(a,d)&&b.call(c||this,d,a[d])},vjs.obj.merge=function(a,b){if(!b)return a;for(var c in b)hasOwnProp.call(b,c)&&(a[c]=b[c]);return a},vjs.obj.deepMerge=function(a,b){var c,d,e;a=vjs.obj.copy(a);for(c in b)hasOwnProp.call(b,c)&&(d=a[c],e=b[c],vjs.obj.isPlain(d)&&vjs.obj.isPlain(e)?a[c]=vjs.obj.deepMerge(d,e):a[c]=b[c]);return a},vjs.obj.copy=function(a){return vjs.obj.merge({},a)},vjs.obj.isPlain=function(a){return!!a&&"object"==typeof a&&"[object Object]"===a.toString()&&a.constructor===Object},vjs.obj.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},vjs.isNaN=function(a){return a!==a},vjs.bind=function(a,b,c){b.guid||(b.guid=vjs.guid++);var d=function(){return b.apply(a,arguments)};return d.guid=c?c+"_"+b.guid:b.guid,d},vjs.cache={},vjs.guid=1,vjs.expando="vdata"+(new Date).getTime(),vjs.getData=function(a){var b=a[vjs.expando];return b||(b=a[vjs.expando]=vjs.guid++),vjs.cache[b]||(vjs.cache[b]={}),vjs.cache[b]},vjs.hasData=function(a){var b=a[vjs.expando];return!(!b||vjs.isEmpty(vjs.cache[b]))},vjs.removeData=function(a){var b=a[vjs.expando];if(b){delete vjs.cache[b];try{delete a[vjs.expando]}catch(c){a.removeAttribute?a.removeAttribute(vjs.expando):a[vjs.expando]=null}}},vjs.isEmpty=function(a){for(var b in a)if(null!==a[b])return!1;return!0},vjs.hasClass=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")!==-1},vjs.addClass=function(a,b){vjs.hasClass(a,b)||(a.className=""===a.className?b:a.className+" "+b)},vjs.removeClass=function(a,b){var c,d;if(vjs.hasClass(a,b)){for(c=a.className.split(" "),d=c.length-1;d>=0;d--)c[d]===b&&c.splice(d,1);a.className=c.join(" ")}},vjs.TEST_VID=vjs.createEl("video"),function(){var a=document.createElement("track");a.kind="captions",a.srclang="en",a.label="English",vjs.TEST_VID.appendChild(a)}(),vjs.USER_AGENT=navigator.userAgent,vjs.IS_IPHONE=/iPhone/i.test(vjs.USER_AGENT),vjs.IS_IPAD=/iPad/i.test(vjs.USER_AGENT),vjs.IS_IPOD=/iPod/i.test(vjs.USER_AGENT),vjs.IS_IOS=vjs.IS_IPHONE||vjs.IS_IPAD||vjs.IS_IPOD,vjs.IOS_VERSION=function(){var a=vjs.USER_AGENT.match(/OS (\d+)_/i);if(a&&a[1])return a[1]}(),vjs.IS_ANDROID=/Android/i.test(vjs.USER_AGENT),vjs.ANDROID_VERSION=function(){var a,b,c=vjs.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);return c?(a=c[1]&&parseFloat(c[1]),b=c[2]&&parseFloat(c[2]),a&&b?parseFloat(c[1]+"."+c[2]):a?a:null):null}(),vjs.IS_OLD_ANDROID=vjs.IS_ANDROID&&/webkit/i.test(vjs.USER_AGENT)&&vjs.ANDROID_VERSION<2.3,vjs.IS_FIREFOX=/Firefox/i.test(vjs.USER_AGENT),vjs.IS_CHROME=/Chrome/i.test(vjs.USER_AGENT),vjs.IS_IE8=/MSIE\s8\.0/.test(vjs.USER_AGENT),vjs.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),vjs.BACKGROUND_SIZE_SUPPORTED="backgroundSize"in vjs.TEST_VID.style,vjs.setElementAttributes=function(a,b){vjs.obj.each(b,function(b,c){null===c||"undefined"==typeof c||c===!1?a.removeAttribute(b):a.setAttribute(b,c===!0?"":c)})},vjs.getElementAttributes=function(a){var b,c,d,e,f;if(b={},c=",autoplay,controls,loop,muted,default,",a&&a.attributes&&a.attributes.length>0){d=a.attributes;for(var g=d.length-1;g>=0;g--)e=d[g].name,f=d[g].value,"boolean"!=typeof a[e]&&c.indexOf(","+e+",")===-1||(f=null!==f),b[e]=f}return b},vjs.getComputedDimension=function(a,b){var c="";return document.defaultView&&document.defaultView.getComputedStyle?c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b):a.currentStyle&&(c=a["client"+b.substr(0,1).toUpperCase()+b.substr(1)]+"px"),c},vjs.insertFirst=function(a,b){b.firstChild?b.insertBefore(a,b.firstChild):b.appendChild(a)},vjs.browser={},vjs.el=function(a){return 0===a.indexOf("#")&&(a=a.slice(1)),document.getElementById(a)},vjs.formatTime=function(a,b){b=b||a;var c=Math.floor(a%60),d=Math.floor(a/60%60),e=Math.floor(a/3600),f=Math.floor(b/60%60),g=Math.floor(b/3600);return(isNaN(a)||a===1/0)&&(e=d=c="-"),e=e>0||g>0?e+":":"",d=((e||f>=10)&&d<10?"0"+d:d)+":",c=c<10?"0"+c:c,e+d+c},vjs.blockTextSelection=function(){document.body.focus(),document.onselectstart=function(){return!1}},vjs.unblockTextSelection=function(){document.onselectstart=function(){return!0}},vjs.trim=function(a){return(a+"").replace(/^\s+|\s+$/g,"")},vjs.round=function(a,b){return b||(b=0),Math.round(a*Math.pow(10,b))/Math.pow(10,b)},vjs.createTimeRange=function(a,b){return{length:1,start:function(){return a},end:function(){return b}}},vjs.setLocalStorage=function(a,b){try{var c=window.localStorage||!1;if(!c)return;c[a]=b}catch(d){22==d.code||1014==d.code?vjs.log("LocalStorage Full (VideoJS)",d):18==d.code?vjs.log("LocalStorage not allowed (VideoJS)",d):vjs.log("LocalStorage Error (VideoJS)",d)}},vjs.getAbsoluteURL=function(a){return a.match(/^https?:\/\//)||(a=vjs.createEl("div",{innerHTML:'<a href="'+a+'">x</a>'}).firstChild.href),a},vjs.parseUrl=function(a){var b,c,d,e,f;e=["protocol","hostname","port","pathname","search","hash","host"],c=vjs.createEl("a",{href:a}),d=""===c.host&&"file:"!==c.protocol,d&&(b=vjs.createEl("div"),b.innerHTML='<a href="'+a+'"></a>',c=b.firstChild,b.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(b)),f={};for(var g=0;g<e.length;g++)f[e[g]]=c[e[g]];return"http:"===f.protocol&&(f.host=f.host.replace(/:80$/,"")),"https:"===f.protocol&&(f.host=f.host.replace(/:443$/,"")),d&&document.body.removeChild(b),f},vjs.log=function(){_logType(null,arguments)},vjs.log.history=[],vjs.log.error=function(){_logType("error",arguments)},vjs.log.warn=function(){_logType("warn",arguments)},vjs.findPosition=function(a){var b,c,d,e,f,g,h,i,j;return a.getBoundingClientRect&&a.parentNode&&(b=a.getBoundingClientRect()),b?(c=document.documentElement,d=document.body,e=c.clientLeft||d.clientLeft||0,f=window.pageXOffset||d.scrollLeft,g=b.left+f-e,h=c.clientTop||d.clientTop||0,i=window.pageYOffset||d.scrollTop,j=b.top+i-h,{left:vjs.round(g),top:vjs.round(j)}):{left:0,top:0}},vjs.arr={},vjs.arr.forEach=function(a,b,c){if(vjs.obj.isArray(a)&&b instanceof Function)for(var d=0,e=a.length;d<e;++d)b.call(c||vjs,a[d],d,a);return a},vjs.xhr=function(a,b){var c,d,e,f,g,h,i,j,k;"string"==typeof a&&(a={uri:a}),videojs.util.mergeOptions({method:"GET",timeout:45e3},a),b=b||function(){},j=function(){window.clearTimeout(i),b(null,d,d.response||d.responseText)},k=function(a){window.clearTimeout(i),a&&"string"!=typeof a||(a=new Error(a)),b(a,d)},c=window.XMLHttpRequest,"undefined"==typeof c&&(c=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(c){}throw new Error("This browser does not support XMLHttpRequest.")}),d=new c,d.uri=a.uri,e=vjs.parseUrl(a.uri),f=window.location,h=e.protocol+e.host!==f.protocol+f.host,!h||!window.XDomainRequest||"withCredentials"in d?(g="file:"==e.protocol||"file:"==f.protocol,d.onreadystatechange=function(){if(4===d.readyState){if(d.timedout)return k("timeout");200===d.status||g&&0===d.status?j():k()}},a.timeout&&(i=window.setTimeout(function(){4!==d.readyState&&(d.timedout=!0,d.abort())},a.timeout))):(d=new window.XDomainRequest,d.onload=j,d.onerror=k,d.onprogress=function(){},d.ontimeout=function(){});try{d.open(a.method||"GET",a.uri,!0)}catch(l){return k(l)}a.withCredentials&&(d.withCredentials=!0),
a.responseType&&(d.responseType=a.responseType);try{d.send()}catch(l){return k(l)}return d},vjs.util={},vjs.util.mergeOptions=function(a,b){var c,d,e;a=vjs.obj.copy(a);for(c in b)b.hasOwnProperty(c)&&(d=a[c],e=b[c],vjs.obj.isPlain(d)&&vjs.obj.isPlain(e)?a[c]=vjs.util.mergeOptions(d,e):a[c]=b[c]);return a},vjs.EventEmitter=function(){},vjs.EventEmitter.prototype.allowedEvents_={},vjs.EventEmitter.prototype.on=function(a,b){var c=this.addEventListener;this.addEventListener=Function.prototype,vjs.on(this,a,b),this.addEventListener=c},vjs.EventEmitter.prototype.addEventListener=vjs.EventEmitter.prototype.on,vjs.EventEmitter.prototype.off=function(a,b){vjs.off(this,a,b)},vjs.EventEmitter.prototype.removeEventListener=vjs.EventEmitter.prototype.off,vjs.EventEmitter.prototype.one=function(a,b){vjs.one(this,a,b)},vjs.EventEmitter.prototype.trigger=function(a){var b=a.type||a;"string"==typeof a&&(a={type:b}),a=vjs.fixEvent(a),this.allowedEvents_[b]&&this["on"+b]&&this["on"+b](a),vjs.trigger(this,a)},vjs.EventEmitter.prototype.dispatchEvent=vjs.EventEmitter.prototype.trigger,vjs.Component=vjs.CoreObject.extend({init:function(a,b,c){this.player_=a,this.options_=vjs.obj.copy(this.options_),b=this.options(b),this.id_=b.id||b.el&&b.el.id,this.id_||(this.id_=(a.id&&a.id()||"no_player")+"_component_"+vjs.guid++),this.name_=b.name||null,this.el_=b.el||this.createEl(),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.initChildren(),this.ready(c),b.reportTouchActivity!==!1&&this.enableTouchActivity()}}),vjs.Component.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var a=this.children_.length-1;a>=0;a--)this.children_[a].dispose&&this.children_[a].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),vjs.removeData(this.el_),this.el_=null},vjs.Component.prototype.player_=!0,vjs.Component.prototype.player=function(){return this.player_},vjs.Component.prototype.options_,vjs.Component.prototype.options=function(a){return void 0===a?this.options_:this.options_=vjs.util.mergeOptions(this.options_,a)},vjs.Component.prototype.el_,vjs.Component.prototype.createEl=function(a,b){return vjs.createEl(a,b)},vjs.Component.prototype.localize=function(a){var b=this.player_.language(),c=this.player_.languages();return c&&c[b]&&c[b][a]?c[b][a]:a},vjs.Component.prototype.el=function(){return this.el_},vjs.Component.prototype.contentEl_,vjs.Component.prototype.contentEl=function(){return this.contentEl_||this.el_},vjs.Component.prototype.id_,vjs.Component.prototype.id=function(){return this.id_},vjs.Component.prototype.name_,vjs.Component.prototype.name=function(){return this.name_},vjs.Component.prototype.children_,vjs.Component.prototype.children=function(){return this.children_},vjs.Component.prototype.childIndex_,vjs.Component.prototype.getChildById=function(a){return this.childIndex_[a]},vjs.Component.prototype.childNameIndex_,vjs.Component.prototype.getChild=function(a){return this.childNameIndex_[a]},vjs.Component.prototype.addChild=function(a,b){var c,d,e;return"string"==typeof a?(e=a,b=b||{},d=b.componentClass||vjs.capitalize(e),b.name=e,c=new window.videojs[d](this.player_||this,b)):c=a,this.children_.push(c),"function"==typeof c.id&&(this.childIndex_[c.id()]=c),e=e||c.name&&c.name(),e&&(this.childNameIndex_[e]=c),"function"==typeof c.el&&c.el()&&this.contentEl().appendChild(c.el()),c},vjs.Component.prototype.removeChild=function(a){if("string"==typeof a&&(a=this.getChild(a)),a&&this.children_){for(var b=!1,c=this.children_.length-1;c>=0;c--)if(this.children_[c]===a){b=!0,this.children_.splice(c,1);break}if(b){this.childIndex_[a.id()]=null,this.childNameIndex_[a.name()]=null;var d=a.el();d&&d.parentNode===this.contentEl()&&this.contentEl().removeChild(a.el())}}},vjs.Component.prototype.initChildren=function(){var a,b,c,d,e,f,g;if(a=this,b=a.options(),c=b.children)if(g=function(c,d){void 0!==b[c]&&(d=b[c]),d!==!1&&(a[c]=a.addChild(c,d))},vjs.obj.isArray(c))for(var h=0;h<c.length;h++)d=c[h],"string"==typeof d?(e=d,f={}):(e=d.name,f=d),g(e,f);else vjs.obj.each(c,g)},vjs.Component.prototype.buildCSSClass=function(){return""},vjs.Component.prototype.on=function(a,b,c){var d,e,f,g,h,i;return"string"==typeof a||vjs.obj.isArray(a)?vjs.on(this.el_,a,vjs.bind(this,b)):(d=a,e=b,f=vjs.bind(this,c),i=this,g=function(){i.off(d,e,f)},g.guid=f.guid,this.on("dispose",g),h=function(){i.off("dispose",g)},h.guid=f.guid,a.nodeName?(vjs.on(d,e,f),vjs.on(d,"dispose",h)):"function"==typeof a.on&&(d.on(e,f),d.on("dispose",h))),this},vjs.Component.prototype.off=function(a,b,c){var d,e,f;return!a||"string"==typeof a||vjs.obj.isArray(a)?vjs.off(this.el_,a,b):(d=a,e=b,f=vjs.bind(this,c),this.off("dispose",f),a.nodeName?(vjs.off(d,e,f),vjs.off(d,"dispose",f)):(d.off(e,f),d.off("dispose",f))),this},vjs.Component.prototype.one=function(a,b,c){var d,e,f,g,h;return"string"==typeof a||vjs.obj.isArray(a)?vjs.one(this.el_,a,vjs.bind(this,b)):(d=a,e=b,f=vjs.bind(this,c),g=this,h=function(){g.off(d,e,h),f.apply(this,arguments)},h.guid=f.guid,this.on(d,e,h)),this},vjs.Component.prototype.trigger=function(a){return vjs.trigger(this.el_,a),this},vjs.Component.prototype.isReady_,vjs.Component.prototype.isReadyOnInitFinish_=!0,vjs.Component.prototype.readyQueue_,vjs.Component.prototype.ready=function(a){return a&&(this.isReady_?a.call(this):(void 0===this.readyQueue_&&(this.readyQueue_=[]),this.readyQueue_.push(a))),this},vjs.Component.prototype.triggerReady=function(){this.isReady_=!0;var a=this.readyQueue_;if(a&&a.length>0){for(var b=0,c=a.length;b<c;b++)a[b].call(this);this.readyQueue_=[],this.trigger("ready")}},vjs.Component.prototype.hasClass=function(a){return vjs.hasClass(this.el_,a)},vjs.Component.prototype.addClass=function(a){return vjs.addClass(this.el_,a),this},vjs.Component.prototype.removeClass=function(a){return vjs.removeClass(this.el_,a),this},vjs.Component.prototype.show=function(){return this.removeClass("vjs-hidden"),this},vjs.Component.prototype.hide=function(){return this.addClass("vjs-hidden"),this},vjs.Component.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},vjs.Component.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},vjs.Component.prototype.disable=function(){this.hide(),this.show=function(){}},vjs.Component.prototype.width=function(a,b){return this.dimension("width",a,b)},vjs.Component.prototype.height=function(a,b){return this.dimension("height",a,b)},vjs.Component.prototype.dimensions=function(a,b){return this.width(a,!0).height(b)},vjs.Component.prototype.dimension=function(a,b,c){if(void 0!==b)return(null===b||vjs.isNaN(b))&&(b=0),(""+b).indexOf("%")!==-1||(""+b).indexOf("px")!==-1?this.el_.style[a]=b:"auto"===b?this.el_.style[a]="":this.el_.style[a]=b+"px",c||this.trigger("resize"),this;if(!this.el_)return 0;var d=this.el_.style[a],e=d.indexOf("px");return e!==-1?parseInt(d.slice(0,e),10):parseInt(this.el_["offset"+vjs.capitalize(a)],10)},vjs.Component.prototype.onResize,vjs.Component.prototype.emitTapEvents=function(){var a,b,c,d,e,f,g,h,i,j;a=0,b=null,i=10,j=200,this.on("touchstart",function(c){1===c.touches.length&&(b=vjs.obj.copy(c.touches[0]),a=(new Date).getTime(),d=!0)}),this.on("touchmove",function(a){a.touches.length>1?d=!1:b&&(f=a.touches[0].pageX-b.pageX,g=a.touches[0].pageY-b.pageY,h=Math.sqrt(f*f+g*g),h>i&&(d=!1))}),e=function(){d=!1},this.on("touchleave",e),this.on("touchcancel",e),this.on("touchend",function(e){b=null,d===!0&&(c=(new Date).getTime()-a,c<j&&(e.preventDefault(),this.trigger("tap")))})},vjs.Component.prototype.enableTouchActivity=function(){var a,b,c;this.player().reportUserActivity&&(a=vjs.bind(this.player(),this.player().reportUserActivity),this.on("touchstart",function(){a(),this.clearInterval(b),b=this.setInterval(a,250)}),c=function(c){a(),this.clearInterval(b)},this.on("touchmove",a),this.on("touchend",c),this.on("touchcancel",c))},vjs.Component.prototype.setTimeout=function(a,b){a=vjs.bind(this,a);var c=setTimeout(a,b),d=function(){this.clearTimeout(c)};return d.guid="vjs-timeout-"+c,this.on("dispose",d),c},vjs.Component.prototype.clearTimeout=function(a){clearTimeout(a);var b=function(){};return b.guid="vjs-timeout-"+a,this.off("dispose",b),a},vjs.Component.prototype.setInterval=function(a,b){a=vjs.bind(this,a);var c=setInterval(a,b),d=function(){this.clearInterval(c)};return d.guid="vjs-interval-"+c,this.on("dispose",d),c},vjs.Component.prototype.clearInterval=function(a){clearInterval(a);var b=function(){};return b.guid="vjs-interval-"+a,this.off("dispose",b),a},vjs.Button=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.emitTapEvents(),this.on("tap",this.onClick),this.on("click",this.onClick),this.on("focus",this.onFocus),this.on("blur",this.onBlur)}}),vjs.Button.prototype.createEl=function(a,b){var c;return b=vjs.obj.merge({className:this.buildCSSClass(),role:"button","aria-live":"polite",tabIndex:0},b),c=vjs.Component.prototype.createEl.call(this,a,b),b.innerHTML||(this.contentEl_=vjs.createEl("div",{className:"vjs-control-content"}),this.controlText_=vjs.createEl("span",{className:"vjs-control-text",innerHTML:this.localize(this.buttonText)||"Need Text"}),this.contentEl_.appendChild(this.controlText_),c.appendChild(this.contentEl_)),c},vjs.Button.prototype.buildCSSClass=function(){return"vjs-control "+vjs.Component.prototype.buildCSSClass.call(this)},vjs.Button.prototype.onClick=function(){},vjs.Button.prototype.onFocus=function(){vjs.on(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Button.prototype.onKeyPress=function(a){32!=a.which&&13!=a.which||(a.preventDefault(),this.onClick())},vjs.Button.prototype.onBlur=function(){vjs.off(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Slider=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.bar=this.getChild(this.options_.barName),this.handle=this.getChild(this.options_.handleName),this.on("mousedown",this.onMouseDown),this.on("touchstart",this.onMouseDown),this.on("focus",this.onFocus),this.on("blur",this.onBlur),this.on("click",this.onClick),this.on(a,"controlsvisible",this.update),this.on(a,this.playerEvent,this.update)}}),vjs.Slider.prototype.createEl=function(a,b){return b=b||{},b.className=b.className+" vjs-slider",b=vjs.obj.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},b),vjs.Component.prototype.createEl.call(this,a,b)},vjs.Slider.prototype.onMouseDown=function(a){a.preventDefault(),vjs.blockTextSelection(),this.addClass("vjs-sliding"),this.on(document,"mousemove",this.onMouseMove),this.on(document,"mouseup",this.onMouseUp),this.on(document,"touchmove",this.onMouseMove),this.on(document,"touchend",this.onMouseUp),this.onMouseMove(a)},vjs.Slider.prototype.onMouseMove=function(){},vjs.Slider.prototype.onMouseUp=function(){vjs.unblockTextSelection(),this.removeClass("vjs-sliding"),this.off(document,"mousemove",this.onMouseMove),this.off(document,"mouseup",this.onMouseUp),this.off(document,"touchmove",this.onMouseMove),this.off(document,"touchend",this.onMouseUp),this.update()},vjs.Slider.prototype.update=function(){if(this.el_){var a,b=this.getPercent(),c=this.handle,d=this.bar;if(("number"!=typeof b||b!==b||b<0||b===1/0)&&(b=0),a=b,c){var e=this.el_,f=e.offsetWidth,g=c.el().offsetWidth,h=g?g/f:0,i=1-h,j=b*i;a=j+h/2,c.el().style.left=vjs.round(100*j,2)+"%"}d&&(d.el().style.width=vjs.round(100*a,2)+"%")}},vjs.Slider.prototype.calculateDistance=function(a){var b,c,d,e,f,g,h,i,j;if(b=this.el_,c=vjs.findPosition(b),f=g=b.offsetWidth,h=this.handle,this.options().vertical){if(e=c.top,j=a.changedTouches?a.changedTouches[0].pageY:a.pageY,h){var k=h.el().offsetHeight;e+=k/2,g-=k}return Math.max(0,Math.min(1,(e-j+g)/g))}if(d=c.left,i=a.changedTouches?a.changedTouches[0].pageX:a.pageX,h){var l=h.el().offsetWidth;d+=l/2,f-=l}return Math.max(0,Math.min(1,(i-d)/f))},vjs.Slider.prototype.onFocus=function(){this.on(document,"keydown",this.onKeyPress)},vjs.Slider.prototype.onKeyPress=function(a){37==a.which||40==a.which?(a.preventDefault(),this.stepBack()):38!=a.which&&39!=a.which||(a.preventDefault(),this.stepForward())},vjs.Slider.prototype.onBlur=function(){this.off(document,"keydown",this.onKeyPress)},vjs.Slider.prototype.onClick=function(a){a.stopImmediatePropagation(),a.preventDefault()},vjs.SliderHandle=vjs.Component.extend(),vjs.SliderHandle.prototype.defaultValue=0,vjs.SliderHandle.prototype.createEl=function(a,b){return b=b||{},b.className=b.className+" vjs-slider-handle",b=vjs.obj.merge({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"</span>"},b),vjs.Component.prototype.createEl.call(this,"div",b)},vjs.Menu=vjs.Component.extend(),vjs.Menu.prototype.addItem=function(a){this.addChild(a),a.on("click",vjs.bind(this,function(){this.unlockShowing()}))},vjs.Menu.prototype.createEl=function(){var a=this.options().contentElType||"ul";this.contentEl_=vjs.createEl(a,{className:"vjs-menu-content"});var b=vjs.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return b.appendChild(this.contentEl_),vjs.on(b,"click",function(a){a.preventDefault(),a.stopImmediatePropagation()}),b},vjs.MenuItem=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.selected(b.selected)}}),vjs.MenuItem.prototype.createEl=function(a,b){return vjs.Button.prototype.createEl.call(this,"li",vjs.obj.merge({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label)},b))},vjs.MenuItem.prototype.onClick=function(){this.selected(!0)},vjs.MenuItem.prototype.selected=function(a){a?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},vjs.MenuButton=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.update(),this.on("keydown",this.onKeyPress),this.el_.setAttribute("aria-haspopup",!0),this.el_.setAttribute("role","button")}}),vjs.MenuButton.prototype.update=function(){var a=this.createMenu();this.menu&&this.removeChild(this.menu),this.menu=a,this.addChild(a),this.items&&0===this.items.length?this.hide():this.items&&this.items.length>1&&this.show()},vjs.MenuButton.prototype.buttonPressed_=!1,vjs.MenuButton.prototype.createMenu=function(){var a=new vjs.Menu(this.player_);if(this.options().title&&a.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.options().title),tabindex:-1})),this.items=this.createItems(),this.items)for(var b=0;b<this.items.length;b++)a.addItem(this.items[b]);return a},vjs.MenuButton.prototype.createItems=function(){},vjs.MenuButton.prototype.buildCSSClass=function(){return this.className+" vjs-menu-button "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.MenuButton.prototype.onFocus=function(){},vjs.MenuButton.prototype.onBlur=function(){},vjs.MenuButton.prototype.onClick=function(){this.one("mouseout",vjs.bind(this,function(){this.menu.unlockShowing(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},vjs.MenuButton.prototype.onKeyPress=function(a){32==a.which||13==a.which?(this.buttonPressed_?this.unpressButton():this.pressButton(),a.preventDefault()):27==a.which&&(this.buttonPressed_&&this.unpressButton(),a.preventDefault())},vjs.MenuButton.prototype.pressButton=function(){this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-pressed",!0),this.items&&this.items.length>0&&this.items[0].el().focus()},vjs.MenuButton.prototype.unpressButton=function(){this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-pressed",!1)},vjs.MediaError=function(a){"number"==typeof a?this.code=a:"string"==typeof a?this.message=a:"object"==typeof a&&vjs.obj.merge(this,a),this.message||(this.message=vjs.MediaError.defaultMessages[this.code]||"")},vjs.MediaError.prototype.code=0,vjs.MediaError.prototype.message="",vjs.MediaError.prototype.status=null,vjs.MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],vjs.MediaError.defaultMessages={1:"You aborted the video playback",2:"A network error caused the video download to fail part-way.",3:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",4:"The video could not be loaded, either because the server or network failed or because the format is not supported.",5:"The video is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<vjs.MediaError.errorTypes.length;errNum++)vjs.MediaError[vjs.MediaError.errorTypes[errNum]]=errNum,vjs.MediaError.prototype[vjs.MediaError.errorTypes[errNum]]=errNum;if(function(){var a,b,c,d;for(vjs.browser.fullscreenAPI,a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],b=a[0],d=0;d<a.length;d++)if(a[d][1]in document){c=a[d];break}if(c)for(vjs.browser.fullscreenAPI={},d=0;d<c.length;d++)vjs.browser.fullscreenAPI[b[d]]=c[d]}(),vjs.Player=vjs.Component.extend({init:function(a,b,c){this.tag=a,a.id=a.id||"vjs_video_"+vjs.guid++,this.tagAttributes=a&&vjs.getElementAttributes(a),b=vjs.obj.merge(this.getTagSettings(a),b),this.language_=b.language||vjs.options.language,this.languages_=b.languages||vjs.options.languages,this.cache_={},this.poster_=b.poster||"",this.controls_=!!b.controls,a.controls=!1,b.reportTouchActivity=!1,this.isAudio("audio"===this.tag.nodeName.toLowerCase()),vjs.Component.call(this,this,b,c),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.isAudio()&&this.addClass("vjs-audio"),vjs.players[this.id_]=this,b.plugins&&vjs.obj.each(b.plugins,function(a,b){this[a](b)},this),this.listenForUserActivity()}}),vjs.Player.prototype.language_,vjs.Player.prototype.language=function(a){return void 0===a?this.language_:(this.language_=a,this)},vjs.Player.prototype.languages_,vjs.Player.prototype.languages=function(){return this.languages_},vjs.Player.prototype.options_=vjs.options,vjs.Player.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),vjs.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech&&this.tech.dispose(),vjs.Component.prototype.dispose.call(this)},vjs.Player.prototype.getTagSettings=function(a){var b,c,d={sources:[],tracks:[]};if(b=vjs.getElementAttributes(a),c=b["data-setup"],null!==c&&vjs.obj.merge(b,vjs.JSON.parse(c||"{}")),vjs.obj.merge(d,b),a.hasChildNodes()){var e,f,g,h,i;for(e=a.childNodes,h=0,i=e.length;h<i;h++)f=e[h],g=f.nodeName.toLowerCase(),"source"===g?d.sources.push(vjs.getElementAttributes(f)):"track"===g&&d.tracks.push(vjs.getElementAttributes(f))}return d},vjs.Player.prototype.createEl=function(){var a,b=this.el_=vjs.Component.prototype.createEl.call(this,"div"),c=this.tag;return c.removeAttribute("width"),c.removeAttribute("height"),a=vjs.getElementAttributes(c),vjs.obj.each(a,function(c){"class"==c?b.className=a[c]:b.setAttribute(c,a[c])}),c.id+="_html5_api",c.className="vjs-tech",c.player=b.player=this,this.addClass("vjs-paused"),this.width(this.options_.width,!0),this.height(this.options_.height,!0),c.initNetworkState_=c.networkState,c.parentNode&&c.parentNode.insertBefore(b,c),vjs.insertFirst(c,b),this.el_=b,this.on("loadstart",this.onLoadStart),this.on("waiting",this.onWaiting),this.on(["canplay","canplaythrough","playing","ended"],this.onWaitEnd),this.on("seeking",this.onSeeking),this.on("seeked",this.onSeeked),this.on("ended",this.onEnded),this.on("play",this.onPlay),this.on("firstplay",this.onFirstPlay),this.on("pause",this.onPause),this.on("progress",this.onProgress),this.on("durationchange",this.onDurationChange),this.on("fullscreenchange",this.onFullscreenChange),b},vjs.Player.prototype.loadTech=function(a,b){this.tech&&this.unloadTech(),"Html5"!==a&&this.tag&&(vjs.Html5.disposeMediaElement(this.tag),this.tag=null),this.techName=a,this.isReady_=!1;var c=function(){this.player_.triggerReady()},d=vjs.obj.merge({source:b,parentEl:this.el_},this.options_[a.toLowerCase()]);b&&(this.currentType_=b.type,b.src==this.cache_.src&&this.cache_.currentTime>0&&(d.startTime=this.cache_.currentTime),this.cache_.src=b.src),this.tech=new window.videojs[a](this,d),this.tech.ready(c)},vjs.Player.prototype.unloadTech=function(){this.isReady_=!1,this.tech.dispose(),this.tech=!1},vjs.Player.prototype.onLoadStart=function(){this.removeClass("vjs-ended"),this.error(null),this.paused()?this.hasStarted(!1):this.trigger("firstplay")},vjs.Player.prototype.hasStarted_=!1,vjs.Player.prototype.hasStarted=function(a){return void 0!==a?(this.hasStarted_!==a&&(this.hasStarted_=a,a?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):this.hasStarted_},vjs.Player.prototype.onLoadedMetaData,vjs.Player.prototype.onLoadedData,vjs.Player.prototype.onLoadedAllData,vjs.Player.prototype.onPlay=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0)},vjs.Player.prototype.onWaiting=function(){this.addClass("vjs-waiting")},vjs.Player.prototype.onWaitEnd=function(){this.removeClass("vjs-waiting")},vjs.Player.prototype.onSeeking=function(){this.addClass("vjs-seeking")},vjs.Player.prototype.onSeeked=function(){this.removeClass("vjs-seeking")},vjs.Player.prototype.onFirstPlay=function(){this.options_.starttime&&this.currentTime(this.options_.starttime),this.addClass("vjs-has-started")},vjs.Player.prototype.onPause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused")},vjs.Player.prototype.onTimeUpdate,vjs.Player.prototype.onProgress=function(){1==this.bufferedPercent()&&this.trigger("loadedalldata")},vjs.Player.prototype.onEnded=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause()},vjs.Player.prototype.onDurationChange=function(){var a=this.techGet("duration");a&&(a<0&&(a=1/0),this.duration(a),a===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"))},vjs.Player.prototype.onVolumeChange,vjs.Player.prototype.onFullscreenChange=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},vjs.Player.prototype.onError,vjs.Player.prototype.cache_,vjs.Player.prototype.getCache=function(){return this.cache_},vjs.Player.prototype.techCall=function(a,b){if(this.tech&&!this.tech.isReady_)this.tech.ready(function(){this[a](b)});else try{this.tech[a](b)}catch(c){throw vjs.log(c),c}},vjs.Player.prototype.techGet=function(a){if(this.tech&&this.tech.isReady_)try{return this.tech[a]()}catch(b){throw void 0===this.tech[a]?vjs.log("Video.js: "+a+" method not defined for "+this.techName+" playback technology.",b):"TypeError"==b.name?(vjs.log("Video.js: "+a+" unavailable on "+this.techName+" playback technology element.",b),this.tech.isReady_=!1):vjs.log(b),b}},vjs.Player.prototype.play=function(){return this.techCall("play"),this},vjs.Player.prototype.pause=function(){return this.techCall("pause"),this},vjs.Player.prototype.paused=function(){return this.techGet("paused")!==!1},vjs.Player.prototype.currentTime=function(a){return void 0!==a?(this.techCall("setCurrentTime",a),this):this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(a){return void 0!==a?(this.cache_.duration=parseFloat(a),this):(void 0===this.cache_.duration&&this.onDurationChange(),this.cache_.duration||0)},vjs.Player.prototype.remainingTime=function(){return this.duration()-this.currentTime()},vjs.Player.prototype.buffered=function(){var a=this.techGet("buffered");return a&&a.length||(a=vjs.createTimeRange(0,0)),a},vjs.Player.prototype.bufferedPercent=function(){var a,b,c=this.duration(),d=this.buffered(),e=0;if(!c)return 0;for(var f=0;f<d.length;f++)a=d.start(f),b=d.end(f),b>c&&(b=c),e+=b-a;return e/c},vjs.Player.prototype.bufferedEnd=function(){var a=this.buffered(),b=this.duration(),c=a.end(a.length-1);return c>b&&(c=b),c},vjs.Player.prototype.volume=function(a){var b;return void 0!==a?(b=Math.max(0,Math.min(1,parseFloat(a))),this.cache_.volume=b,this.techCall("setVolume",b),vjs.setLocalStorage("volume",b),this):(b=parseFloat(this.techGet("volume")),isNaN(b)?1:b)},vjs.Player.prototype.muted=function(a){return void 0!==a?(this.techCall("setMuted",a),this):this.techGet("muted")||!1},vjs.Player.prototype.supportsFullScreen=function(){return this.techGet("supportsFullScreen")||!1},vjs.Player.prototype.isFullscreen_=!1,vjs.Player.prototype.isFullscreen=function(a){return void 0!==a?(this.isFullscreen_=!!a,this):this.isFullscreen_},vjs.Player.prototype.isFullScreen=function(a){return vjs.log.warn('player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase "s")'),this.isFullscreen(a)},vjs.Player.prototype.requestFullscreen=function(){var a=vjs.browser.fullscreenAPI;return this.isFullscreen(!0),a?(vjs.on(document,a.fullscreenchange,vjs.bind(this,function(b){this.isFullscreen(document[a.fullscreenElement]),this.isFullscreen()===!1&&vjs.off(document,a.fullscreenchange,arguments.callee),this.trigger("fullscreenchange")})),this.el_[a.requestFullscreen]()):this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.requestFullScreen=function(){return vjs.log.warn('player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase "s")'),this.requestFullscreen()},vjs.Player.prototype.exitFullscreen=function(){var a=vjs.browser.fullscreenAPI;return this.isFullscreen(!1),a?document[a.exitFullscreen]():this.tech.supportsFullScreen()?this.techCall("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.cancelFullScreen=function(){return vjs.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()"),this.exitFullscreen()},vjs.Player.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,vjs.on(document,"keydown",vjs.bind(this,this.fullWindowOnEscKey)),document.documentElement.style.overflow="hidden",vjs.addClass(document.body,"vjs-full-window"),this.trigger("enterFullWindow")},vjs.Player.prototype.fullWindowOnEscKey=function(a){27===a.keyCode&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},vjs.Player.prototype.exitFullWindow=function(){this.isFullWindow=!1,vjs.off(document,"keydown",this.fullWindowOnEscKey),document.documentElement.style.overflow=this.docOrigOverflow,vjs.removeClass(document.body,"vjs-full-window"),this.trigger("exitFullWindow")},vjs.Player.prototype.selectSource=function(a){for(var b=0,c=this.options_.techOrder;b<c.length;b++){var d=vjs.capitalize(c[b]),e=window.videojs[d];if(e){if(e.isSupported())for(var f=0,g=a;f<g.length;f++){var h=g[f];if(e.canPlaySource(h))return{source:h,tech:d}}}else vjs.log.error('The "'+d+'" tech is undefined. Skipped browser support check for that tech.')}return!1},vjs.Player.prototype.src=function(a){return void 0===a?this.techGet("src"):(vjs.obj.isArray(a)?this.sourceList_(a):"string"==typeof a?this.src({src:a}):a instanceof Object&&(a.type&&!window.videojs[this.techName].canPlaySource(a)?this.sourceList_([a]):(this.cache_.src=a.src,this.currentType_=a.type||"",this.ready(function(){window.videojs[this.techName].prototype.hasOwnProperty("setSource")?this.techCall("setSource",a):this.techCall("src",a.src),"auto"==this.options_.preload&&this.load(),this.options_.autoplay&&this.play()}))),this)},vjs.Player.prototype.sourceList_=function(a){var b=this.selectSource(a);b?b.tech===this.techName?this.src(b.source):this.loadTech(b.tech,b.source):(this.setTimeout(function(){this.error({code:4,message:this.localize(this.options().notSupportedMessage)})},0),this.triggerReady())},vjs.Player.prototype.load=function(){return this.techCall("load"),this},vjs.Player.prototype.currentSrc=function(){return this.techGet("currentSrc")||this.cache_.src||""},vjs.Player.prototype.currentType=function(){return this.currentType_||""},vjs.Player.prototype.preload=function(a){return void 0!==a?(this.techCall("setPreload",a),this.options_.preload=a,this):this.techGet("preload")},vjs.Player.prototype.autoplay=function(a){return void 0!==a?(this.techCall("setAutoplay",a),this.options_.autoplay=a,this):this.techGet("autoplay",a)},vjs.Player.prototype.loop=function(a){return void 0!==a?(this.techCall("setLoop",a),this.options_.loop=a,this):this.techGet("loop")},vjs.Player.prototype.poster_,vjs.Player.prototype.poster=function(a){return void 0===a?this.poster_:(a||(a=""),this.poster_=a,this.techCall("setPoster",a),this.trigger("posterchange"),this)},vjs.Player.prototype.controls_,vjs.Player.prototype.controls=function(a){return void 0!==a?(a=!!a,this.controls_!==a&&(this.controls_=a,a?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled")):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"))),this):this.controls_},vjs.Player.prototype.usingNativeControls_,vjs.Player.prototype.usingNativeControls=function(a){return void 0!==a?(a=!!a,this.usingNativeControls_!==a&&(this.usingNativeControls_=a,a?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):this.usingNativeControls_},vjs.Player.prototype.error_=null,vjs.Player.prototype.error=function(a){return void 0===a?this.error_:null===a?(this.error_=a,this.removeClass("vjs-error"),this):(a instanceof vjs.MediaError?this.error_=a:this.error_=new vjs.MediaError(a),this.trigger("error"),this.addClass("vjs-error"),vjs.log.error("(CODE:"+this.error_.code+" "+vjs.MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this)},vjs.Player.prototype.ended=function(){return this.techGet("ended")},vjs.Player.prototype.seeking=function(){return this.techGet("seeking")},vjs.Player.prototype.userActivity_=!0,vjs.Player.prototype.reportUserActivity=function(a){this.userActivity_=!0},vjs.Player.prototype.userActive_=!0,vjs.Player.prototype.userActive=function(a){return void 0!==a?(a=!!a,a!==this.userActive_&&(this.userActive_=a,a?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech&&this.tech.one("mousemove",function(a){a.stopPropagation(),a.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},vjs.Player.prototype.listenForUserActivity=function(){var a,b,c,d,e,f,g,h,i;a=vjs.bind(this,this.reportUserActivity),b=function(b){b.screenX==h&&b.screenY==i||(h=b.screenX,i=b.screenY,a())},c=function(){a(),this.clearInterval(d),d=this.setInterval(a,250)},e=function(b){a(),this.clearInterval(d)},this.on("mousedown",c),this.on("mousemove",b),this.on("mouseup",e),this.on("keydown",a),this.on("keyup",a),f=this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(g);var a=this.options().inactivityTimeout;a>0&&(g=this.setTimeout(function(){this.userActivity_||this.userActive(!1);
},a))}},250)},vjs.Player.prototype.playbackRate=function(a){return void 0!==a?(this.techCall("setPlaybackRate",a),this):this.tech&&this.tech.featuresPlaybackRate?this.techGet("playbackRate"):1},vjs.Player.prototype.isAudio_=!1,vjs.Player.prototype.isAudio=function(a){return void 0!==a?(this.isAudio_=!!a,this):this.isAudio_},vjs.Player.prototype.networkState=function(){return this.techGet("networkState")},vjs.Player.prototype.readyState=function(){return this.techGet("readyState")},vjs.Player.prototype.textTracks=function(){return this.tech&&this.tech.textTracks()},vjs.Player.prototype.remoteTextTracks=function(){return this.tech&&this.tech.remoteTextTracks()},vjs.Player.prototype.addTextTrack=function(a,b,c){return this.tech&&this.tech.addTextTrack(a,b,c)},vjs.Player.prototype.addRemoteTextTrack=function(a){return this.tech&&this.tech.addRemoteTextTrack(a)},vjs.Player.prototype.removeRemoteTextTrack=function(a){this.tech&&this.tech.removeRemoteTextTrack(a)},vjs.ControlBar=vjs.Component.extend(),vjs.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{},playbackRateMenuButton:{},subtitlesButton:{},captionsButton:{},chaptersButton:{}}},vjs.ControlBar.prototype.createEl=function(){return vjs.createEl("div",{className:"vjs-control-bar"})},vjs.LiveDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.LiveDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-live-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE"),"aria-live":"off"}),a.appendChild(this.contentEl_),a},vjs.PlayToggle=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.on(a,"play",this.onPlay),this.on(a,"pause",this.onPause)}}),vjs.PlayToggle.prototype.buttonText="Play",vjs.PlayToggle.prototype.buildCSSClass=function(){return"vjs-play-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.PlayToggle.prototype.onClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},vjs.PlayToggle.prototype.onPlay=function(){this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.el_.children[0].children[0].innerHTML=this.localize("Pause")},vjs.PlayToggle.prototype.onPause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.el_.children[0].children[0].innerHTML=this.localize("Play")},vjs.CurrentTimeDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.on(a,"timeupdate",this.updateContent)}}),vjs.CurrentTimeDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00',"aria-live":"off"}),a.appendChild(this.contentEl_),a},vjs.CurrentTimeDisplay.prototype.updateContent=function(){var a=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Current Time")+"</span> "+vjs.formatTime(a,this.player_.duration())},vjs.DurationDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.on(a,"timeupdate",this.updateContent),this.on(a,"loadedmetadata",this.updateContent)}}),vjs.DurationDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00","aria-live":"off"}),a.appendChild(this.contentEl_),a},vjs.DurationDisplay.prototype.updateContent=function(){var a=this.player_.duration();a&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> "+vjs.formatTime(a))},vjs.TimeDivider=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.TimeDivider.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},vjs.RemainingTimeDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.on(a,"timeupdate",this.updateContent)}}),vjs.RemainingTimeDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00","aria-live":"off"}),a.appendChild(this.contentEl_),a},vjs.RemainingTimeDisplay.prototype.updateContent=function(){this.player_.duration()&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -"+vjs.formatTime(this.player_.remainingTime()))},vjs.FullscreenToggle=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b)}}),vjs.FullscreenToggle.prototype.buttonText="Fullscreen",vjs.FullscreenToggle.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.FullscreenToggle.prototype.onClick=function(){this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText_.innerHTML=this.localize("Fullscreen")):(this.player_.requestFullscreen(),this.controlText_.innerHTML=this.localize("Non-Fullscreen"))},vjs.ProgressControl=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.ProgressControl.prototype.options_={children:{seekBar:{}}},vjs.ProgressControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},vjs.SeekBar=vjs.Slider.extend({init:function(a,b){vjs.Slider.call(this,a,b),this.on(a,"timeupdate",this.updateARIAAttributes),a.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.SeekBar.prototype.options_={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},vjs.SeekBar.prototype.playerEvent="timeupdate",vjs.SeekBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},vjs.SeekBar.prototype.updateARIAAttributes=function(){var a=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",vjs.round(100*this.getPercent(),2)),this.el_.setAttribute("aria-valuetext",vjs.formatTime(a,this.player_.duration()))},vjs.SeekBar.prototype.getPercent=function(){return this.player_.currentTime()/this.player_.duration()},vjs.SeekBar.prototype.onMouseDown=function(a){vjs.Slider.prototype.onMouseDown.call(this,a),this.player_.scrubbing=!0,this.player_.addClass("vjs-scrubbing"),this.videoWasPlaying=!this.player_.paused(),this.player_.pause()},vjs.SeekBar.prototype.onMouseMove=function(a){var b=this.calculateDistance(a)*this.player_.duration();b==this.player_.duration()&&(b-=.1),this.player_.currentTime(b)},vjs.SeekBar.prototype.onMouseUp=function(a){vjs.Slider.prototype.onMouseUp.call(this,a),this.player_.scrubbing=!1,this.player_.removeClass("vjs-scrubbing"),this.videoWasPlaying&&this.player_.play()},vjs.SeekBar.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},vjs.SeekBar.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},vjs.LoadProgressBar=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.on(a,"progress",this.update)}}),vjs.LoadProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},vjs.LoadProgressBar.prototype.update=function(){var a,b,c,d,e=this.player_.buffered(),f=this.player_.duration(),g=this.player_.bufferedEnd(),h=this.el_.children,i=function(a,b){var c=a/b||0;return 100*c+"%"};for(this.el_.style.width=i(g,f),a=0;a<e.length;a++)b=e.start(a),c=e.end(a),d=h[a],d||(d=this.el_.appendChild(vjs.createEl())),d.style.left=i(b,g),d.style.width=i(c-b,g);for(a=h.length;a>e.length;a--)this.el_.removeChild(h[a-1])},vjs.PlayProgressBar=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.PlayProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},vjs.SeekHandle=vjs.SliderHandle.extend({init:function(a,b){vjs.SliderHandle.call(this,a,b),this.on(a,"timeupdate",this.updateContent)}}),vjs.SeekHandle.prototype.defaultValue="00:00",vjs.SeekHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"})},vjs.SeekHandle.prototype.updateContent=function(){var a=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.innerHTML='<span class="vjs-control-text">'+vjs.formatTime(a,this.player_.duration())+"</span>"},vjs.VolumeControl=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),a.tech&&a.tech.featuresVolumeControl===!1&&this.addClass("vjs-hidden"),this.on(a,"loadstart",function(){a.tech.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}}),vjs.VolumeControl.prototype.options_={children:{volumeBar:{}}},vjs.VolumeControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},vjs.VolumeBar=vjs.Slider.extend({init:function(a,b){vjs.Slider.call(this,a,b),this.on(a,"volumechange",this.updateARIAAttributes),a.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.VolumeBar.prototype.updateARIAAttributes=function(){this.el_.setAttribute("aria-valuenow",vjs.round(100*this.player_.volume(),2)),this.el_.setAttribute("aria-valuetext",vjs.round(100*this.player_.volume(),2)+"%")},vjs.VolumeBar.prototype.options_={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},vjs.VolumeBar.prototype.playerEvent="volumechange",vjs.VolumeBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},vjs.VolumeBar.prototype.onMouseMove=function(a){this.player_.muted()&&this.player_.muted(!1),this.player_.volume(this.calculateDistance(a))},vjs.VolumeBar.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},vjs.VolumeBar.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},vjs.VolumeBar.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},vjs.VolumeLevel=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.VolumeLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},vjs.VolumeHandle=vjs.SliderHandle.extend(),vjs.VolumeHandle.prototype.defaultValue="00:00",vjs.VolumeHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"})},vjs.MuteToggle=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.on(a,"volumechange",this.update),a.tech&&a.tech.featuresVolumeControl===!1&&this.addClass("vjs-hidden"),this.on(a,"loadstart",function(){a.tech.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}}),vjs.MuteToggle.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.localize("Mute")+"</span></div>"})},vjs.MuteToggle.prototype.onClick=function(){this.player_.muted(!this.player_.muted())},vjs.MuteToggle.prototype.update=function(){var a=this.player_.volume(),b=3;0===a||this.player_.muted()?b=0:a<.33?b=1:a<.67&&(b=2),this.player_.muted()?this.el_.children[0].children[0].innerHTML!=this.localize("Unmute")&&(this.el_.children[0].children[0].innerHTML=this.localize("Unmute")):this.el_.children[0].children[0].innerHTML!=this.localize("Mute")&&(this.el_.children[0].children[0].innerHTML=this.localize("Mute"));for(var c=0;c<4;c++)vjs.removeClass(this.el_,"vjs-vol-"+c);vjs.addClass(this.el_,"vjs-vol-"+b)},vjs.VolumeMenuButton=vjs.MenuButton.extend({init:function(a,b){vjs.MenuButton.call(this,a,b),this.on(a,"volumechange",this.volumeUpdate),a.tech&&a.tech.featuresVolumeControl===!1&&this.addClass("vjs-hidden"),this.on(a,"loadstart",function(){a.tech.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}),this.addClass("vjs-menu-button")}}),vjs.VolumeMenuButton.prototype.createMenu=function(){var a=new vjs.Menu(this.player_,{contentElType:"div"}),b=new vjs.VolumeBar(this.player_,this.options_.volumeBar);return b.on("focus",function(){a.lockShowing()}),b.on("blur",function(){a.unlockShowing()}),a.addChild(b),a},vjs.VolumeMenuButton.prototype.onClick=function(){vjs.MuteToggle.prototype.onClick.call(this),vjs.MenuButton.prototype.onClick.call(this)},vjs.VolumeMenuButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.localize("Mute")+"</span></div>"})},vjs.VolumeMenuButton.prototype.volumeUpdate=vjs.MuteToggle.prototype.update,vjs.PlaybackRateMenuButton=vjs.MenuButton.extend({init:function(a,b){vjs.MenuButton.call(this,a,b),this.updateVisibility(),this.updateLabel(),this.on(a,"loadstart",this.updateVisibility),this.on(a,"ratechange",this.updateLabel)}}),vjs.PlaybackRateMenuButton.prototype.buttonText="Playback Rate",vjs.PlaybackRateMenuButton.prototype.className="vjs-playback-rate",vjs.PlaybackRateMenuButton.prototype.createEl=function(){var a=vjs.MenuButton.prototype.createEl.call(this);return this.labelEl_=vjs.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),a.appendChild(this.labelEl_),a},vjs.PlaybackRateMenuButton.prototype.createMenu=function(){var a=new vjs.Menu(this.player()),b=this.player().options().playbackRates;if(b)for(var c=b.length-1;c>=0;c--)a.addChild(new vjs.PlaybackRateMenuItem(this.player(),{rate:b[c]+"x"}));return a},vjs.PlaybackRateMenuButton.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},vjs.PlaybackRateMenuButton.prototype.onClick=function(){for(var a=this.player().playbackRate(),b=this.player().options().playbackRates,c=b[0],d=0;d<b.length;d++)if(b[d]>a){c=b[d];break}this.player().playbackRate(c)},vjs.PlaybackRateMenuButton.prototype.playbackRateSupported=function(){return this.player().tech&&this.player().tech.featuresPlaybackRate&&this.player().options().playbackRates&&this.player().options().playbackRates.length>0},vjs.PlaybackRateMenuButton.prototype.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},vjs.PlaybackRateMenuButton.prototype.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},vjs.PlaybackRateMenuItem=vjs.MenuItem.extend({contentElType:"button",init:function(a,b){var c=this.label=b.rate,d=this.rate=parseFloat(c,10);b.label=c,b.selected=1===d,vjs.MenuItem.call(this,a,b),this.on(a,"ratechange",this.update)}}),vjs.PlaybackRateMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player().playbackRate(this.rate)},vjs.PlaybackRateMenuItem.prototype.update=function(){this.selected(this.player().playbackRate()==this.rate)},vjs.PosterImage=vjs.Button.extend({init:function(a,b){vjs.Button.call(this,a,b),this.update(),a.on("posterchange",vjs.bind(this,this.update))}}),vjs.PosterImage.prototype.dispose=function(){this.player().off("posterchange",this.update),vjs.Button.prototype.dispose.call(this)},vjs.PosterImage.prototype.createEl=function(){var a=vjs.createEl("div",{className:"vjs-poster",tabIndex:-1});return vjs.BACKGROUND_SIZE_SUPPORTED||(this.fallbackImg_=vjs.createEl("img"),a.appendChild(this.fallbackImg_)),a},vjs.PosterImage.prototype.update=function(){var a=this.player().poster();this.setSrc(a),a?this.show():this.hide()},vjs.PosterImage.prototype.setSrc=function(a){var b;this.fallbackImg_?this.fallbackImg_.src=a:(b="",a&&(b='url("'+a+'")'),this.el_.style.backgroundImage=b)},vjs.PosterImage.prototype.onClick=function(){this.player_.play()},vjs.LoadingSpinner=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b)}}),vjs.LoadingSpinner.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"})},vjs.BigPlayButton=vjs.Button.extend(),vjs.BigPlayButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span aria-hidden="true"></span>',"aria-label":"play video"})},vjs.BigPlayButton.prototype.onClick=function(){this.player_.play()},vjs.ErrorDisplay=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.update(),this.on(a,"error",this.update)}}),vjs.ErrorDisplay.prototype.createEl=function(){var a=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-error-display"});return this.contentEl_=vjs.createEl("div"),a.appendChild(this.contentEl_),a},vjs.ErrorDisplay.prototype.update=function(){this.player().error()&&(this.contentEl_.innerHTML=this.localize(this.player().error().message))},function(){var a;vjs.MediaTechController=vjs.Component.extend({init:function(a,b,c){b=b||{},b.reportTouchActivity=!1,vjs.Component.call(this,a,b,c),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),this.initControlsListeners(),this.featuresNativeTextTracks||this.emulateTextTracks(),this.initTextTrackListeners()}}),vjs.MediaTechController.prototype.initControlsListeners=function(){var a,b;a=this.player(),b=function(){a.controls()&&!a.usingNativeControls()&&this.addControlsListeners()},this.ready(b),this.on(a,"controlsenabled",b),this.on(a,"controlsdisabled",this.removeControlsListeners),this.ready(function(){this.networkState&&this.networkState()>0&&this.player().trigger("loadstart")})},vjs.MediaTechController.prototype.addControlsListeners=function(){var a;this.on("mousedown",this.onClick),this.on("touchstart",function(b){a=this.player_.userActive()}),this.on("touchmove",function(b){a&&this.player().reportUserActivity()}),this.on("touchend",function(a){a.preventDefault()}),this.emitTapEvents(),this.on("tap",this.onTap)},vjs.MediaTechController.prototype.removeControlsListeners=function(){this.off("tap"),this.off("touchstart"),this.off("touchmove"),this.off("touchleave"),this.off("touchcancel"),this.off("touchend"),this.off("click"),this.off("mousedown")},vjs.MediaTechController.prototype.onClick=function(a){0===a.button&&this.player().controls()&&(this.player().paused()?this.player().play():this.player().pause())},vjs.MediaTechController.prototype.onTap=function(){this.player().userActive(!this.player().userActive())},vjs.MediaTechController.prototype.manualProgressOn=function(){this.manualProgress=!0,this.trackProgress()},vjs.MediaTechController.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress()},vjs.MediaTechController.prototype.trackProgress=function(){this.progressInterval=this.setInterval(function(){var a=this.player().bufferedPercent();this.bufferedPercent_!=a&&this.player().trigger("progress"),this.bufferedPercent_=a,1===a&&this.stopTrackingProgress()},500)},vjs.MediaTechController.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},vjs.MediaTechController.prototype.manualTimeUpdatesOn=function(){var a=this.player_;this.manualTimeUpdates=!0,this.on(a,"play",this.trackCurrentTime),this.on(a,"pause",this.stopTrackingCurrentTime),this.one("timeupdate",function(){this.featuresTimeupdateEvents=!0,this.manualTimeUpdatesOff()})},vjs.MediaTechController.prototype.manualTimeUpdatesOff=function(){var a=this.player_;this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off(a,"play",this.trackCurrentTime),this.off(a,"pause",this.stopTrackingCurrentTime)},vjs.MediaTechController.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.player().trigger("timeupdate")},250)},vjs.MediaTechController.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.player().trigger("timeupdate")},vjs.MediaTechController.prototype.dispose=function(){this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),vjs.Component.prototype.dispose.call(this)},vjs.MediaTechController.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.player().trigger("timeupdate")},vjs.MediaTechController.prototype.initTextTrackListeners=function(){var a,b=this.player_,c=function(){var a=b.getChild("textTrackDisplay");a&&a.updateDisplay()};a=this.textTracks(),a&&(a.addEventListener("removetrack",c),a.addEventListener("addtrack",c),this.on("dispose",vjs.bind(this,function(){a.removeEventListener("removetrack",c),a.removeEventListener("addtrack",c)})))},vjs.MediaTechController.prototype.emulateTextTracks=function(){var a,b,c,d=this.player_;window.WebVTT||(c=document.createElement("script"),c.src=d.options()["vtt.js"]||"../node_modules/vtt.js/dist/vtt.js",d.el().appendChild(c),window.WebVTT=!0),b=this.textTracks(),b&&(a=function(){var a,b,c;for(c=d.getChild("textTrackDisplay"),c.updateDisplay(),a=0;a<this.length;a++)b=this[a],b.removeEventListener("cuechange",vjs.bind(c,c.updateDisplay)),"showing"===b.mode&&b.addEventListener("cuechange",vjs.bind(c,c.updateDisplay))},b.addEventListener("change",a),this.on("dispose",vjs.bind(this,function(){b.removeEventListener("change",a)})))},vjs.MediaTechController.prototype.textTracks_,vjs.MediaTechController.prototype.textTracks=function(){return this.player_.textTracks_=this.player_.textTracks_||new vjs.TextTrackList,this.player_.textTracks_},vjs.MediaTechController.prototype.remoteTextTracks=function(){return this.player_.remoteTextTracks_=this.player_.remoteTextTracks_||new vjs.TextTrackList,this.player_.remoteTextTracks_},a=function(a,b,c,d,e){var f,g=a.textTracks();return e=e||{},e.kind=b,c&&(e.label=c),d&&(e.language=d),e.player=a.player_,f=new vjs.TextTrack(e),g.addTrack_(f),f},vjs.MediaTechController.prototype.addTextTrack=function(b,c,d){if(!b)throw new Error("TextTrack kind is required but was not provided");return a(this,b,c,d)},vjs.MediaTechController.prototype.addRemoteTextTrack=function(b){var c=a(this,b.kind,b.label,b.language,b);return this.remoteTextTracks().addTrack_(c),{track:c}},vjs.MediaTechController.prototype.removeRemoteTextTrack=function(a){this.textTracks().removeTrack_(a),this.remoteTextTracks().removeTrack_(a)},vjs.MediaTechController.prototype.setPoster=function(){},vjs.MediaTechController.prototype.featuresVolumeControl=!0,vjs.MediaTechController.prototype.featuresFullscreenResize=!1,vjs.MediaTechController.prototype.featuresPlaybackRate=!1,vjs.MediaTechController.prototype.featuresProgressEvents=!1,vjs.MediaTechController.prototype.featuresTimeupdateEvents=!1,vjs.MediaTechController.prototype.featuresNativeTextTracks=!1,vjs.MediaTechController.withSourceHandlers=function(a){a.registerSourceHandler=function(b,c){var d=a.sourceHandlers;d||(d=a.sourceHandlers=[]),void 0===c&&(c=d.length),d.splice(c,0,b)},a.selectSourceHandler=function(b){for(var c,d=a.sourceHandlers||[],e=0;e<d.length;e++)if(c=d[e].canHandleSource(b))return d[e];return null},a.canPlaySource=function(b){var c=a.selectSourceHandler(b);return c?c.canHandleSource(b):""},a.prototype.setSource=function(b){var c=a.selectSourceHandler(b);return c||(a.nativeSourceHandler?c=a.nativeSourceHandler:vjs.log.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),this.currentSource_=b,this.sourceHandler_=c.handleSource(b,this),this.on("dispose",this.disposeSourceHandler),this},a.prototype.disposeSourceHandler=function(){this.sourceHandler_&&this.sourceHandler_.dispose&&this.sourceHandler_.dispose()}},vjs.media={}}(),vjs.Html5=vjs.MediaTechController.extend({init:function(a,b,c){var d,e,f,g,h,i;b.nativeCaptions!==!1&&b.nativeTextTracks!==!1||(this.featuresNativeTextTracks=!1),vjs.MediaTechController.call(this,a,b,c),this.setupTriggers();var j=b.source;if(j&&(this.el_.currentSrc!==j.src||a.tag&&3===a.tag.initNetworkState_)&&this.setSource(j),this.el_.hasChildNodes()){for(d=this.el_.childNodes,e=d.length,i=[];e--;)g=d[e],h=g.nodeName.toLowerCase(),"track"===h&&(this.featuresNativeTextTracks?this.remoteTextTracks().addTrack_(g.track):i.push(g));for(f=0;f<i.length;f++)this.el_.removeChild(i[f])}this.featuresNativeTextTracks&&this.on("loadstart",vjs.bind(this,this.hideCaptions)),vjs.TOUCH_ENABLED&&a.options().nativeControlsForTouch===!0&&this.useNativeControls(),a.ready(function(){this.src()&&this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())}),this.triggerReady()}}),vjs.Html5.prototype.dispose=function(){vjs.Html5.disposeMediaElement(this.el_),vjs.MediaTechController.prototype.dispose.call(this)},vjs.Html5.prototype.createEl=function(){var a,b,c,d,e,f=this.player_,g=f.tag;if(!g||this.movingMediaElementInDOM===!1){if(g?(e=g.cloneNode(!1),vjs.Html5.disposeMediaElement(g),g=e,f.tag=null):(g=vjs.createEl("video"),d=videojs.util.mergeOptions({},f.tagAttributes),vjs.TOUCH_ENABLED&&f.options().nativeControlsForTouch===!0||delete d.controls,vjs.setElementAttributes(g,vjs.obj.merge(d,{id:f.id()+"_html5_api","class":"vjs-tech"}))),g.player=f,f.options_.tracks)for(c=0;c<f.options_.tracks.length;c++)a=f.options_.tracks[c],b=document.createElement("track"),b.kind=a.kind,b.label=a.label,b.srclang=a.srclang,b.src=a.src,"default"in a&&b.setAttribute("default","default"),g.appendChild(b);vjs.insertFirst(g,f.el())}var h=["autoplay","preload","loop","muted"];for(c=h.length-1;c>=0;c--){var i=h[c],j={};"undefined"!=typeof f.options_[i]&&(j[i]=f.options_[i]),vjs.setElementAttributes(g,j)}return g},vjs.Html5.prototype.hideCaptions=function(){for(var a,b=this.el_.querySelectorAll("track"),c=b.length,d={captions:1,subtitles:1};c--;)a=b[c].track,a&&a.kind in d&&!b[c]["default"]&&(a.mode="disabled")},vjs.Html5.prototype.setupTriggers=function(){for(var a=vjs.Html5.Events.length-1;a>=0;a--)this.on(vjs.Html5.Events[a],this.eventHandler)},vjs.Html5.prototype.eventHandler=function(a){"error"==a.type&&this.error()?this.player().error(this.error().code):(a.bubbles=!1,this.player().trigger(a))},vjs.Html5.prototype.useNativeControls=function(){var a,b,c,d,e;a=this,b=this.player(),a.setControls(b.controls()),c=function(){a.setControls(!0)},d=function(){a.setControls(!1)},b.on("controlsenabled",c),b.on("controlsdisabled",d),e=function(){b.off("controlsenabled",c),b.off("controlsdisabled",d)},a.on("dispose",e),b.on("usingcustomcontrols",e),b.usingNativeControls(!0)},vjs.Html5.prototype.play=function(){this.el_.play()},vjs.Html5.prototype.pause=function(){this.el_.pause()},vjs.Html5.prototype.paused=function(){return this.el_.paused},vjs.Html5.prototype.currentTime=function(){return this.el_.currentTime},vjs.Html5.prototype.setCurrentTime=function(a){try{this.el_.currentTime=a}catch(b){vjs.log(b,"Video is not ready. (Video.js)")}},vjs.Html5.prototype.duration=function(){return this.el_.duration||0},vjs.Html5.prototype.buffered=function(){return this.el_.buffered},vjs.Html5.prototype.volume=function(){return this.el_.volume},vjs.Html5.prototype.setVolume=function(a){this.el_.volume=a},vjs.Html5.prototype.muted=function(){return this.el_.muted},vjs.Html5.prototype.setMuted=function(a){this.el_.muted=a},vjs.Html5.prototype.width=function(){return this.el_.offsetWidth},vjs.Html5.prototype.height=function(){return this.el_.offsetHeight},vjs.Html5.prototype.supportsFullScreen=function(){return!("function"!=typeof this.el_.webkitEnterFullScreen||!/Android/.test(vjs.USER_AGENT)&&/Chrome|Mac OS X 10.5/.test(vjs.USER_AGENT))},vjs.Html5.prototype.enterFullScreen=function(){var a=this.el_;"webkitDisplayingFullscreen"in a&&this.one("webkitbeginfullscreen",function(){this.player_.isFullscreen(!0),this.one("webkitendfullscreen",function(){this.player_.isFullscreen(!1),this.player_.trigger("fullscreenchange")}),this.player_.trigger("fullscreenchange")}),a.paused&&a.networkState<=a.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){a.pause(),a.webkitEnterFullScreen()},0)):a.webkitEnterFullScreen()},vjs.Html5.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},vjs.Html5.prototype.src=function(a){return void 0===a?this.el_.src:void this.setSrc(a)},vjs.Html5.prototype.setSrc=function(a){this.el_.src=a},vjs.Html5.prototype.load=function(){this.el_.load()},vjs.Html5.prototype.currentSrc=function(){return this.el_.currentSrc},vjs.Html5.prototype.poster=function(){return this.el_.poster},vjs.Html5.prototype.setPoster=function(a){this.el_.poster=a},vjs.Html5.prototype.preload=function(){return this.el_.preload},vjs.Html5.prototype.setPreload=function(a){this.el_.preload=a},vjs.Html5.prototype.autoplay=function(){return this.el_.autoplay},vjs.Html5.prototype.setAutoplay=function(a){this.el_.autoplay=a},vjs.Html5.prototype.controls=function(){return this.el_.controls},vjs.Html5.prototype.setControls=function(a){this.el_.controls=!!a},vjs.Html5.prototype.loop=function(){return this.el_.loop},vjs.Html5.prototype.setLoop=function(a){this.el_.loop=a},vjs.Html5.prototype.error=function(){return this.el_.error},vjs.Html5.prototype.seeking=function(){return this.el_.seeking},vjs.Html5.prototype.ended=function(){return this.el_.ended},vjs.Html5.prototype.defaultMuted=function(){return this.el_.defaultMuted},vjs.Html5.prototype.playbackRate=function(){return this.el_.playbackRate},vjs.Html5.prototype.setPlaybackRate=function(a){this.el_.playbackRate=a},vjs.Html5.prototype.networkState=function(){return this.el_.networkState},vjs.Html5.prototype.readyState=function(){return this.el_.readyState},vjs.Html5.prototype.textTracks=function(){return this.featuresNativeTextTracks?this.el_.textTracks:vjs.MediaTechController.prototype.textTracks.call(this)},vjs.Html5.prototype.addTextTrack=function(a,b,c){return this.featuresNativeTextTracks?this.el_.addTextTrack(a,b,c):vjs.MediaTechController.prototype.addTextTrack.call(this,a,b,c)},vjs.Html5.prototype.addRemoteTextTrack=function(a){if(!this.featuresNativeTextTracks)return vjs.MediaTechController.prototype.addRemoteTextTrack.call(this,a);var b=document.createElement("track");return a=a||{},a.kind&&(b.kind=a.kind),a.label&&(b.label=a.label),(a.language||a.srclang)&&(b.srclang=a.language||a.srclang),a["default"]&&(b["default"]=a["default"]),a.id&&(b.id=a.id),a.src&&(b.src=a.src),this.el().appendChild(b),"metadata"===b.track.kind?b.track.mode="hidden":b.track.mode="disabled",b.onload=function(){var a=b.track;b.readyState>=2&&("metadata"===a.kind&&"hidden"!==a.mode?a.mode="hidden":"metadata"!==a.kind&&"disabled"!==a.mode&&(a.mode="disabled"),b.onload=null)},this.remoteTextTracks().addTrack_(b.track),b},vjs.Html5.prototype.removeRemoteTextTrack=function(a){if(!this.featuresNativeTextTracks)return vjs.MediaTechController.prototype.removeRemoteTextTrack.call(this,a);
var b,c;for(this.remoteTextTracks().removeTrack_(a),b=this.el().querySelectorAll("track"),c=0;c<b.length;c++)if(b[c]===a||b[c].track===a){b[c].parentNode.removeChild(b[c]);break}},vjs.Html5.isSupported=function(){try{vjs.TEST_VID.volume=.5}catch(a){return!1}return!!vjs.TEST_VID.canPlayType},vjs.MediaTechController.withSourceHandlers(vjs.Html5),vjs.Html5.nativeSourceHandler={},vjs.Html5.nativeSourceHandler.canHandleSource=function(a){function b(a){try{return vjs.TEST_VID.canPlayType(a)}catch(b){return""}}var c,d;return a.type?b(a.type):a.src?(c=a.src.match(/\.([^.\/\?]+)(\?[^\/]+)?$/i),d=c&&c[1],b("video/"+d)):""},vjs.Html5.nativeSourceHandler.handleSource=function(a,b){b.setSrc(a.src)},vjs.Html5.nativeSourceHandler.dispose=function(){},vjs.Html5.registerSourceHandler(vjs.Html5.nativeSourceHandler),vjs.Html5.canControlVolume=function(){var a=vjs.TEST_VID.volume;return vjs.TEST_VID.volume=a/2+.1,a!==vjs.TEST_VID.volume},vjs.Html5.canControlPlaybackRate=function(){var a=vjs.TEST_VID.playbackRate;return vjs.TEST_VID.playbackRate=a/2+.1,a!==vjs.TEST_VID.playbackRate},vjs.Html5.supportsNativeTextTracks=function(){var a;return a=!!vjs.TEST_VID.textTracks,a&&vjs.TEST_VID.textTracks.length>0&&(a="number"!=typeof vjs.TEST_VID.textTracks[0].mode),a&&vjs.IS_FIREFOX&&(a=!1),a},vjs.Html5.prototype.featuresVolumeControl=vjs.Html5.canControlVolume(),vjs.Html5.prototype.featuresPlaybackRate=vjs.Html5.canControlPlaybackRate(),vjs.Html5.prototype.movingMediaElementInDOM=!vjs.IS_IOS,vjs.Html5.prototype.featuresFullscreenResize=!0,vjs.Html5.prototype.featuresProgressEvents=!0,vjs.Html5.prototype.featuresNativeTextTracks=vjs.Html5.supportsNativeTextTracks(),function(){var a,b=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,c=/^video\/mp4/i;vjs.Html5.patchCanPlayType=function(){vjs.ANDROID_VERSION>=4&&(a||(a=vjs.TEST_VID.constructor.prototype.canPlayType),vjs.TEST_VID.constructor.prototype.canPlayType=function(c){return c&&b.test(c)?"maybe":a.call(this,c)}),vjs.IS_OLD_ANDROID&&(a||(a=vjs.TEST_VID.constructor.prototype.canPlayType),vjs.TEST_VID.constructor.prototype.canPlayType=function(b){return b&&c.test(b)?"maybe":a.call(this,b)})},vjs.Html5.unpatchCanPlayType=function(){var b=vjs.TEST_VID.constructor.prototype.canPlayType;return vjs.TEST_VID.constructor.prototype.canPlayType=a,a=null,b},vjs.Html5.patchCanPlayType()}(),vjs.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),vjs.Html5.disposeMediaElement=function(a){if(a){for(a.player=null,a.parentNode&&a.parentNode.removeChild(a);a.hasChildNodes();)a.removeChild(a.firstChild);a.removeAttribute("src"),"function"==typeof a.load&&!function(){try{a.load()}catch(b){}}()}},vjs.Flash=vjs.MediaTechController.extend({init:function(a,b,c){vjs.MediaTechController.call(this,a,b,c);var d=b.source,e=a.id()+"_flash_api",f=a.options_,g=vjs.obj.merge({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:f.autoplay,preload:f.preload,loop:f.loop,muted:f.muted},b.flashVars),h=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},b.params),i=vjs.obj.merge({id:e,name:e,"class":"vjs-tech"},b.attributes);d&&this.ready(function(){this.setSource(d)}),vjs.insertFirst(this.el_,b.parentEl),b.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(b.startTime)}),vjs.IS_FIREFOX&&this.ready(function(){this.on("mousemove",function(){this.player().trigger({type:"mousemove",bubbles:!1})})}),a.on("stageclick",a.reportUserActivity),this.el_=vjs.Flash.embed(b.swf,this.el_,g,h,i)}}),vjs.Flash.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Flash.prototype.play=function(){this.el_.vjs_play()},vjs.Flash.prototype.pause=function(){this.el_.vjs_pause()},vjs.Flash.prototype.src=function(a){return void 0===a?this.currentSrc():this.setSrc(a)},vjs.Flash.prototype.setSrc=function(a){if(a=vjs.getAbsoluteURL(a),this.el_.vjs_src(a),this.player_.autoplay()){var b=this;this.setTimeout(function(){b.play()},0)}},vjs.Flash.prototype.setCurrentTime=function(a){this.lastSeekTarget_=a,this.el_.vjs_setProperty("currentTime",a),vjs.MediaTechController.prototype.setCurrentTime.call(this)},vjs.Flash.prototype.currentTime=function(a){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},vjs.Flash.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},vjs.Flash.prototype.load=function(){this.el_.vjs_load()},vjs.Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")},vjs.Flash.prototype.setPoster=function(){},vjs.Flash.prototype.buffered=function(){return vjs.createTimeRange(0,this.el_.vjs_getProperty("buffered"))},vjs.Flash.prototype.supportsFullScreen=function(){return!1},vjs.Flash.prototype.enterFullScreen=function(){return!1},function(){function a(a){var b=a.charAt(0).toUpperCase()+a.slice(1);d["set"+b]=function(b){return this.el_.vjs_setProperty(a,b)}}function b(a){d[a]=function(){return this.el_.vjs_getProperty(a)}}var c,d=vjs.Flash.prototype,e="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),f="error,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(",");for(c=0;c<e.length;c++)b(e[c]),a(e[c]);for(c=0;c<f.length;c++)b(f[c])}(),vjs.Flash.isSupported=function(){return vjs.Flash.version()[0]>=10},vjs.MediaTechController.withSourceHandlers(vjs.Flash),vjs.Flash.nativeSourceHandler={},vjs.Flash.nativeSourceHandler.canHandleSource=function(a){var b;return a.type?(b=a.type.replace(/;.*/,"").toLowerCase(),b in vjs.Flash.formats?"maybe":""):""},vjs.Flash.nativeSourceHandler.handleSource=function(a,b){b.setSrc(a.src)},vjs.Flash.nativeSourceHandler.dispose=function(){},vjs.Flash.registerSourceHandler(vjs.Flash.nativeSourceHandler),vjs.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},vjs.Flash.onReady=function(a){var b,c;b=vjs.el(a),c=b&&b.parentNode&&b.parentNode.player,c&&(b.player=c,vjs.Flash.checkReady(c.tech))},vjs.Flash.checkReady=function(a){a.el()&&(a.el().vjs_getProperty?a.triggerReady():this.setTimeout(function(){vjs.Flash.checkReady(a)},50))},vjs.Flash.onEvent=function(a,b){var c=vjs.el(a).player;c.trigger(b)},vjs.Flash.onError=function(a,b){var c=vjs.el(a).player,d="FLASH: "+b;"srcnotfound"==b?c.error({code:4,message:d}):c.error(d)},vjs.Flash.version=function(){var a="0,0,0";try{a=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(a=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(c){}}return a.split(",")},vjs.Flash.embed=function(a,b,c,d,e){var f=vjs.Flash.getEmbedCode(a,c,d,e),g=vjs.createEl("div",{innerHTML:f}).childNodes[0],h=b.parentNode;b.parentNode.replaceChild(g,b),g[vjs.expando]=b[vjs.expando];var i=h.childNodes[0];return setTimeout(function(){i.style.display="block"},1e3),g},vjs.Flash.getEmbedCode=function(a,b,c,d){var e='<object type="application/x-shockwave-flash" ',f="",g="",h="";return b&&vjs.obj.each(b,function(a,b){f+=a+"="+b+"&amp;"}),c=vjs.obj.merge({movie:a,flashvars:f,allowScriptAccess:"always",allowNetworking:"all"},c),vjs.obj.each(c,function(a,b){g+='<param name="'+a+'" value="'+b+'" />'}),d=vjs.obj.merge({data:a,width:"100%",height:"100%"},d),vjs.obj.each(d,function(a,b){h+=a+'="'+b+'" '}),e+h+">"+g+"</object>"},vjs.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},vjs.Flash.streamFromParts=function(a,b){return a+"&"+b},vjs.Flash.streamToParts=function(a){var b={connection:"",stream:""};if(!a)return b;var c,d=a.indexOf("&");return d!==-1?c=d+1:(d=c=a.lastIndexOf("/")+1,0===d&&(d=c=a.length)),b.connection=a.substring(0,d),b.stream=a.substring(c,a.length),b},vjs.Flash.isStreamingType=function(a){return a in vjs.Flash.streamingFormats},vjs.Flash.RTMP_RE=/^rtmp[set]?:\/\//i,vjs.Flash.isStreamingSrc=function(a){return vjs.Flash.RTMP_RE.test(a)},vjs.Flash.rtmpSourceHandler={},vjs.Flash.rtmpSourceHandler.canHandleSource=function(a){return vjs.Flash.isStreamingType(a.type)||vjs.Flash.isStreamingSrc(a.src)?"maybe":""},vjs.Flash.rtmpSourceHandler.handleSource=function(a,b){var c=vjs.Flash.streamToParts(a.src);b.setRtmpConnection(c.connection),b.setRtmpStream(c.stream)},vjs.Flash.registerSourceHandler(vjs.Flash.rtmpSourceHandler),vjs.MediaLoader=vjs.Component.extend({init:function(a,b,c){if(vjs.Component.call(this,a,b,c),a.options_.sources&&0!==a.options_.sources.length)a.src(a.options_.sources);else for(var d=0,e=a.options_.techOrder;d<e.length;d++){var f=vjs.capitalize(e[d]),g=window.videojs[f];if(g&&g.isSupported()){a.loadTech(f);break}}}}),vjs.TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"},vjs.TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},function(){vjs.TextTrack=function(b){var d,e,f,g,h,i,j,k,l,m,n;if(b=b||{},!b.player)throw new Error("A player was not provided.");if(d=this,vjs.IS_IE8){d=document.createElement("custom");for(n in vjs.TextTrack.prototype)d[n]=vjs.TextTrack.prototype[n]}if(d.player_=b.player,f=vjs.TextTrackMode[b.mode]||"disabled",g=vjs.TextTrackKind[b.kind]||"subtitles",h=b.label||"",i=b.language||b.srclang||"",e=b.id||"vjs_text_track_"+vjs.guid++,"metadata"!==g&&"chapters"!==g||(f="hidden"),d.cues_=[],d.activeCues_=[],j=new vjs.TextTrackCueList(d.cues_),k=new vjs.TextTrackCueList(d.activeCues_),m=!1,l=vjs.bind(d,function(){this.activeCues,m&&(this.trigger("cuechange"),m=!1)}),"disabled"!==f&&d.player_.on("timeupdate",l),Object.defineProperty(d,"kind",{get:function(){return g},set:Function.prototype}),Object.defineProperty(d,"label",{get:function(){return h},set:Function.prototype}),Object.defineProperty(d,"language",{get:function(){return i},set:Function.prototype}),Object.defineProperty(d,"id",{get:function(){return e},set:Function.prototype}),Object.defineProperty(d,"mode",{get:function(){return f},set:function(a){vjs.TextTrackMode[a]&&(f=a,"showing"===f&&this.player_.on("timeupdate",l),this.trigger("modechange"))}}),Object.defineProperty(d,"cues",{get:function(){return this.loaded_?j:null},set:Function.prototype}),Object.defineProperty(d,"activeCues",{get:function(){var a,b,d,e,f;if(!this.loaded_)return null;if(0===this.cues.length)return k;for(e=this.player_.currentTime(),a=0,b=this.cues.length,d=[];a<b;a++)f=this.cues[a],f.startTime<=e&&f.endTime>=e?d.push(f):f.startTime===f.endTime&&f.startTime<=e&&f.startTime+.5>=e&&d.push(f);if(m=!1,d.length!==this.activeCues_.length)m=!0;else for(a=0;a<d.length;a++)c.call(this.activeCues_,d[a])===-1&&(m=!0);return this.activeCues_=d,k.setCues_(this.activeCues_),k},set:Function.prototype}),b.src?a(b.src,d):d.loaded_=!0,vjs.IS_IE8)return d},vjs.TextTrack.prototype=vjs.obj.create(vjs.EventEmitter.prototype),vjs.TextTrack.prototype.constructor=vjs.TextTrack,vjs.TextTrack.prototype.allowedEvents_={cuechange:"cuechange"},vjs.TextTrack.prototype.addCue=function(a){var b=this.player_.textTracks(),c=0;if(b)for(;c<b.length;c++)b[c]!==this&&b[c].removeCue(a);this.cues_.push(a),this.cues.setCues_(this.cues_)},vjs.TextTrack.prototype.removeCue=function(a){for(var b,c=0,d=this.cues_.length,e=!1;c<d;c++)b=this.cues_[c],b===a&&(this.cues_.splice(c,1),e=!0);e&&this.cues.setCues_(this.cues_)};var a,b,c;a=function(a,c){vjs.xhr(a,vjs.bind(this,function(a,d,e){return a?vjs.log.error(a):(c.loaded_=!0,void b(e,c))}))},b=function(a,c){if("function"!=typeof window.WebVTT)return window.setTimeout(function(){b(a,c)},25);var d=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());d.oncue=function(a){c.addCue(a)},d.onparsingerror=function(a){vjs.log.error(a)},d.parse(a),d.flush()},c=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=+b||0;if(Math.abs(f)===1/0&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);c<e;){if(c in d&&d[c]===a)return c;c++}return-1}}(),vjs.TextTrackList=function(a){var b,c=this,d=0;if(vjs.IS_IE8){c=document.createElement("custom");for(b in vjs.TextTrackList.prototype)c[b]=vjs.TextTrackList.prototype[b]}for(a=a||[],c.tracks_=[],Object.defineProperty(c,"length",{get:function(){return this.tracks_.length}});d<a.length;d++)c.addTrack_(a[d]);if(vjs.IS_IE8)return c},vjs.TextTrackList.prototype=vjs.obj.create(vjs.EventEmitter.prototype),vjs.TextTrackList.prototype.constructor=vjs.TextTrackList,vjs.TextTrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},function(){var a;for(a in vjs.TextTrackList.prototype.allowedEvents_)vjs.TextTrackList.prototype["on"+a]=null}(),vjs.TextTrackList.prototype.addTrack_=function(a){var b=this.tracks_.length;""+b in this||Object.defineProperty(this,b,{get:function(){return this.tracks_[b]}}),a.addEventListener("modechange",vjs.bind(this,function(){this.trigger("change")})),this.tracks_.push(a),this.trigger({type:"addtrack",track:a})},vjs.TextTrackList.prototype.removeTrack_=function(a){for(var b,c=0,d=this.length;c<d;c++)if(b=this[c],b===a){this.tracks_.splice(c,1);break}this.trigger({type:"removetrack",track:a})},vjs.TextTrackList.prototype.getTrackById=function(a){for(var b,c=0,d=this.length,e=null;c<d;c++)if(b=this[c],b.id===a){e=b;break}return e},vjs.TextTrackCueList=function(a){var b,c=this;if(vjs.IS_IE8){c=document.createElement("custom");for(b in vjs.TextTrackCueList.prototype)c[b]=vjs.TextTrackCueList.prototype[b]}if(vjs.TextTrackCueList.prototype.setCues_.call(c,a),Object.defineProperty(c,"length",{get:function(){return this.length_}}),vjs.IS_IE8)return c},vjs.TextTrackCueList.prototype.setCues_=function(a){var b,c=this.length||0,d=0,e=a.length;if(this.cues_=a,this.length_=a.length,b=function(a){""+a in this||Object.defineProperty(this,""+a,{get:function(){return this.cues_[a]}})},c<e)for(d=c;d<e;d++)b.call(this,d)},vjs.TextTrackCueList.prototype.getCueById=function(a){for(var b,c=0,d=this.length,e=null;c<d;c++)if(b=this[c],b.id===a){e=b;break}return e},function(){"use strict";vjs.TextTrackDisplay=vjs.Component.extend({init:function(a,b,c){vjs.Component.call(this,a,b,c),a.on("loadstart",vjs.bind(this,this.toggleDisplay)),a.ready(vjs.bind(this,function(){if(a.tech&&a.tech.featuresNativeTextTracks)return void this.hide();var b,c,d;for(a.on("fullscreenchange",vjs.bind(this,this.updateDisplay)),c=a.options_.tracks||[],b=0;b<c.length;b++)d=c[b],this.player_.addRemoteTextTrack(d)}))}}),vjs.TextTrackDisplay.prototype.toggleDisplay=function(){this.player_.tech&&this.player_.tech.featuresNativeTextTracks?this.hide():this.show()},vjs.TextTrackDisplay.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})},vjs.TextTrackDisplay.prototype.clearDisplay=function(){"function"==typeof window.WebVTT&&window.WebVTT.processCues(window,[],this.el_)};var a=function(a,b){return"rgba("+parseInt(a[1]+a[1],16)+","+parseInt(a[2]+a[2],16)+","+parseInt(a[3]+a[3],16)+","+b+")"},b="#222",c="#ccc",d={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},e=function(a,b,c){try{a.style[b]=c}catch(d){}};vjs.TextTrackDisplay.prototype.updateDisplay=function(){var a,b=this.player_.textTracks(),c=0;if(this.clearDisplay(),b)for(;c<b.length;c++)a=b[c],"showing"===a.mode&&this.updateForTrack(a)},vjs.TextTrackDisplay.prototype.updateForTrack=function(f){if("function"==typeof window.WebVTT&&f.activeCues){for(var g,h,i=0,j=this.player_.textTrackSettings.getValues(),k=[];i<f.activeCues.length;i++)k.push(f.activeCues[i]);for(window.WebVTT.processCues(window,f.activeCues,this.el_),i=k.length;i--;)g=k[i].displayState,j.color&&(g.firstChild.style.color=j.color),j.textOpacity&&e(g.firstChild,"color",a(j.color||"#fff",j.textOpacity)),j.backgroundColor&&(g.firstChild.style.backgroundColor=j.backgroundColor),j.backgroundOpacity&&e(g.firstChild,"backgroundColor",a(j.backgroundColor||"#000",j.backgroundOpacity)),j.windowColor&&(j.windowOpacity?e(g,"backgroundColor",a(j.windowColor,j.windowOpacity)):g.style.backgroundColor=j.windowColor),j.edgeStyle&&("dropshadow"===j.edgeStyle?g.firstChild.style.textShadow="2px 2px 3px "+b+", 2px 2px 4px "+b+", 2px 2px 5px "+b:"raised"===j.edgeStyle?g.firstChild.style.textShadow="1px 1px "+b+", 2px 2px "+b+", 3px 3px "+b:"depressed"===j.edgeStyle?g.firstChild.style.textShadow="1px 1px "+c+", 0 1px "+c+", -1px -1px "+b+", 0 -1px "+b:"uniform"===j.edgeStyle&&(g.firstChild.style.textShadow="0 0 4px "+b+", 0 0 4px "+b+", 0 0 4px "+b+", 0 0 4px "+b)),j.fontPercent&&1!==j.fontPercent&&(h=window.parseFloat(g.style.fontSize),g.style.fontSize=h*j.fontPercent+"px",g.style.height="auto",g.style.top="auto",g.style.bottom="2px"),j.fontFamily&&"default"!==j.fontFamily&&("small-caps"===j.fontFamily?g.firstChild.style.fontVariant="small-caps":g.firstChild.style.fontFamily=d[j.fontFamily])}},vjs.TextTrackMenuItem=vjs.MenuItem.extend({init:function(a,b){var c,d,e=this.track=b.track,f=a.textTracks();f&&(c=vjs.bind(this,function(){var a,b,c,d="showing"===this.track.mode;if(this instanceof vjs.OffTextTrackMenuItem)for(d=!0,b=0,c=f.length;b<c;b++)if(a=f[b],a.kind===this.track.kind&&"showing"===a.mode){d=!1;break}this.selected(d)}),f.addEventListener("change",c),a.on("dispose",function(){f.removeEventListener("change",c)})),b.label=e.label||e.language||"Unknown",b.selected=e["default"]||"showing"===e.mode,vjs.MenuItem.call(this,a,b),f&&void 0===f.onchange&&this.on(["tap","click"],function(){if("object"!=typeof window.Event)try{d=new window.Event("change")}catch(a){}d||(d=document.createEvent("Event"),d.initEvent("change",!0,!0)),f.dispatchEvent(d)})}}),vjs.TextTrackMenuItem.prototype.onClick=function(){var a,b=this.track.kind,c=this.player_.textTracks(),d=0;if(vjs.MenuItem.prototype.onClick.call(this),c)for(;d<c.length;d++)a=c[d],a.kind===b&&(a===this.track?a.mode="showing":a.mode="disabled")},vjs.OffTextTrackMenuItem=vjs.TextTrackMenuItem.extend({init:function(a,b){b.track={kind:b.kind,player:a,label:b.kind+" off","default":!1,mode:"disabled"},vjs.TextTrackMenuItem.call(this,a,b),this.selected(!0)}}),vjs.CaptionSettingsMenuItem=vjs.TextTrackMenuItem.extend({init:function(a,b){b.track={kind:b.kind,player:a,label:b.kind+" settings","default":!1,mode:"disabled"},vjs.TextTrackMenuItem.call(this,a,b),this.addClass("vjs-texttrack-settings")}}),vjs.CaptionSettingsMenuItem.prototype.onClick=function(){this.player().getChild("textTrackSettings").show()},vjs.TextTrackButton=vjs.MenuButton.extend({init:function(a,b){var c,d;vjs.MenuButton.call(this,a,b),c=this.player_.textTracks(),this.items.length<=1&&this.hide(),c&&(d=vjs.bind(this,this.update),c.addEventListener("removetrack",d),c.addEventListener("addtrack",d),this.player_.on("dispose",function(){c.removeEventListener("removetrack",d),c.removeEventListener("addtrack",d)}))}}),vjs.TextTrackButton.prototype.createItems=function(){var a,b,c=[];if(!(this instanceof vjs.CaptionsButton)||this.player().tech&&this.player().tech.featuresNativeTextTracks||c.push(new vjs.CaptionSettingsMenuItem(this.player_,{kind:this.kind_})),c.push(new vjs.OffTextTrackMenuItem(this.player_,{kind:this.kind_})),b=this.player_.textTracks(),!b)return c;for(var d=0;d<b.length;d++)a=b[d],a.kind===this.kind_&&c.push(new vjs.TextTrackMenuItem(this.player_,{track:a}));return c},vjs.CaptionsButton=vjs.TextTrackButton.extend({init:function(a,b,c){vjs.TextTrackButton.call(this,a,b,c),this.el_.setAttribute("aria-label","Captions Menu")}}),vjs.CaptionsButton.prototype.kind_="captions",vjs.CaptionsButton.prototype.buttonText="Captions",vjs.CaptionsButton.prototype.className="vjs-captions-button",vjs.CaptionsButton.prototype.update=function(){var a=2;vjs.TextTrackButton.prototype.update.call(this),this.player().tech&&this.player().tech.featuresNativeTextTracks&&(a=1),this.items&&this.items.length>a?this.show():this.hide()},vjs.SubtitlesButton=vjs.TextTrackButton.extend({init:function(a,b,c){vjs.TextTrackButton.call(this,a,b,c),this.el_.setAttribute("aria-label","Subtitles Menu")}}),vjs.SubtitlesButton.prototype.kind_="subtitles",vjs.SubtitlesButton.prototype.buttonText="Subtitles",vjs.SubtitlesButton.prototype.className="vjs-subtitles-button",vjs.ChaptersButton=vjs.TextTrackButton.extend({init:function(a,b,c){vjs.TextTrackButton.call(this,a,b,c),this.el_.setAttribute("aria-label","Chapters Menu")}}),vjs.ChaptersButton.prototype.kind_="chapters",vjs.ChaptersButton.prototype.buttonText="Chapters",vjs.ChaptersButton.prototype.className="vjs-chapters-button",vjs.ChaptersButton.prototype.createItems=function(){var a,b,c=[];if(b=this.player_.textTracks(),!b)return c;for(var d=0;d<b.length;d++)a=b[d],a.kind===this.kind_&&c.push(new vjs.TextTrackMenuItem(this.player_,{track:a}));return c},vjs.ChaptersButton.prototype.createMenu=function(){for(var a,b,c=this.player_.textTracks()||[],d=0,e=c.length,f=this.items=[];d<e;d++)if(a=c[d],a.kind==this.kind_){if(a.cues){b=a;break}a.mode="hidden",window.setTimeout(vjs.bind(this,function(){this.createMenu()}),100)}var g=this.menu;if(void 0===g&&(g=new vjs.Menu(this.player_),g.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1}))),b){var h,i,j=b.cues;for(d=0,e=j.length;d<e;d++)h=j[d],i=new vjs.ChaptersTrackMenuItem(this.player_,{track:b,cue:h}),f.push(i),g.addChild(i);this.addChild(g)}return this.items.length>0&&this.show(),g},vjs.ChaptersTrackMenuItem=vjs.MenuItem.extend({init:function(a,b){var c=this.track=b.track,d=this.cue=b.cue,e=a.currentTime();b.label=d.text,b.selected=d.startTime<=e&&e<d.endTime,vjs.MenuItem.call(this,a,b),c.addEventListener("cuechange",vjs.bind(this,this.update))}}),vjs.ChaptersTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},vjs.ChaptersTrackMenuItem.prototype.update=function(){var a=this.cue,b=this.player_.currentTime();this.selected(a.startTime<=b&&b<a.endTime)}}(),function(){"use strict";function a(a){var b;return a.selectedOptions?b=a.selectedOptions[0]:a.options&&(b=a.options[a.options.selectedIndex]),b.value}function b(a,b){var c,d;if(b){for(c=0;c<a.options.length&&(d=a.options[c],d.value!==b);c++);a.selectedIndex=c}}function c(){return'<div class="vjs-tracksettings"><div class="vjs-tracksettings-colors"><div class="vjs-fg-color vjs-tracksetting"><label class="vjs-label">Foreground</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-text-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Opaque</option></select></span></div><div class="vjs-bg-color vjs-tracksetting"><label class="vjs-label">Background</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-bg-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div><div class="window-color vjs-tracksetting"><label class="vjs-label">Window</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-window-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div></div><div class="vjs-tracksettings-font"><div class="vjs-font-percent vjs-tracksetting"><label class="vjs-label">Font Size</label><select><option value="0.50">50%</option><option value="0.75">75%</option><option value="1.00" selected>100%</option><option value="1.25">125%</option><option value="1.50">150%</option><option value="1.75">175%</option><option value="2.00">200%</option><option value="3.00">300%</option><option value="4.00">400%</option></select></div><div class="vjs-edge-style vjs-tracksetting"><label class="vjs-label">Text Edge Style</label><select><option value="none">None</option><option value="raised">Raised</option><option value="depressed">Depressed</option><option value="uniform">Uniform</option><option value="dropshadow">Dropshadow</option></select></div><div class="vjs-font-family vjs-tracksetting"><label class="vjs-label">Font Family</label><select><option value="">Default</option><option value="monospaceSerif">Monospace Serif</option><option value="proportionalSerif">Proportional Serif</option><option value="monospaceSansSerif">Monospace Sans-Serif</option><option value="proportionalSansSerif">Proportional Sans-Serif</option><option value="casual">Casual</option><option value="script">Script</option><option value="small-caps">Small Caps</option></select></div></div></div><div class="vjs-tracksettings-controls"><button class="vjs-default-button">Defaults</button><button class="vjs-done-button">Done</button></div>'}vjs.TextTrackSettings=vjs.Component.extend({init:function(a,b){vjs.Component.call(this,a,b),this.hide(),vjs.on(this.el().querySelector(".vjs-done-button"),"click",vjs.bind(this,function(){this.saveSettings(),this.hide()})),vjs.on(this.el().querySelector(".vjs-default-button"),"click",vjs.bind(this,function(){this.el().querySelector(".vjs-fg-color > select").selectedIndex=0,this.el().querySelector(".vjs-bg-color > select").selectedIndex=0,this.el().querySelector(".window-color > select").selectedIndex=0,this.el().querySelector(".vjs-text-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-bg-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-window-opacity > select").selectedIndex=0,this.el().querySelector(".vjs-edge-style select").selectedIndex=0,this.el().querySelector(".vjs-font-family select").selectedIndex=0,this.el().querySelector(".vjs-font-percent select").selectedIndex=2,this.updateDisplay()})),vjs.on(this.el().querySelector(".vjs-fg-color > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-bg-color > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".window-color > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-text-opacity > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-bg-opacity > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-window-opacity > select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-font-percent select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-edge-style select"),"change",vjs.bind(this,this.updateDisplay)),vjs.on(this.el().querySelector(".vjs-font-family select"),"change",vjs.bind(this,this.updateDisplay)),a.options().persistTextTrackSettings&&this.restoreSettings()}}),vjs.TextTrackSettings.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:c()})},vjs.TextTrackSettings.prototype.getValues=function(){var b,c,d,e,f,g,h,i,j,k,l,m;b=this.el(),f=a(b.querySelector(".vjs-edge-style select")),g=a(b.querySelector(".vjs-font-family select")),h=a(b.querySelector(".vjs-fg-color > select")),d=a(b.querySelector(".vjs-text-opacity > select")),i=a(b.querySelector(".vjs-bg-color > select")),c=a(b.querySelector(".vjs-bg-opacity > select")),j=a(b.querySelector(".window-color > select")),e=a(b.querySelector(".vjs-window-opacity > select")),m=window.parseFloat(a(b.querySelector(".vjs-font-percent > select"))),k={backgroundOpacity:c,textOpacity:d,windowOpacity:e,edgeStyle:f,fontFamily:g,color:h,backgroundColor:i,windowColor:j,fontPercent:m};for(l in k)(""===k[l]||"none"===k[l]||"fontPercent"===l&&1===k[l])&&delete k[l];return k},vjs.TextTrackSettings.prototype.setValues=function(a){var c,d=this.el();b(d.querySelector(".vjs-edge-style select"),a.edgeStyle),b(d.querySelector(".vjs-font-family select"),a.fontFamily),b(d.querySelector(".vjs-fg-color > select"),a.color),b(d.querySelector(".vjs-text-opacity > select"),a.textOpacity),b(d.querySelector(".vjs-bg-color > select"),a.backgroundColor),b(d.querySelector(".vjs-bg-opacity > select"),a.backgroundOpacity),b(d.querySelector(".window-color > select"),a.windowColor),b(d.querySelector(".vjs-window-opacity > select"),a.windowOpacity),c=a.fontPercent,c&&(c=c.toFixed(2)),b(d.querySelector(".vjs-font-percent > select"),c)},vjs.TextTrackSettings.prototype.restoreSettings=function(){var a;try{a=JSON.parse(window.localStorage.getItem("vjs-text-track-settings"))}catch(b){}a&&this.setValues(a)},vjs.TextTrackSettings.prototype.saveSettings=function(){var a;if(this.player_.options().persistTextTrackSettings){a=this.getValues();try{vjs.isEmpty(a)?window.localStorage.removeItem("vjs-text-track-settings"):window.localStorage.setItem("vjs-text-track-settings",JSON.stringify(a))}catch(b){}}},vjs.TextTrackSettings.prototype.updateDisplay=function(){var a=this.player_.getChild("textTrackDisplay");a&&a.updateDisplay()}}(),vjs.JSON,"undefined"!=typeof window.JSON&&"function"==typeof window.JSON.parse)vjs.JSON=window.JSON;else{vjs.JSON={};var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;vjs.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data")}}vjs.autoSetup=function(){var a,b,c,d,e,f=document.getElementsByTagName("video"),g=document.getElementsByTagName("audio"),h=[];if(f&&f.length>0)for(d=0,e=f.length;d<e;d++)h.push(f[d]);if(g&&g.length>0)for(d=0,e=g.length;d<e;d++)h.push(g[d]);if(h&&h.length>0)for(d=0,e=h.length;d<e;d++){if(b=h[d],!b||!b.getAttribute){vjs.autoSetupTimeout(1);break}void 0===b.player&&(a=b.getAttribute("data-setup"),null!==a&&(c=videojs(b)))}else vjs.windowLoaded||vjs.autoSetupTimeout(1)},vjs.autoSetupTimeout=function(a){setTimeout(vjs.autoSetup,a)},"complete"===document.readyState?vjs.windowLoaded=!0:vjs.one(window,"load",function(){
vjs.windowLoaded=!0}),vjs.autoSetupTimeout(1),vjs.plugin=function(a,b){vjs.Player.prototype[a]=b},function(a){var b=a.vttjs={},c=b.VTTCue,d=b.VTTRegion,e=a.VTTCue,f=a.VTTRegion;b.shim=function(){b.VTTCue=c,b.VTTRegion=d},b.restore=function(){b.VTTCue=e,b.VTTRegion=f}}(this),function(a,b){function c(a){if("string"!=typeof a)return!1;var b=h[a.toLowerCase()];return!!b&&a.toLowerCase()}function d(a){if("string"!=typeof a)return!1;var b=i[a.toLowerCase()];return!!b&&a.toLowerCase()}function e(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a}function f(a,b,f){var h=this,i=/MSIE\s8\.0/.test(navigator.userAgent),j={};i?h=document.createElement("custom"):j.enumerable=!0,h.hasBeenReset=!1;var k="",l=!1,m=a,n=b,o=f,p=null,q="",r=!0,s="auto",t="start",u=50,v="middle",w=50,x="middle";if(Object.defineProperty(h,"id",e({},j,{get:function(){return k},set:function(a){k=""+a}})),Object.defineProperty(h,"pauseOnExit",e({},j,{get:function(){return l},set:function(a){l=!!a}})),Object.defineProperty(h,"startTime",e({},j,{get:function(){return m},set:function(a){if("number"!=typeof a)throw new TypeError("Start time must be set to a number.");m=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",e({},j,{get:function(){return n},set:function(a){if("number"!=typeof a)throw new TypeError("End time must be set to a number.");n=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",e({},j,{get:function(){return o},set:function(a){o=""+a,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",e({},j,{get:function(){return p},set:function(a){p=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",e({},j,{get:function(){return q},set:function(a){var b=c(a);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");q=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",e({},j,{get:function(){return r},set:function(a){r=!!a,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",e({},j,{get:function(){return s},set:function(a){if("number"!=typeof a&&a!==g)throw new SyntaxError("An invalid number or illegal string was specified.");s=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",e({},j,{get:function(){return t},set:function(a){var b=d(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");t=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",e({},j,{get:function(){return u},set:function(a){if(a<0||a>100)throw new Error("Position must be between 0 and 100.");u=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",e({},j,{get:function(){return v},set:function(a){var b=d(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");v=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",e({},j,{get:function(){return w},set:function(a){if(a<0||a>100)throw new Error("Size must be between 0 and 100.");w=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",e({},j,{get:function(){return x},set:function(a){var b=d(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");x=b,this.hasBeenReset=!0}})),h.displayState=void 0,i)return h}var g="auto",h={"":!0,lr:!0,rl:!0},i={start:!0,middle:!0,end:!0,left:!0,right:!0};f.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},a.VTTCue=a.VTTCue||f,b.VTTCue=f}(this,this.vttjs||{}),function(a,b){function c(a){if("string"!=typeof a)return!1;var b=f[a.toLowerCase()];return!!b&&a.toLowerCase()}function d(a){return"number"==typeof a&&a>=0&&a<=100}function e(){var a=100,b=3,e=0,f=100,g=0,h=100,i="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return a},set:function(b){if(!d(b))throw new Error("Width must be between 0 and 100.");a=b}},lines:{enumerable:!0,get:function(){return b},set:function(a){if("number"!=typeof a)throw new TypeError("Lines must be set to a number.");b=a}},regionAnchorY:{enumerable:!0,get:function(){return f},set:function(a){if(!d(a))throw new Error("RegionAnchorX must be between 0 and 100.");f=a}},regionAnchorX:{enumerable:!0,get:function(){return e},set:function(a){if(!d(a))throw new Error("RegionAnchorY must be between 0 and 100.");e=a}},viewportAnchorY:{enumerable:!0,get:function(){return h},set:function(a){if(!d(a))throw new Error("ViewportAnchorY must be between 0 and 100.");h=a}},viewportAnchorX:{enumerable:!0,get:function(){return g},set:function(a){if(!d(a))throw new Error("ViewportAnchorX must be between 0 and 100.");g=a}},scroll:{enumerable:!0,get:function(){return i},set:function(a){var b=c(a);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");i=b}}})}var f={"":!0,up:!0};a.VTTRegion=a.VTTRegion||e,b.VTTRegion=e}(this,this.vttjs||{}),function(a){function b(a,b){this.name="ParsingError",this.code=a.code,this.message=b||a.message}function c(a){function b(a,b,c,d){return 3600*(0|a)+60*(0|b)+(0|c)+(0|d)/1e3}var c=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return c?c[3]?b(c[1],c[2],c[3].replace(":",""),c[4]):c[1]>59?b(c[1],c[2],0,c[4]):b(0,c[1],c[2],c[4]):null}function d(){this.values=o(null)}function e(a,b,c,d){var e=d?a.split(d):[a];for(var f in e)if("string"==typeof e[f]){var g=e[f].split(c);if(2===g.length){var h=g[0],i=g[1];b(h,i)}}}function f(a,f,g){function h(){var d=c(a);if(null===d)throw new b(b.Errors.BadTimeStamp,"Malformed timestamp: "+k);return a=a.replace(/^[^\sa-zA-Z-]+/,""),d}function i(a,b){var c=new d;e(a,function(a,b){switch(a){case"region":for(var d=g.length-1;d>=0;d--)if(g[d].id===b){c.set(a,g[d].region);break}break;case"vertical":c.alt(a,b,["rl","lr"]);break;case"line":var e=b.split(","),f=e[0];c.integer(a,f),c.percent(a,f)?c.set("snapToLines",!1):null,c.alt(a,f,["auto"]),2===e.length&&c.alt("lineAlign",e[1],["start","middle","end"]);break;case"position":e=b.split(","),c.percent(a,e[0]),2===e.length&&c.alt("positionAlign",e[1],["start","middle","end"]);break;case"size":c.percent(a,b);break;case"align":c.alt(a,b,["start","middle","end","left","right"])}},/:/,/\s/),b.region=c.get("region",null),b.vertical=c.get("vertical",""),b.line=c.get("line","auto"),b.lineAlign=c.get("lineAlign","start"),b.snapToLines=c.get("snapToLines",!0),b.size=c.get("size",100),b.align=c.get("align","middle"),b.position=c.get("position",{start:0,left:0,middle:50,end:100,right:100},b.align),b.positionAlign=c.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},b.align)}function j(){a=a.replace(/^\s+/,"")}var k=a;if(j(),f.startTime=h(),j(),"-->"!==a.substr(0,3))throw new b(b.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+k);a=a.substr(3),j(),f.endTime=h(),j(),i(a,f)}function g(a,b){function d(){function a(a){return b=b.substr(a.length),a}if(!b)return null;var c=b.match(/^([^<]*)(<[^>]+>?)?/);return a(c[1]?c[1]:c[2])}function e(a){return p[a]}function f(a){for(;o=a.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)a=a.replace(o[0],e);return a}function g(a,b){return!s[b.localName]||s[b.localName]===a.localName}function h(b,c){var d=q[b];if(!d)return null;var e=a.document.createElement(d);e.localName=d;var f=r[b];return f&&c&&(e[f]=c.trim()),e}for(var i,j=a.document.createElement("div"),k=j,l=[];null!==(i=d());)if("<"!==i[0])k.appendChild(a.document.createTextNode(f(i)));else{if("/"===i[1]){l.length&&l[l.length-1]===i.substr(2).replace(">","")&&(l.pop(),k=k.parentNode);continue}var m,n=c(i.substr(1,i.length-2));if(n){m=a.document.createProcessingInstruction("timestamp",n),k.appendChild(m);continue}var o=i.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!o)continue;if(m=h(o[1],o[3]),!m)continue;if(!g(k,m))continue;o[2]&&(m.className=o[2].substr(1).replace("."," ")),l.push(o[1]),k.appendChild(m),k=m}return j}function h(a){function b(a,b){for(var c=b.childNodes.length-1;c>=0;c--)a.push(b.childNodes[c])}function c(a){if(!a||!a.length)return null;var d=a.pop(),e=d.textContent||d.innerText;if(e){var f=e.match(/^.*(\n|\r)/);return f?(a.length=0,f[0]):e}return"ruby"===d.tagName?c(a):d.childNodes?(b(a,d),c(a)):void 0}var d,e=[],f="";if(!a||!a.childNodes)return"ltr";for(b(e,a);f=c(e);)for(var g=0;g<f.length;g++){d=f.charCodeAt(g);for(var h=0;h<t.length;h++)if(t[h]===d)return"rtl"}return"ltr"}function i(a){if("number"==typeof a.line&&(a.snapToLines||a.line>=0&&a.line<=100))return a.line;if(!a.track||!a.track.textTrackList||!a.track.textTrackList.mediaElement)return-1;for(var b=a.track,c=b.textTrackList,d=0,e=0;e<c.length&&c[e]!==b;e++)"showing"===c[e].mode&&d++;return++d*-1}function j(){}function k(a,b,c){var d=/MSIE\s8\.0/.test(navigator.userAgent),e="rgba(255, 255, 255, 1)",f="rgba(0, 0, 0, 0.8)";d&&(e="rgb(255, 255, 255)",f="rgb(0, 0, 0)"),j.call(this),this.cue=b,this.cueDiv=g(a,b.text);var i={color:e,backgroundColor:f,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};d||(i.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl",i.unicodeBidi="plaintext"),this.applyStyles(i,this.cueDiv),this.div=a.document.createElement("div"),i={textAlign:"middle"===b.align?"center":b.align,font:c.font,whiteSpace:"pre-line",position:"absolute"},d||(i.direction=h(this.cueDiv),i.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(i),this.div.appendChild(this.cueDiv);var k=0;switch(b.positionAlign){case"start":k=b.position;break;case"middle":k=b.position-b.size/2;break;case"end":k=b.position-b.size}""===b.vertical?this.applyStyles({left:this.formatStyle(k,"%"),width:this.formatStyle(b.size,"%")}):this.applyStyles({top:this.formatStyle(k,"%"),height:this.formatStyle(b.size,"%")}),this.move=function(a){this.applyStyles({top:this.formatStyle(a.top,"px"),bottom:this.formatStyle(a.bottom,"px"),left:this.formatStyle(a.left,"px"),right:this.formatStyle(a.right,"px"),height:this.formatStyle(a.height,"px"),width:this.formatStyle(a.width,"px")})}}function l(a){var b,c,d,e,f=/MSIE\s8\.0/.test(navigator.userAgent);if(a.div){c=a.div.offsetHeight,d=a.div.offsetWidth,e=a.div.offsetTop;var g=(g=a.div.childNodes)&&(g=g[0])&&g.getClientRects&&g.getClientRects();a=a.div.getBoundingClientRect(),b=g?Math.max(g[0]&&g[0].height||0,a.height/g.length):0}this.left=a.left,this.right=a.right,this.top=a.top||e,this.height=a.height||c,this.bottom=a.bottom||e+(a.height||c),this.width=a.width||d,this.lineHeight=void 0!==b?b:a.lineHeight,f&&!this.lineHeight&&(this.lineHeight=13)}function m(a,b,c,d){function e(a,b){for(var e,f=new l(a),g=1,h=0;h<b.length;h++){for(;a.overlapsOppositeAxis(c,b[h])||a.within(c)&&a.overlapsAny(d);)a.move(b[h]);if(a.within(c))return a;var i=a.intersectPercentage(c);g>i&&(e=new l(a),g=i),a=new l(f)}return e||f}var f=new l(b),g=b.cue,h=i(g),j=[];if(g.snapToLines){var k;switch(g.vertical){case"":j=["+y","-y"],k="height";break;case"rl":j=["+x","-x"],k="width";break;case"lr":j=["-x","+x"],k="width"}var m=f.lineHeight,n=m*Math.round(h),o=c[k]+m,p=j[0];Math.abs(n)>o&&(n=n<0?-1:1,n*=Math.ceil(o/m)*m),h<0&&(n+=""===g.vertical?c.height:c.width,j=j.reverse()),f.move(p,n)}else{var q=f.lineHeight/c.height*100;switch(g.lineAlign){case"middle":h-=q/2;break;case"end":h-=q}switch(g.vertical){case"":b.applyStyles({top:b.formatStyle(h,"%")});break;case"rl":b.applyStyles({left:b.formatStyle(h,"%")});break;case"lr":b.applyStyles({right:b.formatStyle(h,"%")})}j=["+y","-x","+x","-y"],f=new l(b)}var r=e(f,j);b.move(r.toCSSCompatValues(c))}function n(){}var o=Object.create||function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return a.prototype=b,new a}}();b.prototype=o(Error.prototype),b.prototype.constructor=b,b.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},d.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){var c;return!!((c=b.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(b=parseFloat(b),b>=0&&b<=100))&&(this.set(a,b),!0)}};var p={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},q={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},r={v:"title",lang:"lang"},s={rt:"ruby"},t=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];j.prototype.applyStyles=function(a,b){b=b||this.div;for(var c in a)a.hasOwnProperty(c)&&(b.style[c]=a[c])},j.prototype.formatStyle=function(a,b){return 0===a?0:a+b},k.prototype=o(j.prototype),k.prototype.constructor=k,l.prototype.move=function(a,b){switch(b=void 0!==b?b:this.lineHeight,a){case"+x":this.left+=b,this.right+=b;break;case"-x":this.left-=b,this.right-=b;break;case"+y":this.top+=b,this.bottom+=b;break;case"-y":this.top-=b,this.bottom-=b}},l.prototype.overlaps=function(a){return this.left<a.right&&this.right>a.left&&this.top<a.bottom&&this.bottom>a.top},l.prototype.overlapsAny=function(a){for(var b=0;b<a.length;b++)if(this.overlaps(a[b]))return!0;return!1},l.prototype.within=function(a){return this.top>=a.top&&this.bottom<=a.bottom&&this.left>=a.left&&this.right<=a.right},l.prototype.overlapsOppositeAxis=function(a,b){switch(b){case"+x":return this.left<a.left;case"-x":return this.right>a.right;case"+y":return this.top<a.top;case"-y":return this.bottom>a.bottom}},l.prototype.intersectPercentage=function(a){var b=Math.max(0,Math.min(this.right,a.right)-Math.max(this.left,a.left)),c=Math.max(0,Math.min(this.bottom,a.bottom)-Math.max(this.top,a.top)),d=b*c;return d/(this.height*this.width)},l.prototype.toCSSCompatValues=function(a){return{top:this.top-a.top,bottom:a.bottom-this.bottom,left:this.left-a.left,right:a.right-this.right,height:this.height,width:this.width}},l.getSimpleBoxPosition=function(a){var b=a.div?a.div.offsetHeight:a.tagName?a.offsetHeight:0,c=a.div?a.div.offsetWidth:a.tagName?a.offsetWidth:0,d=a.div?a.div.offsetTop:a.tagName?a.offsetTop:0;a=a.div?a.div.getBoundingClientRect():a.tagName?a.getBoundingClientRect():a;var e={left:a.left,right:a.right,top:a.top||d,height:a.height||b,bottom:a.bottom||d+(a.height||b),width:a.width||c};return e},n.StringDecoder=function(){return{decode:function(a){if(!a)return"";if("string"!=typeof a)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}},n.convertCueToDOMTree=function(a,b){return a&&b?g(a,b):null};var u=.05,v="sans-serif",w="1.5%";n.processCues=function(a,b,c){function d(a){for(var b=0;b<a.length;b++)if(a[b].hasBeenReset||!a[b].displayState)return!0;return!1}if(!a||!b||!c)return null;for(;c.firstChild;)c.removeChild(c.firstChild);var e=a.document.createElement("div");if(e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin=w,c.appendChild(e),d(b)){var f=[],g=l.getSimpleBoxPosition(e),h=Math.round(g.height*u*100)/100,i={font:h+"px "+v};!function(){for(var c,d,h=0;h<b.length;h++)d=b[h],c=new k(a,d,i),e.appendChild(c.div),m(a,c,g,f),d.displayState=c.div,f.push(l.getSimpleBoxPosition(c))}()}else for(var j=0;j<b.length;j++)e.appendChild(b[j].displayState)},n.Parser=function(a,b,c){c||(c=b,b={}),b||(b={}),this.window=a,this.vttjs=b,this.state="INITIAL",this.buffer="",this.decoder=c||new TextDecoder("utf8"),this.regionList=[]},n.Parser.prototype={reportOrThrowError:function(a){if(!(a instanceof b))throw a;this.onparsingerror&&this.onparsingerror(a)},parse:function(a){function c(){for(var a=i.buffer,b=0;b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var c=a.substr(0,b);return"\r"===a[b]&&++b,"\n"===a[b]&&++b,i.buffer=a.substr(b),c}function g(a){var b=new d;if(e(a,function(a,c){switch(a){case"id":b.set(a,c);break;case"width":b.percent(a,c);break;case"lines":b.integer(a,c);break;case"regionanchor":case"viewportanchor":var e=c.split(",");if(2!==e.length)break;var f=new d;if(f.percent("x",e[0]),f.percent("y",e[1]),!f.has("x")||!f.has("y"))break;b.set(a+"X",f.get("x")),b.set(a+"Y",f.get("y"));break;case"scroll":b.alt(a,c,["up"])}},/=/,/\s/),b.has("id")){var c=new(i.vttjs.VTTRegion||i.window.VTTRegion);c.width=b.get("width",100),c.lines=b.get("lines",3),c.regionAnchorX=b.get("regionanchorX",0),c.regionAnchorY=b.get("regionanchorY",100),c.viewportAnchorX=b.get("viewportanchorX",0),c.viewportAnchorY=b.get("viewportanchorY",100),c.scroll=b.get("scroll",""),i.onregion&&i.onregion(c),i.regionList.push({id:b.get("id"),region:c})}}function h(a){e(a,function(a,b){switch(a){case"Region":g(b)}},/:/)}var i=this;a&&(i.buffer+=i.decoder.decode(a,{stream:!0}));try{var j;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;j=c();var k=j.match(/^WEBVTT([ \t].*)?$/);if(!k||!k[0])throw new b(b.Errors.BadSignature);i.state="HEADER"}for(var l=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(l?l=!1:j=c(),i.state){case"HEADER":/:/.test(j)?h(j):j||(i.state="ID");continue;case"NOTE":j||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(j)){i.state="NOTE";break}if(!j)continue;if(i.cue=new(i.vttjs.VTTCue||i.window.VTTCue)(0,0,""),i.state="CUE",j.indexOf("-->")===-1){i.cue.id=j;continue}case"CUE":try{f(j,i.cue,i.regionList)}catch(m){i.reportOrThrowError(m),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var n=j.indexOf("-->")!==-1;if(!j||n&&(l=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=j;continue;case"BADCUE":j||(i.state="ID");continue}}}catch(m){i.reportOrThrowError(m),"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var a=this;try{if(a.buffer+=a.decoder.decode(),(a.cue||"HEADER"===a.state)&&(a.buffer+="\n\n",a.parse()),"INITIAL"===a.state)throw new b(b.Errors.BadSignature)}catch(c){a.reportOrThrowError(c)}return a.onflush&&a.onflush(),this}},a.WebVTT=n}(this,this.vttjs||{}),function(a){var b,c=0,d=a.MediaSource||a.WebKitMediaSource||{},e=a.URL||{},f=/video\/flv(;\s*codecs=["']vp6,aac["'])?$/,g="blob:vjs-media-source/";b=function(){},b.prototype.init=function(){this.listeners=[]},b.prototype.addEventListener=function(a,b){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].unshift(b)},b.prototype.removeEventListener=function(a,b){for(var c=this.listeners[a],d=c.length;d--;)if(c[d]===b)return c.splice(d,1)},b.prototype.trigger=function(a){for(var b=this.listeners[a.type]||[],c=b.length;c--;)b[c](a)},videojs.MediaSource=function(){var a=this;videojs.MediaSource.prototype.init.call(this),this.sourceBuffers=[],this.readyState="closed",this.listeners={sourceopen:[function(b){a.swfObj=document.getElementById(b.swfId),a.readyState="open",a.swfObj&&a.swfObj.vjs_load()}],webkitsourceopen:[function(b){a.trigger({type:"sourceopen"})}]}},videojs.MediaSource.prototype=new b,videojs.MediaSource.BYTES_PER_SECOND_GOAL=4194304,videojs.MediaSource.TICKS_PER_SECOND=60,videojs.MediaSource.prototype.addSourceBuffer=function(a){var b;if(f.test(a))b=new videojs.SourceBuffer(this);else{if(!this.nativeSource)throw new Error("NotSupportedError (Video.js)");b=this.nativeSource.addSourceBuffer.apply(this.nativeSource,arguments)}return this.sourceBuffers.push(b),b},videojs.MediaSource.prototype.endOfStream=function(){this.readyState="ended"},videojs.mediaSources={},videojs.MediaSource.open=function(a,b){var c=videojs.mediaSources[a];if(!c)throw new Error("Media Source not found (Video.js)");c.trigger({type:"sourceopen",swfId:b})},videojs.SourceBuffer=function(b){var c=this,d=[],e=0,f=function(b){a.setTimeout(b,Math.ceil(1e3/videojs.MediaSource.TICKS_PER_SECOND))},g=function(){var b,h,i,j,k,l="";if(d.length){for(k=document.hidden?videojs.MediaSource.BYTES_PER_SECOND_GOAL:Math.ceil(videojs.MediaSource.BYTES_PER_SECOND_GOAL/videojs.MediaSource.TICKS_PER_SECOND),j=new Uint8Array(Math.min(k,e)),h=j.byteLength;h;)b=d[0].subarray(0,h),j.set(b,j.byteLength-h),b.byteLength<d[0].byteLength?d[0]=d[0].subarray(h):d.shift(),h-=b.byteLength;for(e-=j.byteLength,h=0,i=j.byteLength;h<i;h++)l+=String.fromCharCode(j[h]);b64str=a.btoa(l),c.source.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+b64str+"</string></arguments></invoke>"),0!==e?f(g):(c.updating=!1,c.trigger({type:"updateend"}),"ended"===c.source.readyState&&c.source.swfObj.vjs_endOfStream())}};videojs.SourceBuffer.prototype.init.call(this),this.source=b,this.updating=!1,this.appendBuffer=function(a){var b;if(this.updating)throw b=new Error("SourceBuffer.append() cannot be called while an update is in progress"),b.name="InvalidStateError",b.code=11,b;0===d.length&&f(g),this.updating=!0,this.source.readyState="open",this.trigger({type:"update"}),d.push(a),e+=a.byteLength},this.abort=function(){d=[],e=0,this.source.swfObj.vjs_abort(),this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))}},videojs.SourceBuffer.prototype=new b,videojs.URL={createObjectURL:function(a){var b=g+c;return c++,videojs.mediaSources[b]=a,b}},videojs.plugin("mediaSource",function(a){var b=this;b.on("loadstart",function(){var a,c=b.currentSrc(),f=function(b){
a.trigger(b)};"Html5"===b.techName&&0===c.indexOf(g)&&(a=videojs.mediaSources[c],a.nativeUrl||(a.nativeSource=new d,a.nativeSource.addEventListener("sourceopen",f,!1),a.nativeSource.addEventListener("webkitsourceopen",f,!1),a.nativeUrl=e.createObjectURL(a.nativeSource)),b.src(a.nativeUrl))})})}(window),function(a,b,c,d){"use strict";var e,f,g,h=1.1,i=500;f=function(a){return a.retries&&a.retries>=2},b.Hls=b.Flash.extend({init:function(a,c,d){var e=c.source,f=a.options();e&&(a.hls=this,delete c.source,c.swf=f.flash.swf,b.Flash.call(this,a,c,d),c.source=e,this.bytesReceived=0,this.currentTime=b.Hls.prototype.currentTime,this.setCurrentTime=b.Hls.prototype.setCurrentTime,this.segmentBuffer_=[],this.startCheckingBuffer_(),b.Hls.prototype.src.call(this,c.source&&c.source.src))}}),b.Hls.GOAL_BUFFER_LENGTH=30,b.Hls.prototype.src=function(a){var c,f,g,h=this,i=this.player(),j=i.options().hls||{};a&&(this.src_&&this.resetSrc_(),this.src_=a,c=new b.MediaSource,g={src:b.URL.createObjectURL(c),type:"video/flv"},this.mediaSource=c,this.segmentBuffer_=[],this.segmentParser_=new b.Hls.SegmentParser,this.setupMetadataCueTranslation_(),this.mediaSource.addEventListener("sourceopen",b.bind(this,this.handleSourceOpen)),this.playlists&&this.playlists.dispose(),this.mediaIndex=0,this.playlists=new b.Hls.PlaylistLoader(this.src_,j.withCredentials),this.playlists.on("loadedmetadata",b.bind(this,function(){var a,c,e,g,h,j,k,l;k=function(){this.fillBuffer(),i.trigger("loadedmetadata")},f=this.playlists.media(),this.bandwidth===d&&this.setBandwidth({bandwidth:5*this.playlists.bandwidth}),a=this.selectPlaylist(),e=f.attributes&&f.attributes.BANDWIDTH||0,g=a.attributes&&a.attributes.BANDWIDTH||0,h=f.segments&&f.segments[this.mediaIndex].duration||f.targetDuration,j=h*g/this.bandwidth,j||(j=1/0),l=10,g>e&&j<=l?(this.playlists.media(a),c=b.bind(this,function(){k.call(this),this.playlists.off("loadedplaylist",c)}),this.playlists.on("loadedplaylist",c)):k.call(this)})),this.playlists.on("error",b.bind(this,function(){i.error(this.playlists.error)})),this.playlists.on("loadedplaylist",b.bind(this,function(){var a=this.playlists.media();a&&(this.updateDuration(this.playlists.media()),this.mediaIndex=b.Hls.translateMediaIndex(this.mediaIndex,f,a),f=a,this.fetchKeys_())})),this.playlists.on("mediachange",b.bind(this,function(){e&&this.cancelKeyXhr(),i.trigger("mediachange")})),this.player().ready(function(){h.el()&&h.el().vjs_src(g.src)}))},b.Hls.getMediaIndexForLive_=function(a){if(!a.segments)return 0;for(var b=a.segments.length,c=0,d=3*(a.targetDuration||10);c<d&&b>0;)c+=a.segments[b-1].duration,b--;return b},b.Hls.prototype.handleSourceOpen=function(){var a=this.player(),b=this.mediaSource.addSourceBuffer('video/flv; codecs="vp6,aac"');this.sourceBuffer=b,a.options().autoplay&&a.play(),b.appendBuffer(this.segmentParser_.getFlvHeader())},b.Hls.prototype.setupMetadataCueTranslation_=function(){var c,d=this,e=d.segmentParser_.metadataStream;d.player().addTextTrack&&(e.on("data",function(f){var g,h,i,j,k,l,m;if(!c)for(c=d.player().addTextTrack("metadata","Timed Metadata"),c.inBandMetadataTrackDispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16).toUpperCase(),g=0;g<e.descriptor.length;g++)m=("00"+e.descriptor[g].toString(16).toUpperCase()).slice(-2),c.inBandMetadataTrackDispatchType+=m;for(k=d.playlists.media(),l=d.playlists.expiredPreDiscontinuity_+d.playlists.expiredPostDiscontinuity_,l+=b.Hls.Playlist.duration(k,k.mediaSequence,k.mediaSequence+d.mediaIndex),g=0;g<f.frames.length;g++)i=f.frames[g],j=d.segmentParser_.mediaTimelineOffset+.001*(f.pts-d.segmentParser_.timestampOffset),h=new a.VTTCue(j,j,i.value||i.url||""),h.frame=i,c.addCue(h)}),d.on(d.player(),"seeking",function(){var a,e,f;if(c)for(a=d.playlists.media(),e=d.playlists.expiredPreDiscontinuity_+d.playlists.expiredPostDiscontinuity_,e+=b.Hls.Playlist.duration(a,a.mediaSequence,a.mediaSequence+d.mediaIndex),f=c.cues.length;f--;)c.cues[f].startTime>=e&&c.removeCue(c.cues[f])}))},b.Hls.prototype.play=function(){return this.ended()&&(this.mediaIndex=0),this.duration()===1/0&&(!this.player().hasClass("vjs-has-started")||this.currentTime()>this.seekable().end(0)?this.setCurrentTime(this.seekable().end(0)):this.currentTime()<this.seekable().start(0)&&this.setCurrentTime(this.seekable().start(0))),b.Flash.prototype.play.apply(this,arguments)},b.Hls.prototype.currentTime=function(){return this.lastSeekedTime_?this.lastSeekedTime_:this.el()&&this.el().vjs_getProperty?this.el().vjs_getProperty("currentTime"):0},b.Hls.prototype.setCurrentTime=function(a){return this.playlists&&this.playlists.media()&&this.playlists.media().segments?(a<this.seekable().start(0)?a=this.seekable().start(0):a>this.seekable().end(0)&&(a=this.seekable().end(0)),this.lastSeekedTime_=a,this.mediaIndex=this.playlists.getMediaIndexForTime_(a),this.sourceBuffer.abort(),this.cancelSegmentXhr(),e&&(e.aborted=!0,this.cancelKeyXhr()),this.segmentBuffer_=[],void this.fillBuffer(1e3*a)):0},b.Hls.prototype.duration=function(){var a=this.playlists;return a?b.Hls.Playlist.duration(a.media()):0},b.Hls.prototype.seekable=function(){var a,c,d;return this.playlists&&(d=this.playlists.media())?(a=b.Hls.Playlist.seekable(d),c=this.playlists.expiredPostDiscontinuity_-this.playlists.expiredPreDiscontinuity_,b.createTimeRange(c,c+(a.end(0)-a.start(0)))):b.createTimeRange()},b.Hls.prototype.updateDuration=function(a){var c=this.player(),d=c.duration(),e=b.Hls.Playlist.duration(a);d!==e&&c.trigger("durationchange")},b.Hls.prototype.resetSrc_=function(){this.cancelSegmentXhr(),this.cancelKeyXhr(),this.sourceBuffer&&this.sourceBuffer.abort()},b.Hls.prototype.cancelKeyXhr=function(){e&&(e.onreadystatechange=null,e.abort(),e=null)},b.Hls.prototype.cancelSegmentXhr=function(){this.segmentXhr_&&(this.segmentXhr_.onreadystatechange=null,this.segmentXhr_.abort(),this.segmentXhr_=null)},b.Hls.prototype.dispose=function(){this.stopCheckingBuffer_(),this.playlists&&this.playlists.dispose(),this.resetSrc_(),b.Flash.prototype.dispose.call(this)},b.Hls.prototype.selectPlaylist=function(){var a,c,d,e,f,g,i,j,k=this.player(),l=this.playlists.master.playlists.slice(),m=[],n=l.length;for(l.sort(b.Hls.comparePlaylistBandwidth);n--;)c=l[n],c.attributes&&c.attributes.BANDWIDTH&&(a=c.attributes.BANDWIDTH*h,a<k.hls.bandwidth&&(m.push(c),e||(e=c)));for(n=m.length,m.sort(b.Hls.comparePlaylistResolution),c=null,i=parseInt(getComputedStyle(k.el()).width,10),j=parseInt(getComputedStyle(k.el()).height,10);n--;)if(d=c,c=m[n],c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&c.attributes.RESOLUTION.height){if(c.attributes.RESOLUTION.width===i&&c.attributes.RESOLUTION.height===j){f=null,g=c;break}if(c.attributes.RESOLUTION.width<i&&c.attributes.RESOLUTION.height<j){d&&d.attributes&&d.attributes.RESOLUTION&&d.attributes.RESOLUTION.width&&d.attributes.RESOLUTION.height&&(f=d),g=c;break}}return f||g||e||l[0]},b.Hls.prototype.checkBuffer_=function(){this.checkBufferTimeout_&&(a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null),this.fillBuffer(),this.drainBuffer(),this.checkBufferTimeout_=a.setTimeout(b.bind(this,this.checkBuffer_),i)},b.Hls.prototype.startCheckingBuffer_=function(){this.player().on("waiting",b.bind(this,this.drainBuffer)),this.checkBuffer_()},b.Hls.prototype.stopCheckingBuffer_=function(){a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null,this.player().off("waiting",this.drainBuffer)},b.Hls.prototype.fillBuffer=function(a){var c,e,f=this.player(),g=f.buffered(),h=0;(f.hasClass("vjs-has-started")||"none"!==f.options().preload)&&f.currentSrc()&&this.playlists&&(this.segmentXhr_||"HAVE_NOTHING"!==this.playlists.state&&this.playlists.media()&&this.playlists.media().segments&&(this.playlists.media().endList||this.player().hasClass("vjs-has-started")||a!==d)&&"SWITCHING_MEDIA"!==this.playlists.state&&(c=this.playlists.media().segments[this.mediaIndex],c&&(g&&(h=f.buffered().end(0)-f.currentTime()),"number"!=typeof a&&h>=b.Hls.GOAL_BUFFER_LENGTH||(e=this.playlistUriToUrl(c.uri),this.loadSegment(e,a)))))},b.Hls.prototype.playlistUriToUrl=function(a){var b;return b=this.playlists.media().uri===this.src_?g(this.src_,a):g(g(this.src_,this.playlists.media().uri||""),a)},b.Hls.prototype.setBandwidth=function(a){var b=this;b.segmentXhrTime=a.roundTripTime,b.bandwidth=a.bandwidth,b.bytesReceived+=a.bytesReceived||0,b.trigger("bandwidthupdate")},b.Hls.prototype.loadSegment=function(a,c){var d=this,e=this.player(),f=e.options().hls||{};this.segmentXhr_=b.Hls.xhr({url:a,responseType:"arraybuffer",withCredentials:f.withCredentials},function(a,b){var f;return d.segmentXhr_=null,a?"timeout"===a?(d.bandwidth=1,d.playlists.media(d.selectPlaylist())):(d.error={status:this.status,message:"HLS segment request error at URL: "+b,code:this.status>=500?4:2},void d.mediaIndex++):void(this.response&&(d.setBandwidth(this),f={mediaIndex:d.mediaIndex,playlist:d.playlists.media(),offset:c,bytes:null,encryptedBytes:null,decrypter:null},f.playlist.segments[f.mediaIndex].key?f.encryptedBytes=new Uint8Array(this.response):f.bytes=new Uint8Array(this.response),d.segmentBuffer_.push(f),e.trigger("progress"),d.drainBuffer(),d.mediaIndex++,d.playlists.media(d.selectPlaylist())))})},b.Hls.prototype.drainBuffer=function(a){var c,d,e,g,h,i,j,k,l,m,n=0,o=0,p=this.segmentBuffer_;if(p.length&&this.sourceBuffer&&!this.sourceBuffer.updating){if(c=p[0],d=c.mediaIndex,e=c.playlist,g=c.offset,i=c.bytes,j=e.segments[d],j.key&&!i)return f(j.key)?p.shift():j.key.bytes?c.decrypter?void 0:(l=j.key.iv||new Uint32Array([0,0,0,d+e.mediaSequence]),k=new b.Hls.Decrypter(c.encryptedBytes,j.key.bytes,l,function(a,b){c.bytes=b}),void(c.decrypter=k)):this.fetchKeys_();for(a=a||{},o=this.playlists.expiredPreDiscontinuity_,o+=this.playlists.expiredPostDiscontinuity_,o+=b.Hls.Playlist.duration(e,e.mediaSequence,e.mediaSequence+d),o*=1e3,j.discontinuity?(this.segmentParser_.mediaTimelineOffset=.001*o,this.segmentParser_.timestampOffset=null):null===this.segmentParser_.mediaTimelineOffset&&(this.segmentParser_.mediaTimelineOffset=.001*o),this.segmentParser_.parseSegmentBinaryData(i),this.segmentParser_.flushTags(),h=[],this.segmentParser_.tagsAvailable()&&(j.minVideoPts=this.segmentParser_.stats.minVideoPts(),j.maxVideoPts=this.segmentParser_.stats.maxVideoPts(),j.minAudioPts=this.segmentParser_.stats.minAudioPts(),j.maxAudioPts=this.segmentParser_.stats.maxAudioPts());this.segmentParser_.tagsAvailable();)h.push(this.segmentParser_.getNextTag());if(this.updateDuration(this.playlists.media()),"number"==typeof g){for(m=g-o+h[0].pts;h[n].pts<m;)n++;this.el().vjs_setProperty("currentTime",.001*(h[n].pts-h[0].pts+o)),h=h.slice(n),this.lastSeekedTime_=null}j.discontinuity&&h.length&&this.el().vjs_discontinuity(),function(){var a,b,c=0;for(n=0;n<h.length;n++)c+=h[n].bytes.byteLength;for(b=new Uint8Array(c),n=0,a=0;n<h.length;n++)b.set(h[n].bytes,a),a+=h[n].bytes.byteLength;this.sourceBuffer.appendBuffer(b)}.call(this),p.shift(),this.duration()!==1/0&&d+1===e.segments.length&&this.mediaSource.endOfStream()}},b.Hls.prototype.fetchKeys_=function(){var a,c,d,g,h,i,j,k;if(!e&&this.segmentBuffer_.length)for(d=this,g=this.player(),h=g.options().hls||{},k=function(a){return function(b){return e=null,b||!this.response||16!==this.response.byteLength?(a.retries=a.retries||0,a.retries++,void(this.aborted||d.fetchKeys_())):(j=new DataView(this.response),a.bytes=new Uint32Array([j.getUint32(0),j.getUint32(4),j.getUint32(8),j.getUint32(12)]),void d.checkBuffer_())}},a=0;a<d.segmentBuffer_.length;a++)if(i=d.segmentBuffer_[a].playlist.segments[d.segmentBuffer_[a].mediaIndex],c=i.key,c&&!c.bytes&&!f(c)){e=b.Hls.xhr({url:this.playlistUriToUrl(c.uri),responseType:"arraybuffer",withCredentials:h.withCredentials},k(c));break}},b.Hls.supportsNativeHls=function(){var a,d,e=c.createElement("video");return!!b.Html5.isSupported()&&(a=e.canPlayType("application/x-mpegURL"),d=e.canPlayType("application/vnd.apple.mpegURL"),/probably|maybe/.test(a)||/probably|maybe/.test(d))}(),b.Hls.isSupported=function(){return!b.Hls.supportsNativeHls&&b.Flash.isSupported()&&b.MediaSource&&a.Uint8Array},b.Hls.canPlaySource=function(a){var b=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return b.test(a.type)},b.Hls.getPlaylistDuration=function(a,c,d){return b.log.warn("videojs.Hls.getPlaylistDuration is deprecated. Use videojs.Hls.Playlist.duration instead"),b.Hls.Playlist.duration(a,c,d)},b.Hls.getPlaylistTotalDuration=function(a){return b.log.warn("videojs.Hls.getPlaylistTotalDuration is deprecated. Use videojs.Hls.Playlist.duration instead"),b.Hls.Playlist.duration(a)},b.Hls.translateMediaIndex=function(a,c,d){var e;return 0===a?0:d&&d.segments?(e=a+(c.mediaSequence-d.mediaSequence),e>d.segments.length||e<0?b.Hls.getMediaIndexForLive_(d)+1:e):0},b.Hls.getMediaIndexByTime=function(){return b.log.warn("getMediaIndexByTime is deprecated. Use PlaylistLoader.getMediaIndexForTime_ instead."),0},b.Hls.prototype.getCurrentTimeByMediaIndex_=function(a,b){var c,d=0;if(!a.segments||0===b)return 0;for(c=0;c<b;c++)d+=a.segments[c].duration;return d},b.Hls.comparePlaylistBandwidth=function(b,c){var d,e;return b.attributes&&b.attributes.BANDWIDTH&&(d=b.attributes.BANDWIDTH),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.BANDWIDTH&&(e=c.attributes.BANDWIDTH),e=e||a.Number.MAX_VALUE,d-e},b.Hls.comparePlaylistResolution=function(b,c){var d,e;return b.attributes&&b.attributes.RESOLUTION&&b.attributes.RESOLUTION.width&&(d=b.attributes.RESOLUTION.width),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&(e=c.attributes.RESOLUTION.width),e=e||a.Number.MAX_VALUE,d===e&&b.attributes.BANDWIDTH&&c.attributes.BANDWIDTH?b.attributes.BANDWIDTH-c.attributes.BANDWIDTH:d-e},g=b.Hls.resolveUrl=function(a,b){var d,e,f=c.querySelector("base"),g=c.querySelector("head"),h=c.createElement("a"),i=f;return f?d=f.href:i=g.appendChild(c.createElement("base")),i.href=a,h.href=b,e=h.href,f?f.href=d:g.removeChild(i),e}}(window,window.videojs,document),function(a){a.Hls.xhr=function(b,c){var d,e,f={method:"GET",timeout:45e3};return"function"!=typeof c&&(c=function(){}),"object"==typeof b&&(f=a.util.mergeOptions(f,b),b=f.url),d=new window.XMLHttpRequest,d.open(f.method,b),d.url=b,d.requestTime=(new Date).getTime(),f.responseType&&(d.responseType=f.responseType),f.withCredentials&&(d.withCredentials=!0),f.timeout&&(e=window.setTimeout(function(){4!==d.readyState&&(d.timedout=!0,d.abort())},f.timeout)),d.onreadystatechange=function(){if(4===this.readyState)return window.clearTimeout(e),d.timedout?c.call(this,"timeout",b):this.status>=400||0===this.status?c.call(this,!0,b):(this.response&&(this.responseTime=(new Date).getTime(),this.roundTripTime=this.responseTime-this.requestTime,this.bytesReceived=this.response.byteLength||this.response.length,this.bandwidth=Math.floor(this.bytesReceived/this.roundTripTime*8*1e3)),c.call(this,!1,b))},d.send(null),d}}(window.videojs),function(a){a.videojs=a.videojs||{},a.videojs.Hls=a.videojs.Hls||{};var b=a.videojs.Hls;b.FlvTag=function(a,c){var d,e=0,f=function(a,b){var c,d=a.position+b;d<a.bytes.byteLength||(c=new Uint8Array(2*d),c.set(a.bytes.subarray(0,a.position),0),a.bytes=c,a.view=new DataView(a.bytes.buffer))},g=b.FlvTag.widthBytes||new Uint8Array("width".length),h=b.FlvTag.heightBytes||new Uint8Array("height".length),i=b.FlvTag.videocodecidBytes||new Uint8Array("videocodecid".length);if(!b.FlvTag.widthBytes){for(d=0;d<"width".length;d++)g[d]="width".charCodeAt(d);for(d=0;d<"height".length;d++)h[d]="height".charCodeAt(d);for(d=0;d<"videocodecid".length;d++)i[d]="videocodecid".charCodeAt(d);b.FlvTag.widthBytes=g,b.FlvTag.heightBytes=h,b.FlvTag.videocodecidBytes=i}switch(this.keyFrame=!1,a){case b.FlvTag.VIDEO_TAG:this.length=16;break;case b.FlvTag.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case b.FlvTag.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(16384),this.view=new DataView(this.bytes.buffer),this.bytes[0]=a,this.position=this.length,this.keyFrame=c,this.pts=0,this.dts=0,this.writeBytes=function(a,b,c){var d,e=b||0;c=c||a.byteLength,d=e+c,f(this,c),this.bytes.set(a.subarray(e,d),this.position),this.position+=c,this.length=Math.max(this.length,this.position)},this.writeByte=function(a){f(this,1),this.bytes[this.position]=a,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(a){f(this,2),this.view.setUint16(this.position,a),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(a){return this.bytes[this.length-a]},this.nalUnitSize=function(){return 0===e?0:this.length-(e+4)},this.startNalUnit=function(){if(e>0)throw new Error("Attempted to create new NAL wihout closing the old one");e=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(a){var b,c;this.length===e+4?this.length-=4:e>0&&(b=e+4,c=this.length-b,this.position=e,this.view.setUint32(this.position,c),this.position=this.length,a&&a.push(this.bytes.subarray(b,b+c))),e=0},this.writeMetaDataDouble=function(a,b){var c;if(f(this,2+a.length+9),this.view.setUint16(this.position,a.length),this.position+=2,"width"===a)this.bytes.set(g,this.position),this.position+=5;else if("height"===a)this.bytes.set(h,this.position),this.position+=6;else if("videocodecid"===a)this.bytes.set(i,this.position),this.position+=12;else for(c=0;c<a.length;c++)this.bytes[this.position]=a.charCodeAt(c),this.position++;this.position++,this.view.setFloat64(this.position,b),this.position+=8,this.length=Math.max(this.length,this.position),++e},this.writeMetaDataBoolean=function(a,b){var c;for(f(this,2),this.view.setUint16(this.position,a.length),this.position+=2,c=0;c<a.length;c++)f(this,1),this.bytes[this.position]=a.charCodeAt(c),this.position++;f(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,b?1:0),this.position++,this.length=Math.max(this.length,this.position),++e},this.finalize=function(){var a,d;switch(this.bytes[0]){case b.FlvTag.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||c?16:32),this.bytes[12]=c?0:1,a=this.pts-this.dts,this.bytes[13]=(16711680&a)>>>16,this.bytes[14]=(65280&a)>>>8,this.bytes[15]=(255&a)>>>0;break;case b.FlvTag.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=c?0:1;break;case b.FlvTag.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,e),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return d=this.length-11,this.bytes[1]=(16711680&d)>>>16,this.bytes[2]=(65280&d)>>>8,this.bytes[3]=(255&d)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,f(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=b.FlvTag.frameTime(this.bytes),this}},b.FlvTag.AUDIO_TAG=8,b.FlvTag.VIDEO_TAG=9,b.FlvTag.METADATA_TAG=18,b.FlvTag.isAudioFrame=function(a){return b.FlvTag.AUDIO_TAG===a[0]},b.FlvTag.isVideoFrame=function(a){return b.FlvTag.VIDEO_TAG===a[0]},b.FlvTag.isMetaData=function(a){return b.FlvTag.METADATA_TAG===a[0]},b.FlvTag.isKeyFrame=function(a){return b.FlvTag.isVideoFrame(a)?23===a[11]:!!b.FlvTag.isAudioFrame(a)||!!b.FlvTag.isMetaData(a)},b.FlvTag.frameTime=function(a){var b=a[4]<<16;return b|=a[5]<<8,b|=a[6]<<0,b|=a[7]<<24}}(this),function(a,b){var c=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return!!a[b]&&(d=a[b].indexOf(c),a[b].splice(d,1),d>-1)},this.trigger=function(b){var c,d,e,f;if(c=a[b])for(f=Array.prototype.slice.call(arguments,1),e=c.length,d=0;d<e;++d)c[d].apply(this,f)},this.dispose=function(){a={}}}};c.prototype.pipe=function(a){this.on("data",function(b){a.push(b)})},a.Hls.Stream=c}(window.videojs),function(a){a.videojs.Hls.ExpGolomb=function(a){var b=a.byteLength,c=0,d=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+d},this.loadWord=function(){var e=a.byteLength-b,f=new Uint8Array(4),g=Math.min(4,b);if(0===g)throw new Error("no bytes available");f.set(a.subarray(e,e+g)),c=new DataView(f.buffer).getUint32(0),d=8*g,b-=g},this.skipBits=function(a){var e;d>a?(c<<=a,d-=a):(a-=d,e=a/8,a-=8*e,b-=e,this.loadWord(),c<<=a,d-=a)},this.readBits=function(a){var e=Math.min(d,a),f=c>>>32-e;return d-=e,d>0?c<<=e:b>0&&this.loadWord(),e=a-e,e>0?f<<e|this.readBits(e):f},this.skipLeadingZeros=function(){var a;for(a=0;a<d;++a)if(0!==(c&2147483648>>>a))return c<<=a,d-=a,a;return this.loadWord(),a+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var a=this.skipLeadingZeros();return this.readBits(a+1)-1},this.readExpGolomb=function(){var a=this.readUnsignedExpGolomb();return 1&a?1+a>>>1:-1*(a>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}}(this),function(){var a,b=window.videojs.Hls.ExpGolomb,c=window.videojs.Hls.FlvTag;window.videojs.Hls.H264ExtraData=a=function(){this.sps=[],this.pps=[]},a.prototype.extraDataExists=function(){return this.sps.length>0},a.prototype.scaling_list=function(a,b){var c,d,e=8,f=8;for(c=0;c<a;++c)0!==f&&(d=b.readExpGolomb(),f=(e+d+256)%256),e=0===f?e:f},a.prototype.getSps0Rbsp=function(){for(var a=this.sps[0],b=1,c=1,d=0,e=a.byteLength-2,f=new Uint8Array(a.byteLength);b<e;)0===a[b]&&0===a[b+1]&&3===a[b+2]&&(f.set(a.subarray(c,b+1),d),d+=b+1-c,c=b+3),b++;return f.set(a.subarray(c),d),f.subarray(0,d+(a.byteLength-c))},a.prototype.metaDataTag=function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=new c(c.METADATA_TAG),r=0,s=0,t=0,u=0;if(q.dts=a,q.pts=a,d=new b(this.getSps0Rbsp()),e=d.readUnsignedByte(),d.skipBits(16),d.skipUnsignedExpGolomb(),(100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e)&&(f=d.readUnsignedExpGolomb(),3===f&&d.skipBits(1),d.skipUnsignedExpGolomb(),d.skipUnsignedExpGolomb(),d.skipBits(1),d.readBoolean()))for(g=3!==f?8:12,h=0;h<g;++h)d.readBoolean()&&(h<6?this.scaling_list(16,d):this.scaling_list(64,d));if(d.skipUnsignedExpGolomb(),i=d.readUnsignedExpGolomb(),0===i)d.readUnsignedExpGolomb();else if(1===i)for(d.skipBits(1),d.skipExpGolomb(),d.skipExpGolomb(),j=d.readUnsignedExpGolomb(),h=0;h<j;++h)d.skipExpGolomb();return d.skipUnsignedExpGolomb(),d.skipBits(1),k=d.readUnsignedExpGolomb(),l=d.readUnsignedExpGolomb(),m=d.readBits(1),0===m&&d.skipBits(1),d.skipBits(1),n=d.readBoolean(),n&&(r=d.readUnsignedExpGolomb(),s=d.readUnsignedExpGolomb(),t=d.readUnsignedExpGolomb(),u=d.readUnsignedExpGolomb()),o=16*(k+1)-2*r-2*s,p=(2-m)*(l+1)*16-2*t-2*u,q.writeMetaDataDouble("videocodecid",7),q.writeMetaDataDouble("width",o),q.writeMetaDataDouble("height",p),q},a.prototype.extraDataTag=function(a){var b,d=new c(c.VIDEO_TAG,(!0));for(d.dts=a,d.pts=a,d.writeByte(1),d.writeByte(this.sps[0][1]),d.writeByte(this.sps[0][2]),d.writeByte(this.sps[0][3]),d.writeByte(255),d.writeByte(225),d.writeShort(this.sps[0].length),d.writeBytes(this.sps[0]),d.writeByte(this.pps.length),b=0;b<this.pps.length;++b)d.writeShort(this.pps[b].length),d.writeBytes(this.pps[b]);return d}}(),function(a){var b,c,d=a.videojs.Hls.FlvTag,e=a.videojs.Hls.H264ExtraData;a.videojs.Hls.NALUnitType=c={unspecified:0,slice_layer_without_partitioning_rbsp_non_idr:1,slice_data_partition_a_layer_rbsp:2,slice_data_partition_b_layer_rbsp:3,slice_data_partition_c_layer_rbsp:4,slice_layer_without_partitioning_rbsp_idr:5,sei_rbsp:6,seq_parameter_set_rbsp:7,pic_parameter_set_rbsp:8,access_unit_delimiter_rbsp:9,end_of_seq_rbsp:10,end_of_stream_rbsp:11},a.videojs.Hls.H264Stream=b=function(){this._next_pts=0,this._next_dts=0,this._h264Frame=null,this._oldExtraData=new e,this._newExtraData=new e,this._nalUnitType=-1,this._state=0,this.tags=[]},b.prototype.setTimeStampOffset=function(){},b.prototype.setNextTimeStamp=function(a,b,c){this._next_pts=a,this._next_dts=b,c&&this.finishFrame()},b.prototype.finishFrame=function(){this._h264Frame&&(this._newExtraData.extraDataExists()&&(this._oldExtraData=this._newExtraData,this._newExtraData=new e),this._oldExtraData.extraDataExists()&&(this._h264Frame.keyFrame||0===this.tags.length)&&(this.tags.push(this._oldExtraData.metaDataTag(this._h264Frame.pts)),this.tags.push(this._oldExtraData.extraDataTag(this._h264Frame.pts))),this._h264Frame.endNalUnit(),this.tags.push(this._h264Frame)),this._h264Frame=null,this._nalUnitType=-1,this._state=0},b.prototype.writeBytes=function(a,b,e){var f,g,h,i;if(b=b||0,e=e||0,!(e<=0))switch(this._state){default:case 0:this._state=1;case 1:if(a[b]<=1&&(f=this._h264Frame?this._h264Frame.nalUnitSize():0,f>=1&&0===this._h264Frame.negIndex(1))){if(1===a[b]&&f>=2&&0===this._h264Frame.negIndex(2))return 3<=f&&0===this._h264Frame.negIndex(3)?this._h264Frame.length-=3:this._h264Frame.length-=2,this._state=3,this.writeBytes(a,b+1,e-1);if(e>1&&0===a[b]&&1===a[b+1])return f>=2&&0===this._h264Frame.negIndex(2)?this._h264Frame.length-=2:this._h264Frame.length-=1,this._state=3,this.writeBytes(a,b+2,e-2);if(e>2&&0===a[b]&&0===a[b+1]&&1===a[b+2])return this._state=3,this.writeBytes(a,b+3,e-3)}this._state=2;case 2:for(g=b,h=g+e,i=h-3;b<i;)if(a[b+2]>1)b+=3;else if(0!==a[b+1])b+=2;else if(0!==a[b])b+=1;else{if(1===a[b+2])return b>g&&this._h264Frame.writeBytes(a,g,b-g),this._state=3,b+=3,this.writeBytes(a,b,h-b);if(h-b>=4&&0===a[b+2]&&1===a[b+3])return b>g&&this._h264Frame.writeBytes(a,g,b-g),this._state=3,b+=4,this.writeBytes(a,b,h-b);b+=3}return this._state=1,void(this._h264Frame&&this._h264Frame.writeBytes(a,g,e));case 3:if(this._h264Frame)switch(this._nalUnitType){case c.seq_parameter_set_rbsp:this._h264Frame.endNalUnit(this._newExtraData.sps);break;case c.pic_parameter_set_rbsp:this._h264Frame.endNalUnit(this._newExtraData.pps);break;case c.slice_layer_without_partitioning_rbsp_idr:this._h264Frame.endNalUnit();break;default:this._h264Frame.endNalUnit()}return this._nalUnitType=31&a[b],this._h264Frame&&(this._nalUnitType===c.access_unit_delimiter_rbsp?this.finishFrame():this._nalUnitType===c.slice_layer_without_partitioning_rbsp_idr&&(this._h264Frame.keyFrame=!0)),this._h264Frame||(this._h264Frame=new d(d.VIDEO_TAG),this._h264Frame.pts=this._next_pts,this._h264Frame.dts=this._next_dts),this._h264Frame.startNalUnit(),this._state=2,this.writeBytes(a,b,e)}}}(this),function(a){var b=a.videojs.Hls.FlvTag,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3];a.videojs.Hls.AacStream=function(){var a,d,e,f,g,h,i,j,k,l,m,n,o;this.tags=[],this.setTimeStampOffset=function(a){f=a-1e3},this.setNextTimeStamp=function(b,c,f){a=b,e=c,f&&(d=0)},this.writeBytes=function(p,q,r){var s,t,u;for(q=q||0,r=r||0,r=e<r?e:r,e-=r,s=q+r;q<s;)switch(d){default:d=0;break;case 0:if(q>=s)return;if(255!==p[q])return q+=1,void(d=0);q+=1,d=1;break;case 1:if(q>=s)return;if(240!==(240&p[q]))return q+=1,void(d=0);g=!!(1&p[q]),q+=1,d=2;break;case 2:if(q>=s)return;h=((192&p[q])>>>6)+1,i=(60&p[q])>>>2,j=(1&p[q])<<2,q+=1,d=3;break;case 3:if(q>=s)return;j|=(192&p[q])>>>6,k=(3&p[q])<<11,q+=1,d=4;break;case 4:if(q>=s)return;k|=p[q]<<3,q+=1,d=5;break;case 5:if(q>=s)return;k|=(224&p[q])>>>5,k-=g?7:9,q+=1,d=6;break;case 6:if(q>=s)return;l=1024*((3&p[q])+1),m=1e3*l/c[i],t=h<<11|i<<7|j<<3,(t!==o||a-f>=1e3)&&(n=new b(b.METADATA_TAG),n.pts=a,n.dts=a,n.writeMetaDataDouble("audiocodecid",10),n.writeMetaDataBoolean("stereo",2===j),n.writeMetaDataDouble("audiosamplerate",c[i]),n.writeMetaDataDouble("audiosamplesize",16),this.tags.push(n),o=t,n=new b(b.AUDIO_TAG,(!0)),n.pts=a,n.dts=n.pts,n.view.setUint16(n.position,t),n.position+=2,n.length=Math.max(n.length,n.position),this.tags.push(n),f=a),q+=1,d=7;break;case 7:if(!g){if(2>s-q)return;q+=2}n=new b(b.AUDIO_TAG),n.pts=a,n.dts=a,d=8;break;case 8:for(;k;){if(q>=s)return;u=s-q<k?s-q:k,n.writeBytes(p,q,u),q+=u,k-=u}this.tags.push(n),d=0,a+=m}}}}(this),function(a,b,c){"use strict";var d,e=function(a,b,c){var d,e="";for(d=b;d<c;d++)e+="%"+("00"+a[d].toString(16)).slice(-2);return e},f=function(b,c,d){return a.decodeURIComponent(e(b,c,d))},g=function(b,c,d){return a.unescape(e(b,c,d))},h={TXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.value=f(a.data,b+1,a.data.length-1);break}},WXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.url=f(a.data,b+1,a.data.length);break}},PRIV:function(a){var b;for(b=0;b<a.data.length;b++)if(0===a.data[b]){a.owner=g(a.data,0,b);break}a.privateData=a.data.subarray(b+1)}};d=function(a){var c,e={debug:!(!a||!a.debug),descriptor:a&&a.descriptor},f=0,g=[],i=0;if(d.prototype.init.call(this),this.dispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16),e.descriptor)for(c=0;c<e.descriptor.length;c++)this.dispatchType+=("00"+e.descriptor[c].toString(16)).slice(-2);this.push=function(a){var c,d,j,k,l;if(0===g.length&&(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0)))return void(e.debug&&b.log("Skipping unrecognized metadata packet"));if(g.push(a),i+=a.data.byteLength,1===g.length&&(f=a.data[6]<<21|a.data[7]<<14|a.data[8]<<7|a.data[9],f+=10),!(i<f)){for(c={data:new Uint8Array(f),frames:[],pts:g[0].pts,dts:g[0].dts},l=0;l<f;)c.data.set(g[0].data,l),l+=g[0].data.byteLength,i-=g[0].data.byteLength,g.shift();d=10,64&c.data[5]&&(d+=4,d+=c.data[10]<<24|c.data[11]<<16|c.data[12]<<8|c.data[13],f-=c.data[16]<<24|c.data[17]<<16|c.data[18]<<8|c.data[19]);do{if(j=c.data[d+4]<<24|c.data[d+5]<<16|c.data[d+6]<<8|c.data[d+7],j<1)return b.log("Malformed ID3 frame encountered. Skipping metadata parsing.");k={id:String.fromCharCode(c.data[d],c.data[d+1],c.data[d+2],c.data[d+3]),data:c.data.subarray(d+10,d+j+10)},h[k.id]&&h[k.id](k),c.frames.push(k),d+=10,d+=j}while(d<f);this.trigger("data",c)}}},d.prototype=new b.Hls.Stream,b.Hls.MetadataStream=d}(window,window.videojs),function(a){var b,c,d=a.videojs,e=d.Hls.FlvTag,f=d.Hls.H264Stream,g=d.Hls.AacStream,h=d.Hls.MetadataStream;d.Hls.SegmentParser=function(){var a,i=this,j=new Uint8Array(b),k=0,l=new f,m=new g;i.stream={programMapTable:{}},i.metadataStream=new h,this.mediaTimelineOffset=null,i.timestampOffset=null,i.getFlvHeader=function(a,b,c){var d,f,g,h=new Uint8Array(9),i=new DataView(h.buffer);return a=a||0,b=void 0===b||b,c=void 0===c||c,i.setUint8(0,70),i.setUint8(1,76),i.setUint8(2,86),i.setUint8(3,1),i.setUint8(4,(b?4:0)|(c?1:0)),i.setUint32(5,h.byteLength),a<=0?(f=new Uint8Array(h.byteLength+4),f.set(h),f.set([0,0,0,0],h.byteLength),f):(d=new e(e.METADATA_TAG),d.pts=d.dts=0,d.writeMetaDataDouble("duration",a),g=d.finalize().length,f=new Uint8Array(h.byteLength+g),f.set(h),f.set(i.byteLength,g),f)},i.flushTags=function(){l.finishFrame()},i.tagsAvailable=function(){return l.tags.length+m.tags.length},i.getNextTag=function(){var a;return a=l.tags.length?m.tags.length&&m.tags[0].dts<l.tags[0].dts?m.tags.shift():l.tags.shift():m.tags.shift(),a.finalize()},i.parseSegmentBinaryData=function(c){var e,f=0;if(k>0){if(c.byteLength+k<b)return d.log("data.length + streamBuffer.length < MP2T_PACKET_LENGTH ??"),void j.readBytes(c,c.length,j.length);e=c.subarray(0,b-k),j.set(e,k),a(j),j=new Uint8Array(b),k=0}for(;;){for(;f<c.byteLength&&71!==c[f];)f++;if(c.byteLength-f<b)return void(c.byteLength-f>0&&(j.set(c.subarray(f),k),k+=c.byteLength-f));a(c.subarray(f,f+b))?f+=b:(d.log("error parsing m2ts packet, attempting to re-align"),f++)}},a=function(a){var e,f,g,h,j,k,n,o,p,q,r,s,t,u,v,w,x,y,z=0,A=z+b,B=!!(64&a[z+1]),C=(31&a[z+1])<<8|a[z+2],D=(48&a[z+3])>>>4;
if(z+=4,D>1&&(z+=a[z]+1),0===C){if(B&&(z+=1+a[z]),e=a[z],0!==e&&d.log("the table_id of the PAT should be 0x00 but was"+e.toString(16)),f=!!(1&a[z+5]))for(g=(15&a[z+1])<<8|a[z+2],z+=8,k=z+(g-5-4);z<k;z+=4)if(h=a[z]<<8|a[z+1],j=(31&a[z+2])<<8|a[z+3],0===h)i.stream.networkPid=j;else if(void 0===i.stream.pmtPid)i.stream.pmtPid=j;else if(i.stream.pmtPid!==j)throw new Error("TS has more that 1 program")}else if(C===i.stream.programMapTable[c.h264]||C===i.stream.programMapTable[c.adts]||C===i.stream.programMapTable[c.metadata]){if(B){if(0!==a[z+0]||0!==a[z+1]||1!==a[z+2])throw new Error("PES did not begin with start code");n=a[z+4]<<8|a[z+5],o=0!==(4&a[z+6]),p=a[z+7],q=a[z+8],z+=9,192&p&&(r=(14&a[z+0])<<28|(255&a[z+1])<<21|(254&a[z+2])<<13|(255&a[z+3])<<6|(254&a[z+4])>>>2,r/=45,s=r,64&p&&(s=(14&a[z+5])<<28|(255&a[z+6])<<21|(254&a[z+7])<<13|(255&a[z+8])<<6|(254&a[z+9])>>>2,s/=45)),z+=q,null===i.timestampOffset&&(i.timestampOffset=r),C===i.stream.programMapTable[c.h264]?l.setNextTimeStamp(r,s,o):C===i.stream.programMapTable[c.adts]&&m.setNextTimeStamp(r,n,o)}C===i.stream.programMapTable[c.adts]?m.writeBytes(a,z,A-z):C===i.stream.programMapTable[c.h264]?l.writeBytes(a,z,A-z):C===i.stream.programMapTable[c.metadata]&&i.metadataStream.push({pts:r,dts:s,data:a.subarray(z)})}else if(i.stream.pmtPid===C){if(B&&(z+=1+a[z]),2!==a[z]&&d.log("The table_id of a PMT should be 0x02 but was "+a[z].toString(16)),t=!!(1&a[z+5]))for(i.stream.programMapTable={},v=(15&a[z+1])<<8|a[z+2],u=(15&a[z+10])<<8|a[z+11],v-=u,v-=13,i.stream.programMapTable.pcrPid=(31&a[z+8])<<8|a[z+9],z+=12+u;0<v;){if(w=a[z+0],x=(31&a[z+1])<<8|a[z+2],w===c.h264&&i.stream.programMapTable[w]&&i.stream.programMapTable[w]!==x)throw new Error("Program has more than 1 video stream");if(w===c.adts&&i.stream.programMapTable[w]&&i.stream.programMapTable[w]!==x)throw new Error("Program has more than 1 audio Stream");i.stream.programMapTable[w]=x,y=(15&a[z+3])<<8|a[z+4],w===c.metadata&&(i.metadataStream.descriptor=new Uint8Array(a.subarray(z+5,z+5+y))),z+=5+y,v-=5+y}}else i.stream.networkPid===C||17===C||8191===C||i.stream.programMapTable.pcrPid||d.log("Unknown PID parsing TS packet: "+C);return!0},i.getTags=function(){return l.tags},i.stats={h264Tags:function(){return l.tags.length},minVideoPts:function(){return l.tags[0].pts},maxVideoPts:function(){return l.tags[l.tags.length-1].pts},aacTags:function(){return m.tags.length},minAudioPts:function(){return m.tags[0].pts},maxAudioPts:function(){return m.tags[m.tags.length-1].pts}}},d.Hls.SegmentParser.MP2T_PACKET_LENGTH=b=188,d.Hls.SegmentParser.STREAM_TYPES=c={h264:27,adts:15,metadata:21}}(window),function(a,b,c,d,e){var f,g,h,i=function(){},j=function(){var a="[^=]*",b='"[^"]*"|[^,]*',c="(?:"+a+")=(?:"+b+")";return new RegExp("(?:^|,)("+c+")")}(),k=function(a){for(var b,c=a.split(j),d=c.length,e={};d--;)""!==c[d]&&(b=/([^=]*)=(.*)/.exec(c[d]).slice(1),b[0]=b[0].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^['"](.*)['"]$/g,"$1"),e[b[0]]=b[1]);return e},l=a.Hls.Stream;f=function(){var a="";f.prototype.init.call(this),this.push=function(b){var c;for(a+=b,c=a.indexOf("\n");c>-1;c=a.indexOf("\n"))this.trigger("data",a.substring(0,c)),a=a.substring(c+1)}},f.prototype=new l,g=function(){g.prototype.init.call(this)},g.prototype=new l,g.prototype.push=function(a){var c,d;if(a=a.replace(/^\s+|\s+$/g,""),0!==a.length)return"#"!==a[0]?void this.trigger("data",{type:"uri",uri:a}):0!==a.indexOf("#EXT")?void this.trigger("data",{type:"comment",text:a.slice(1)}):(a=a.replace("\r",""),(c=/^#EXTM3U/.exec(a))?void this.trigger("data",{type:"tag",tagType:"m3u"}):(c=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(a))?(d={type:"tag",tagType:"inf"},c[1]&&(d.duration=parseFloat(c[1])),c[2]&&(d.title=c[2]),void this.trigger("data",d)):(c=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"targetduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"totalduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"version"},c[1]&&(d.version=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"media-sequence"},c[1]&&(d.number=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"discontinuity-sequence"},c[1]&&(d.number=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(a))?(d={type:"tag",tagType:"playlist-type"},c[1]&&(d.playlistType=c[1]),void this.trigger("data",d)):(c=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"byterange"},c[1]&&(d.length=b(c[1],10)),c[2]&&(d.offset=b(c[2],10)),void this.trigger("data",d)):(c=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(a))?(d={type:"tag",tagType:"allow-cache"},c[1]&&(d.allowed=!/NO/.test(c[1])),void this.trigger("data",d)):(c=/^#EXT-X-STREAM-INF:?(.*)$/.exec(a))?(d={type:"tag",tagType:"stream-inf"},c[1]&&(d.attributes=k(c[1]),d.attributes.RESOLUTION&&!function(){var a=d.attributes.RESOLUTION.split("x"),c={};a[0]&&(c.width=b(a[0],10)),a[1]&&(c.height=b(a[1],10)),d.attributes.RESOLUTION=c}(),d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=b(d.attributes.BANDWIDTH,10)),d.attributes["PROGRAM-ID"]&&(d.attributes["PROGRAM-ID"]=b(d.attributes["PROGRAM-ID"],10))),void this.trigger("data",d)):(c=/^#EXT-X-ENDLIST/.exec(a))?void this.trigger("data",{type:"tag",tagType:"endlist"}):(c=/^#EXT-X-DISCONTINUITY/.exec(a))?void this.trigger("data",{type:"tag",tagType:"discontinuity"}):(c=/^#EXT-X-KEY:?(.*)$/.exec(a))?(d={type:"tag",tagType:"key"},c[1]&&(d.attributes=k(c[1]),d.attributes.IV&&("0x"===d.attributes.IV.substring(0,2)&&(d.attributes.IV=d.attributes.IV.substring(2)),d.attributes.IV=d.attributes.IV.match(/.{8}/g),d.attributes.IV[0]=b(d.attributes.IV[0],16),d.attributes.IV[1]=b(d.attributes.IV[1],16),d.attributes.IV[2]=b(d.attributes.IV[2],16),d.attributes.IV[3]=b(d.attributes.IV[3],16),d.attributes.IV=new Uint32Array(d.attributes.IV))),void this.trigger("data",d)):void this.trigger("data",{type:"tag",data:a.slice(4,a.length)}))},h=function(){var a,b=this,j=[],k={};h.prototype.init.call(this),this.lineStream=new f,this.parseStream=new g,this.lineStream.pipe(this.parseStream),this.manifest={allowCache:!0},this.parseStream.on("data",function(f){({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=f.allowed,"allowed"in f||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var a={};"length"in f&&(k.byterange=a,a.length=f.length,"offset"in f||(this.trigger("info",{message:"defaulting offset to zero"}),f.offset=0)),"offset"in f&&(k.byterange=a,a.offset=f.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),f.duration>=0&&(k.duration=f.duration),this.manifest.segments=j},key:function(){return f.attributes?"NONE"===f.attributes.METHOD?void(a=null):f.attributes.URI?(f.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:f.attributes.METHOD||"AES-128",uri:f.attributes.URI},void(f.attributes.IV!==e&&(a.iv=f.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){return c(f.number)?void(this.manifest.mediaSequence=f.number):void this.trigger("warn",{message:"ignoring invalid media sequence: "+f.number})},"discontinuity-sequence":function(){return c(f.number)?void(this.manifest.discontinuitySequence=f.number):void this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+f.number})},"playlist-type":function(){return/VOD|EVENT/.test(f.playlistType)?void(this.manifest.playlistType=f.playlistType):void this.trigger("warn",{message:"ignoring unknown playlist type: "+f.playlist})},"stream-inf":function(){return this.manifest.playlists=j,f.attributes?(k.attributes||(k.attributes={}),void(k.attributes=d(k.attributes,f.attributes))):void this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){k.discontinuity=!0},targetduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid target duration: "+f.duration}):void(this.manifest.targetDuration=f.duration)},totalduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid total duration: "+f.duration}):void(this.manifest.totalDuration=f.duration)}})[f.tagType]||i).call(b)},uri:function(){k.uri=f.uri,j.push(k),!this.manifest.targetDuration||"duration"in k||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),k.duration=this.manifest.targetDuration),a&&(k.key=a),k={}},comment:function(){}})[f.type].call(b)})},h.prototype=new l,h.prototype.push=function(a){this.lineStream.push(a)},h.prototype.end=function(){this.lineStream.push("\n")},window.videojs.m3u8={LineStream:f,ParseStream:g,Parser:h}}(window.videojs,window.parseInt,window.isFinite,window.videojs.util.mergeOptions),function(a,b){"use strict";var c,d,e,f=10;e=function(a,b,c){var d,e,g,h,i,j,k=0;for(b=b||0,e=b,c=void 0!==c?c:(a.segments||[]).length,d=a.targetDuration||f,j=Math.max(a.mediaSequence-b,0),k+=j*d,e+=j;e<c;e++)if(h=a.segments[e-a.mediaSequence],void 0!==h.minVideoPts){for(g=e;g<c-1&&(i=a.segments[g-a.mediaSequence+1],void 0!==i.maxVideoPts&&!i.discontinuity);g++);i=a.segments[g-a.mediaSequence],k+=.001*(Math.max(i.maxVideoPts,i.maxAudioPts)-Math.min(h.minVideoPts,h.minAudioPts)),e=g}else k+=h.duration||d;return k},c=function(b,c,d){if(!b)return 0;if(void 0===c&&void 0===d){if(b.totalDuration)return b.totalDuration;if(!b.endList)return a.Infinity}return e(b,c,d)},d=function(a){var d,g,h,i,j,k,l;if(!a.segments)return b.createTimeRange();if(a.endList)return b.createTimeRange(0,c(a));if(d=e(a,0,a.mediaSequence),g=d+e(a,a.mediaSequence,a.mediaSequence+a.segments.length),i=a.targetDuration||f,!a.endList)for(h=3*i,l=a.segments.length-1;l>=0&&h>0;l--)j=a.segments[l],k=Math.min(j.preciseDuration||j.duration||i,h),h-=k,g-=k;return b.createTimeRange(d,g)},b.Hls.Playlist={duration:c,seekable:d}}(window,window.videojs),function(a,b){"use strict";var c=b.Hls.resolveUrl,d=b.Hls.xhr,e=b.Hls.Playlist,f=b.util.mergeOptions,g=function(a,b){var c,d,e=!1,g=f(a,{});for(c=a.playlists.length;c--;)if(d=g.playlists[c],d.uri===b.uri){if(d.segments&&b.segments&&d.segments.length===b.segments.length&&d.mediaSequence===b.mediaSequence)continue;g.playlists[c]=f(d,b),g.playlists[b.uri]=g.playlists[c],d.segments&&(g.playlists[c].segments=h(d.segments,b.segments,b.mediaSequence-d.mediaSequence)),e=!0}return e?g:null},h=function(a,b,c){var d,e,g=b.slice();for(c=c||0,d=Math.min(a.length,b.length+c),e=c;e<d;e++)g[e-c]=f(a[e],g[e-c]);return g},i=function(e,f){var h,j,k,l,m=this;if(i.prototype.init.call(this),!e)throw new Error("A non-empty playlist URL is required");l=function(c,d,e){var f,h,i;return m.setBandwidth(k||d),k=null,c?(m.error={status:d.status,message:"HLS playlist request error at URL: "+e,responseText:d.responseText,code:d.status>=500?4:2},m.trigger("error")):(m.state="HAVE_METADATA",f=new b.m3u8.Parser,f.push(d.responseText),f.end(),f.manifest.uri=e,i=g(m.master,f.manifest),h=1e3*(f.manifest.targetDuration||10),i?(m.master=i,m.updateMediaPlaylist_(f.manifest)):h/=2,m.media().endList||(a.clearTimeout(j),j=a.setTimeout(function(){m.trigger("mediaupdatetimeout")},h)),void m.trigger("loadedplaylist"))},m.state="HAVE_NOTHING",m.expiredPostDiscontinuity_=0,m.expiredPreDiscontinuity_=0,h=this.dispose,m.dispose=function(){k&&(k.onreadystatechange=null,k.abort(),k=null),a.clearTimeout(j),h.call(this)},m.media=function(a){var b=!1;if(!a)return m.media_;if("HAVE_NOTHING"===m.state||"HAVE_MASTER"===m.state)throw new Error("Cannot switch media playlist from "+m.state);if("string"==typeof a){if(!m.master.playlists[a])throw new Error("Unknown playlist URI: "+a);a=m.master.playlists[a]}if(b=a.uri!==m.media_.uri,m.master.playlists[a.uri].endList)return k&&(k.onreadystatechange=null,k.abort(),k=null),m.state="HAVE_METADATA",m.media_=a,void(b&&m.trigger("mediachange"));if(b){if(m.state="SWITCHING_MEDIA",k){if(c(m.master.uri,a.uri)===k.url)return;k.onreadystatechange=null,k.abort(),k=null}k=d({url:c(m.master.uri,a.uri),withCredentials:f},function(b){l(b,this,a.uri),m.trigger("mediachange")})}},m.setBandwidth=function(a){m.bandwidth=a.bandwidth},m.on("mediaupdatetimeout",function(){"HAVE_METADATA"===m.state&&(m.state="HAVE_CURRENT_METADATA",k=d({url:c(m.master.uri,m.media().uri),withCredentials:f},function(a){l(a,this,m.media().uri)}))}),d({url:e,withCredentials:f},function(g){var h,i;if(g)return m.error={status:this.status,message:"HLS playlist request error at URL: "+e,responseText:this.responseText,code:2},m.trigger("error");if(h=new b.m3u8.Parser,h.push(this.responseText),h.end(),m.state="HAVE_MASTER",h.manifest.uri=e,h.manifest.playlists){for(m.master=h.manifest,i=m.master.playlists.length;i--;)m.master.playlists[m.master.playlists[i].uri]=m.master.playlists[i];return k=d({url:c(e,h.manifest.playlists[0].uri),withCredentials:f},function(a){l(a,this,h.manifest.playlists[0].uri),a||m.trigger("loadedmetadata")}),m.trigger("loadedplaylist")}return m.master={uri:a.location.href,playlists:[{uri:e}]},m.master.playlists[e]=m.master.playlists[0],l(null,this,e),m.trigger("loadedmetadata")})};i.prototype=new b.Hls.Stream,i.prototype.updateMediaPlaylist_=function(a){var b,c,d;if(this.media_){if(c=a.mediaSequence-this.media_.mediaSequence,b=this.media_.mediaSequence,this.media_.discontinuitySequence!==a.discontinuitySequence)for(d=c;d--;)if(this.media_.segments[d].discontinuity){b=d+this.media_.mediaSequence,this.expiredPreDiscontinuity_+=this.expiredPostDiscontinuity_,this.expiredPostDiscontinuity_=0;break}this.expiredPreDiscontinuity_+=e.duration(this.media_,this.media_.mediaSequence,b),this.expiredPostDiscontinuity_+=e.duration(this.media_,b,this.media_.mediaSequence+c)}this.media_=this.master.playlists[a.uri]},i.prototype.getMediaIndexForTime_=function(a){var b;if(!this.media_)return 0;if(a-=this.expiredPreDiscontinuity_+this.expiredPostDiscontinuity_,a<0)return 0;for(b=0;b<this.media_.segments.length;b++)if(a-=e.duration(this.media_,this.media_.mediaSequence+b,this.media_.mediaSequence+b+1),a<=0)return b;return this.media_.segments.length-1},b.Hls.PlaylistLoader=i}(window,window.videojs),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(b){b.window.pkcs7={unpad:a("./unpad")}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./unpad":2}],2:[function(a,b,c){"use strict";b.exports=function(a){return a.subarray(0,a.byteLength-a[a.byteLength-1])}},{}]},{},[1]),function(a,b,c){"use strict";var d,e,f,g,h;h=function(a){return a<<24|(65280&a)<<8|(16711680&a)>>8|a>>>24},d=function(a){this._precompute();var b,c,d,e,f,g=this._tables[0][4],h=this._tables[1],i=a.length,j=1;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size");for(e=a.slice(0),f=[],this._key=[e,f],b=i;b<4*i+28;b++)d=e[b-1],(b%i===0||8===i&&b%i===4)&&(d=g[d>>>24]<<24^g[d>>16&255]<<16^g[d>>8&255]<<8^g[255&d],b%i===0&&(d=d<<8^d>>>24^j<<24,j=j<<1^283*(j>>7))),e[b]=e[b-i]^d;for(c=0;b;c++,b--)d=e[3&c?b:b-4],b<=4||c<4?f[c]=d:f[c]=h[0][g[d>>>24]]^h[1][g[d>>16&255]]^h[2][g[d>>8&255]]^h[3][g[255&d]]},d.prototype={_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;a<256;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;a<4;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;a<5;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},decrypt:function(a,b,c,d,e,f){var g,h,i,j,k=this._key[1],l=a^k[0],m=d^k[1],n=c^k[2],o=b^k[3],p=k.length/4-2,q=4,r=this._tables[1],s=r[0],t=r[1],u=r[2],v=r[3],w=r[4];for(j=0;j<p;j++)g=s[l>>>24]^t[m>>16&255]^u[n>>8&255]^v[255&o]^k[q],h=s[m>>>24]^t[n>>16&255]^u[o>>8&255]^v[255&l]^k[q+1],i=s[n>>>24]^t[o>>16&255]^u[l>>8&255]^v[255&m]^k[q+2],o=s[o>>>24]^t[l>>16&255]^u[m>>8&255]^v[255&n]^k[q+3],q+=4,l=g,m=h,n=i;for(j=0;j<4;j++)e[(3&-j)+f]=w[l>>>24]<<24^w[m>>16&255]<<16^w[n>>8&255]<<8^w[255&o]^k[q++],g=l,l=m,m=n,n=o,o=g}},g=function(a,b,c){var e,f,g,i,j,k,l,m,n,o=new Int32Array(a.buffer,a.byteOffset,a.byteLength>>2),p=new d(Array.prototype.slice.call(b)),q=new Uint8Array(a.byteLength),r=new Int32Array(q.buffer);for(e=c[0],f=c[1],g=c[2],i=c[3],n=0;n<o.length;n+=4)j=h(o[n]),k=h(o[n+1]),l=h(o[n+2]),m=h(o[n+3]),p.decrypt(j,k,l,m,r,n),r[n]=h(r[n]^e),r[n+1]=h(r[n+1]^f),r[n+2]=h(r[n+2]^g),r[n+3]=h(r[n+3]^i),e=j,f=k,g=l,i=m;return q},e=function(){this.jobs=[],this.delay=1,this.timeout_=null},e.prototype=new b.Hls.Stream,e.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(b.bind(this,this.processJob_),this.delay):this.timeout_=null},e.prototype.push=function(a){this.jobs.push(a),this.timeout_||(this.timeout_=setTimeout(b.bind(this,this.processJob_),this.delay))},f=function(a,b,d,g){var i=f.STEP,j=new Int32Array(a.buffer),k=new Uint8Array(a.byteLength),l=0;for(this.asyncStream_=new e,this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k,l)),l=i;l<j.length;l+=i)d=new Uint32Array([h(j[l-4]),h(j[l-3]),h(j[l-2]),h(j[l-1])]),this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k));this.asyncStream_.push(function(){g(null,c(k))})},f.prototype=new b.Hls.Stream,f.prototype.decryptChunk_=function(a,b,c,d){return function(){var e=g(a,b,c);d.set(e,a.byteOffset)}},f.STEP=32e3,b.Hls.decrypt=g,b.Hls.Decrypter=f,b.Hls.AsyncStream=e}(window,window.videojs,window.pkcs7.unpad),function(a){var b={hexDump:function(a){for(var b,c,d=Array.prototype.slice.call(a),e=16,f=function(a,b){var c=a.toString(16);return"00".substring(0,2-c.length)+c+(b%2?" ":"")},g=function(a){return a>=32&&a<126?String.fromCharCode(a):"."},h="",i=0;i<d.length/e;i++)b=d.slice(i*e,i*e+e).map(f).join(""),c=d.slice(i*e,i*e+e).map(g).join(""),h+=b+" "+c+"\n";return h},tagDump:function(a){return b.hexDump(a.bytes)}};a.videojs.Hls.utils=b}(this),function(){videojs.plugin("hotkeys",function(a){var b=this,c={volumeStep:.1,seekStep:5,enableMute:!0,enableFullscreen:!0};a=a||{},b.el().hasAttribute("tabIndex")||b.el().setAttribute("tabIndex","-1"),b.on("play",function(){var a=b.el().querySelector(".iframeblocker");a&&""===a.style.display&&(a.style.display="block",a.style.bottom="39px")}),$(b.node).find(".vjs-play-control").on("click",function(){$(this).blur()});var d=!1,e=function(e){var f=a.volumeStep||c.volumeStep,g=a.seekStep||c.seekStep,h=a.enableMute||c.enableMute,i=a.enableFullscreen||c.enableFullscreen;if(b.controls()){var j=document.activeElement;if(j==b.el()||j==b.el().querySelector(".vjs-tech")||j==b.el().querySelector(".vjs-control-bar")||j==b.el().querySelector(".iframeblocker")||j!==b.el().querySelector(".vjs-mute-control")&&j!==b.el().querySelector(".vjs-resolutions-button"))if(32===e.which){if(e.preventDefault(),b.options().isLive&&!b.advertInProgress)return!1;d||(d=!0,b.one("keyup",function(){b.paused()?b.play():b.pause(),d=!1}))}else if(37!==e.which||b.advertInProgress)if(39!==e.which||b.advertInProgress){if(40===e.which)e.preventDefault(),b.volume(b.volume()-f);else if(38===e.which)e.preventDefault(),b.volume(b.volume()+f);else if(77===e.which)h&&(b.muted()?b.muted(!1):b.muted(!0));else if(70===e.which&&i){var k=b.controlBar.getNestedChild("fullscreenToggle");k&&k.trigger("click")}}else e.preventDefault(),b.currentTime(b.currentTime()+g);else{e.preventDefault();var l=b.currentTime()-g;b.currentTime()<=g&&(l=0),b.currentTime(l)}}},f=function(d){var e=a.enableFullscreen||c.enableFullscreen;if(b.controls()){var f=d.relatedTarget||d.toElement||document.activeElement;if((f==b.el()||f==b.el().querySelector(".vjs-tech")||f==b.el().querySelector(".iframeblocker"))&&e){var g=b.controlBar.getNestedChild("fullscreenToggle");g&&g.trigger("click")}}};b.on("keydown",e),b.on("dblclick",f)})}.call(this),function(){videojs.plugin("progressTips",function(a){var b;b=function(){var a;if("Html5"===this.techName||"Shaka"===this.techName||"Dashjs"===this.techName){a=this;var b=a.options().spriteImg;if($("div#"+a.id()+" .vjs-progress-control").after($("      <div class='vjs-tip'>      <div class='vjs-tip-arrow'></div>      <div class='vjs-tip-inner'></div>      </div>    ")),b.hasSprite&&"undefined"!=typeof uDevice&&"desktop"===uDevice.toLowerCase()){b.images=[],b.images.push(b.img.url),a.on("videoBegin",function(){var c=a.duration(),d=c/3%100;if(d)for(var e=1;e<=d;e++){var f=e;e>9&&e<99&&(f="0"+e),e<10&&(f="00"+e),b.images.push(b.img.url.replace(/(-001)/,f))}});var c=new Image;c.src=b.img.url,c.onload=function(){b.img.fullWidth=c.width,b.img.fullHeight=c.height,b.img.singleWidth=b.img.fullWidth/10,b.img.singleHeight=b.img.singleWidth*(9/16),$("div#"+a.id()+" .vjs-tip .vjs-tip-inner").before($("<div>",{"class":"vjs-tip-image"})),$("div#"+a.id()+" .vjs-tip .vjs-tip-image").css({"background-image":"url("+b.img.url+")","background-repeat":"no-repeat",width:b.img.singleWidth+"px",height:b.img.singleHeight+"px"})}}$("div#"+a.id()+" .vjs-progress-control").on("mousemove",function(c){if(a.advertInProgress!==!0){var d,e,f,g,h,i;h=a.controlBar.getNestedChild("seekBar");var j=h.calculateDistance(c);if(i=j*a.duration(),i===a.duration()&&(i-=.1),f=Math.floor(i/60),g=Math.floor(i-60*f),g<10&&(g="0"+g),f<0&&(f=0,g="00"),b.hasSprite&&"undefined"!=typeof uDevice&&"desktop"===uDevice.toLowerCase()){var k=0,l=0,m=0,n=0;m=k=Math.floor(i/3),m>9&&(m=k%10,n=Math.floor(k/10)),n>9&&(n-=10*Math.floor(n/10),$("div#"+a.id()+" .vjs-tip-image").css({"background-image":b.images[n]})),k=m*b.img.singleWidth,l=n*b.img.singleHeight,$("div#"+a.id()+" .vjs-tip-image").css({"background-position":"-"+k+"px -"+l+"px"})}$("div#"+a.id()+" .vjs-tip-inner").html(""+f+":"+g),d=$("div#"+a.id()+" .vjs-control-bar").height(),e=$("div#"+a.id()+" .vjs-control-bar").width();var o=0,p=0;b.hasSprite&&$(a.node).width()>=680?($("div#"+a.id()+" .vjs-tip").removeClass("vjs-hide-tip-image"),o=b.img.singleHeight,p=b.img.singleWidth/2-19):$("div#"+a.id()+" .vjs-tip").addClass("vjs-hide-tip-image");var q=c.pageX-$(this).offset().left-p-22,r=$("div#"+a.id()+" .vjs-tip"),s=r.find(".vjs-tip-inner"),t=r.width(),u=-5,v=e-t-5,w=-4,x=r.find(".vjs-tip-arrow");if(q<u||q>v){var y=(t/2-2)*-1,z=t/2-x.width()-2;q<u?(w=q-u-4,q=u,y>w?s.addClass("vjs-no-border-bottom-left-radius"):s.removeClass("vjs-no-border-bottom-left-radius")):(w=q-v-4,q=v,z<w?s.addClass("vjs-no-border-bottom-right-radius"):s.removeClass("vjs-no-border-bottom-right-radius"))}x.css("margin-left",w),r.css({top:""+(c.pageY-$(this).offset().top-d-o-5)+"px",left:""+q+"px",visibility:"visible",opacity:1})}}),$("div#"+a.id()+" .vjs-progress-control, div#"+a.id()+" .vjs-play-control").on("mouseout",function(){$("div#"+a.id()+" .vjs-tip").css({visibility:"hidden",opacity:0})})}},this.on("videoAllFirstStart",b)})}.call(this),"undefined"==typeof PLAYER_DEBUG&&(PLAYER_DEBUG=!1);var PARSER_DEBUG=!1,PLAYER_STATS_DEBUG=!1,PLAYER_EVENTS_DEBUG=!1,PLAYER_SONDA_SERVER="http://quiz.services.tvn.pl",quizDataStorage=[],PLAYER_DEFAULT_HOST="http://s1-player5.cdntvn.pl/",PLAYER_DEFAULT_OPACITY=1,PLAYER5_DEVICES_TYPE={mobile:["mobile","smartfon","telefon"],tablet:["tablet"]},IPAD_DEVICEMOTION=0;Array.prototype.forEach||(Array.prototype.forEach=function(a){var b=this.length;if("function"!=typeof a)throw new TypeError;for(var c=arguments[1],d=0;d<b;d++)d in this&&a.call(c,this[d],d,this)});var hex_chr="0123456789abcdef".split(""),add32=function(a,b){return a+b&4294967295};if("5d41402abc4b2a76b9719d911017c592"!=md5("hello")&&(add32=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}),$(document).on("mouseenter",".video-js .imgHover",function(){var a=$(this),b=a.attr("src"),c=a.data("hover");a.attr("src",c),a.data("hover",b)}),$(document).on("mouseleave",".video-js .imgHover",function(){var a=$(this),b=a.attr("src"),c=a.data("hover");a.attr("src",c),a.data("hover",b)}),"undefined"==typeof getDisableAdBlockCheck)var getDisableAdBlockCheck=function(){return"undefined"!=typeof DISABLE_ADBLOCK_DETECTION&&DISABLE_ADBLOCK_DETECTION};if("undefined"==typeof isAdBlockEnabled)var isAdBlockEnabled=function(){if("undefined"==typeof window.isAdBlockEnabledCheckCounter&&(window.isAdBlockEnabledCheckCounter=0),!document.body&&window.isAdBlockEnabledCheckCounter<15)return setTimeout(function(){window.isAdBlockEnabledCheckCounter++,isAdBlockEnabled()},10),!1;var a=document.createElement("div");a.setAttribute("class","sponsored-ad adoSlave advertisement pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links"),a.setAttribute("style","width: 1px !important; height: 1px !important; position: absolute !important; left: -1000px !important; top: -1000px !important;"),document.body.appendChild(a);var b=$(a),c=$(a).is(":visible");return b.remove(),window.adBlockEnabled=!c,!c};getCookieItem=function(a){if(!a||!hasCookieItem(a))return null;var b=new RegExp("(?:^|.*;\\s*)"+window.escape(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*");return window.unescape(document.cookie.replace(b,"$1"))},setCookieItem=function(a,b,c,d,e,f){if(a&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(a)){var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toGMTString()}document.cookie=window.escape(a)+"="+window.escape(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":"")}},canPlayMp4=function(){var a=!1,b=document.createElement("video");return b.canPlayType&&b.canPlayType("video/mp4").replace(/no/,"")&&(a=!0),a},hasCookieItem=function(a){return new RegExp("(?:^|;\\s*)"+window.escape(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},hasLocalStorage=function(){try{return window.localStorage.setItem("persistVolume","persistVolume"),window.localStorage.removeItem("persistVolume"),!0}catch(a){return!1}},getStorageItem=function(a){return hasLocalStorage()?window.localStorage.getItem(a):getCookieItem(a)},setStorageItem=function(a,b){return hasLocalStorage()?window.localStorage.setItem(a,b):setCookieItem(a,b,1/0,"/")},"undefined"==typeof errorLoadMovie&&(errorLoadMovie=function(){return'<div class="vjs-error-load-wrapper"><div class="vjs-error-load-container"><div class="vjs-error-load-content"><h2>materiał jest niedostępny</h2><span class="vjs-error-load-icon"></span></div></div>'}),"undefined"==typeof errorMovie360notSupported&&(errorMovie360notSupported=function(){return'<div class="vjs-error-load-wrapper vjs-error360"><div class="vjs-error-load-container"><div class="vjs-error-load-content"><span class="vjs-error-load-icon"></span><h1>Ups...</h1><h2>Materiał nie jest dostępny dla Twojej przeglądarki</h2><p>Wideo 360 są wspierane przez określone przeglądarki, aby je oglądać skorzystaj z Google Chrome lub Firefox.</p></div></div>'}),"undefined"==typeof errorTransferDegradation&&(errorTransferDegradation=function(){return'<div class="vjs-error-load-wrapper"><div class="vjs-error-transfer-container"><div class="vjs-error-transfer-content"><span class="vjs-error-transfer-icon"></span><h1>Przepraszamy za utrudnienia</h1><h3>Twoje połączenie z internetem może być niewystarczające, aby kontynuować oglądanie. Sprawdź swoje połączenie.</h3></div></div></div>'}),"undefined"==typeof errorLowProcessorPerformance&&(errorLowProcessorPerformance=function(){return'<div class="vjs-error-load-wrapper vjs-error360"><div class="vjs-error-load-container"><div class="vjs-error-load-content"><span class="vjs-error-load-icon"></span><h1>Materiał nie działa płynnie?</h1><h2>Jego jakość może nie być dostosowana do możliwości Twojego Urządzenia</h2><p>Materiał, który chcesz obejrzeć, jest w bardzo wysokiej jakości, co powoduje, że zajmuje więcej pamięci Twojego urządzenia. Aby działał płynnie, możesz ręcznie zmienić jakość materiału w dolnej części odtwarzacza.</p></div></div>'}),setBrandingSize=function(a,b){var c=$(b).siblings(".adoHide").find("div.tvn-advertisement").length,d=0,e=1,f=new Array(45,45,30,30,15,15,40,40,26,26,18,18),g=new Array(45,42,30,26,15,11,40,38,30,30,22,25),h=a.hasBranding;if(c&&!h.isBranding){var i=parseInt($(b).attr("data-branding-width"),10);("undefined"==typeof i||isNaN(i)||0===i)&&(i=parseInt($(b).width(),10)),970==i&&(d=0,e=1),640==i&&(d=2,e=3),308==i&&(d=4,e=5),960==i&&(d=6,e=7),632==i&&(d=8,e=9),616==i&&(d=10,e=11),618==i&&(d=10,e=11);var j=i-2*f[d],k=Math.ceil(9*j/16),l=g[d],m=g[e];$(b).css({left:l,top:m,width:j,height:k}),$(b).find(".vjs-tech").css({width:j+1,height:k}),h.isBranding=!0,h.width=j,h.height=k,h.left=l,h.top=m}c&&h.isBranding&&$(b).css({left:h.left,top:h.top,width:h.width,height:h.height})};var vastParserProviders={getLinearData:function(a,b){try{var c,d=this.getFirstChildrenByTagName(b,"Linear");if(!d)return a;c=this.getFirstChildrenByTagName(d,"Duration",!0),a.Duration=c?c:"00:00:00.000",c=this.getFirstChildrenByTagName(d,"MediaFiles"),a.MediaFile=!!c&&this.getFirstChildrenByTagName(c,"MediaFile",!0),c=this.getFirstChildrenByTagName(d,"VideoClicks",!1),a.ClickThrough=!!c&&this.getFirstChildrenByTagName(c,"ClickThrough",!0,!0),this.getFirstChildrenByTagName(c,"ClickThroughAction")&&(a.VideoClicks={},a.VideoClicks.ClickThroughText=this.getChildrenByTagName(c,"ClickThroughText",!0,!0),a.VideoClicks.ClickThroughAction=this.getChildrenByTagName(c,"ClickThroughAction",!0),a.VideoClicks.ClickThroughActionPhone=this.getChildrenByTagName(c,"ClickThroughActionPhone",!0),a.VideoClicks.ClickThroughActionText=this.getChildrenByTagName(c,"ClickThroughActionText",!0),c=this.getChildrenByTagName(c,"ClickThrough"),a.VideoClicks.ClickThrough=!!c&&extractCdataArray(c,!0)),c=null}catch(e){}return a},tapGoTimes:[],tvn:function(a){function b(a,b,c){c=c||!1;var d=a;return a={},d&&(a.image=d),"undefined"!=typeof b&&(b.attributes.length&&(a.attribs=getAttribs(b)),b.getElementsByTagName("Image").length&&(a.image=extractCdata(b.getElementsByTagName("Image")[0])),b.getElementsByTagName("Normal").length&&(a.image=extractCdata(b.getElementsByTagName("Normal")[0])),b.getElementsByTagName("TargetBackground").length&&(a.TargetBackground={attribs:getAttribs(b.getElementsByTagName("TargetBackground")[0]),background:extractCdata(b.getElementsByTagName("TargetBackground")[0],!0)}),b.getElementsByTagName("Hover").length&&(a.hover=extractCdata(b.getElementsByTagName("Hover")[0])),b.getElementsByTagName("ImageHoover").length&&(a.hover=extractCdata(b.getElementsByTagName("ImageHoover")[0])),b.getElementsByTagName("Link").length&&(a.link=extractCdata(b.getElementsByTagName("Link")[0])),b.getElementsByTagName("ClickThrough").length&&(a.link=extractCdata(b.getElementsByTagName("ClickThrough")[0])),(a.link||c)&&b.getElementsByTagName("StatUrl3").length&&(a.statUrl3=extractCdataArray(b.getElementsByTagName("StatUrl3"),!0)),b.getElementsByTagName("ImageSelected").length&&(a.selected=extractCdata(b.getElementsByTagName("ImageSelected")[0])),b.getElementsByTagName("GroupBackground").length&&(a.GroupBackground={
attribs:getAttribs(b.getElementsByTagName("GroupBackground")[0]),background:extractCdata(b.getElementsByTagName("GroupBackground")[0],!0)}),b.getElementsByTagName("StatUrl").length&&(a.statUrl=extractCdataArray(b.getElementsByTagName("StatUrl"),!0)),b.getElementsByTagName("StatUrlFail").length&&(a.statUrlFail=extractCdataArray(b.getElementsByTagName("StatUrlFail"),!0)),b.getElementsByTagName("SoundUrl").length&&(a.SoundUrl=extractCdata(b.getElementsByTagName("SoundUrl")[0],!0)),b.getElementsByTagName("Url").length&&(a.Url=extractCdata(b.getElementsByTagName("Url")[0],!0))),a}function c(a,b){var c=document.createDocumentFragment(),d=[];if(a.length)for(var e=0;a.length>e;e++)a[e].parentNode.nodeName==b&&d.push(a[e]);for(var f=0;d.length>f;f++)c.appendChild(d[f]);return c.childNodes}function d(a,b,c){var d={};if(a.length)for(var e=0;a.length>e;e++)if(a[e].parentNode.nodeName==b){var f=extractCdata(a[e],c);f&&(d[e]=extractCdata(a[e],c))}return d}function e(a,c){var e={},g=new Date,k="u&d%BA[!cxzAg";e.type=a[c].attributes.id.value,e.adType=!1;var l=a[c].getElementsByTagName("Wrapper")[0];if("videoAd_wrapper"==e.type||"undefined"!=typeof l)return void f(a,c);var m=getAttribs(a[c].getElementsByTagName("InLine")[0]);e.position=0,"undefined"!=typeof m.position&&(e.position=m.position),e.AdId=md5(k+g.getTime()+1e4*Math.random()),e.AdSystem=extractCdata(a[c].getElementsByTagName("AdSystem").item(0)),e.AdTitle=extractCdata(a[c].getElementsByTagName("AdTitle")[0]),e.Impression=d(a[c].getElementsByTagName("Impression"),"InLine",!0),e.AdParameters=extractCdataArray(a[c].getElementsByTagName("AdParameters")),e.AdParametersJSON=i.getAdParametersJSON(extractCdataArray(a[c].getElementsByTagName("AdParameters")));try{h=a[c].getElementsByTagName("Linear")[0],e.Duration=extractCdata(h.getElementsByTagName("Duration")[0]),e.MediaFile=extractCdata(h.getElementsByTagName("MediaFiles")[0].getElementsByTagName("MediaFile")[0]),e.ClickThrough=extractCdata(h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThrough")[0],!0);var n=h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThroughAction")[0];"undefined"!=typeof n&&(e.VideoClicks={ClickThrough:extractCdataArray(h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThrough"),!0),ClickThroughText:extractCdata(h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThroughText")[0],!0),ClickThroughAction:extractCdata(h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThroughAction")[0]),ClickThroughActionPhone:extractCdata(h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThroughActionPhone")[0]),ClickThroughActionText:extractCdata(h.getElementsByTagName("VideoClicks")[0].getElementsByTagName("ClickThroughActionText")[0])})}catch(o){}var p=a[c].getElementsByTagName("Tvn")[0];if("undefined"!=typeof p){var q,r,s=p.getElementsByTagName("Panorama")[0],t=p.getElementsByTagName("InfoButtons")[0],u=p.getElementsByTagName("InfoButtons2")[0],v=p.getElementsByTagName("Sequential")[0],w=p.getElementsByTagName("TapGo")[0];if(s){if(e.adType="360",e.Video360={attribs:{}},e.Video360.attribs=getAttribs(s),s.getElementsByTagName("Remote")[0]){e.Remote={attribs:{},backgrounds:{},controls:{}};var x=s.getElementsByTagName("Remote")[0];e.Remote.attribs=getAttribs(x);var y=e.Remote.controls,z=e.Remote.backgrounds,A=x.getElementsByTagName("Backgrounds")[0];y.template=extractCdata(x.getElementsByTagName("Controls")[0]),z.bg=extractCdata(A.getElementsByTagName("Bg")[0]),z.img=extractCdata(A.getElementsByTagName("Img")[0]),z.up=extractCdata(A.getElementsByTagName("Up")[0]),z.down=extractCdata(A.getElementsByTagName("Down")[0]),z.left=extractCdata(A.getElementsByTagName("Left")[0]),z.right=extractCdata(A.getElementsByTagName("Right")[0])}if(s.getElementsByTagName("InfoIcon")[0]){e.InfoIcon={attribs:{},img:""};var B=s.getElementsByTagName("InfoIcon")[0];e.InfoIcon.attribs=getAttribs(B),e.InfoIcon.img=extractCdata(B.getElementsByTagName("Img")[0])}"MacOS"===window.uOS&&"undefined"!=typeof s.outerHTML&&(e.panoramaXML=a[c].outerHTML)}else if(t){e.adType="Interactive2",e.Interactive={attribs:{},buttons:[]},e.Interactive.attribs=getAttribs(t);for(var C=t.getElementsByTagName("Button"),D=0;D<C.length;D++)q=C[D],r={},r.icon=extractCdata(q.getElementsByTagName("Icon")[0]),r.title=extractCdata(q.getElementsByTagName("Title")[0]),r.statUrl=extractCdataArray(q.getElementsByTagName("StatUrl"),!0),r.url=extractCdata(q.getElementsByTagName("Url")[0],!0),e.Interactive.buttons.push(r)}else if(u){e.adType="Interactive2",e.Interactive2={attribs:{},buttons:[]},e.Interactive2.attribs=getAttribs(u);for(var E=u.getElementsByTagName("Button"),F=0;F<E.length;F++){r={},q=E[F],r.attribs=getAttribs(q),r.icon=extractCdata(q.getElementsByTagName("Icon")[0]),r.title=extractCdata(q.getElementsByTagName("Title")[0]),r.statUrl=extractCdataArray(q.getElementsByTagName("StatUrl"),!0),r.statUrl2=extractCdataArray(q.getElementsByTagName("StatUrl2"),!0),r.url=extractCdata(q.getElementsByTagName("Url")[0],!0),r.slide={};var G=q.getElementsByTagName("Slide")[0];if("undefined"!=typeof G){r.slide.attribs=getAttribs(G),r.slide.background=extractCdata(G.getElementsByTagName("Background")[0]);var H={welcome:"Logo,Desc,Packshot,ActionButton",sonda:"color1,color2,color3,quiz_id,Logo,Desc,Packshot,VoteButton,ActionButton",survey:"color1,color2,color3,Survey_id,Logo,Desc,ActionButton",map:"BingDesc,BingTitle,Latitude,Longitude,Logo,ActionButton,Desc",gallery:"ActionButton"};if("billboard"==r.slide.attribs.id){r.slide.image=r.slide.background;var I=d(G.getElementsByTagName("ClickThrough"),"Slide",!0);if("undefined"!=typeof I[0]&&(r.slide.link=I[0]),r.slide.link){var J=d(G.getElementsByTagName("StatUrl3"),"Slide");"undefined"!=typeof J[0]&&(r.slide.statUrl3=J)}}if("string"==typeof H[r.slide.attribs.id]){var K,L=H[r.slide.attribs.id].split(",");for(K in L)r.slide[L[K]]=extractCdata(G.getElementsByTagName(L[K])[0])}if("undefined"!=typeof r.slide.Packshot){var M=G.getElementsByTagName("Packshot")[0];r.slide.Packshot=b(r.slide.Packshot,M)}if("undefined"!=typeof r.slide.VoteButton){var N=G.getElementsByTagName("VoteButton")[0];r.slide.VoteButton=b(r.slide.VoteButton,N,!0)}if("survey"==r.slide.attribs.id){r.slide.redirects=[];var O=G.getElementsByTagName("Redirects").item(0);if(null!==O){var P,Q=O.getElementsByTagName("Url");for(P=0;P<Q.length;P++)r.slide.redirects.push({attribs:getAttribs(Q.item(P)),url:extractCdata(Q.item(P),!0)})}}if("gallery"==r.slide.attribs.id){r.slide.images=[];var R=G.getElementsByTagName("Image");if(R.length>0)for(var S=0;S<R.length;S++){var T={};T=extractCdata(R[S]),r.slide.images.push(T)}}if("undefined"!=typeof r.slide.ActionButton){var U=G.getElementsByTagName("ActionButton")[0],V=!1;"survey"==r.slide.attribs.id&&(V=!0),r.slide.ActionButton=b(r.slide.ActionButton,U,V)}if("undefined"!=typeof r.slide.Logo){var W=G.getElementsByTagName("Logo")[0];r.slide.Logo=b(r.slide.Logo,W)}r.slide.elements=[];for(var X=G.getElementsByTagName("Element"),Y=0;Y<X.length;Y++){var Z={};Z=b(Z,X[Y]),r.slide.elements.push(Z)}}e.Interactive2.buttons.push(r)}}else if(v){e.adType="Sequential",e.Sequential={},e.Sequential.attribs=getAttribs(v),e.Sequential.background=extractCdata(v.getElementsByTagName("Background")[0]),e.Sequential.elements=[];var $=v.getElementsByTagName("Elements").item(0);if(null!==$){var _,aa=$.getElementsByTagName("Navigation").item(0),ba=$.getElementsByTagName("Element");for(_=0;_<ba.length;_++){var ca={};ca.attribs=getAttribs(ba.item(_));var da="Duration,ImageHoover,Image,Video,Background,ClickThrough".split(",");for(var ea in da){var fa=da[ea];ca[fa]=extractCdata(ba.item(_).getElementsByTagName(fa).item(0))}ca.Impression=extractCdataArray(ba.item(_).getElementsByTagName("Impression"),!0),ca.StatUrl=extractCdataArray(ba.item(_).getElementsByTagName("StatUrl"),!0),ca.TrackingEvents=extractTrackingEvents(ba.item(_).getElementsByTagName("TrackingEvents"),!0),e.Sequential.elements.push(ca)}}if(null!==aa){e.Sequential.Navigation={};var ga=aa.getElementsByTagName("ButtonReturn").item(0);null!==ga&&(e.Sequential.Navigation.ButtonReturn={},e.Sequential.Navigation.ButtonReturn.attribs=getAttribs(ga),e.Sequential.Navigation.ButtonReturn.Image=extractCdata(ga.getElementsByTagName("Image").item(0)),e.Sequential.Navigation.ButtonReturn.ImageHover=extractCdata(ga.getElementsByTagName("ImageHover").item(0)),ga.getElementsByTagName("StatUrl").length&&(e.Sequential.Navigation.ButtonReturn.StatUrl=extractCdataArray(ga.getElementsByTagName("StatUrl"),!0)));var ha=aa.getElementsByTagName("ButtonSkip").item(0);null!==ha&&(e.Sequential.Navigation.ButtonSkip={},e.Sequential.Navigation.ButtonSkip.attribs=getAttribs(ha),e.Sequential.Navigation.ButtonSkip.Image=extractCdata(ha.getElementsByTagName("Image").item(0)),e.Sequential.Navigation.ButtonSkip.ImageHover=extractCdata(ha.getElementsByTagName("ImageHover").item(0)),ha.getElementsByTagName("StatUrl").length&&(e.Sequential.Navigation.ButtonSkip.StatUrl=extractCdataArray(ha.getElementsByTagName("StatUrl"),!0)))}}else if(w){e.adType="TapGo",i.tapGoTimes=[],e.TapGo=i.parseTapGo(w,0),e.TapGo.lvlsMaxDurations=[];var ia=i.tapGoTimes.length,ja=e.TapGo.lvlsMaxDurations;if(ia){for(var ka=0;ia--;)ja[ia]=i.tapGoTimes[ia],ka+=i.tapGoTimes[ia];e.TapGo.attribs.duration=toHHMMSS(i.tapGoTimes[0])}e.TapGo.movieDuration=e.Duration,e.Duration=toHHMMSS(ka),ja=ka=null}}"undefined"!=typeof h&&(e.TrackingEvents=extractTrackingEvents(h.getElementsByTagName("TrackingEvents"))),"Overlay"===e.type&&(e.adType="Overlay",h=a[c].getElementsByTagName("NonLinear").item(0)||a[c].getElementsByTagName("Linear").item(0),e.attribs=getAttribs(h),e.src=extractCdata(h.getElementsByTagName("StaticResource").item(0)),e.ClickThrough=extractCdata(h.getElementsByTagName("NonLinearClickThrough")[0],!0)),"Restboard"===e.type&&(e.adType="Restboard",h=a[c].getElementsByTagName("NonLinear").item(0),e.attribs=getAttribs(h),e.src=extractCdata(h.getElementsByTagName("StaticResource").item(0)),e.ClickThrough=extractCdata(h.getElementsByTagName("NonLinearClickThrough").item(0),!0)),j.push(e)}function f(a,b){var d={};d.type=a[b].attributes.id.value,"videoAd_wrapper"==d.type&&(d.type="Preroll"),d.isIMA=!0,d.Impression=extractCdataArray(c(a[b].getElementsByTagName("Impression"),"Wrapper"),!0),d.Error=extractCdataArray(c(a[b].getElementsByTagName("Error"),"Wrapper"),!0),d.urlToRedirect=extractCdata(a[b].getElementsByTagName("VASTAdTagURL")[0].getElementsByTagName("URL")[0]),d.Passback={};var e=a[b].getElementsByTagName("Passback")[0];if(isDefined(e)){d.Passback.Link=extractCdata(e.getElementsByTagName("Link")[0]),d.Passback.ID=extractCdata(e.getElementsByTagName("ID")[0]),d.Passback.Time=extractCdata(e.getElementsByTagName("Time")[0]);var f=e.getElementsByTagName("MaxDuration")[0];if(isDefined(f)){d.Passback.maxDurationTime=getAttribs(f).time;var g=extractCdataArray(f.getElementsByTagName("TimeError"),"MaxDuration");g&&(d.Passback.timeError=extractCdataArray(c(f.getElementsByTagName("TimeError"),"MaxDuration"),!0))}}d.Duration="00:00:30";var h=getAttribs(a[b].getElementsByTagName("Wrapper")[0]);d.position=0,"undefined"!=typeof h.position&&(d.position=h.position);var i=new Date;d.AdId=md5(d.urlToRedirect+i.getTime()+1e4*Math.random()),j.push(d)}var g,h,i=this,j=[];if("string"==typeof a&&(a=VJSreplaceAll(a,"&quot;",'"'),a=$.parseXML(a)),"object"!=typeof a||null===a){if(PLAYER_DEBUG)throw"Błąd przy pobieraniu pliku VAST";return!1}g=a.getElementsByTagName("Ad");for(var k=0;k<g.length;k++)e(g,k);return j},getChildrenByTagName:function(a,b){var c,d=a.getElementsByTagName(b),e=d.length,f=[];if(!e)return!1;for(;e--;)d[e].parentNode==a&&f.push(d[e]);if(e=f.length,!e)return!1;for(c=document.createDocumentFragment();e--;)c.appendChild(f[e]);return c.childNodes},getFirstChildrenByTagName:function(a,b,c,d){var e=this.getChildrenByTagName(a,b);return!!e&&("undefined"!=typeof c&&c?extractCdata(e[0],"undefined"!=typeof d&&d):e[0])},getTapGoBackground:function(a){var b=this.getChildrenByTagName(a,"Background");if(!b)return!1;b=b[0];var c=extractCdata(b.getElementsByTagName("Image")[0],!0),d=extractCdata(b.getElementsByTagName("Hover")[0],!0),e=extractCdata(b.getElementsByTagName("Selected")[0],!0);return{attribs:getAttribs(b),image:!!c.length&&c,hover:!!d.length&&d,selected:!!e.length&&e}},getUrlArrayByTagName:function(a,b){var c=this.getChildrenByTagName(a,b);if(c){var d=extractCdataArray(c,!0);return 0!==Object.keys(d).length&&d}return!1},getTapGoSound:function(a){var b=this.getChildrenByTagName(a,"Sound");if(b){b=b[0];var c,d=extractCdata(b.getElementsByTagName("Url")[0],!0);if(d&&d.length)return c={attribs:getAttribs(b),url:d},c.attribs.delay||(c.attribs.delay=0),c}return!1},getTapGoRedirect:function(a){var b=this.getChildrenByTagName(a,"Redirect");if(b){b=b[0];var c,d=extractCdata(b.getElementsByTagName("Url")[0],!0);if(d&&d.length)return c={attribs:getAttribs(b),url:d,statUrl:this.getUrlArrayByTagName(b,"StatUrl"),impression:this.getUrlArrayByTagName(b,"Impression")},c.attribs.delay||(c.attribs.delay=0),c}return!1},getAdParametersJSON:function(a){if("undefined"!=typeof a[0]){var b=a[0].split(";");for(var c in b)if(null!==b[c].match('^{"params'))return JSON.parse(b[c])}return{}},getTapGoItem:function(a,b,c,d){if("undefined"==typeof a||!a)return!1;var e,f=this,g={};return g.groupId="undefined"!=typeof b?b:0,g.type="undefined"!=typeof c?c:"",g.attribs=getAttribs(a),g.attribs.index&&(g.index=g.attribs.index),g.attribs.groupId||(g.attribs.groupId=g.groupId),g.background=f.getTapGoBackground(a),g.statUrl=f.getUrlArrayByTagName(a,"StatUrl"),g.statUrlFail=f.getUrlArrayByTagName(a,"StatUrlFail"),g.impression=f.getUrlArrayByTagName(a,"Impression"),g.showed=!1,g.visible=!1,"action"===g.type&&(g.sound=f.getTapGoSound(a),g.redirect=f.getTapGoRedirect(a),g.attribs.endTapGo=!(!g.attribs.endTapGo||"true"!==g.attribs.endTapGo),e=this.getChildrenByTagName(a,"TapGo"),g.tapGo=!!e&&this.parseTapGo(e[0],d+1)),g},parseTapGo:function(a,b){function c(a){return"undefined"!=typeof a.stopSpot&&a.stopSpot.length?"true"==a.stopSpot:null}function d(a,b){return!!a&&void("undefined"!=typeof b&&null!==b?a.attribs.stopSpot=b:a.attribs.stopSpot=c(a.attribs)||!1)}function e(a){var b,e,f,g,h=i.getChildrenByTagName(a,"Boards"),j=[];if(h)for(e=c(getAttribs(h[0])),h=!!h&&h[0].getElementsByTagName("Board"),b=h&&h[0]?h.length:0;b--;)f=h[b],g={type:"board",attribs:getAttribs(f),background:i.getTapGoBackground(f),statUrl:i.getUrlArrayByTagName(f,"StatUrl")},d(g,e),j.push(g);return!!j.length&&j}function f(a,e){function f(a,b){var e,f,g,h=i.getChildrenByTagName(a,"Buttons"),j=[];if(h)for(e=c(getAttribs(h[0])),h=i.getChildrenByTagName(h[0],"Button"),f=!!h&&h.length;f--;)g=i.getTapGoItem(h[f],b,"button"),d(g,e),j[g.index]=g,o.buttonsIds.push(g.index);return!!Object.keys(j).length&&j}function g(a,b){var e,f,g,h=i.getChildrenByTagName(a,"Goals"),j=[];if(h)for(e=c(getAttribs(h[0])),h=i.getChildrenByTagName(h[0],"Goal"),f=h?h.length:0;f--;)g=i.getTapGoItem(h[f],b,"goal"),d(g,e),j[g.index]=g,o.goalsIds.push(g.index);return!!Object.keys(j).length&&j}function h(a,b){var e,f,g,h=i.getChildrenByTagName(a,"Slides"),j=[];if(h)for(j.attribs=getAttribs(h[0]),j.type="imageSlider",j.background=!1,e=c(j.attribs),h=i.getChildrenByTagName(h[0],"Slide"),f=h?h.length:0;f--;)g=i.getTapGoItem(h[f],b,"slide"),d(g,e),j[g.index]=g,o.slidesIds.push(g.index);return!!Object.keys(j).length&&j}function j(a,c,e){function f(a,f){var g,h=i.getChildrenByTagName(a,"Action"),j=h?h.length:0,l=[],m=!1;for("shape"!==e||f.checkActionsOrder&&"true"===f.checkActionsOrder||(m=!0);j--;)g=i.getTapGoItem(h[j],c,"action",b),d(g),m&&(g.index=g.index.split(",").sort().join(",")),l[g.index]=g,k.actionsIds.push(g.index);return!!Object.keys(l).length&&l}function g(a){for(var e,f,g,h,j,k,l=i.getChildrenByTagName(a,"ButtonActions"),m=l?l.length:0,n=[];m--;)if(f=getAttribs(l[m]),f.index){for(n[f.index]=[],e=n[f.index],e.buttonActionsIds=[],e.attribs=f,g=i.getChildrenByTagName(l[m],"ButtonAction"),j=g.length;j--;)h=i.getTapGoItem(g[j],c,"action",b),d(h),h.buttonId=f.index,e[h.index]=h,e.endActionIndex=f.endActionIndex,e.buttonActionsIds.push(h.index);k=i.getChildrenByTagName(l[m],"DefaultAction"),k=!!k&&i.getTapGoItem(k[0],c,"action",b),d(k),k&&(k.buttonId=f.index,e.buttonActionsIds.push("default")),e["default"]=k}return!!Object.keys(n).length&&n}function h(a){for(var e,f=i.getChildrenByTagName(a,"FinishAction"),g=f?f.length:0,h=0,j=[];g--;)e=i.getTapGoItem(f[g],c,"action",b),d(e),e&&(e.index?(j[e.index]=e,k.finishActionsIds.push(e.index)):(j[h]=e,k.finishActionsIds.push(h),h++));return!!Object.keys(j).length&&j}var j=i.getChildrenByTagName(a,"Target"),k=!1;return j=!!j&&j[0],j&&(k={attribs:getAttribs(j),groupId:c,buttonActions:g(j),actionsIds:[],finishActionsIds:[]},k.actions=f(j,k.attribs),k.finishAction=h(j)),k}var k=i.getChildrenByTagName(a,"ButtonsGroups");k=!!k&&k[0];var l=!!k&&i.getChildrenByTagName(k,"ButtonGroup"),m=l&&l[0]?l.length:0,n=[];if(m)for(var o,p;m--;)p=l[m],o={attribs:getAttribs(p),buttonsIds:[],goalsIds:[],slidesIds:[]},o.type=o.attribs.type||"",o.index=o.attribs.index||m,o.target=j(p,o.index,o.type),o.goals=g(p,o.index),o.slides=h(p,o.index),o.buttons=f(p,o.index),n[o.index]=o,e.groupsIds.push(o.index);return!!n.length&&n}function g(a){var b=i.getFirstChildrenByTagName(a,"Linear"),c={};return!!b&&(c.statUrl=i.getUrlArrayByTagName(b,"StatUrl"),c.impression=i.getUrlArrayByTagName(b,"Impression"),$(a).prepend(b),c=i.getLinearData(c,a))}var h,i=this;return h={level:b,spot:g(a),attribs:getAttribs(a),boards:e(a),buttonsGroups:!1,groupsIds:[],movieDuration:""},h.buttonsGroups=f(a,h),h.attribs.duration&&(h.attribs.tapGoDuration=makeSeconds(h.attribs.duration),h.attribs.tapGoDuration&&(i.tapGoTimes[b]?h.attribs.tapGoDuration>i.tapGoTimes[b]&&(i.tapGoTimes[b]=h.attribs.tapGoDuration):i.tapGoTimes[b]=h.attribs.tapGoDuration)),h.attribs.delay||(h.attribs.delay=0),"undefined"!=typeof h.attribs.skipMainVideo&&"true"===h.attribs.skipMainVideo?h.attribs.skipMainVideo=!0:h.attribs.skipMainVideo=!1,h}};videojs.plugin("adBreak",function(a){var b=this;b.on("videoPlaying",function(){$.each(b.newAdStock,function(a){if("mid-roll"===this.type){var c=$("div#"+b.id()+" .vjs-control-bar"),d=this.timeStart/b.duration()*c.width();$("div#"+b.id()+" #vjsMidroll_"+a).length||$("div#"+b.id()+" .vjs-progress-control .vjs-play-progress").after($("<div>",{"class":"vjs-ad-midroll",id:"vjsMidroll_"+a,style:"left : "+Math.round(d)+"px;","data-start":this.timeStart,"data-duration":b.duration()}))}})}),b.on("videoPlayingAd",function(){var a=$("div#"+b.id()+" .vjs-ad-midroll");a.length&&a.css({visibility:"hidden"})}),b.on("videoCompleteAd",function(){var a=$("div#"+b.id()+" .vjs-ad-midroll");a.length&&a.css({visibility:"visible"})}),b.on("videoFullScreen",function(){var a=$("div#"+b.id()+" .vjs-ad-midroll");if(a.length){var c=$("div#"+b.id()+" .vjs-control-bar");$.each(a,function(a,d){var e=parseInt($(d).data("start"),10),f=parseInt($(d).data("duration"),10),g="visible";b.advertInProgress&&(g="hidden");var h=e/f*c.width();$(d).attr({style:"left : "+Math.round(h)+"px; visibility: "+g})})}})}),function(a){"function"==typeof define&&define.amd?define(["./video"],function(b){a(window,document,b)}):"object"==typeof exports&&"object"==typeof module?a(window,document,require("video.js")):a(window,document,videojs)}(function(a,b,c){var d=function(c){if(!c||!f(c))return null;var d=new RegExp("(?:^|.*;\\s*)"+a.escape(c).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*");return a.unescape(b.cookie.replace(d,"$1"))},e=function(c,d,e,f,g,h){if(c&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(c)){var i="";if(e)switch(e.constructor){case Number:i=e===1/0?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+e;break;case String:i="; expires="+e;break;case Date:i="; expires="+e.toGMTString()}b.cookie=a.escape(c)+"="+a.escape(d)+i+(g?"; domain="+g:"")+(f?"; path="+f:"")+(h?"; secure":"")}},f=function(c){return new RegExp("(?:^|;\\s*)"+a.escape(c).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(b.cookie)},g=function(){try{return a.localStorage.setItem("persistVolume","persistVolume"),a.localStorage.removeItem("persistVolume"),!0}catch(b){return!1}},h=function(b){return g()?a.localStorage.getItem(b):d(b)},i=function(b,c){return g()?a.localStorage.setItem(b,c):e(b,c,1/0,"/")},j=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a},k={namespace:""},l=function(a){var b=this;if(b.options().isMobile)return void b.muted(!1);var c=j({},k,a||{}),d=c.namespace+"-volume",e=c.namespace+"-mute";b.on("volumechange",function(){b.options().changeMute||(i(d,b.volume()),i(e,b.muted()))});var f=h(d);null!==f&&b.volume(f);var g=h(e);null!==g&&b.muted("true"===g),b.controlBar.muteToggle&&b.controlBar.muteToggle.update(),b.controlBar.volumeControl&&isDefined(b.controlBar.volumeControl.volumeBar)&&b.controlBar.volumeControl.volumeBar.update()};c.plugin("persistvolume",l)}),PlayersCollection.prototype={players:[],addPlayer:function(a){this.players.push(a)},pause:function(){$(this.players).each(function(a,b){b.pause()})},remove:function(){var a=this;$(this.players).each(function(b,c){"undefined"!=typeof a.players[b]&&(c.remove(),delete a.players[b])})},find:function(a){var b=null;return $(this.players).each(function(c,d){$(d.el()).attr("id")==a&&(b=d)}),b}};var PlayerTemplateFactory=function(){this.templates=this.getTemplatesCollection(),this.currentTemplate=!1};PlayerTemplateFactory.prototype.getTemplatesCollection=function(){return{"default":{extendable:!1,adProgressBar:!0,stopButton:!1,playPrevButton:!0,playNextButton:!1,shareButton:!1,sleepMode:!1,className:"vjs-default-skin",buttons:{children:["playToggle","stopButton","playPrevButton","playNextButton","currentTimeDisplay","timeDivider","durationDisplay","remainingTimeDisplay","progressControl","fullscreenToggle","volumeControl","muteToggle","playbackRateMenuButton","subtitlesButton","captionsButton","chaptersButton"]}},123:{extendable:!1,adProgressBar:!1,stopButton:!0,playPrevButton:!1,playNextButton:!0,shareButton:!1,qualityButton:!0,sleepMode:!1,qualityWarningButton:!0,progressControlInactivityTimeout:3257,className:"vjs-sl-skin",buttons:{children:{fullscreenToggle:!0,shareButton:!1,playToggle:!0,stopButton:!0,playPrevButton:!1,playNextButton:!0,liveDisplay:!1,progressControl:!0,volumeControl:!1,volumeMenuButton:{volumeBar:{vertical:!0}},qualityButton:!0,durationDisplay:!0,timeDivider:!0,currentTimeDisplay:!0,remainingTimeDisplay:!1,muteToggle:!1,playbackRateMenuButton:!1,captionsButton:!0}}},"player-pl":{extendable:!1,adProgressBar:!1,stopButton:!0,playPrevButton:!1,playNextButton:!0,shareButton:!1,qualityButton:!0,sleepMode:!0,qualityWarningButton:!0,gyroButton:!0,vrButton:!0,className:"vjs-player-pl-skin",progressControlInactivityTimeout:300,settingsController:!0,buttons:{children:{stopButton:!0,playToggle:!0,movieInfo:!0,rightControlsWrapper:{children:{fullscreenToggle:!0,cogButton:!0,volumeWrapper:{children:{muteToggle:!0,volumeControl:!0}},playPrevButton:!1,playNextButton:!0,liveDisplay:!1,captionsButton:!0,gyroButton:!0,vrButton:!0}},shareButton:!1,qualityButton:!0,playbackRateMenuButton:!1,progressControl:{children:{timeControlsWrapper:{children:{currentTimeDisplay:!0,timeDivider:!0,durationDisplay:!0}}}}}}},standard:{extendable:!0},inwestor:{shareButton:!1,buttons:{children:{shareButton:!1}}},tvnwarszawa:{defaultColor:"#B8D62C"},kontakt24:{defaultColor:"#00b200"},tvn24:{defaultColor:"#2471b9"},tvnmeteo:{defaultColor:"#097BC1"},tvn24bis:{defaultColor:"#c59d25"},veedo:{defaultColor:"#ca1300"},"standard-square":{shareButton:!1,className:"vjs-standard-skin vjs-standard-square",buttons:{children:{shareButton:!1}}},"standard-circle":{shareButton:!1,className:"vjs-standard-skin vjs-standard-circle",buttons:{children:{shareButton:!1}}},msn:{defaultColor:"#2471b9"}}},PlayerTemplateFactory.prototype.getTemplate=function(a){"undefined"==typeof PLAYER5_ID&&(PLAYER5_ID="default");var b={adProgressBar:!1,stopButton:!0,playPrevButton:!1,playNextButton:!1,shareButton:!0,qualityButton:!1,sleepMode:!1,qualityWarningButton:!1,vrButton:!0,gyroButton:!0,className:"vjs-standard-skin",progressControlInactivityTimeout:3257,defaultColor:"",buttons:{children:{fullscreenToggle:!0,shareButton:!0,playToggle:!0,stopButton:!0,playPrevButton:!1,playNextButton:!1,liveDisplay:!1,progressControl:!0,muteToggle:!0,volumeControl:!0,qualityButton:!1,currentTimeDisplay:!0,timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,playbackRateMenuButton:!1,multiAudioButton:!0,captionsButton:!0,vrButton:!0,gyroButton:!0}}};return"long"===a&&"player-pl"!==PLAYER5_ID?(b.qualityButton=!0,b.buttons.children.qualityButton=!0,this.currentTemplate="undefined"!=typeof this.templates[123]?this.templates[123]:this.templates["default"]):this.currentTemplate="undefined"!=typeof this.templates[PLAYER5_ID]?this.templates[PLAYER5_ID]:this.templates["default"],"undefined"!=typeof this.currentTemplate.extendable&&this.currentTemplate.extendable!==!0||(this.currentTemplate=this.mergeRecursive(b,this.currentTemplate)),this.setCustomColorVariant(),this.currentTemplate},PlayerTemplateFactory.prototype.setCustomColorVariant=function(){if("undefined"==typeof this.currentTemplate.defaultColor||""===this.currentTemplate.defaultColor)return!1;var a="."+this.currentTemplate.className.split(" ").join("."),b=this.currentTemplate.defaultColor,c=[[" .vjs-play-progress","background-color"],[" .vjs-shareboard-content h2","color"],[" .vjs-shareboard-content h2","border-color"],[" .vjs-big-play-button:hover","background-color","0.8"],[" .vjs-control:hover","background","0.85"],[".vjs-playing .vjs-play-control:hover","background","0.85"],[" .vjs-current-time:hover","background","0"],[" .vjs-duration:hover","background","0"],[" .vjs-remaining-time:hover","background","0"],[" .vjs-time-divider:hover","background","0"],[" .vjs-volume-level","background"],[" .vjs-volume-control:hover","background","0"],[" .vjs-menu-button ul li:focus","background","0.85"],[" .vjs-menu-button ul li:hover","background","0.85"],[" .vjs-menu-button ul li.vjs-selected","background","0.85"],[" .vjs-menu-button ul li.vjs-selected:focus","background","0.85"],[" .vjs-menu-button ul li.vjs-selected:hover","background","0.85"],[" .vjs-shareboard-content .vjs-share-link-button","background","0.8"]],d='<style type="text/css">';for(var e in c){var f="undefined"!=typeof c[e][2]?0==c[e][2]?0:hexToRGB_MA(b,c[e][2]):b;d+=".video-js"+a+c[e][0]+"{"+c[e][1]+": "+f+";}"}d+="</style>",$(d).appendTo("head")},PlayerTemplateFactory.prototype.mergeRecursive=function(a,b){for(var c in b)try{b[c].constructor==Object?a[c]=PlayerTemplateFactory.prototype.mergeRecursive(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a};var tvnPlayerSocialMedia=function(){this.popup={open:function(a,b,c){var d,e;d=window.screen.width/2-(b/2+10),e=window.screen.height/2-(c/2+50),window.open(a,"Window2","status=no,height="+c+",width="+b+",resizable=yes,left="+d+",top="+e+",screenX="+d+",screenY="+e+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no")}}};tvnPlayerSocialMedia.prototype.generatePopup=function(a,b,c){var d={facebook:"https://www.facebook.com/sharer/sharer.php?u=",gplus:"https://plus.google.com/share?url=",twitter:"https://twitter.com/share?url="},e=d[a];return e+=b,"twitter"==a&&(e+="&text="+c.replace("|"," ")),this.popup.open(e,545,460),!1},window.TvnPlayerSocialMedia=new tvnPlayerSocialMedia;var TvnPlayerEventsStats=function(a){this.collectors=a||[],this.definedCollectors=this.defineCollectors(this.collectors)};TvnPlayerEventsStats.GEMIUS_TRAFFIC="gemius",TvnPlayerEventsStats.GOOGLE_ANALYTICS="GA",TvnPlayerEventsStats.PIX2="pix2",TvnPlayerEventsStats.AVAILABLE_COLLECTORS=[TvnPlayerEventsStats.GEMIUS_TRAFFIC,TvnPlayerEventsStats.GOOGLE_ANALYTICS,TvnPlayerEventsStats.PIX2],TvnPlayerEventsStats.prototype.defineCollectors=function(a){var b=[];if($.isArray(a)&&a.length)for(var c=a.length,d=0;d<c;d++)$.inArray(a[d],TvnPlayerEventsStats.AVAILABLE_COLLECTORS)>-1&&b.push(a[d]);else"string"==typeof a&&$.inArray(a,TvnPlayerEventsStats.AVAILABLE_COLLECTORS)>-1&&b.push(a);return b},TvnPlayerEventsStats.prototype.getDefinedCollectors=function(){return this.definedCollectors},TvnPlayerEventsStats.prototype.trackGA=function(a){var b,c;if("undefined"!=typeof ga&&"function"==typeof ga){ga("set","dimension1",this.isUserLogged()?"Yes":"No"),this.getUserHash()&&ga("set","dimension2",this.getUserHash()),b=["send","event"];for(c in a.GA)a.GA.hasOwnProperty(c)&&b.push(a.GA[c]);ga.apply(void 0,b)}else if("undefined"!=typeof _gaq&&"function"==typeof _gaq.push){_gaq.push(["_setCustomVar",1,"logged_user",this.isUserLogged()?"Yes":"No"]),b=["_trackEvent"];for(c in a.GA)a.GA.hasOwnProperty(c)&&b.push(a.GA[c]);_gaq.push(b)}},TvnPlayerEventsStats.prototype.trackGemius=function(a,b){if("undefined"!=typeof gemius_event){var c,d=this.getGemiusCode(a);if(d!==!1){c=["_view_",d];for(var e in b.gemius)b.gemius.hasOwnProperty(e)&&c.push(e+"="+b.gemius[e]);c.push("logged_user="+(this.isUserLogged()?"Yes":"No")),this.getUserHash()&&c.push("id="+this.getUserHash()),"undefined"!=typeof __pix2&&"function"==typeof __pix2.getUUID&&c.push("id_p="+__pix2.getUUID()),gemius_event.apply(void 0,c)}}},TvnPlayerEventsStats.prototype.trackPix2=function(a){if("undefined"!=typeof __pix2&&"undefined"!=typeof __pix2.event&&"undefined"!=typeof a.pix2&&"undefined"!=typeof a.pix2.event){var b={};for(var c in a.pix2)"params"==c&&(b=a.pix2.params);window.__pix2.event(a.pix2.event,b)}},TvnPlayerEventsStats.prototype.track=function(a,b){"undefined"==typeof b&&(b=a),$.inArray(TvnPlayerEventsStats.GOOGLE_ANALYTICS,this.definedCollectors)>-1&&this.trackGA(b),$.inArray(TvnPlayerEventsStats.GEMIUS_TRAFFIC,this.definedCollectors)>-1&&this.trackGemius(a,b),$.inArray(TvnPlayerEventsStats.PIX2,this.definedCollectors)>-1&&this.trackPix2(b)},TvnPlayerEventsStats.prototype.isUserLogged=function(){if("undefined"!=typeof Sso&&Sso.isLoggedUser){var a=Sso.getLoggedUser;if(a&&a.isAuthenticated)return a.isAuthenticated()}return!1},TvnPlayerEventsStats.prototype.getUserHash=function(){return"undefined"!=typeof Sso&&Sso.getStorageUserHash?Sso.getStorageUserHash():""},TvnPlayerEventsStats.prototype.getGemiusCode=function(a){if(!$.isArray(a))return!1;var b={Adblock:{Start:"ofuan7eAP2jXhYLy1WYF8qSfDot6pCcizN1vuzQW9b7.i7",StartAd:".KswPPCZUxXctxxLuLd4tqSfrhd6pGblbHofJORtxe..I7",StartAsset:"nAE6QQ.5Ly9GopLDr9cdCJa0DiEdxScWoe9v_L5hHTn.l7"}};for(var c in a)b.hasOwnProperty(a[c])&&(b=b[a[c]]);return"string"==typeof b&&b};var tvnAdBlockBoardUtils=function(){this.defaultCookieExpiration=120,this.cookieName="tvn_adblock"};tvnAdBlockBoardUtils.prototype=new TvnPlayerEventsStats([TvnPlayerEventsStats.GEMIUS_TRAFFIC,TvnPlayerEventsStats.GOOGLE_ANALYTICS,TvnPlayerEventsStats.PIX2]),tvnAdBlockBoardUtils.prototype.setCookie=function(a){if("undefined"==typeof jQuery.cookie)return!1;a=a||this.defaultCookieExpiration;var b=new Date;b.setTime(b.getTime()+60*a*1e3),$.cookie(this.cookieName,1,{useLocalStorage:!1,expires:b,path:"/"})},tvnAdBlockBoardUtils.prototype.removeCookie=function(){return"undefined"!=typeof jQuery.cookie&&($.cookie(this.cookieName,null),!0)},tvnAdBlockBoardUtils.prototype.checkCookie=function(){return"undefined"!=typeof jQuery.cookie&&$.cookie(this.cookieName)},tvnAdBlockBoardUtils.prototype.generateBoardHTML=function(a){if("function"==typeof adBlockBoard)return adBlockBoard();if("undefined"!=typeof adBlockBoard)return adBlockBoard;var b="undefined"!=typeof a.adBlockBanner?"background-image:url('"+a.adBlockBanner+"')":"";return $('<div class="vjs-abDetected" style="'+b+'"><a href="http://player.pl/faq/dlaczego-wideo-sie-nie-odtwarza,9374.html" title="Sprawdź jak wyłączyć blokowanie reklam" class="vjs-off-adblock">&nbsp;</a></div>')},tvnAdBlockBoardUtils.prototype.adBlockBoardCallback=function(a){"function"==typeof adBlockBoardCallback?adBlockBoardCallback():($(a).trigger("video.adBlockBoard"),
TvnAdBlockBoardUtils.setCookie(),TvnAdBlockBoardUtils.track(["Adblock","Start"],{gemius:{player_action:"Plansza Adblock Start"},GA:{category:"Plansza Adblok",action:"Wyświetlenie"},pix2:{event:"Plansza Adblock Start"}}))},window.TvnAdBlockBoardUtils=new tvnAdBlockBoardUtils,function(a){function b(a,b,k){var l=0,m=[0],o="",p=null,o=k||"UTF8";if("UTF8"!==o&&"UTF16BE"!==o&&"UTF16LE"!==o)throw"encoding must be UTF8, UTF16BE, or UTF16LE";if("HEX"===b){if(0!==a.length%2)throw"srcString of HEX type must be in byte increments";p=d(a),l=p.binLen,m=p.value}else if("TEXT"===b||"ASCII"===b)p=c(a,o),l=p.binLen,m=p.value;else if("B64"===b)p=f(a),l=p.binLen,m=p.value;else{if("BYTES"!==b)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";p=e(a),l=p.binLen,m=p.value}this.getHash=function(a,b,c,d){var e,f=null,k=m.slice(),o=l;if(3===arguments.length?"number"!=typeof c&&(d=c,c=1):2===arguments.length&&(c=1),c!==parseInt(c,10)||1>c)throw"numRounds must a integer >= 1";switch(b){case"HEX":f=g;break;case"B64":f=h;break;case"BYTES":f=i;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-1"!==a)throw"Chosen SHA variant is not supported";for(e=0;e<c;e+=1)k=n(k,o),o=160;return f(k,j(d))},this.getHMAC=function(a,b,k,p,q){var r,s,t,u,v=[],w=[];switch(r=null,p){case"HEX":p=g;break;case"B64":p=h;break;case"BYTES":p=i;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-1"!==k)throw"Chosen SHA variant is not supported";if(s=64,u=160,"HEX"===b)r=d(a),t=r.binLen,r=r.value;else if("TEXT"===b||"ASCII"===b)r=c(a,o),t=r.binLen,r=r.value;else if("B64"===b)r=f(a),t=r.binLen,r=r.value;else{if("BYTES"!==b)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";r=e(a),t=r.binLen,r=r.value}if(a=8*s,b=s/4-1,s<t/8){if("SHA-1"!==k)throw"Unexpected error in HMAC implementation";for(r=n(r,t);r.length<=b;)r.push(0);r[b]&=4294967040}else if(s>t/8){for(;r.length<=b;)r.push(0);r[b]&=4294967040}for(s=0;s<=b;s+=1)v[s]=909522486^r[s],w[s]=1549556828^r[s];if("SHA-1"!==k)throw"Unexpected error in HMAC implementation";return k=n(w.concat(n(v.concat(m),a+l)),a+u),p(k,j(q))}}function c(a,b){var c,d,e,f,g=[],h=[],i=0;if("UTF8"===b)for(d=0;d<a.length;d+=1)for(c=a.charCodeAt(d),h=[],128>c?h.push(c):2048>c?(h.push(192|c>>>6),h.push(128|63&c)):55296>c||57344<=c?h.push(224|c>>>12,128|c>>>6&63,128|63&c):(d+=1,c=65536+((1023&c)<<10|1023&a.charCodeAt(d)),h.push(240|c>>>18,128|c>>>12&63,128|c>>>6&63,128|63&c)),e=0;e<h.length;e+=1){for(f=i>>>2;g.length<=f;)g.push(0);g[f]|=h[e]<<24-i%4*8,i+=1}else if("UTF16BE"===b||"UTF16LE"===b)for(d=0;d<a.length;d+=1){for(c=a.charCodeAt(d),"UTF16LE"===b&&(e=255&c,c=e<<8|c>>8),f=i>>>2;g.length<=f;)g.push(0);g[f]|=c<<16-i%4*8,i+=2}return{value:g,binLen:8*i}}function d(a){var b,c,d,e=[],f=a.length;if(0!==f%2)throw"String of HEX type must be in byte increments";for(b=0;b<f;b+=2){if(c=parseInt(a.substr(b,2),16),isNaN(c))throw"String of HEX type contains invalid characters";for(d=b>>>3;e.length<=d;)e.push(0);e[b>>>3]|=c<<24-b%8*4}return{value:e,binLen:4*f}}function e(a){var b,c,d,e=[];for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),d=c>>>2,e.length<=d&&e.push(0),e[d]|=b<<24-c%4*8;return{value:e,binLen:8*a.length}}function f(a){var b,c,d,e,f,g=[],h=0;if(-1===a.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(c=a.indexOf("="),a=a.replace(/\=/g,""),-1!==c&&c<a.length)throw"Invalid '=' found in base-64 string";for(c=0;c<a.length;c+=4){for(f=a.substr(c,4),d=e=0;d<f.length;d+=1)b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[d]),e|=b<<18-6*d;for(d=0;d<f.length-1;d+=1){for(b=h>>>2;g.length<=b;)g.push(0);g[b]|=(e>>>16-8*d&255)<<24-h%4*8,h+=1}}return{value:g,binLen:8*h}}function g(a,b){var c,d,e="",f=4*a.length;for(c=0;c<f;c+=1)d=a[c>>>2]>>>8*(3-c%4),e+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(15&d);return b.outputUpper?e.toUpperCase():e}function h(a,b){var c,d,e,f="",g=4*a.length;for(c=0;c<g;c+=3)for(e=c+1>>>2,d=a.length<=e?0:a[e],e=c+2>>>2,e=a.length<=e?0:a[e],e=(a[c>>>2]>>>8*(3-c%4)&255)<<16|(d>>>8*(3-(c+1)%4)&255)<<8|e>>>8*(3-(c+2)%4)&255,d=0;4>d;d+=1)f=8*c+6*d<=32*a.length?f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-d)&63):f+b.b64Pad;return f}function i(a){var b,c,d="",e=4*a.length;for(b=0;b<e;b+=1)c=a[b>>>2]>>>8*(3-b%4)&255,d+=String.fromCharCode(c);return d}function j(a){var b={outputUpper:!1,b64Pad:"="};try{a.hasOwnProperty("outputUpper")&&(b.outputUpper=a.outputUpper),a.hasOwnProperty("b64Pad")&&(b.b64Pad=a.b64Pad)}catch(c){}if("boolean"!=typeof b.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof b.b64Pad)throw"Invalid b64Pad formatting option";return b}function k(a,b){return a<<b|a>>>32-b}function l(a,b){var c=(65535&a)+(65535&b);return((a>>>16)+(b>>>16)+(c>>>16)&65535)<<16|65535&c}function m(a,b,c,d,e){var f=(65535&a)+(65535&b)+(65535&c)+(65535&d)+(65535&e);return((a>>>16)+(b>>>16)+(c>>>16)+(d>>>16)+(e>>>16)+(f>>>16)&65535)<<16|65535&f}function n(a,b){var c,d,e,f,g,h,i,j,n,o=[],p=[1732584193,4023233417,2562383102,271733878,3285377520];for(c=(b+65>>>9<<4)+15;a.length<=c;)a.push(0);for(a[b>>>5]|=128<<24-b%32,a[c]=b,n=a.length,i=0;i<n;i+=16){for(c=p[0],d=p[1],e=p[2],f=p[3],g=p[4],j=0;80>j;j+=1)o[j]=16>j?a[j+i]:k(o[j-3]^o[j-8]^o[j-14]^o[j-16],1),h=20>j?m(k(c,5),d&e^~d&f,g,1518500249,o[j]):40>j?m(k(c,5),d^e^f,g,1859775393,o[j]):60>j?m(k(c,5),d&e^d&f^e&f,g,2400959708,o[j]):m(k(c,5),d^e^f,g,3395469782,o[j]),g=f,f=e,e=k(d,30),d=c,c=h;p[0]=l(c,p[0]),p[1]=l(d,p[1]),p[2]=l(e,p[2]),p[3]=l(f,p[3]),p[4]=l(g,p[4])}return p}"function"==typeof define&&define.amd?define(function(){return b}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=b:exports=b:a.jsSHA=b}(this);var nuvi;!function(){if(!nuvi||!nuvi.requirejs){nuvi?require=nuvi:nuvi={};var requirejs,require,define;!function(global,setTimeout){function commentReplace(a,b){return b||""}function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){!c&&hasProp(a,e)||(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(0===b||1===b&&".."===a[2]||".."===a[b-1])continue;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=c&&c.split("/"),r=x.map,s=r&&r["*"];if(a&&(a=a.split("/"),k=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[k])&&(a[k]=a[k].replace(jsSuffixRegExp,"")),"."===a[0].charAt(0)&&q&&(p=q.slice(0,q.length-1),a=p.concat(a)),b(a),a=a.join("/")),d&&r&&(q||s)){g=a.split("/");a:for(h=g.length;h>0;h-=1){if(j=g.slice(0,h).join("/"),q)for(i=q.length;i>0;i-=1)if(f=getOwn(r,q.slice(0,i).join("/")),f&&(f=getOwn(f,j))){l=f,m=h;break a}!n&&s&&getOwn(s,j)&&(n=getOwn(s,j),o=h)}!l&&n&&(l=n,m=o),l&&(g.splice(0,m,l),a=g.join("/"))}return e=getOwn(x.pkgs,a),e?e:a}function d(a){isBrowser&&each(scripts(),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName)return b.parentNode.removeChild(b),!0})}function e(a){var b=getOwn(x.paths,a);if(b&&isArray(b)&&b.length>1)return b.shift(),u.require.undef(a),u.makeRequire(null,{skipMap:!0})([a]),!0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):a.indexOf("!")===-1?c(a,l,e):a:(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(each(globalDefQueue,function(a){var b=a[0];"string"==typeof b&&(u.defQueueMap[b]=!0),B.push(a)}),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}u.defQueueMap={}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){if(a.usingExports=!0,a.map.isDefine)return a.exports?C[a.map.id]=a.exports:a.exports=C[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?void u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(b){a=b}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;if(this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad)){var g=[];each(this.depMaps,function(a){g.push(a.normalizedMap||a)}),req.onResourceLoad(u,this.map,g)}l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(u.defQueueMap,c)||this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.map.normalizedMap=f,this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),void(k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(a,c){var d=k.name,f=g(d),i=useInteractive;c&&(a=c),i&&(useInteractive=!1),h(f),hasProp(x.config,b)&&(x.config[d]=x.config[b]);try{req.exec(a)}catch(k){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+k,k,[b]))}i&&(useInteractive=!0),this.depMaps.push(f),u.completeLoad(d),p([d],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.undefed||(this.defineDep(b,a),this.check())})),this.errback?i(a,"error",bind(this,this.errback)):this.events.error&&i(a,"error",bind(this,function(a){this.emit("error",a)}))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,defQueueMap:{},Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){if(a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/"),"string"==typeof a.urlArgs){var b=a.urlArgs;a.urlArgs=function(a,c){return(c.indexOf("?")===-1?"?":"&")+b}}var c=x.shim,d={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){d[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,b){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),c[b]=a}),x.shim=c),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b,null,!0))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return e!==-1&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);e.undefed=!0,d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),delete u.defQueueMap[a],e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(u.defQueueMap={},d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|^blob\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs&&!/^blob\:/.test(h)?h+x.urlArgs(a,h):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);if(!e(b.id)){var c=[];return eachProp(y,function(a,d){0!==d.indexOf("_@r")&&each(a.depMaps,function(a){if(a.id===b.id)return c.push(d),!0})}),j(makeError("scripterror",'Script error for "'+b.id+(c.length?'", needed by: '+c.join(", "):'"'),a,[b.id]))}}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){if("interactive"===a.readyState)return interactiveScript=a}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.2",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a,b,c){var d=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return d.type=a.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,e.onNodeCreated&&e.onNodeCreated(d,e,b,c),currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{setTimeout(function(){},0),importScripts(c),a.completeLoad(b)}catch(d){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,d,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){if(head||(head=a.parentNode),dataMain=a.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||mainScript.indexOf("!")!==-1||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),e?(e.defQueue.push([a,b,c]),e.defQueueMap[a]=!0):globalDefQueue.push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),nuvi.requirejs=requirejs,nuvi.require=require,nuvi.define=define}}(),nuvi.define("requireLib",function(){}),nuvi.define("foo",function(){}),nuvi.require.config({paths:{moduleSL:"//s1-player5.cdntvn.pl/sl6f54975r5tk9g8f75435jhf98765lkjg",imaGoogle:"//imasdk.googleapis.com/js/sdkloader/ima3"}}),videojs.RedcdnPlayer=videojs.Html5.extend({init:function(a,b,c){var d,e;d=b.source,delete b.source,videojs.Html5.call(this,a,b,c);var f,g=$(a.el()).find("video")[0],h={};f=getStorageItem(a.namespace+"-volume"),null!==f&&(h.volume=100*f),e=new window.redcdnplayer.Player(g).setup(h),"true"==getStorageItem(a.namespace+"-mute")&&setTimeout(function(){a.muted(!0)},250),a.mediaPlayer=e}}),videojs.RedcdnPlayer.prototype.currentTime=function(){var a=getExtensionByUrl(this.player().src());if("mp4"!=a)try{return this.player().mediaPlayer.time()}catch(b){}return videojs.Html5.prototype.currentTime.call(this)},videojs.RedcdnPlayer.prototype.setCurrentTime=function(a){var b=getExtensionByUrl(this.player().src());"mp4"!=b?this.player().mediaPlayer.seekTo(a):videojs.Html5.prototype.setCurrentTime.call(this,a)},videojs.RedcdnPlayer.prototype.duration=function(){var a=getExtensionByUrl(this.player().src());if("mp4"!=a)try{return this.player().mediaPlayer.getDuration()}catch(b){}return videojs.Html5.prototype.duration.call(this)},videojs.RedcdnPlayer.isSupported=function(){return!!window.MediaSource},videojs.RedcdnPlayer.canPlaySource=function(a){return"application/dash+xml"===a.type?"maybe":""},videojs.options.techOrder.push("RedcdnPlayer");var _PlayerSLCurrent=0;isAdBlockEnabled();var VideoPlayerState=function(){this.breakName="",this.breakNr=[],this.adIsPlaying=!1,this.materialIsPlaying=!1,this.adsCounter=0,this.firstAd=!1,this.watchingTime=-1,this.playbackTime=-1,this.progressIntervalId=null,this.materialStarted=!1,this.registerAd=function(a){this.adIsPlaying||(this.adIsPlaying=!0,this.firstAd=0===this.adsCounter,this.adsCounter++,"undefined"==typeof this.breakNr[a]?this.breakNr[a]=1:this.breakNr[a]++,this.breakName=a+"/"+this.breakNr[a],this.materialIsPlaying=!1)},this.setPlayingMaterial=function(){this.materialIsPlaying=!0},this.getIsPlayingMaterial=function(){return this.materialIsPlaying},this.setMaterialStarted=function(){this.materialStarted=!0},this.getMaterialStarted=function(){return this.materialStarted},this.getActualBreak=function(){return this.adIsPlaying===!0?this.breakName:""},this.unregisterAd=function(){this.breakName="",this.adIsPlaying=!1},this.setWatchingTime=function(a){a&&!isNaN(parseInt(a,10))&&(this.watchingTime=a)},this.incrementWatchingTime=function(){this.watchingTime++},this.setPlaybackTime=function(a){isNaN(parseInt(a,10))||(this.playbackTime=a)}};Player=function(){this.brandingWidth=0,this.brandingHeight=0,this.state=new VideoPlayerState,this.eventEmitter=new TvnPlayerEventsStats([TvnPlayerEventsStats.PIX2])},Player.debugMode=!1,Player.prototype.disableEventEmitter=function(){this.eventEmitter=new TvnPlayerEventsStats([])},Player.prototype.getState=function(){return this.state},Player.prototype.resetState=function(){this.getState().progressIntervalId&&clearInterval(this.getState().progressIntervalId),this.state=new VideoPlayerState},Player.prototype.log=function(){!0===Player.debugMode&&"undefined"!=typeof console&&console.log(arguments)},Player.prototype.error=function(){!0===Player.debugMode&&"undefined"!=typeof console&&console.error(arguments)},Player.prototype.render=function(){},Player.prototype.show=function(){this.node&&$(this.node).show()},Player.prototype.hide=function(){this.node&&$(this.node).hide()},Player.prototype.play=function(){},Player.prototype.stop=function(){},Player.prototype.pause=function(){},Player.prototype.playingCallback=function(){$(this.node).trigger("video.playing",arguments),$(this.node).trigger("video.loadingEnd",arguments),this.getState().getIsPlayingMaterial()||(this.getState().unregisterAd(),this.getState().setPlayingMaterial()),this.getState().getMaterialStarted()||(this.getState().setMaterialStarted(),"function"==typeof this.getMaterialType&&this.trackEvent("play_"+this.getMaterialType(),"video_time="+this.getInformation().totalTime),this.initProgress&&this.initProgress(),TvnAdBlockBoardUtils.checkCookie()&&TvnAdBlockBoardUtils.track(["Adblock","StartAsset"],{gemius:{player_action:"Plansza Adblock Start assetu"},GA:{category:"Plansza Adblok",action:"Start assetu"},pix2:{event:"Plansza Adblock Start assetu"}}))},Player.prototype.trackEvent=function(a,b){var c=[];"undefined"!=typeof b&&(c.ap=b),c.asset_id=this.getGstreamVideoId(),"function"==typeof this.getGstreamVideoId&&this.getGstreamVideoId&&$.inArray(TvnPlayerEventsStats.PIX2,this.eventEmitter.getDefinedCollectors())>-1?this.eventEmitter.track({pix2:{event:a,params:c}}):this.error("Some events could not be sent")},Player.prototype.stoppedCallback=function(){this.trackEvent("play_stop","video_time="+this.getInformation().playbackTime),$(this.node).trigger("video.stopped",arguments),this.resetState()},Player.prototype.changeView=function(){$(this.node).trigger("video.changeView",arguments)},Player.prototype.completeCallback=function(){this.trackEvent("play_end","video_time="+this.getInformation().totalTime),$(this.node).trigger("video.complete",arguments),this.resetState()},Player.prototype.pausedCallback=function(){$(this.node).trigger("video.paused",arguments),this.trackEvent("play_pause","video_time="+this.getInformation().playbackTime)},Player.prototype.playingAdCallback=function(){if($(this.node).trigger("video.playingAd",arguments),!this.getState().adIsPlaying){this.trackEvent("break_event",this.adsPotential("begin"));var a="Preroll";"undefined"!=typeof arguments[0]&&(a=arguments[0]),this.getState().registerAd(a),TvnAdBlockBoardUtils.checkCookie()&&TvnAdBlockBoardUtils.track(["Adblock","StartAd"],{gemius:{player_action:"Plansza Adblock Start reklamy"},GA:{category:"Plansza Adblok",action:"Start reklamy",label:a},pix2:{event:"Plansza Adblock Start reklamy",params:{breakName:a}}})}},Player.prototype.completeAdCallback=function(){this.trackEvent("break_event",this.adsPotential("end")),$(this.node).trigger("video.completeAd",arguments),this.getState().unregisterAd()},Player.prototype.pausedAdCallback=function(){$(this.node).trigger("video.pausedAd",arguments)},Player.prototype.seekCallback=function(){$(this.node).trigger("video.seek",arguments),this.trackEvent("play_seek")},Player.prototype.errorCallback=function(){$(this.node).trigger("video.error",arguments)},Player.prototype.licenseErrorCallback=function(){$(this.node).trigger("video.licenseError",arguments)},Player.prototype.fullscreenCallback=function(){$(this.node).trigger("video.fullScreen",arguments)},Player.prototype.playlistClipEndCallback=function(){$(this.node).trigger("video.playlistClipEnd",arguments),this.resetState()},Player.prototype.playlistEndCallback=function(){$(this.node).trigger("video.playlistEnd",arguments),this.resetState()},Player.prototype.renewLicenseErrorCallback=function(){var a={response:arguments[0]};$(this.node).trigger("video.renewLicenseError",a)},Player.prototype.renewLicenseSuccessCallback=function(){var a={response:arguments[0]};$(this.node).trigger("video.renewLicense",a)},Player.prototype.notAvailableCallback=function(){$(this.node).trigger("video.notAvailableCallback",arguments)},Player.prototype.deviceLimitExceededCallback=function(){$(this.node).trigger("video.deviceLimitExceededCallback",arguments)},Player.prototype.progressCallback=function(a,b){$(this.node).trigger("video.progress",arguments),b=b||a.watchingTime,!isNaN(b)&&0===b%60&&b>0&&this.trackEvent("play_"+b+"s","video_time="+this.getInformation().playbackTime)},Player.prototype.adReceivedCallback=function(a){$(this.node).trigger("video.adReceived",arguments)},Player.prototype.remove=function(){},Player.prototype.isRendered=function(){return!1},Player.prototype.loadingCallback=function(){$(this.node).trigger("video.loadingStart")},Player.prototype.adBlockBoardCallback=function(){$(this.node).trigger("video.adBlockBoard",arguments),TvnAdBlockBoardUtils.setCookie(),TvnAdBlockBoardUtils.track(["Adblock","Start"],{gemius:{player_action:"Plansza Adblock Start"},GA:{category:"Plansza Adblok",action:"Wyświetlenie"},pix2:{event:"Plansza Adblock Start"}})},Player.prototype.error=function(){$(this.node).trigger("video.error")},Player.prototype.width=function(){},Player.prototype.height=function(){},Player.prototype.setBrandingWidth=function(a){this.brandingWidth=a},Player.prototype.setBrandingHeight=function(a){this.brandingHeight=a},PlayerSL=function(node,vars,params,player5options){
vars=vars||{},params=params||{},this.x=0,this.y=1,this.player5=null,this.player5options=player5options,this.playerFile="http://s1-player5.cdntvn.pl/player.xap","undefined"!=typeof SILVER_LIGHT_PLAYER&&(this.playerFile=SILVER_LIGHT_PLAYER),this.skin=null,this.isRendered()||(_PlayerSLCurrent=_PlayerSLCurrent++),this.id="_playerSLNode_"+_PlayerSLCurrent,this.node=node,this.playerNode=null,this.playerObjectNode=null,node.PlayerSL=this,this.addEmptyDiv();var that=this,createCallbackFunction=function(type){var functionName="_PlayerSL_"+_PlayerSLCurrent+"_"+type;return eval(functionName+" = function(){ that[type].apply(that, arguments); }"),functionName};$(node).on("set-license-url",function(a,b){"undefined"!=typeof this.PlayerSL&&"undefined"!=typeof this.PlayerSL.vars&&(this.PlayerSL.vars.licenseUrl=b),$(this).data("license-url",b)}),this.events={onError:createCallbackFunction("onError"),onLoad:createCallbackFunction("onSLLoad")},this.loading=!1,this.vars=$.extend({},{playlist:$(node).data("video-playlist"),autostart:!!$(node).data("video-autostart"),stopButton:!!$(node).data("stop-button"),externalAds:!0,seekCallback:createCallbackFunction("seekCallback"),errorCallback:createCallbackFunction("errorCallback"),licenseErrorCallback:createCallbackFunction("licenseErrorCallback"),fullscreenCallback:createCallbackFunction("fullscreenCallback"),completeCallback:createCallbackFunction("completeCallback"),stoppedCallback:createCallbackFunction("stoppedCallback"),completeAdCallback:createCallbackFunction("completeAdCallback"),pausedCallback:createCallbackFunction("pausedCallback"),pausedAdCallback:createCallbackFunction("pausedAdCallback"),playingCallback:createCallbackFunction("playingCallback"),playingAdCallback:createCallbackFunction("playingAdCallback"),playlistClipEndCallback:createCallbackFunction("playlistClipEndCallback"),playlistEndCallback:createCallbackFunction("playlistEndCallback"),renewLicenseErrorCallback:createCallbackFunction("renewLicenseErrorCallback"),renewLicenseSuccessCallback:createCallbackFunction("renewLicenseSuccessCallback"),notAvailableCallback:createCallbackFunction("notAvailableCallback"),deviceLimitExceededCallback:createCallbackFunction("deviceLimitExceededCallback"),adBlockBoardCallback:createCallbackFunction("adBlockBoardCallback"),changePlayerCallback:createCallbackFunction("changePlayerCallback")},vars),this._width=$(node).data("width")||$(node).width(),this._height=$(node).data("height")||$(node).height(),$(node).data("tvn-vod")&&(this.vars.tvnVod=!0),$(node).data("license-url")&&(this.vars.licenseUrl=$(node).data("license-url")),"undefined"!=typeof $(node).data("disable-adblock")&&(1==$(node).data("disable-adblock")?this.vars.blocker="off":this.vars.blocker="on"),$(node).data("license-renew-url")&&(this.vars.licenseRenewUrl=$(node).data("license-renew-url")),$(node).data("device-id")&&(this.vars.deviceId=$(node).data("device-id")),$(node).data("device-name")&&(this.vars.deviceName=$(node).data("device-name")),$(node).data("video-gstream-account")&&(this.vars.gstreamAccount=$(node).data("video-gstream-account")),$(node).data("only-audio")&&(this.vars.onlyAudio=$(node).data("only-audio")),this.params=$.extend({},{enableGPUAcceleration:"true",autoUpgrade:"true",enableHtmlAccess:"true",background:"white",windowless:"true",version:"4.0",inplaceInstallPrompt:"true"},params)},PlayerSL.prototype=new Player,PlayerSL.prototype.setPlayer5=function(a){this.player5=a},PlayerSL.prototype.changePlayerCallback=function(a){var b=this,c=$.extend({},this.player5options,{advertiseMode:!0,externalAdsMode:!0});this.player5||(this.player5=PlayerVJS(c,this.playerObjectNode.parent())),window.uBrowser&&"MSIE"===window.uBrowser||"Edge"===window.uBrowser||this.hidePlayerSL(),$(this.player5.node).trigger("changePlayer",a),$(this.node).one("video.completeAdsBlock",function(){b.player5.isFullscreen_&&b.player5.exitFullscreenOnEnd(),b.play(),b.showPlayerSL(),b.player5&&b.player5.remove(),$(b.node).off("video.completeAdsBlock")})},PlayerSL.prototype.hidePlayerSL=function(){this.playerObjectNode&&this.playerObjectNode.css("visibility","hidden"),this.player5&&$(this.player5.el()).show()},PlayerSL.prototype.showPlayerSL=function(){this.playerObjectNode&&this.playerObjectNode.css("visibility","visible"),this.player5&&$(this.player5.el()).hide()},PlayerSL.prototype.addEmptyDiv=function(){0===$(this.node).find(this.id).length&&(this.playerNode=$('<div id="'+this.id+'"></div>'),$(this.node).append(this.playerNode))},PlayerSL.prototype.onSLLoad=function(){$(this.node).trigger("video.SLLoad")},PlayerSL.prototype.onError=function(){$(this.node).trigger("video.error")},PlayerSL.prototype.createObject=function(a,b,c,d,e,f){return Silverlight.createObjectEx({source:a,parentElement:b,id:c,properties:d,events:e,initParams:f})},PlayerSL.prototype.render=function(a,b){if(!this.isRendered()){a=a||{},b=b||{},a=$.extend({},this.vars,a),a.width=this._width,a.height=this._height,b=$.extend({},this.params,b),b.width=this._width,b.height=this._height;var c="";for(var d in a)c+=d+"="+a[d]+",";c&&c.length&&(c=c.substr(0,c.length-1));var e=this;window.Silverlight?(e.playerObjectNode=$(this.createObject(this.playerFile,null,this.id,b,this.events,c)),$(this.node).html(this.playerObjectNode)):nuvi.require(["moduleSL"],function(){e.playerObjectNode=$(e.createObject(e.playerFile,null,e.id,b,e.events,c)),$(e.node).html(e.playerObjectNode)}),this.resetState()}},PlayerSL.prototype.isRendered=function(){var a=document.getElementById(this.id);return a&&a.nodeName&&"OBJECT"==a.nodeName},PlayerSL.prototype.play=function(){if(this.loading||(this.loadingCallback(),this.loading=!0),this.isRendered()){var a=document.getElementById(this.id);a&&"undefined"!=typeof a.content&&a.content.SL.play()}else this.render({autostart:!0})},PlayerSL.prototype.initProgress=function(){var a=this;this.getState().progressIntervalId=null,this.getInformation&&(this.getState().progressIntervalId=setInterval(function(){a.progressCallback(a.getInformation())},1e3))},PlayerSL.prototype.stop=function(){var a=document.getElementById(this.id);a&&"undefined"!=typeof a.content&&a.content.SL.stop()},PlayerSL.prototype.pause=function(){var a=document.getElementById(this.id);a&&"undefined"!=typeof a.content&&a.content.SL.pause()},PlayerSL.prototype.remove=function(){$(this.node).removeClass("player-initialized"),this.playerObjectNode.remove(),this.addEmptyDiv()},PlayerSL.prototype.setPlaylistUrl=function(a){this.vars.playlist=a},PlayerSL.prototype.width=function(a){$("#"+this.id).css("width",a-this.brandingWidth)},PlayerSL.prototype.height=function(a){$("#"+this.id).css("height",a-this.brandingHeight)},PlayerSL.prototype.getGstreamVideoId=function(){return this.getInformation().moveId!==-1?this.getInformation().moveId:"string"==typeof $(this.node).data("gstream-video-id")?$(this.node).data("gstream-video-id"):""},PlayerSL.prototype.getMaterialType=function(){return"long"},PlayerSL.prototype.getInformation=function(){var a={watchingTime:-1,playbackTime:-1,totalTime:-1,moveId:-1};try{var b=document.getElementById(this.id);b&&"undefined"!=typeof b.content&&(a.watchingTime=b.content.SL.getMovieWatchingTime(),a.playbackTime=b.content.SL.getMoviePlaybackTime(),a.totalTime=b.content.SL.getMovieTotalTime(),a.moveId=b.content.SL.getMovieId())}catch(c){}return a},PlayerSL.prototype.getAdsPotentialInfo=function(){var a=this,b={"break":-1,advert_id:-1,adverts_count:-1,video_time:-1,midrolls_count:-1,has_preroll:-1,has_postroll:-1};try{var c=document.getElementById(this.id);if(c&&"undefined"!=typeof c.content){b["break"]=c.content.SL.getBreakType();var d=function(){var d=c.content.SL.getAdOrder();return a.player5&&a.player5.isExternalAdsMode&&a.player5.isExternalAdsMode()&&"Preroll"===b["break"]&&a.player5.newAdStock.length&&a.player5.newAdStock[0]&&"pre-roll"==a.player5.newAdStock[0].type&&a.player5.newAdStock[0].lastIMAadIndex>-1?a.player5.newAdStock[0].lastIMAadIndex+1+d:d};b.advert_id=d(),b.adverts_count=c.content.SL.getAdvertsCount(),b.video_time=c.content.SL.getVideoTime(),b.midrolls_count=c.content.SL.getMidrollsCount(),b.has_preroll=c.content.SL.hasPreroll(),b.has_postroll=c.content.SL.hasPostroll()}}catch(e){}return b},PlayerSL.prototype.getAdvertId=function(a){var b=0,c=a.content.SL.getBreakType();return this.player5&&this.player5.isExternalAdsMode&&this.player5.isExternalAdsMode()&&"Preroll"===c&&"function"==typeof getLastImaAdIndex,a.content.SL.getAdOrder()+b},PlayerSL.prototype.adsPotential=function(a){var b=[],c=this.getAdsPotentialInfo();return b.push("break="+c["break"]),b.push("advert_id="+c.advert_id),b.push("advert_pos="+a),b.push("adverts_count="+c.adverts_count),b.push("video_time="+parseInt(c.video_time,10)),b.push("midrolls_count="+c.midrolls_count),b.push("has_preroll="+c.has_preroll),b.push("has_postroll="+c.has_postroll),b};var PlayerVJS=function(a,b){var c="player5_";if(!a.initialRequest){if($(b).hasClass("player-initialized")){var d=videojs($(b).find(".vjs-tech").attr("id"));return setBrandingSize(d,b),d}$(b).addClass("player-initialized");var e=!1,f=!1,g=!1,h=!1,i=$(b).attr("data-movie-info");("undefined"!=typeof $(b).data("advertise-mode")&&1==$(b).data("advertise-mode")||"undefined"!=typeof a.advertiseMode&&a.advertiseMode===!0)&&(e=!0),"undefined"!=typeof $(b).data("webview-mode")&&1==$(b).data("webview-mode")&&(f=!0),"undefined"!=typeof a.externalAdsMode&&a.externalAdsMode===!0&&(g=!0);var j=!1;if(isDefined($(b).data("video-playlist"))){var k=$(b).data("video-playlist").replace(".xml",".json");$.ajax({url:k,dataType:"json",async:!1,success:function(a){j=a}}),"object"==typeof j&&j.hasOwnProperty("movies")&&(j={playlist:j}),isNotDefined(a.autoplay)&&"undefined"!=typeof j.playlist&&"undefined"!=typeof j.playlist.movies&&(a.autoplay=1===j.playlist.movies.autoplay)}var l=$(b).data("vast"),m=$(b).data("movie-params"),n={};isDefined(m)&&(isDefined($(b).data("video-custom-package"))&&(n.gstream=$(b).data("video-custom-package")),isDefined($(b).data("video-material-id"))&&(n.id=$(b).data("video-material-id")),isDefined($(b).data("title"))&&(n.title=$(b).data("title")),isDefined(l)&&(n.adserver=l.ads.servers[0].apiAddress),isDefined(m)&&m.dash.src.indexOf(".livx")!=-1?n.profiles={row:{name:"Live",url:m.ss.src},wv:{url:m.dash.src,kid:isDefined(m.dash.kid)?m.dash.kid:""}}:n.profiles={row:{name:"480p",url:m.ss.src},wv:{url:m.dash.src,kid:isDefined(m.dash.kid)?m.dash.kid:""}}),jQuery.isEmptyObject(n)||(j={playlist:{movies:{movie:n}}}),a.adBlock=!1,a.adBlockBanner="",a.adBlockSendHit=!1,"undefined"!=typeof $(b).data("disable-adblock")&&!!$(b).data("disable-adblock")!=!1||"function"!=typeof isAdBlockEnabled||isAdBlockEnabled()!==!0||tvn24ScrollTvnCheck()||(a.adBlock=!0,a.adBlockBanner="http://s.tvn.pl/bc/ab/960x540_AdBlock-SplashScreen2.jpg"),"undefined"!=typeof $(b).data("disable-adblock")&&1==$(b).data("disable-adblock")&&(a.adBlockSendHit=!0),"undefined"==typeof a.adBlock||a.adBlock!==!0||tvn24ScrollTvnCheck()||(g?$(b).prepend(TvnAdBlockBoardUtils.generateBoardHTML(a)):$(b).append(TvnAdBlockBoardUtils.generateBoardHTML(a)),TvnAdBlockBoardUtils.adBlockBoardCallback(b)),a.continueWatchingEnabled=!0,isDefined($(b).data("continue-watching"))&&!!$(b).data("continue-watching")==!1&&(a.continueWatchingEnabled=!1),"undefined"!=typeof $(b).data("share-url")?a.shareUrl=$(b).data("share-url"):h?a.shareUrl="":a.shareUrl=document.location.href,"undefined"!=typeof $(b).data("share-title")?a.shareTitle=$(b).data("share-title"):h?a.shareTitle="":a.shareTitle=document.title;var o=a.autoplay===!1?"":" autoplay ",p=a.muted===!0?" muted ":"",q=a.controls===!1?"":" controls ";"Smartfon"==detector.getDevice()&&(q=" ",a.autoplay=!1,o=" "),a.controls="undefined"==typeof a.controls||a.controls;var r,s,t,u,v=Math.round(1e6*Math.random()),w="undefined"!=typeof $(b).data("poster")?$(b).data("poster"):"",x=w?'poster="'+w+'"':"",y=!1,z=!1,A=!1,B={},C=!1,D=!1,E="short",F=a.adbBannerOnVastError,G="undefined"!=typeof $(b).attr("data-change-mute")&&$(b).attr("data-change-mute"),H="undefined"!=typeof $(b).attr("data-video-start-time")&&$(b).attr("data-video-start-time"),I="undefined"!=typeof $(b).attr("data-hide-play-button-on-pause")&&$(b).attr("data-hide-play-button-on-pause");u="undefined"!=typeof $(b).data("video-gstream-account")?$(b).data("video-gstream-account"):"undefined"!=typeof IDENTIFIER?IDENTIFIER:"",isNotDefined(F)&&(F=!0);var J=$(b).data("watermark"),K=!!$(b).data("video-360"),L=$(b).data("video-360-zoom"),M=!!$(b).data("flv");if(j){E="long";var N=!1;for(var O in j.playlist.movies){var P=j.playlist.movies[O];if(A=P,P.hasOwnProperty("start")&&1==P.start){A=P,N=O;var Q=parseInt(O,10)+1;"undefined"!=typeof j.playlist.movies[Q]&&(y=j.playlist.movies[Q],z=j.playlist.movies[Q-2]);break}}document.location.origin||(document.location.origin=document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:"")),document.location.origin.indexOf("player")!==-1&&(C=!0),!A.profiles.row||"Live"!=A.profiles.row.name&&"Live_audio"!=A.profiles.row.name&&"Transmisja obrad Sejmu"!=A.profiles.row.name||(D=!0),B={ads:{midBrakes:[],servers:[{apiAddress:A.adserver,provider:"tvn"}],skipAd:{enabled:!1,timeOut:1}},parentalRating:A.parental_rating,playlist:j},$(b).attr("data-src",A.profiles.wv.url);var R=A.ad_breaks;for(var S in R)B.ads.midBrakes.push({time:R[S]});"1"===A.show_product_placement&&"1"===A.has_product_placement&&(B.productPlacement={afterStart:{offset:5,duration:5,y:"20px"},beforeEnd:{offset:15,duration:5,y:"20px"}}),r=A.id,s=A.gstream,t={480:A.profiles.wv.url},J=A.watermark,"undefined"!=typeof A.video360&&(K=!!A.video360,"undefined"!=typeof A.quality&&(t=A.quality)),isDefined(A.video360zoom)&&""!==A.video360zoom&&A.video360zoom>0&&(L=A.video360zoom)}else isDefined($(b).data("vast"))&&(B=$(b).data("vast"),"undefined"!=typeof a.parentalRating&&(B.parentalRating=a.parentalRating),"undefined"!=typeof a.productPlacement&&(B.productPlacement=a.productPlacement)),t=$(b).data("quality"),r=$(b).data("video-material-id"),s=$(b).data("video-custom-package");B.ads&&isDefined($(b).data("ad-legal-label"))&&(B.ads.adLegalLabel=$(b).data("ad-legal-label"));var T={playlist:j.playlist,activeMovie:A},U=$(b).data("sprite");U="undefined"!=typeof U?{hasSprite:!0,img:{url:U}}:{hasSprite:!1,img:!1};var V=(new PlayerTemplateFactory).getTemplate(E);if("undefined"!=typeof $(b).data("share-button")){var W=1==$(b).data("share-button");V.shareButton=W,V.buttons.children.shareButton=W}var X="string"==typeof uDevice&&PLAYER5_DEVICES_TYPE.mobile.indexOf(uDevice.toLowerCase())>-1,Y="string"==typeof uDevice&&PLAYER5_DEVICES_TYPE.tablet.indexOf(uDevice.toLowerCase())>-1,Z=X===!0?" vjs-mobile ":"";Y&&(Z+=" vjs-tablet "),detectIE()?(Z+=" vjs-ie ",detectIE()<11&&(Z+=" vjs-ie-lt11 ")):(Z+=" vjs-not-ie ",videojs.IS_IOS&&(Z+=" vjs-ios ",(videojs.IS_IPHONE||videojs.IS_IPOD)&&(Z+=" vjs-ios-mobile ",window.uVersion>9&&(Z+=" vjs-ios-mobile-10 ")),videojs.IS_IPAD&&(Z+=" vjs-ios-tablet "))),h&&(Z+=" vjs-embed "),f&&(Z+=" vjs-webview-mode ");var _=$(b).is(":visible");_?null:$(b).attr("style","display:block;");var aa=getPlayerSizeType($(b).width());_?null:$(b).attr("style","");var ba="",ca=$(b).data("src"),da="video/mp4",ea=navigator.appVersion.indexOf("Edge")!=-1,fa=window.isMobileDevice&&"Firefox"===window.uBrowser||"Firefox"==window.uBrowser&&parseInt(window.uVersion)<48,ga=window.isMobileDevice||fa||$.inArray(uBrowser,["Safari","iPad","iPod","iPhone"])>-1||"MSIE"==uBrowser&&uVersion>=10||ea;"undefined"==typeof $(b).attr("data-hls-src")||!ga&&"undefined"==typeof FORCE_HLS||(ca=$(b).attr("data-hls-src"),$(b).data("src",$(b).data("hls-src"))),"HLS"!=vjsIsTypeMovieDashOrHLS(ca)||!ga&&"undefined"==typeof FORCE_HLS||(videojs.options.techOrder.unshift("hls"),da="application/x-mpegURL",ba='<source src="'+ca+'" type="'+da+'">'),(!detectIE()&&videojs.IS_IOS&&7===parseInt(videojs.IOS_VERSION,10)||"MSIE"==uBrowser&&"Smartfon"==uDevice||"Tablet"==uDevice)&&(e||(ba='<source src="'+ca+'" type="'+da+'">')),"on"==getParameterByName("playerFlash")?setCookieItem("playerFlash",1):"off"==getParameterByName("playerFlash")&&setCookieItem("playerFlash",0),(canPlayMp4()||vjsIsTypeMovieDashOrHLS(ca))&&1!=getCookieItem("playerFlash")||(videojs.options.techOrder=["flash","html5"],videojs.options.flash.params={allowfullscreen:"true",wmode:"opaque",allowscriptaccess:"always"},ba='<source src="'+ca+'" type="video/mp4">');var ha="",ia=parseInt((/WebKit\/([0-9]+)/.exec(navigator.appVersion)||0)[1],10)||void 0,ja=navigator.userAgent.indexOf("Android")>=0,ka=ja&&ia<=534&&0===navigator.vendor.indexOf("Google");ka&&(ha=" vjs-native-tablet");var la=$(b).attr("data-subtitles");if(la){la=JSON.parse(la);for(var ma in la){var na="true"==la[ma]["default"]?" default":"";ba+='<track kind="captions" src="'+la[ma].src+'" srclang="'+la[ma].lang+'" label="'+la[ma].label+'"'+na+">"}}var oa='<video id="'+c+v+'" crossorigin="anonymous"  class="video-js  '+V.className+Z+aa+ha+'" '+p+o+q+' playsinline webkit-playsinline preload="none" width="100%" height="100%" '+x+" controls>"+ba+" </video>",pa=$(b).data("license-wv"),qa=$(b).data("video-additional-package"),ra={videoMaterialId:r,videoCustomPackage:s,videoAdditionalPackage:qa},sa=!1;("Smartfon"==detector.getDevice()||ka)&&(sa=!0);var ta,ua=document.getElementById("detailProgramLive");ta=null!==ua&&null!==ua.getAttribute("data-stream-id")&&ua.getAttribute("data-stream-id");var va={nativeControlsForTouch:sa,adBlock:a.adBlock,adBlockSendHit:a.adBlockSendHit,shareUrl:a.shareUrl,shareTitle:a.shareTitle,continueWatchingEnabled:a.continueWatchingEnabled,quality:t,controls:a.controls,license:{url:pa},streamId:ta,hash:objectToStringRecursive(window.navigator)+Math.random()+(new Date).getTime(),controlBar:V.buttons,plugins:{timeWatcher:!0,resolutions:!0,dashManager:!0,playerUtilsTvn:!0,spawnEntityTvn:!0,userUtilsTvn:!0,eventsTvn:T,coreTvn:B,statsTvn:ra,playlistManager:!0,tapGoManager:!0,debug:!0,adBreak:!0,hawkEye:!0,sleepModePlugin:V.sleepMode||!1,multiAudio:!0,settingsController:V.settingsController||!1,video360FpsCounter:!0},html5:{nativeTextTracks:!1},playlistData:j,playlistIndex:N,activeMovie:A,nextMovie:y,prevMovie:z,isLive:D,isMobile:X,isTablet:Y,adbBannerOnVastError:F,enabledRestboard:C,gStreamAccount:u,spriteImg:U,inactivityTimeout:3257,progressControlInactivityTimeout:V.progressControlInactivityTimeout,textTrackSettings:!0,isNativeAndroid:ka,isAndroid:ja,defaultPoster:w,changeMute:G,videoStartTime:H,hidePlayButtonOnPause:I,force360:K,zoom360:L,forceFlv:M,watermark:J,embed:h,advertiseMode:e,webviewMode:f,externalAdsMode:g,movieInfo:i,hasBranding:{isBranding:!1,width:void 0,height:void 0,left:void 0,top:void 0}};g?$(b).prepend(oa):$(b).append(oa);var wa=videojs(c+v,va,function(){this.namespace=c,this.node=b,this.clipId=$(b).data("clip-id");var a=this.controlBar.getNestedChild("stopButton"),d=this.controlBar.getNestedChild("playNextButton"),e=this.controlBar.getNestedChild("playPrevButton"),f=this.controlBar.getNestedChild("shareButton");a&&(a.requestStopButton=V.stopButton),d&&(d.requestPlayNextButton=!!y&&V.playNextButton),e&&(e.requestPlayPrevButton=!!z&&V.playPrevButton),f&&(f.requestShareButton=V.shareButton),this.adProgressBar=V.adProgressBar,this.progressTips(),"undefined"!=typeof va.changeMute&&(this.changeMute=va.changeMute),"undefined"!=typeof va.hasBranding&&(this.hasBranding={isBranding:!1,width:void 0,height:void 0,left:void 0,top:void 0}),this.textTrackSettings.setValues({edgeStyle:"uniform",fontPercent:1.25,backgroundOpacity:"0"}),this.hotkeys({volumeStep:.1,seekStep:5,enableMute:!0,enableFullscreen:!0}),this.hasMetaViewport=$("meta[name=viewport]").length;var g=this;if(setBrandingSize(this,b),X){this.on("fullscreenchange2",function(){g.isFullscreen()?g.hasMetaViewport||$("<meta>",{name:"viewport",content:"width=480, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}).appendTo("head"):g.hasMetaViewport||$("meta[name=viewport]").attr("content","user-scalable=yes")});var h=window.navigator.userAgent.indexOf("Edge/")!==-1;if(detectIE()&&!h){var i=this.node.find("video"),j=$("<div>",{"class":"vjs-control-bar-wrapper"}),k=i.siblings().not(".vjs-poster").detach();i.after(j),j.append(k)}}});return wa.persistvolume({namespace:wa.namespace}),wa.setVideoTitleForIOS(),wa}};if("undefined"!=typeof $){$.contextMenu({selector:".video-js",items:{tvn:{name:"TVN S.A.",disabled:!0}}});var playersCollection=new PlayersCollection;$.fn.player5=function(a){var b=null,c=this,d=!!$(c).data("video-360");if(a=a||{},isBrowserPlayer5Ready()||!(c.data("video-playlist")||c.data("src")&&"MPEG-DASH"==vjsIsTypeMovieDashOrHLS(c.data("src")))||d){var e=!0;"undefined"==typeof a.autoplay||a.autoplay||(e=!1),b=PlayerVJS(a,c),e&&window.uDevice&&"Desktop"!==window.uDevice&&"object"==typeof google&&"object"==typeof google.ima&&(b.initializeImaAdContainer(),b.imaContainerInitialized=!0)}else b=new PlayerSL(c[0],{},{},a);if(b)return"undefined"!=typeof b.id_?playersCollection.find(b.id_)||playersCollection.addPlayer(b):playersCollection.addPlayer(b),b},window.uDevice&&"Desktop"!==window.uDevice&&$.ajax({url:"//imasdk.googleapis.com/js/sdkloader/ima3.js",type:"GET",dataType:"script",async:!0,cache:!0,error:function(){PLAYER_DEBUG&&console.log("Error loading IMA SDK for mobile")}})}else console.log("Player5 init error: jQuery not found..");!function(a,b,c){"use strict";var d=function(c){function d(){return"123"===PLAYER5_ID?"player.pl":"tvn24"===PLAYER5_ID?"tvn24.pl":null}function e(){var d=navigator.appVersion.indexOf("Edge")!=-1,e=!(!a.MSInputMethodContext||!b.documentMode||"8.1"!=a.uOSversion&&"10"!=a.uOSversion||"Windows"!=a.uOS);if(!c.playbackOrigin)return c.hasStarted(!1),void c.errorLoadMovie();c.src(null),c.loadTech("RedcdnPlayer",c.playbackOrigin),c.setVideoTitleForIOS();var f=c.options().hash,g=new jsSHA(f,"TEXT"),h=g.getHash("SHA-1","HEX"),i=c.options().activeMovie.profiles.wv.kid,j=[];j.push(["key",encodeURIComponent(i)].join("=")),j.push(["hash",h].join("=")),c.options().streamId&&j.push(["stream-id",c.options().streamId].join("="));var k=c.options().license.url;(e||d)&&k&&(k=c.options().isLive===!1?c.options().license.url.replace("licensewebwv","licensewebpr"):c.options().license.url.replace("licensewebwvlive","licensewebprlive"),c.options().license.url.indexOf("drm-web")!=-1&&(k=c.options().license.url+="/pr"));var l={playready:[k,j.join("&")].join("?")},m={widevine:[k,j.join("&")].join("?")},n={};null!==k&&j.length>0&&(n=e||d?l:m);var o={firefoxMseEnabled:!0};c.options().isLive&&(o.startBufferLength=5,o.liveDelay=20),c.mediaPlayer.setup(o),c.mediaPlayer.load({dash:c.playbackOrigin}),c.mediaPlayer.setDrm(n)}return{isInitialized:!1,currentPortal:d(),licenseRenewInterval:!1,pauseTimestamp:null,setDefaultQuality:function(){var a="undefined"!=typeof $(c.node).attr("data-default-quality")&&parseInt($(c.node).attr("data-default-quality"),10),b=c.mediaPlayer.getProfiles(),d=c.options().playlistData;d!==!1&&d.playlist.hasOwnProperty("defaultQuality")&&(a=d.playlist.defaultQuality);for(var e=0;e<b.length;e++)parseInt(a,10)===b[e].height&&(c.debug("[DM] defaultQuality = "+a+", bitrate = "+b[e].bandwidth),c.mediaPlayer.minAutoBitrate(b[e].bandwidth))},init:function(){e(),c.one("loadedmetadata",function(){c.dashManager.QS.init(),c.dashManager.setDefaultQuality()})},licenseRenew:function(a,b){if(a===!1)return this.licenseRenewInterval&&clearInterval(this.licenseRenewInterval),this.licenseRenewInterval=!1,"pause"===b&&(this.pauseTimestamp=Date.now()),void c.debug("[DM] licenseRenew(false)");c.debug("[DM] licenseRenew(true)");var d="%62VoDP275@3",e="*@3d80Vx276!2",f=Math.random().toString(10).slice(2),g=new jsSHA(d+f,"TEXT").getHash("SHA-1","HEX"),h=new jsSHA(f+e,"TEXT").getHash("SHA-1","HEX"),i="undefined"!=typeof $(c.node).data("device-id")?$(c.node).data("device-id"):null,j="undefined"!=typeof $(c.node).data("device-name")?$(c.node).data("device-name"):null,k=9e4,l=function(a){var b;try{var d=JSON.parse(a);b=d.hash}catch(e){b=a}if("undefined"==typeof a||0===a.length||g+h!=b){var f=c.getInformation();f.response=a,$(c.node).trigger("video.renewLicenseError",f),c.resetPlayerAds()}else{var i={};i.response=a,$(c.node).trigger("video.renewLicense",i)}},m=function(){c.debug("[DM] licenseRenewRequest"),$.ajax({url:$(c.node).data("license-renew-url"),type:"post",data:{id:c.options().activeMovie.id,hash:f,deviceId:encodeURIComponent(i),deviceName:encodeURIComponent(j)}}).done(l).fail(l)};c.debug("[DM] !this.licenseRenewInterval",!this.licenseRenewInterval),this.licenseRenewInterval||(c.debug("[DM] !licenseRenewInterval",!this.licenseRenewInterval),(null===this.pauseTimestamp||this.pauseTimestamp&&Date.now()-this.pauseTimestamp>k)&&m(),this.licenseRenewInterval=setInterval(function(){m()},k))},QS:{isEnabled:!1,isInitialized:!1,isAdaptive:!0,isBuffering:!1,insufficientBufferCounter:0,bufferingTime:0,bufferingMaxTime:20,currentBitrate:"auto",currentQuality:"auto",bitrateInfoList:null,startTime:null,bitrates:{},bitrateInfo:!1,bitrateInfoInterval:null,DEBUG:!1,qualityButton:c.controlBar.getNestedChild("qualityButton"),waitingCallCounter:0,waitingCallTimestamp:0,prettyBitrate:function(a){var b=parseFloat(a/1e3);return b<1e3?b+" Kbps":b/1e3+" Mbps"},getCurrentProfile:function(){return{bitrate:this.currentBitrate,pretty:this.prettyBitrate(this.currentBitrate)}},getSelectedQuality:function(){return this.isAdaptive?"adaptive":this.currentBitrate},bitrateInfoUpdate:{start:function(){var a=c.dashManager.QS;a.bitrateInfo!==!0&&(a.bitrateInfo=!0,c.dashManager.QS.bitrateInfoInterval=setInterval(function(){var a="",b=c.dashManager.QS,d=b.getCurrentProfile();c.dashManager.QS.isAdaptive&&(d.bitrate<=b.bitrates.low&&c.mediaPlayer.getCurrentTime()-c.dashManager.QS.startTime>=10?$(c.el()).find(".vjs-quality-warning-info").hasClass("vjs-visible")||c.qualityWarningButton.show():c.qualityWarningButton.hide(),"auto"!==d.bitrate&&(a=" ("+b.prettyBitrate(d.bitrate)+")"))},1e3))},stop:function(){clearInterval(c.dashManager.QS.bitrateInfoInterval),c.dashManager.QS.bitrateInfo=!1}},bufferingTimer:{start:function(){var a=c.dashManager.QS,b=1e3;$(c.el()).hasClass("vjs-error-load")||a.isBuffering===!0||"auto"!==a.currentQuality||(c.debug("[DM][QS] bufferingTimer.start()"),c.dashManager.QS.bufferingInterval=setInterval(function(){c.advertInProgress&&(a.bufferingTimer.stop(),c.debug("[DM][QS] bufferingTimer.stop()  // Advert"),c.dashManager.QS.insufficientBufferCounter=0),c.debug("[DM][QS] aktualny czas timestampu: "+~~((Date.now()-a.waitingCallTimestamp)/1e3)),~~((Date.now()-a.waitingCallTimestamp)/1e3)>25&&6===a.waitingCallCounter&&(c.errorTransferDegradation(),a.bufferingTimer.stop()),"auto"===a.currentQuality&&a.currentBitrate<=a.bitrates.low&&(a.bufferingTime+=b,c.debug("[DM][QS] zwiekszam bufferingTime ("+a.bufferingTime/1e3+")"),a.bufferingTime>b*a.bufferingMaxTime&&(c.debug("[DM][QS] przekroczony bufferingTime 20s, l.293"),c.errorTransferDegradation(),a.bufferingTimer.stop(),c.debug("[DM][QS] bufferingTimer.stop()  // plachta")))},b),c.dashManager.QS.isBuffering=!0)},stop:function(){c.dashManager.QS.isBuffering&&(clearInterval(c.dashManager.QS.bufferingInterval),c.dashManager.QS.bufferingTime=0,c.dashManager.QS.isBuffering=!1)}},startMultipleSeeking:function(){this.waitingCallCounter++,0===this.waitingCallTimestamp&&(this.waitingCallTimestamp=Date.now())},resetMultipleSeeking:function(){this.waitingCallCounter=0,this.waitingCallTimestamp=0},init:function(){if(this.isEnabled=(c.options().playlistData!==!1||c.options().isLive)&&"player.pl"==c.dashManager.currentPortal||"undefined"!=typeof FORCE_QS&&FORCE_QS,this.isEnabled&&!this.isInitialized){var a=function(){var a,b=c.dashManager.QS;b.bitrateInfoList=c.mediaPlayer.getProfiles();for(var d=0;d<b.bitrateInfoList.length;d++)a=b.bitrateInfoList[d].bandwidth,a<7e5?(b.bitrates.low=a,b.bitrates.lowPretty=b.prettyBitrate(a)):a>=7e5&&a<15e5?(b.bitrates.medium=a,b.bitrates.mediumPretty=b.prettyBitrate(a)):a>=15e5&&("undefined"!=typeof b.bitrates.high&&a>b.bitrates.high||"undefined"==typeof b.bitrates.high)&&(b.bitrates.high=a,b.bitrates.highPretty=b.prettyBitrate(a));for(var e in["low","medium","high"])"undefined"==typeof b.bitrates[e]&&$(c.el()).find('.vjs-quality-button .vjs-menu-item[data-bitrate="'+e+'"]').remove();b.bitrateInfoList.length>1&&($(c.el()).find(".vjs-quality-button").addClass("vjs-visible").removeClass("vjs-hidden"),$(c.el()).find('.vjs-quality-button .vjs-menu-item[data-res="auto"]').addClass("vjs-selected"),c.trigger("qualityButtonsCreated"))},b=function(){c.mediaPlayer.on("waiting",function(a){c.debug("waiting "+a),c.isIma||$(c.el()).addClass("vjs-waiting"),c.dashManager.QS.bufferingTimer.start(),c.dashManager.QS.startMultipleSeeking(),c.debug("[DM][QS] bufferingTimer.start()  // WAITING 2"),c.debug("[DM][QS] aktualny stam przewinięcia: "+c.dashManager.QS.waitingCallCounter)}),c.on("seeked",function(){c.debug("[DM][QS] bufferingTimer.stop()  // SEEKED"),c.dashManager.QS.bufferingTimer.stop(),c.dashManager.QS.resetMultipleSeeking(),c.debug("[DM][QS] aktualny stan przewinięcia: "+c.dashManager.QS.waitingCallCounter)}),c.mediaPlayer.on("profile",function(a,b){c.dashManager.QS.currentBitrate=b.bandwidth}),c.mediaPlayer.on("waitingEnd",function(a){c.debug("waitingEnd "+a),$(c.el()).removeClass("vjs-waiting"),c.dashManager.QS.bufferingTimer.stop(),c.dashManager.QS.resetMultipleSeeking(),c.debug("[DM][QS] bufferingTimer.stop()  // waitingEnd"),c.debug("[DM][QS] aktualny stan przewinięcia: "+c.dashManager.QS.waitingCallCounter)}),c.mediaPlayer.on("offline",function(){c.debug("offline"),c.errorTransferDegradation()}),c.mediaPlayer.on("error",function(a){c.debug(a);try{var b=[];b.push("code="+a.code),b.push("material_id="+c.materialId),b.push("video_time="+enforcePrecision(~~c.currentTime(),1)),sendPix2event("atende_error",b.join())}catch(d){return}c.dashManager.QS;switch(a.code){case 300:c.errorTransferDegradation();break;case 402:break;case 507:if(c.currentTime()>2)return;"undefined"!=typeof userLicenseError&&userLicenseError.errorMessage()}})};b(),a(),this.bitrateInfoUpdate.start(),this.isInitialized=!0,this.show()}this.isInitialized&&($(c.el()).find(".vjs-quality-button .vjs-menu-item").removeClass("vjs-selected"),$(c.el()).find('.vjs-quality-button .vjs-menu-item[data-bitrate="'+this.currentQuality+'"]').addClass("vjs-selected"),this.isAdaptive&&this.bitrateInfoUpdate.start(),this.selectQuality(this.currentQuality,!0)),this.startTime=c.mediaPlayer.getCurrentTime()},selectQuality:function(a,b){if(this.currentQuality==a&&b!==!0)return!1;var d=$.inArray(a,["high","medium","low"])!==-1?this.bitrates[a]:"auto";"auto"===d&&(c.debug("[QS] switchProfile","auto"),c.mediaPlayer.switchProfile("auto"),this.bitrateInfoUpdate.start()),"auto"!==d&&(this.bitrateInfoUpdate.stop(),this.bufferingTimer.stop(),c.dashManager.QS.resetMultipleSeeking(),c.debug("[DM][QS] bufferingTimer.stop()  // manual control"),$(c.el()).find('.vjs-quality-button .vjs-menu-item[data-res="auto"]').html("Auto"),c.qualityWarningButton.hide(),c.debug("[QS] switchProfile",d),setTimeout(function(){c.mediaPlayer.switchProfile(d)},500)),this.currentQuality=a,this.currentBitrate=d,this.isAdaptive=c.mediaPlayer.getOptions().autoAdaptation},show:function(){var a=c.dashManager;a.QS.isInitialized&&a.QS.isEnabled&&a.QS.bitrateInfoList.length>1&&(a.QS.qualityButton.show(),$(".vjs-quality-button .vjs-control-content").show())},hide:function(){c.dashManager.QS.qualityButton.hide()}}}},e=function(){var a=this;a.dashManager=new d(a)};c.plugin("dashManager",e)}(window,document,videojs),videojs.options.children.qualityWarningButton={},videojs.options.children.blackVideoCover={},videojs.ControlBar.prototype.options_={loadEvent:"play"},vjs.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.msMaxTouchPoints>0),videojs.Slider.prototype.update=function(){if(this.el_){var a,b=this.getPercent(),c=this.handle,d=this.bar;if(("number"!=typeof b||b!==b||b<0||b===1/0)&&(b=0),a=b,c){var e,f,g,h=this.el_;if(this.options().vertical){
var i=h.offsetHeight,j=c.el().offsetHeight;e=j?j/i:0,f=1-e,g=b*f,a=g+e/2,c.el().style.bottom=videojs.round(100*g,2)+"%"}else{var k=h.offsetWidth,l=c.el().offsetWidth;e=l?l/k:0,f=1-e,g=b*f,a=g+e/2,c.el().style.left=videojs.round(100*g,2)+"%"}this.options().vertical?d&&(d.el().style.height=videojs.round(100*a,2)+"%"):d&&(d.el().style.width=videojs.round(100*a,2)+"%")}}},videojs.Slider.prototype.calculateDistance=function(a){var b,c,d,e,f,g,h,i,j;if(b=this.el_,c=videojs.findPosition(b),f=g=b.offsetWidth,h=this.handle,this.options().vertical){if(e=c.top,g=b.offsetHeight,j=a.changedTouches?a.changedTouches[0].pageY:a.pageY,h){var k=h.el().offsetHeight;e+=k/2,g-=k}return Math.max(0,Math.min(1,(e-j+g)/g))}if(d=c.left,i=a.changedTouches?a.changedTouches[0].pageX:a.pageX,h){var l=h.el().offsetWidth;d+=l/2,f-=l}return Math.max(0,Math.min(1,(i-d)/f))},videojs.SeekBar.prototype.onMouseDown=function(a){"undefined"!=typeof window.uBrowser&&"MSIE"==window.uBrowser&&"10"==window.uVersion&&a.target.className.indexOf("vjs-progress-holder")!==-1||this.player().scrubbing||this.player().seekLocked||(this.player().turnTransition(!1),this.player().setPreviousAction("seek-started"),this.player().allowSeekEvent=!0,this.player().scrubbing=!0,this.videoWasPlaying=this.player().videoWasPlaying=!this.player().paused(),this.player().pause(),videojs.Slider.prototype.onMouseDown.call(this,a))},videojs.SeekBar.prototype.onMouseMove=function(a){if(!this.player().seekLocked){var b=this.calculateDistance(a)*this.player().duration();b>=this.player().duration()&&(b=this.player().duration()-.1),this.player().currentTime(b)}},videojs.SeekBar.prototype.onMouseUp=function(a){this.player().scrubbing&&(this.player().seekLocked||(this.player().turnTransition(!0),this.player().allowSeekEvent=!!this.player().getPreviousAction("seek-started"),videojs.Slider.prototype.onMouseUp.call(this,a),this.player().scrubbing=!1,this.player().setPreviousAction("seek-ended"),this.videoWasPlaying&&this.player().play()))},videojs.MediaTechController.prototype.onClick=function(a){if(0===a.button)return!(this.player().options().isLive&&!this.player().advertInProgress)&&void(this.player().controls()&&(this.player().paused()&&!this.player().seekLocked?(this.player().play(),this.player().options().enabledRestboard||this.player().bigPlayButton.addClass("vjs-hidden").hide()):(this.player().pause(),this.player().options().enabledRestboard||this.player().bigPlayButton.removeClass("vjs-hidden").show())))},videojs.getElementAttributes=function(a){var b,c,d,e,f;if(b={},c=",autoplay,controls,loop,muted,default,",a&&a.attributes&&a.attributes.length>0){d=a.attributes;for(var g=d.length-1;g>=0;g--)e=d[g].name,f=d[g].value,"boolean"!=typeof a[e]&&c.indexOf(","+e+",")===-1||(f=null!==f),b[e]=f}return b},videojs.StopButton=videojs.Button.extend({init:function(a,b){videojs.Button.call(this,a,b),this.requestStopButton=!1,this.hide()}}),videojs.StopButton.prototype.buildCSSClass=function(){return"vjs-stop-control "+videojs.Button.prototype.buildCSSClass.call(this)},videojs.StopButton.prototype.buttonText="Stop",videojs.StopButton.prototype.onClick=function(){this.player().trigger("stopped")},videojs.VrButton=videojs.Button.extend({init:function(a,b){videojs.Button.call(this,a,b),this.hide()}}),videojs.VrButton.prototype.buildCSSClass=function(){return"vjs-vr-control "+videojs.Button.prototype.buildCSSClass.call(this)},videojs.VrButton.prototype.buttonText="VR",videojs.VrButton.prototype.onClick=function(){this.player().trigger("toggleVR")},videojs.VrButton.prototype.show=function(){this.removeClass("vjs-hidden")},videojs.VrButton.prototype.hide=function(){this.addClass("vjs-hidden")},videojs.GyroButton=videojs.Button.extend({init:function(a,b){videojs.Button.call(this,a,b),this.hide()}}),videojs.GyroButton.prototype.buildCSSClass=function(){return"vjs-gyro-control "+videojs.Button.prototype.buildCSSClass.call(this)},videojs.GyroButton.prototype.buttonText="Gyro",videojs.GyroButton.prototype.onClick=function(){this.player().trigger("toggleGyro")},videojs.GyroButton.prototype.show=function(){this.removeClass("vjs-hidden")},videojs.GyroButton.prototype.hide=function(){this.addClass("vjs-hidden")},videojs.VolumeWrapper=videojs.Component.extend({init:function(a,b){videojs.Component.call(this,a,b)}}),videojs.VolumeWrapper.prototype.createEl=function(a,b){return b=b||{},b.className="vjs-volume-wrapper vjs-control",vjs.Component.prototype.createEl.call(this,a,b)},videojs.RightControlsWrapper=videojs.Component.extend({init:function(a,b){videojs.Component.call(this,a,b)}}),videojs.RightControlsWrapper.prototype.createEl=function(a,b){return b=b||{},b.className="vjs-right-controls-wrapper",vjs.Component.prototype.createEl.call(this,a,b)},videojs.TimeControlsWrapper=videojs.Component.extend({init:function(a,b){videojs.Component.call(this,a,b)}}),videojs.TimeControlsWrapper.prototype.createEl=function(a,b){return b=b||{},b.className="vjs-time-controls-wrapper",vjs.Component.prototype.createEl.call(this,a,b)},videojs.MovieInfo=videojs.Component.extend({init:function(a,b){a.options().activeMovie?this.movie=a.options().activeMovie:a.options().movieInfo&&(this.movie=JSON.parse(a.options().movieInfo)),this.info="",this.title="",this.episodeName="",this.seasonInfo="","undefined"!=typeof this.movie&&(this.episode="undefined"!=typeof this.movie.episode&&"0"!==this.movie.episode?"Odcinek "+this.movie.episode:"",this.season="undefined"!=typeof this.movie.season&&0!==this.movie.season?", Sezon "+this.movie.season:"","undefined"!=typeof this.movie.episode_name&&this.movie.episode_name.length>1&&(this.episodeName='<span class="vjs-movie-info-subtitle">'+this.movie.episode_name+"</span>"),"undefined"!=typeof this.movie.title&&this.movie.title.length>1&&(this.title='<div class="vjs-movie-info-title">'+this.movie.title+this.episodeName+"</div>"),(this.episode.length>1||this.season.length>1)&&(this.seasonInfo='<div class="vjs-movie-info-season">'+this.episode+this.season+"</div>"),this.info=this.title+this.seasonInfo),videojs.Component.call(this,a,b)}}),videojs.MovieInfo.prototype.createEl=function(a,b){return b=b||{},b.className="vjs-movie-info vjs-control",b.innerHTML=this.info,vjs.Component.prototype.createEl.call(this,a,b)},videojs.Component.prototype.getNestedChild=function(a){if("undefined"!=typeof this.childNameIndex_[a])return this.childNameIndex_[a];if(this.children_.length)for(var b in this.children_){var c=this.children_[b].getNestedChild(a);if(c)return c}},videojs.CogButton=videojs.Button.extend({init:function(a,b){videojs.Button.call(this,a,b)}}),videojs.CogButton.prototype.createEl=function(a,b){return b=b||{},b.className="vjs-cog-button vjs-control",vjs.Button.prototype.createEl.call(this,a,b)},videojs.CogButton.prototype.onClick=function(){this.player().settingsController.toggleVisibility()},videojs.PlayNextButton=videojs.Button.extend({init:function(a,b){videojs.Button.call(this,a,b),this.requestPlayNextButton=!1,this.hide()}}),videojs.PlayPrevButton=videojs.Button.extend({init:function(a,b){videojs.Button.call(this,a,b),this.requestPlayPrevButton=!1,this.hide()}}),videojs.PlayNextButton.prototype.createEl=function(){var a;return"undefined"!=typeof this.player().options().nextMovie&&(a=this.player().options().nextMovie.detail_path+"#play"),vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-play-next-control vjs-control",innerHTML:'<a href="'+a+'" class="vjs-play-next-href"></a></div>'})},videojs.PlayNextButton.prototype.buttonText="PlayNext",videojs.PlayNextButton.prototype.onClick=function(a){if(this.player().options().nextMovie){if(this.player().playlistManager.breakInProgress)return a.preventDefault(),a.stopPropagation(),this.player().sendBreakStats("complete"),this.player().playlistManager.playNextVideo(!1),void this.player().one("canplay",function(){this.player().sendBreakStats("playing")});this.player().resetPlayerAds(),$(this.player().node).trigger("video.playlistClipEnd")}},videojs.PlayPrevButton.prototype.createEl=function(){var a;return"undefined"!=typeof this.player().options().prevMovie&&(a=this.player().options().prevMovie.detail_path+"#play"),vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-play-prev-control vjs-control",innerHTML:'<a href="'+a+'" class="vjs-play-prev-href"></a></div>'})},videojs.PlayPrevButton.prototype.buttonText="PlayPrev",videojs.PlayPrevButton.prototype.onClick=function(){this.player().options().prevMovie&&(this.player().resetPlayerAds(),$(this.player().node).trigger("video.playlistClipEnd"))},videojs.QualityMenuItem=videojs.MenuItem.extend({init:function(a,b){b.label=b.source["data-res"],videojs.MenuItem.call(this,a,b),this.el_.setAttribute("class","vjs-menu-item "+b.className),this.el_.setAttribute("data-res",b.source["data-res"].toLowerCase()),this.el_.setAttribute("data-bitrate",b.source["data-bitrate"]),this.source=b.source,this.resolution=b.source["data-res"]}}),videojs.QualityMenuItem.prototype.onClick=function(){videojs.MenuItem.prototype.onClick.call(this),$(this.player().el()).find(".vjs-quality-button .vjs-menu-item").removeClass("vjs-selected"),this.selected(!0),this.player().dashManager.QS.selectQuality(this.source["data-bitrate"])},videojs.QualityButton=videojs.MenuButton.extend({init:function(a,b){videojs.MenuButton.call(this,a,b),this.hide()}}),videojs.QualityButton.prototype.buttonText="Quality Button",videojs.QualityButton.prototype.className="vjs-quality-button",videojs.QualityButton.prototype.createMenu=function(){var a=new videojs.Menu(this.player_,{}),b=this.createItems();this.items=b;for(var c=0;c<b.length;c++)a.addChild(b[c]);return a},videojs.QualityButton.prototype.createItems=function(){var a=[{"data-res":"Wysoka","data-bitrate":"high",controls:!1,src:""},{"data-res":"Średnia","data-bitrate":"medium",controls:!1,src:""},{"data-res":"Niska","data-bitrate":"low",controls:!1,src:""}];if(a.length<=1)return[];if(a.length>1){var b={"data-res":"Auto",controls:!0,src:"auto","data-bitrate":"auto"};a.push(b)}var c=[];if("undefined"!=typeof a)for(var d=0;d<a.length;d++)c.push(new videojs.QualityMenuItem(this.player_,{source:a[d]}));return c},videojs.QualityButton.prototype.show=function(){this.addClass("vjs-visible").removeClass("vjs-hidden");var a=$(this.el()).find(".vjs-selected");a.length&&"Niska"==a.attr("data-res")&&this.player().getChild("qualityWarningButton").show(),$(this).find(".vjs-control-content").show()},videojs.QualityButton.prototype.hide=function(){this.removeClass("vjs-visible").addClass("vjs-hidden")},videojs.QualityWarningButton=videojs.Button.extend(),videojs.QualityWarningButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-quality-warning-info vjs-hidden",innerHTML:"<span>Warning: low quality</span>","aria-label":"Low Quality"})},videojs.QualityWarningButton.prototype.show=function(){this.removeClass("vjs-hidden"),this.addClass("vjs-visible")},videojs.QualityWarningButton.prototype.hide=function(){this.removeClass("vjs-visible"),this.addClass("vjs-hidden")},videojs.BlackVideoCover=videojs.Component.extend({init:function(a,b){videojs.Component.call(this,a,b)}}),videojs.BlackVideoCover.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-black-video-cover"})},videojs.MultiaudioMenuItem=videojs.MenuItem.extend({init:function(a,b){b.label=b.source["data-label"],videojs.MenuItem.call(this,a,b),this.el_.setAttribute("class","vjs-menu-item vjs-hidden"),this.el_.setAttribute("data-track",b.source["data-track"]),this.source=b.source}}),videojs.MultiAudioButton=videojs.MenuButton.extend({init:function(a,b){videojs.MenuButton.call(this,a,b),this.hide()}}),videojs.MultiAudioButton.prototype.buttonText="Multiaudio Button",videojs.MultiAudioButton.prototype.className="vjs-multiaudio-button",videojs.MultiAudioButton.prototype.createItems=function(){for(var a=[],b=10,c=1;c<=b;c++)a.push(new videojs.MultiaudioMenuItem(this.player_,{source:{"data-track":c,"data-label":"",controls:!1,src:""}}));return a},videojs.MultiAudioButton.prototype.createMenu=function(){var a=new videojs.Menu(this.player_,{}),b=this.createItems();this.items=b;for(var c=0;c<b.length;c++)a.addChild(b[c]);return a},videojs.MultiAudioButton.prototype.show=function(){this.removeClass("vjs-hidden")},videojs.MultiAudioButton.prototype.hide=function(){this.addClass("vjs-hidden")},videojs.ShareButton=videojs.MenuButton.extend({init:function(a,b){videojs.MenuButton.call(this,a,b),this.requestShareButton=!1,this.hide(),this.video_wrapper=$(a.el()),this.shareboardHandler=this.video_wrapper.find(".vjs-shareboard-container")}}),videojs.ShareButton.prototype.buttonText="Share Menu",videojs.ShareButton.prototype.className="vjs-share-button-control",videojs.ShareButton.prototype.close=function(){this.shareboardHandler.find(".vjs-shareboard-page.vjs-visible").removeClass("vjs-visible").addClass("vjs-hidden"),this.shareboardHandler.find(".vjs-shareboard-page-all").removeClass("vjs-hidden").addClass("vjs-visible"),this.shareboardHandler.find(".vjs-shareboard-back").removeClass("vjs-visible").addClass("vjs-hidden"),this.shareboardHandler.removeClass("vjs-visible").addClass("vjs-hidden"),this.video_wrapper.removeClass("vjs-shareboard-opened")},videojs.ShareButton.prototype.createMenu=function(){var a=new videojs.Menu(this.player_,{}),b=document.createElement("div"),c=this;return c.player().pausedBeforeShareboard=!1,b.className="vjs-shareboard-container",b.innerHTML='<div class="vjs-shareboard-controls"></div><div class="vjs-shareboard-content-wrapper"><div class="vjs-shareboard-content"><h2>Kopiuj link</h2><div class="vjs-shareboard-page vjs-shareboard-page-link"><textarea class="vjs-share-link-textarea">'+this.player().options().shareUrl+'</textarea><div class="vjs-share-link-ready">Skopiuj powyższy link: <button class="vjs-share-link-button">Gotowe</button></div></div></div></div>',this.player().el().appendChild(b),$(this.player().el()).find(".vjs-shareboard-content-wrapper").on("click",function(){c.close(),c.player().pausedBeforeShareboard||c.player().play()}),$(this.player().el()).find(".vjs-share-link-textarea").click(function(a){a.stopPropagation()}),a.addChild(new videojs.ShareButtonMenuItem(this.player(),{label:"Facebook",className:"vjs-share-facebook"})),a.addChild(new videojs.ShareButtonMenuItem(this.player(),{label:"Twitter",className:"vjs-share-twitter"})),a.addChild(new videojs.ShareButtonMenuItem(this.player(),{label:"Google +",className:"vjs-share-google"})),a.addChild(new videojs.ShareButtonMenuItem(this.player(),{label:"Kopiuj link",className:"vjs-share-link"})),a},videojs.ShareButtonMenuItem=videojs.MenuItem.extend({contentElType:"button",init:function(a,b){videojs.MenuItem.call(this,a,b),this.el_.setAttribute("class","vjs-menu-item "+b.className),this.video_wrapper=$(a.el()),this.shareUrl=a.options().shareUrl,this.shareboardHandler=this.video_wrapper.find(".vjs-shareboard-container")}}),videojs.ShareButtonMenuItem.prototype.onClick=function(){var a=this,b=this.shareUrl;a.player().pausedBeforeShareboard=a.player().paused(),this.player().paused()||this.player().pause(),this.hasClass("vjs-share-link")?this.shareLink():this.hasClass("vjs-share-facebook")?TvnPlayerSocialMedia.generatePopup("facebook",b):this.hasClass("vjs-share-twitter")?TvnPlayerSocialMedia.generatePopup("twitter",b,a.player().options().shareTitle):this.hasClass("vjs-share-google")&&TvnPlayerSocialMedia.generatePopup("gplus",b)},videojs.ShareButtonMenuItem.prototype.shareLink=function(){this.player().restboardHandler&&this.video_wrapper.find(".vjs-restboard-container").hide(),this.shareboardHandler.removeClass("vjs-hidden").addClass("vjs-visible"),this.video_wrapper.addClass("vjs-shareboard-opened"),this.shareboardHandler.find(".vjs-shareboard-page-all").removeClass("vjs-visible").addClass("vjs-hidden"),this.shareboardHandler.find(".vjs-shareboard-page-link").removeClass("vjs-hidden").addClass("vjs-visible"),this.shareboardHandler.find(".vjs-shareboard-back").removeClass("vjs-hidden").addClass("vjs-visible"),this.shareboardHandler.find(".vjs-share-link-textarea").on("mouseenter",function(){$(this).select()})},videojs.PosterImage.prototype.hide=function(){this.addClass("vjs-poster-hidden")},videojs.PosterImage.prototype.show=function(){this.removeClass("vjs-poster-hidden")},videojs.BigPlayButton.prototype.show=function(){this.addClass("vjs-visible")},videojs.BigPlayButton.prototype.hide=function(){this.removeClass("vjs-visible")},videojs.BigPlayButton.prototype.onClick=function(a){this.player().initializeImaAdContainer&&this.player().isUserGestureNeededToCallAdvert()&&this.player().updateImaGoogleLibLoaded()&&!this.player().imaContainerInitialized&&this.player().initializeImaAdContainer(),this.player_.play(),this.hide(),this.addClass("vjs-hidden"),"undefined"!=typeof a&&a!==!0&&this.player().el().focus()},videojs.FullscreenToggle.prototype.onClick=function(){function a(){c=!e.paused(),e.blockIpadFullscreenEvent=!0,$("body").prepend(e.node[0]),c&&e.play();var a=$(f.player().el()).width(),b=$(f.player().el()).height();d.length&&(a=d.width(),b=d.height());var g=1*a/e.detectAspectRatio();g>b&&(g=b);var h=(b-g)/2,i=$(f.player().el()).find(".vjs-tech");i[0].style.setProperty("margin-top","-"+g/2+"px"),i[0].style.setProperty("top","50%"),i[0].style.setProperty("height",g+"px","important"),$(window).on("resize.vjsfullscreen",function(){if(d.length?(a=d.width(),b=d.height()):(a=$(f.player().el()).width(),b=$(f.player().el()).height(),a<$(window).width()&&(a=$(window).width(),b=$(window).height())),g=1*a/e.detectAspectRatio(),g>b&&(g=b),h=(b-g)/2,i[0].style.setProperty("margin-top","-"+g/2+"px"),i[0].style.setProperty("top","50%"),i[0].style.setProperty("height",g+"px","important"),videojs.IS_IPAD||"tablet"===uDevice.toLowerCase()){var c=$(e.el());d.width()>d.height()&&"1"!==c.find(".vjs-control-bar").css("opacity")&&c.find(".vjs-overlay-y-bottom").css("bottom","0px")}})}function b(){c=!e.paused(),e.blockIpadFullscreenEvent=!0,$(f.player().el()).find(".vjs-tech").attr("style",""),$(window).off("resize.vjsfullscreen"),$(e.videoParentElement).prepend(e.node[0]),c&&e.play()}var c,d=$("#vjs-cfullscreen-test"),e=this.player(),f=this,g=!!$(e.node).data("force-normal-fullscreen");"desktop"===uDevice.toLowerCase()&&detectIE()&&detectIE()<11&&!g?($("html").toggleClass("vjs-video-on-fullscreen"),$(this.player().el()).toggleClass("vjs-ie-fullscreen vjs-fullscreen"),$(this.player().el()).parent().toggleClass("vjs-fullscreen-parent"),this.player().isFullscreen_=!this.player().isFullscreen_,e.videoParentElement=e.videoParentElement||e.node[0].parentElement,this.player().isFullscreen()&&a(),this.player().isFullscreen()||b(),this.player().trigger("fakefullscreenchange")):videojs.IS_IPAD&&!g?($("html").toggleClass("vjs-video-on-fullscreen"),$(this.player().el()).toggleClass("vjs-ipad-fullscreen vjs-fullscreen"),$(this.player().el()).parent().toggleClass("vjs-fullscreen-parent"),this.player().isFullscreen_=!this.player().isFullscreen_,e.videoParentElement=e.videoParentElement||e.node[0].parentElement,this.player().isFullscreen()&&a(),this.player().isFullscreen()||b(),this.player().trigger("fakefullscreenchange")):"tablet"!==uDevice.toLowerCase()||g?this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText_.innerHTML=this.localize("Fullscreen")):(this.player_.requestFullscreen(),this.controlText_.innerHTML=this.localize("Non-Fullscreen")):($("html").toggleClass("vjs-video-on-fullscreen"),$(this.player().el()).toggleClass("vjs-tablet-fullscreen vjs-fullscreen"),$(this.player().el()).parent().toggleClass("vjs-fullscreen-parent"),this.player().isFullscreen_=!this.player().isFullscreen_,e.videoParentElement=e.videoParentElement||e.node[0].parentElement,this.player().isFullscreen()&&a(),this.player().isFullscreen()||b(),this.player().trigger("fakefullscreenchange")),this.player().el().focus()},videojs.Player.prototype.onWaiting=function(){this.player().isIma||this.player().addClass("vjs-waiting")},videojs.Player.prototype.onPlay=function(){if("undefined"!=typeof this.player().tapGoManager&&this.player().tapGoManager.counter().setVideoPlaying(!0),!this.player().vastInitialised){if(this.player().options().adBlock===!0)return void this.player().bigPlayButton.addClass("vjs-hidden").hide();$(this.player().el()).find("video").removeAttr("poster"),"function"==typeof this.player().initContinueWatching&&this.player().initContinueWatching()}this.removeClass("vjs-paused").removeClass("vjs-ended").addClass("vjs-playing"),this.player().isWebviewMode(),this.hasStarted(!0)},videojs.Player.prototype.onPause=function(){"undefined"!=typeof this.player().tapGoManager&&this.player().tapGoManager.counter().setVideoPlaying(!1),this.removeClass("vjs-playing").addClass("vjs-paused")},vjs.Player.prototype.currentTime=function(a){if(void 0!==a)return this.techCall("setCurrentTime",a),this;try{if(this.player().isIma&&"undefined"!=typeof this.player().ima&&"function"==typeof this.player().ima.currentTime)return this.player().ima.currentTime()}catch(b){}return this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(a){if(void 0!==a)return this.cache_.duration=parseFloat(a),this;void 0===this.cache_.duration&&this.onDurationChange();try{if(this.player().isIma&&"undefined"!=typeof this.player().ima&&"function"==typeof this.player().ima.duration)return this.player().ima.duration()}catch(b){}return this.cache_.duration||0};var mouseDown=!1;$(document).mousedown(function(){mouseDown=!0}),$(document).mouseup(function(){mouseDown=!1}),videojs.ControlBar.prototype.animateMute=function(a,b,c){var d=100,e=5,f=0,g=this.player().volume();detectIE()&&(d=10);var h=g/d,i=this.player();a?i.fadeStepVolume=h:("function"==typeof b&&b(),h=i.fadeStepVolume);var j=function(){f++;var k=a?g-f*h:f*h;i.volume(k),f<d?setTimeout(j,e):(a&&"function"==typeof b&&b(),"function"==typeof c&&c())};j()},videojs.PlayToggle.prototype.onClick=function(){if(this.player().options().isLive&&!this.player().advertInProgress)return!1;var a=this.player().controlBar.getNestedChild("shareButton");"undefined"!=typeof this.player().tapGoManager&&(this.player().paused()?this.player().tapGoManager.counter().setPause(!1):this.player().tapGoManager.counter().setPause(!0)),this.player().fakePlayToggle?this.player().hasClass("vjs-playing")?(this.player().removeClass("vjs-playing"),this.player().trigger("fakePaused")):(a&&a.close(),this.player().addClass("vjs-playing"),this.player().trigger("fakePlaying")):this.player().paused()?(a&&a.close(),this.player().play()):this.player().pause()},videojs.VolumeMenuButton.prototype.createMenu=function(){var a=new videojs.Menu(this.player_,{contentElType:"div"}),b=new videojs.VolumeBar(this.player_,this.options_.volumeBar);b.on("focus",function(){a.lockShowing()}),b.on("blur",function(){a.unlockShowing()}),a.addChild(b);var c=this;return $(a.contentEl()).on("click",function(b){var d="undefined"!=typeof b.offsetY?b.offsetY:b.pageY-$(a.contentEl()).offset().top;d<=20&&(c.player_.muted()||1!==c.player_.volume())&&(c.player_.muted(!1),c.player_.volume(1)),d>=$(this).height()-20&&!c.player_.muted()&&c.player_.muted(!0)}),a},videojs.LoadingSpinner.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",innerHTML:'<div class="vjs-spinner-dot1"></div><div class="vjs-spinner-dot2"></div><div class="vjs-spinner-dot3"></div>'})},videojs.OffTextTrackMenuItem=videojs.TextTrackMenuItem.extend({init:function(a,b){b.track={kind:b.kind,player:a,label:"napisy wył.","default":!1,mode:"disabled"},vjs.TextTrackMenuItem.call(this,a,b),this.selected(!0)}}),videojs.Player.prototype.requestFullscreen=function(){if(!this.isWebviewMode()||!this.isAdvertiseMode()){var a=videojs.browser.fullscreenAPI;return this.isFullscreen(!0),a?(videojs.on(document,a.fullscreenchange,videojs.bind(this,function(b){this.isFullscreen(document[a.fullscreenElement]),this.isFullscreen()===!1&&videojs.off(document,a.fullscreenchange,arguments.callee),this.trigger("fullscreenchange2")})),this.el_[a.requestFullscreen]()):this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange2")),this}},videojs.Html5.prototype.featuresTimeupdateEvents=!0,videojs.MediaTechController.prototype.manualTimeUpdatesOn=function(){var a=this.player_;this.manualTimeUpdates=!0,this.on(a,"play",this.trackCurrentTime),this.on(a,"pause",this.stopTrackingCurrentTime),this.one("timeupdate",function(){this.featuresTimeupdateEvents=!0,this.manualTimeUpdatesOff()})},videojs.Html5.prototype.play=function(){var a=this.el_.play();void 0!==a&&"function"==typeof a.then&&a.then(null,function(a){})},videojs.Html5.prototype.eventHandler=function(a){if("error"==a.type&&this.error()){var b=window.location.href;if(b.indexOf("#")!==-1&&(b=b.split("#")[0]),this.player().src()==b)return;this.player().error(this.error().code)}else a.bubbles=!1,this.player().trigger(a)};var templateCache={},adsTemplates={interactive2_temp:function(a){},interactive2_action:function(a){var b,c,d=a.btnItem,e=a.defaultColor,f=a.defaultOpacity,g=parseInt(a.iconDistance,10),h=0!==parseInt(a.btnWidth,10)?a.btnWidth:60,i=0!==parseInt(a.btnHeight,10)?a.btnHeight:60,j=a.offset,k=a.pulsation,l=d.currentNode,m=(a.videoWrapperHeight,a.videoControlBarHeight,j),n="",o=6,p=1,q="undefined"!=typeof d.attribs["background-color"]?hexToRGBA(d.attribs["background-color"]):hexToRGB_MA(e,f),r="undefined"!=typeof d.attribs["background-color"]?hexToRGBA(d.attribs["background-color"]):hexToRGB_MA(e,PLAYER_DEFAULT_OPACITY),s=hexToRGBA("undefined"!=typeof d.attribs["icon-background-color"]?d.attribs["icon-background-color"]:d.attribs["background-color"]),t="undefined"!=typeof d.attribs["icon-active-color"]?hexToRGBA(d.attribs["icon-active-color"]):s,u=isDefined(d.attribs["time-start"])?d.attribs["time-start"]:0,v="object"!=typeof d.slide.attribs?"vjs-empty":"",w=rgbaToRgb(s),x=isDefined(d.slide.attribs)&&isDefined(d.slide.attribs.width)?parseInt(d.slide.attribs.width,10):0,y=isDefined(d.slide.attribs)&&isDefined(d.slide.attribs.height)?parseInt(d.slide.attribs.height,10):0,z=isDefined(d.attribs.offset)?parseInt(d.attribs.offset,10):0,A=isDefined(d.slide.attribs)&&isDefined(d.slide.attribs["close-color"])?d.slide.attribs["close-color"]:"";0===l&&(g=0),b=0===parseInt(z,10)?j+l*g+l*(parseInt(i,10)+2*o+2*p):z,m=0,c=b+(parseInt(i,10)+2*o+2*p),0===y&&(y=410),0!==y&&c>y&&(m=c-y,n="vjs-no-border-bottom-right");var B='style="top:'+b+'px; position: absolute;"',C="";return 0!==parseInt(i,10)&&0!==parseInt(h,10)&&(C=' style="width: '+h+"px; height: "+i+'px" '),b<0&&Math.abs(b)-parseInt(i,10)>5&&(m-=Math.abs(b)-parseInt(i,10)-5),m+y-c<5&&(n="vjs-no-border-bottom-right"),v?"<div "+B+' class="vjs-action '+v+k+'" data-board-class="'+n+'" data-board-width="'+x+'" data-board-height="'+y+'" data-falldown-color="'+A+'" data-stat='+JSON.stringify(d.statUrl).replace(/<br>/g,"\n")+' data-time-start="'+u+'"  data-default-color="'+q+'" data-border-color="'+w+'" data-icon-background-color="'+s+'" data-icon-active-color="'+t+'" data-default-full-color="'+r+'" data-item="'+d.currentNode+'" data-offset-top="'+m+'"><div class="vjs-wrap"><a href="'+d.url+'" target="_blank"><span class="vjs-int-text-wrapper"><span class="vjs-int-text">'+d.title+"</span></span><img "+C+' src="'+d.icon+'" /></a></div></div>':"<div "+B+' class="vjs-action '+v+k+'" data-board-class="'+n+'" data-board-width="'+x+'" data-board-height="'+y+'" data-falldown-color="'+A+'" data-stat-2='+JSON.stringify(d.statUrl2).replace(/<br>/g,"\n")+' data-time-start="'+u+'"  data-default-color="'+q+'" data-border-color="'+w+'" data-icon-background-color="'+s+'" data-icon-active-color="'+t+'" data-default-full-color="'+r+'" data-item="'+d.currentNode+'" data-offset-top="'+m+'"><div class="vjs-wrap" '+C+'><img src="'+d.icon+'" /></div></div>'},interactive2_gallery:function(a){var b=a.slide.images,c="",d=' style="left: 0"';if(b.length)for(var e=0;e<b.length;e++)0!==e&&(d=' style="left: '+e+'00%"'),c+='<div class="vjs-ads-gallery-item"'+d+'><div class="vjs-ads-gallery-img-wrapper"><img src="'+b[e]+'"/></div></div>';var f='<div class="vjs-ads-gallery-button-content"> '+render("build_img",a.slide.ActionButton)+"</div>";return'<div class="vjs-itemWrap vjs-ads-gallery vjs-itemWrap_'+a.currentNode+'"><div class="vjs-ads-gallery-wrapper"><div class="vjs-ads-gallery-content">'+c+"</div></div>"+f+"</div>"},interactive2_elements:function(a){var b="";if("undefined"!=typeof a.slide.elements)for(var c=0;c<a.slide.elements.length;c++){var d=a.slide.elements[c];b+='<div class="vjs-element" data-base-left="'+d.attribs.x+'" data-base-top="'+d.attribs.y+'" style="left:'+d.attribs.x+"px;top:"+d.attribs.y+'px;">'+render("build_img",d)+"</div>"}return b},interactive2_billboard:function(a){return'<div class="vjs-itemWrap vjs-billboard vjs-itemWrap_'+a.currentNode+'">'+render("build_img",a.slide)+render("interactive2_elements",a)+"</div>"},interactive2_sonda:function(a){var b=a.rescaleInfo;return b||(b={},b.ratio=1,b.baseWidth=960),a.slide.VoteButton.linkClassName="vjs-voteBtn vjs-cursor-pointer",'<div class="vjs-itemWrap vjs-sonda vjs-itemWrap_'+a.currentNode+'" data-color1="'+a.slide.color1+'" data-color2="'+a.slide.color2+'" data-color3="'+a.slide.color3+'"  data-quiz="'+a.slide.quiz_id+'"><div class="vjs-leftSide" ><div class="vjs-half vjs-left vjs-voting"><div class="vjs-empty-form-wrapper vjs-int2-popup-wrapper"><div class="vjs-popup-form-info">Zaznacz właściwą odpowiedź!</div><div class="vjs-popup-form-close">zamknij</div></div><div class="vjs-thank-form-wrapper vjs-int2-popup-wrapper"><div class="vjs-popup-form-info">Twój głos został zarejestrowany. Dziękujemy.</div><div class="vjs-popup-form-close">zamknij</div></div></div><div class="vjs-half vjs-left vjs-button">'+render("build_img",a.slide.VoteButton)+'</div></div><div class="vjs-rightSide"><div class="vjs-half vjs-right vjs-results"></div><div class="vjs-half vjs-right vjs-info-wrapper"><div class="vjs-info"><p>'+a.slide.Desc+'</p></div></div><div class="vjs-half vjs-right vjs-logo">'+render("build_img",a.slide.Logo)+'</div><div class="vjs-half vjs-right vjs-button">'+render("build_img",a.slide.ActionButton)+'</div></div><div class="vjs-clearfix"></div></div>'},interactive2_map:function(a){return a.slide.Logo.imgStyle="width:auto; height: 100%;",'<div class="vjs-itemWrap vjs-itemWrap_'+a.currentNode+'"><div class="vjs-ads-map-content vjs-ads-radius-content"><iframe width="100%" height="100%" frameborder="0" src="http://www.bing.com/maps/embed/viewer.aspx?v=3&cp='+a.slide.Longitude.replace(",",".")+"~"+a.slide.Latitude.replace(",",".")+"&lvl=15&w=100%&h=100%&sty=r&typ=d&pp="+a.slide.BingTitle+"~"+a.slide.BingDesc+"~"+a.slide.Longitude.replace(",",".")+"~"+a.slide.Latitude.replace(",",".")+'&ps=&dir=0&mkt=pl-pl&src=O365&form=BMEMJS"></iframe></div><div class="vjs-ads-map-desc-content-wrapper vjs-ads-radius-content vjs-right"><div class="vjs-ads-map-desc-content">'+a.slide.Desc+'</div></div><div class="vjs-ads-radius-content vjs-ads-map-logo-content vjs-right"> '+render("build_img",a.slide.Logo)+'</div><div class="vjs-ads-map-button-content vjs-right"> '+render("build_img",a.slide.ActionButton)+"</div>"+render("interactive2_elements",a)+"</div>"},interactive2_sonda_question:function(a){var b=a.response.questions[0],c=a.rescaleInfo;c||(c={},c.ratio=1,c.baseWidth=960),960!==c.baseWidth&&(c.ratio=(c.baseWidth/960).toFixed(2));var d='<p class="vjs-question">'+b.question+'</p><ul class="vjs-interactive2-quiz" data-qqe-id="'+b.id+'" data-answer="">';for(var e in b.value){var f="color"+(parseInt(e,10)+1);d+='<li data-base-line-height="63" style="color:'+a.colors[f]+"; line-height: "+~~(63*c.ratio)+'px;"><div class="vjs-radio-0-2" data-base-size="63" data-value="'+b.value[e].id+'" style="width: '+~~(63*c.ratio)+"px; height:"+~~(63*c.ratio)+"px; background-size: "+100*c.ratio+"% "+100*c.ratio+'%;"></div>'+b.value[e].answer+"</li>"}return d+="</ul>"},
interactive2_sonda_results:function(a){var b=a.rescaleInfo;b||(b={},b.ratio=1,b.baseWidth=960),960!==b.baseWidth&&(b.ratio=(b.baseWidth/960).toFixed(2));var c,d,e,f="",g=100,h=0;for(c in a.results)g-=parseInt(a.results[c],10),a.results[c]>h&&(h=c);for(c in a.results)d="color"+(parseInt(c,10)+1),e=c===h?g:0,f+=0===a.results[c]?'<p class="vjs-resultMeter" style="font-size: '+18*b.ratio+'px">0%</p><div class="vjs-quiz-bar" data-base-height="10" style="height: '+10*b.ratio+'px" color="#ff0000"><div class="vjs-level" style="width: 2%;background:'+a.colors[d]+';"></div></div>':'<p class="vjs-resultMeter" style="font-size: '+18*b.ratio+'px">'+(parseInt(a.results[c],10)+parseInt(e,10))+'%</p><div class="vjs-quiz-bar" data-base-height="10" style="height: '+10*b.ratio+'px" color="#ff0000"><div class="vjs-level" style="width: '+a.results[c]+"%;background: "+a.colors[d]+';"></div></div>';return f},interactive2_welcome:function(a){return'<div class="vjs-itemWrap vjs-welcome vjs-itemWrap_'+a.currentNode+'"><div class="vjs-half vjs-left">'+render("build_img",a.slide.Packshot)+'</div><div class="vjs-half vjs-right vjs-logo">'+render("build_img",a.slide.Logo)+'</div><div class="vjs-half vjs-right vjs-info"><p>'+a.slide.Desc+'</p></div><div class="vjs-half vjs-right vjs-button">'+render("build_img",a.slide.ActionButton)+'</div><div class="vjs-clearfix"></div></div>'},interactive2_survey:function(a){return a.slide.ActionButton.linkClassName="voteBtnSurvey vjs-cursor-pointer",'<div class="vjs-itemWrap vjs-survey vjs-itemWrap_'+a.currentNode+"\" data-raw='"+JSON.stringify(a)+"' data-survey=\""+a.slide.Survey_id+'" data-color1="'+a.slide.color1+'" data-color2="'+a.slide.color2+'" data-color3="'+a.slide.color3+'"><div class="vjs-half vjs-left">'+buildImgOrSWF(a.slide.Logo.image,"logo-int-ad")+'</div><div class="vjs-half vjs-right vjs-form"><p class="vjs-question">'+a.slide.Desc+'</p><div class="vjs-form-content"></div><div class="vjs-empty-form-wrapper vjs-int2-popup-wrapper"><div class="vjs-popup-form-info">Zaznacz wszystkie odpowiedzi!</div><div class="vjs-popup-form-close">zamknij</div></div><div class="vjs-thank-form-wrapper vjs-int2-popup-wrapper"><div class="vjs-popup-form-info">Dziękujęmy za wypełnienie formularza.</div><div class="vjs-popup-form-close">zamknij</div></div></div><div class="vjs-half vjs-right vjs-button">'+render("build_img",a.slide.ActionButton)+'</div><div class="vjs-clearfix"></div></div>'},interactive2_survey_question:function(a){var b=a.rescaleInfo;b||(b={},b.ratio=1,b.baseWidth=960);var c,d,e,f=b.baseWidth,g=f/960,h=16*g,i=g*b.ratio*100>100?100:g*b.ratio*100,j=a.response.questions,k='<form class="vjs-survey"><input type="hidden" name="user_form[_id]" value="'+a.response.id+'" /><ul>';for(c in j){e=j[c],k+='<li data-queId="'+e.que_id+'" style="height: '+100/j.length+'%"><p style="font-size:'+h*b.ratio+'px;" data-base-font-size="'+h+'">'+e.question+'</p><div class="vjs-select-wrapper"><select data-base-height="'+~~(25*g)+'" style="height:'+~~(25*g*b.ratio)+"px;font-size:"+~~(h*b.ratio)+'px;" name="user_form['+e.id+']"><option></option>';var l=0;for(d in e.value)l++,k+='<option value="'+l+'">'+e.value[d].answer+"</option>";k+='</select><div class="vjs-dropdown" style="background-size: '+i+"% "+i+'%"></div></div></li>'}return k+="</ul></form>"},playlist_show_similar:function(a){var b=a.playlist.similar_programs,c="";for(var d in b){var e=b[d];c+='<a href="'+e.url+'"><img src="'+e.main_photo.url+'" /></a>'}return'<div class="vjs-similar-info">Może zainteresuje Cię również</div><div class="vjs-show-similiar"><div class="vjs-wrap">'+c+"</div></div>"},playlist_show_siblings:function(a){var b=a.playlist,c=[];for(var d in b)"object"!=typeof b[d]||null===b[d]||$.isArray(b[d])||c.push(b[d]);var e,f,g,h,i="",j="",k=a.index,l=entitySpace.parentalRating;for(var m in c){var n=c[m],o=n.hasOwnProperty("splash_screen")&&n.splash_screen.hasOwnProperty("url")?n.splash_screen.url:"";e='<i class="vjs-icon-play vjs-blue"></i>',f="",g="",h="","object"==typeof n&&(""===j&&(j=n.title),1==n["protected"]&&(f=" vjs-yellow"),"18"==n.parental_rating&&(e+='<i class="vjs-icon-protected"></i>',h='<div class="vjs-onTopEntity vjs-icon-parental-rating" style="background-image: url('+PLAYER_DEFAULT_HOST+l.url+');"></div>'),"undefined"!=typeof n.percent&&k!==m&&(g='<div class="vjs-el-watched"><div class="vjs-el-progress" style="width: '+n.percent+'%;"></div><span class="vjs-el-watched-percent">Obejrzane '+n.percent+"%</span></div>"),"undefined"!=typeof n["new"]&&1===parseInt(n["new"],10)&&(g='<div class="vjs-el-watched vjs-new"><span class="vjs-el-watched-new">Nowy</span></div>'),i+='<li><a href="'+n.detail_path+'"'+("catchup"===n.type?' class="vjs-catchup"':"")+'><img src="'+o+'" />'+h+'<div class="vjs-el-description'+f+'">'+e+"<p>"+n.description+"</p></div></a><span>"+("undefined"!=typeof n.episode_name&&n.episode_name.length>0?n.episode_name+", ":"")+"Odcinek "+n.episode+(0!==parseInt(n.season,10)?", Sezon "+n.season:"")+("premiere"===n.type?"<i>Prapremiera</i>":"")+"</span>"+g+"</li>")}return'<div class="vjs-radial-progress-wrapper vjs-hidden"><span class="vjs-radial-progress-text">Już za</span><div class="vjs-radial-progress" data-tvn-timer="wrapper"><div class="vjs-progress-circle"><div class="vjs-progress-mask vjs-full"><div class="vjs-progress-fill"></div></div><div class="vjs-progress-mask vjs-half"><div class="vjs-progress-fill"></div><div class="vjs-progress-fill-fix"></div></div></div><div class="vjs-progress-inset"><div class="vjs-progress-percentage"><span class="vjs-progress-number" data-tvn-timer="counter" data-tvn-timer-default="10">10</span></div></div></div><span class="vjs-radial-progress-control vjs-hidden" data-tvn-timer="pause">Zatrzymaj</span><span class="vjs-radial-progress-control" data-tvn-timer="start">Wznów</span></div><div class="vjs-playlist-siblings"><div class="vjs-wrap"><div class="vjs-siblings-title">'+j+'</div><div class="vjs-watching-now">Aktualnie oglądasz</div><ul data-pos="'+k+'">'+i+'</ul><div class="vjs-prev"></div><div class="vjs-next"></div></div></div>'},continue_watching:function(a){return'<div class="vjs-continue-watching" data-href="/moj-player/kontynuuj-ogladanie.html" ><div class="vjs-cw-title">Kontynuuj oglądanie</div><div class="vjs-cw-icon"></div><div class="vjs-cw-text">Musisz przerwać, a chcesz obejrzeć to wideo później? Skorzystaj z naszej funkcji "Kontynuuj oglądanie"!</div></div>'},continue_watching_screen:function(a){return'<div class="vjs-continue-watching-screen"><div class="vjs-wrap"><div class="vjs-cw-icon"></div><div class="vjs-cw-title">Kontynuuj oglądanie</div><div class="vjs-cw-text">Poprzednio obejrzałeś ten materiał do '+secondsToHms(a.time,[" godz. "," min. "," sec. "])+'<span class="vjs-bigger">Czy chcesz kontynuować oglądanie?</span><div class="vjs-cw-button vjs-yes">Tak</div><div class="vjs-cw-button vjs-no">Nie</div></div></div></div>'},build_img:function(a){var b="undefined"!=typeof a.imgStyle&&a.imgStyle?' style="'+a.imgStyle+'"':"",c="undefined"!=typeof a.link&&a.link?' href="'+a.link+'" target="_blank"':"",d="undefined"!=typeof a.linkClassName&&a.linkClassName?' class="'+a.linkClassName+'" ':"",e="undefined"!=typeof a.statUrl3&&a.statUrl3?" data-stat='"+JSON.stringify(a.statUrl3)+"'":"",f="undefined"!=typeof a.hover&&a.hover?'class="imgHover" data-hover="'+a.hover+'" ':"";return"<a"+c+e+d+'><img src="'+a.image+'"'+f+b+"/></a>"}};videojs.plugin("resolutions",function(a){if("undefined"!=typeof sessionStorage){var b=this;videojs.reduce=function(a,b,c,d){if(a&&0!==a.length){for(var e=0,f=a.length;e<f;e++)c=b.call(a,c,a[e],e);return c}},this.resolutions_={options_:{},stopStream:function(){switch(b.techName){case"Html5":break;case"Flash":b.tech.el_.vjs_stop()}b.src("")},removeSources:function(a){var c=b.el_.getElementsByTagName("video")[0];"Html5"!==b.techName&&"Flash"!==b.techName||!c},bucketByTypes:function(a){return videojs.reduce(a,function(a,b,c){return(a[b.type]=a[b.type]||[]).push(b),a},{},b)},selectSource:function(a){this.removeSources();var b=this.bucketByTypes(a),c=this.selectTypeAndTech(a);return!!c&&(this.options_.sourceResolutions=b[c.type],this.selectResolution(this.options_.sourceResolutions))},selectTypeAndTech:function(a){for(var c,d,e=0,f=b.options_.techOrder;e<f.length;e++)if(c=videojs.capitalize(f[e]),d=window.videojs[c],d.isSupported())for(var g=0,h=a;g<h.length;g++){var i=h[g];if(d.canPlaySource(i))return{type:i.type,tech:c}}},selectResolution:function(a){var c=0,d=!!window.localStorage;videojs.obj.each(a,function(a,b){b.index=parseInt(a,10),b["data-default"]&&(c=b.index)},b);var e=c;if(d){var f=window.localStorage.getItem("videojs_preferred_res");isNaN(f)||videojs.obj.each(a,function(a,b){b["data-res"]==f&&(e=a)})}var g=a.length-1,h=e>g?g:e;return a[h]}},b.resolution=function(){return this.cache_.src.res},b.changeResolutionDefault=function(a){typeSources=b.sources;var c=getStorageItem("videojs_preferred_res");if(null===c){var d="string"==typeof uDevice&&PLAYER5_DEVICES_TYPE.mobile.indexOf(uDevice.toLowerCase())>-1;c=d?360:480}var e=null,f=!0,g=null,h="undefined"!=typeof $(b.node).attr("data-default-quality")&&parseInt($(b.node).attr("data-default-quality"),10),i=!1;b.debug("[QS MP4] wykryto default-quality",h),videojs.obj.each(typeSources,function(a,d){return h&&parseInt(d["data-res"],10)==h&&(f=!1,i=!0,e=d,b.debug("[QS MP4] ustawiam",e)),!i&&(null===e?(e=d,g=d):parseInt(d["data-res"],10)>parseInt(g["data-res"],10)&&(g=d),parseInt(d["data-res"],10)==parseInt(c,10)?(e=d,f=!1,!1):void 0)}),f&&(e=g),b.changeResolution(e,a)},b.supportQuality=function(){return b.sources.length>0},b.changeResolution=function(a,c){var d=(b.el_.getElementsByTagName("video"),a["data-res"]);if("Auto"!=d&&d.indexOf("p")<0&&(d+="p"),"undefined"==typeof sessionStorage.manualChoice||"false"==sessionStorage.manualChoice?$($(b.el_).find(".vjs-resolutions-button .vjs-menu-content .vjs-menu-item:first")).text("auto ("+d+")"):$($(b.el_).find(".vjs-resolutions-button .vjs-menu-content .vjs-menu-item:first")).text("auto"),this.cache_.src===a.src)return this.trigger("resolutionchange"),this;"undefined"==typeof c&&(c=this.currentTime());var e=!!this.materialStarted&&(this.paused()&&!this.advertInProgress);this.pause();var f=a.src.replace("redir.atmcdn.pl","r.dcs.redcdn.pl");"Chrome"==uBrowser&&uVersion>=45&&(f=jsonRedirectRedcdn(f)),"Html5"===this.techName||"Shaka"===this.techName||"Dashjs"===this.techName||"Flash"===this.techName?this.src(f):this.loadTech(this.techName,{src:f}),b.blockInteraction=!0,e&&this.pause(),this.ready(function(){this.one("loadeddata",videojs.bind(this,function(){this.currentTime(c)})),this.one("loadstart",function(){b.hasStarted(!0)}),this.trigger("resolutionchange"),this.one("canplay",function(){b.blockInteraction=!1}),this.options().isAndroid&&"Chrome"==uBrowser&&(this.load(),e?this.pause():this.play())})};var c=videojs.MenuItem.extend({init:function(a,b){b.label=b.source["data-res"],"Auto"!=b.label&&b.label.indexOf("p")<0&&(b.label+="p"),videojs.MenuItem.call(this,a,b),this.source=b.source,this.resolution=b.source["data-res"],this.player_.one("loadstart",videojs.bind(this,this.update)),this.player_.on("resolutionchange",videojs.bind(this,this.update))}});c.prototype.onClick=function(){videojs.MenuItem.prototype.onClick.call(this),"Auto"!=this.source["data-res"]?(sessionStorage.manualChoice=!0,sessionStorage.selectedQuality=this.source["data-res"],this.player_.changeResolution(this.source),sessionStorage.manualChoice=!1,this.selected(!0)):(sessionStorage.manualChoice=!1,this.trigger("resolutionchange"))},c.prototype.update=function(){if("false"==sessionStorage.manualChoice||isNotDefined(sessionStorage.manualChoice))"Auto"==this.source["data-res"]?this.selected(!0):this.selected(!1);else{var a=this.player_;a.cache_.src===this.source.src?this.selected(!0):this.selected(!1)}};var d=videojs.MenuButton.extend({init:function(a,b){videojs.MenuButton.call(this,a,b),this.items.length<=1&&this.hide()}});d.prototype.sourceResolutions=function(){return this.sourceResolutions_},d.prototype.onClick=function(a){if(a.target.className.match(/vjs-control-content/))this[this.el_.className.match(/touched/)?"removeClass":"addClass"]("touched");else{for(var b=document.getElementsByClassName("vjs-menu-button"),c=0;c<b.length;c++)videojs.removeClass(b[c],"touched");this.removeClass("touched")}},d.prototype.createItems=function(){var a=this.sourceResolutions_=this.player_.resolutions_.options_.sourceResolutions;if(a.length<=1)return[];if(a.length>1){a.reverse();var b={"data-res":"Auto",controls:!0,src:"auto"};a.unshift(b)}var d=[];if("undefined"!=typeof a)for(var e=0;e<a.length;e++)d.push(new c(this.player_,{source:this.sourceResolutions_[e]}));return d},ResolutionsButton=d.extend({init:function(a,b,c){d.call(this,a,b,c),this.el_.setAttribute("aria-label","Resolutions Menu"),this.el_.setAttribute("id","vjs-resolutions-button"),this.el_.setAttribute("name","resolutionsButton")}}),ResolutionsButton.prototype.kind_="resolutions",ResolutionsButton.prototype.buttonText="Resolutions",ResolutionsButton.prototype.className="vjs-resolutions-button",videojs.obj.merge(b.controlBar.options_.children,{resolutionsButton:{}});var e=b.options().quality,f=[],g=1;for(var h in e)if(e.hasOwnProperty(h)){var i=e[h],j={};j.controls=!0,j["data-res"]=h,j.index=g,j.src=i,j.type="video/mp4",f.push(j),g++}b.sources=f;b.resolutions_.selectSource(f);b.ready(function(){if(f.length>1){var a=new ResolutionsButton(b);b.controlBar.addChild(a)}}),b.getCurrentQuality=function(){var a=b.src();for(var c in f)if(f[c].src==a)return f[c];return!1},b.getHigherQuality=function(a){var b=parseInt(a["data-res"],10);for(var c in f){var d=parseInt(f[c]["data-res"],10);if(d>b)return f[c]}return!1},b.getLowerQuality=function(a){var b=parseInt(a["data-res"],10),c=a,d=!1;for(var e in f){if(d)return c;var g=parseInt(f[e]["data-res"],10);g==b?d=!0:c=f[e]}return c};var k=null,l=null,m=2;setStorageItem("connectionCheck",1);var n=!1;b.on("progress",function(a){if(n!==!0&&b.getInformation().watchingTime>2&&b.getInformation().watchingTime<12){if(n=b.paused(),"true"==sessionStorage.manualChoice)return!1;var c=a.timeStamp/1e3,d=parseFloat(getStorageItem("connectionCheck"));if(d&&c>d+2){setStorageItem("connectionCheck",c);try{var e=$(b.el()).children("video")[0].buffered.length-1;k=$(b.el()).children("video")[0].buffered.end(e)}catch(f){return!1}l=b.currentTime();var g,h=k-l,i=b.getCurrentQuality(),j=function(a,b){var c=!1,d=a["p"+b];return $.each(a,function(a,e){c&&(d=e,c=!1),a=="p"+b&&(c=!0)}),d},o={};if(o.p240={},o.p240.time=2,o.p240.profile=240,o.p360={},o.p360.time=12,o.p360.profile=360,o.p480={},o.p480.time=15,o.p480.profile=480,0===$(b.el_).find("object").length&&"Desktop"==uDevice&&(o.p720={},o.p720.time=25,o.p720.profile=720),"undefined"!=typeof i&&"undefined"!=typeof i["data-res"]){var p=i["data-res"].replace("p",""),q=o["p"+p];m=j(o,p).time-q.time}h>m&&0!==m?(g=b.getHigherQuality(i),g&&setStorageItem("videojs_preferred_res",g["data-res"])):h>3?setStorageItem("videojs_preferred_res",i["data-res"]):h<3&&(g=b.getLowerQuality(i),g?setStorageItem("videojs_preferred_res",g["data-res"]):setStorageItem("videojs_preferred_res",i["data-res"]))}}})}}),videojs.plugin("userUtilsTvn",userUtilsTvn),videojs.plugin("playerUtilsTvn",playerUtilsTvn),vjsIsTypeMovieDashOrHLS=function(a){var b=a;b.indexOf(".mp4?")>0?a=b.slice(0,b.lastIndexOf(".mp4")+4):b.indexOf(".webm")>0&&(a=b.slice(0,b.lastIndexOf(".webm")+5));var c=a.substr(a.lastIndexOf(".")+1),d=a.substr(a.lastIndexOf("=")+1);return"mp4"!=c&&"webm"!=c&&"flv"!=c&&"mp4"!=d&&("m3u8"!=c&&"m3u8"!=d?"MPEG-DASH":"HLS")};var THREE={REVISION:"75"};"function"==typeof define&&define.amd?define("three",THREE):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=THREE),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var b=Object(a),c=1,d=arguments.length;c!==d;++c){var e=arguments[c];if(void 0!==e&&null!==e)for(var e=Object(e),f=Object.keys(e),g=0,h=f.length;g!==h;++g){var i=f[g],j=Object.getOwnPropertyDescriptor(e,i);void 0!==j&&j.enumerable&&(b[i]=e[i])}}return b}}),THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.MinEquation=103,THREE.MaxEquation=104,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.NeverDepth=0,THREE.AlwaysDepth=1,THREE.LessDepth=2,THREE.LessEqualDepth=3,THREE.EqualDepth=4,THREE.GreaterEqualDepth=5,THREE.GreaterDepth=6,THREE.NotEqualDepth=7,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.NoToneMapping=0,THREE.LinearToneMapping=1,THREE.ReinhardToneMapping=2,THREE.Uncharted2ToneMapping=3,THREE.CineonToneMapping=4,THREE.UVMapping=300,THREE.CubeReflectionMapping=301,THREE.CubeRefractionMapping=302,THREE.EquirectangularReflectionMapping=303,THREE.EquirectangularRefractionMapping=304,THREE.SphericalReflectionMapping=305,THREE.CubeUVReflectionMapping=306,THREE.CubeUVRefractionMapping=307,THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.HalfFloatType=1025,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGBEFormat=THREE.RGBAFormat,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.RGB_PVRTC_4BPPV1_Format=2100,THREE.RGB_PVRTC_2BPPV1_Format=2101,THREE.RGBA_PVRTC_4BPPV1_Format=2102,THREE.RGBA_PVRTC_2BPPV1_Format=2103,THREE.RGB_ETC1_Format=2151,THREE.LoopOnce=2200,THREE.LoopRepeat=2201,THREE.LoopPingPong=2202,THREE.InterpolateDiscrete=2300,THREE.InterpolateLinear=2301,THREE.InterpolateSmooth=2302,THREE.ZeroCurvatureEnding=2400,THREE.ZeroSlopeEnding=2401,THREE.WrapAroundEnding=2402,THREE.TrianglesDrawMode=0,THREE.TriangleStripDrawMode=1,THREE.TriangleFanDrawMode=2,THREE.LinearEncoding=3e3,THREE.sRGBEncoding=3001,THREE.GammaEncoding=3007,THREE.RGBEEncoding=3002,THREE.LogLuvEncoding=3003,THREE.RGBM7Encoding=3004,THREE.RGBM16Encoding=3005,THREE.RGBDEncoding=3006,THREE.Color=function(a){return 3===arguments.length?this.fromArray(arguments):this.set(a)},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){return a instanceof THREE.Color?this.copy(a):"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a),this},setScalar:function(a){this.b=this.g=this.r=a},setHex:function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this},setRGB:function(a,b,c){return this.r=a,this.g=b,this.b=c,this},setHSL:function(){function a(a,b,c){return 0>c&&(c+=1),1<c&&(c-=1),c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a}return function(b,c,d){return b=THREE.Math.euclideanModulo(b,1),c=THREE.Math.clamp(c,0,1),d=THREE.Math.clamp(d,0,1),0===c?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3)),this}}(),setStyle:function(a){function b(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var c;if(c=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var d=c[2];switch(c[1]){case"rgb":case"rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,b(c[5]),this;if(c=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[5]),this;break;case"hsl":case"hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){var d=parseFloat(c[1])/360,e=parseInt(c[2],10)/100,f=parseInt(c[3],10)/100;return b(c[5]),this.setHSL(d,e,f)}}}else if(c=/^\#([A-Fa-f0-9]+)$/.exec(a)){if(c=c[1],d=c.length,3===d)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return a&&0<a.length&&(c=THREE.ColorKeywords[a],void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+a)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this},copyGammaToLinear:function(a,b){return void 0===b&&(b=2),this.r=Math.pow(a.r,b),this.g=Math.pow(a.g,b),this.b=Math.pow(a.b,b),this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var c=0<b?1/b:1;return this.r=Math.pow(a.r,c),this.g=Math.pow(a.g,c),this.b=Math.pow(a.b,c),this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;return this.r=a*a,this.g=b*b,this.b=c*c,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b,c=this.r,d=this.g,e=this.b,f=Math.max(c,d,e),g=Math.min(c,d,e),h=(g+f)/2;if(g===f)g=b=0;else{var i=f-g,g=.5>=h?i/(f+g):i/(2-f-g);switch(f){case c:b=(d-e)/i+(d<e?6:0);break;case d:b=(e-c)/i+2;break;case e:b=(c-d)/i+4}b/=6}return a.h=b,a.s=g,a.l=h,a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,c){var d=this.getHSL();return d.h+=a,d.s+=b,d.l+=c,this.setHSL(d.h,d.s,d.l),this},add:function(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this},addColors:function(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this},addScalar:function(a){return this.r+=a,this.g+=a,this.b+=a,this},multiply:function(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this},multiplyScalar:function(a){return this.r*=a,this.g*=a,this.b*=a,this},lerp:function(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){return void 0===b&&(b=0),this.r=a[b],this.g=a[b+1],this.b=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(a,b,c,d){this._x=a||0,this._y=b||0,this._z=c||0,this._w=void 0!==d?d:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(a){this._x=a,this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a,this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a,this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a,this.onChangeCallback()},set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this.onChangeCallback(),this},setFromEuler:function(a,b){if(!1==a instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c=Math.cos(a._x/2),d=Math.cos(a._y/2),e=Math.cos(a._z/2),f=Math.sin(a._x/2),g=Math.sin(a._y/2),h=Math.sin(a._z/2),i=a.order;return"XYZ"===i?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"YXZ"===i?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e+f*g*h):"ZXY"===i?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"ZYX"===i?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e+f*g*h):"YZX"===i?(this._x=f*d*e+c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e-f*g*h):"XZY"===i&&(this._x=f*d*e-c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e+f*g*h),!1!==b&&this.onChangeCallback(),this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this.onChangeCallback(),this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],i=b[6],b=b[10],j=c+f+b;return 0<j?(c=.5/Math.sqrt(j+1),this._w=.25/c,this._x=(i-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(i-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=.25*c,this._z=(g+i)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+i)/c,this._z=.25*c),this.onChangeCallback(),this},setFromUnitVectors:function(){var a,b;return function(c,d){return void 0===a&&(a=new THREE.Vector3),b=c.dot(d)+1,1e-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d),this._x=a.x,this._y=a.y,this._z=a.z,this._w=b,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();return 0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a),this.onChangeCallback(),this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this.onChangeCallback(),this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.sqrt(1-g*g);if(.001>Math.abs(h))return this._w=.5*(f+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;var i=Math.atan2(h,g),g=Math.sin((1-b)*i)/h,h=Math.sin(b*i)/h;return this._w=f*g+this._w*h,this._x=c*g+this._x*h,this._y=d*g+this._y*h,this._z=e*g+this._z*h,this.onChangeCallback(),this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){return void 0===b&&(b=0),this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this.onChangeCallback(),this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a},onChange:function(a){return this.onChangeCallback=a,this},onChangeCallback:function(){}},Object.assign(THREE.Quaternion,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],i=c[d+1],j=c[d+2];c=c[d+3],d=e[f+0];var k=e[f+1],l=e[f+2];if(e=e[f+3],c!==e||h!==d||i!==k||j!==l){f=1-g;var m=h*d+i*k+j*l+c*e,n=0<=m?1:-1,o=1-m*m;o>Number.EPSILON&&(o=Math.sqrt(o),m=Math.atan2(o,m*n),f=Math.sin(f*m)/o,g=Math.sin(g*m)/o),n*=g,h=h*f+d*n,i=i*f+k*n,j=j*f+l*n,c=c*f+e*n,f===1-g&&(g=1/Math.sqrt(h*h+i*i+j*j+c*c),h*=g,i*=g,j*=g,c*=g)}a[b]=h,a[b+1]=i,a[b+2]=j,a[b+3]=c}}),THREE.Vector2=function(a,b){this.x=a||0,this.y=b||0},
THREE.Vector2.prototype={constructor:THREE.Vector2,get width(){return this.x},set width(a){this.x=a},get height(){return this.y},set height(a){this.y=a},set:function(a,b){return this.x=a,this.y=b,this},setScalar:function(a){return this.y=this.x=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){return this.x=a.x,this.y=a.y,this},add:function(a,b){return void 0!==b?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this)},addScalar:function(a){return this.x+=a,this.y+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this},sub:function(a,b){return void 0!==b?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this)},subScalar:function(a){return this.x-=a,this.y-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this},multiplyScalar:function(a){return isFinite(a)?(this.x*=a,this.y*=a):this.y=this.x=0,this},divide:function(a){return this.x/=a.x,this.y/=a.y,this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this},clampScalar:function(){var a,b;return function(c,d){return void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2),a.set(c,c),b.set(d,d),this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.multiplyScalar(Math.max(a,Math.min(b,c))/c),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var a=Math.atan2(this.y,this.x);return 0>a&&(a+=2*Math.PI),a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;return a=this.y-a.y,b*b+a*a},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a},fromAttribute:function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this},rotateAround:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,f=this.y-a.y;return this.x=e*c-f*d+a.x,this.y=e*d+f*c+a.y,this}},THREE.Vector3=function(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setScalar:function(a){return this.z=this.y=this.x=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this},sub:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},multiplyScalar:function(a){return isFinite(a)?(this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyEuler:function(){var a;return function(b){return!1==b instanceof THREE.Euler&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===a&&(a=new THREE.Quaternion),this.applyQuaternion(a.setFromEuler(b)),this}}(),applyAxisAngle:function(){var a;return function(b,c){return void 0===a&&(a=new THREE.Quaternion),this.applyQuaternion(a.setFromAxisAngle(b,c)),this}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;return a=a.elements,this.x=a[0]*b+a[3]*c+a[6]*d,this.y=a[1]*b+a[4]*c+a[7]*d,this.z=a[2]*b+a[5]*c+a[8]*d,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;return a=a.elements,this.x=a[0]*b+a[4]*c+a[8]*d+a[12],this.y=a[1]*b+a[5]*c+a[9]*d+a[13],this.z=a[2]*b+a[6]*c+a[10]*d+a[14],this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);return this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e,this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e,this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e,this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,i=a*c+g*b-e*d,j=a*d+e*c-f*b,b=-e*b-f*c-g*d;return this.x=h*a+b*-e+i*-g-j*-f,this.y=i*a+b*-f+j*-e-h*-g,this.z=j*a+b*-g+h*-f-i*-e,this},project:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld)),this.applyProjection(a)}}(),unproject:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix)),this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;return a=a.elements,this.x=a[0]*b+a[4]*c+a[8]*d,this.y=a[1]*b+a[5]*c+a[9]*d,this.z=a[2]*b+a[6]*c+a[10]*d,this.normalize(),this},divide:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this},clampScalar:function(){var a,b;return function(c,d){return void 0===a&&(a=new THREE.Vector3,b=new THREE.Vector3),a.set(c,c,c),b.set(d,d,d),this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.multiplyScalar(Math.max(a,Math.min(b,c))/c),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;return this.x=d*a.z-e*a.y,this.y=e*a.x-c*a.z,this.z=c*a.y-d*a.x,this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},projectOnVector:function(){var a,b;return function(c){return void 0===a&&(a=new THREE.Vector3),a.copy(c).normalize(),b=this.dot(a),this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){return void 0===a&&(a=new THREE.Vector3),a.copy(this).projectOnVector(b),this.sub(a)}}(),reflect:function(){var a;return function(b){return void 0===a&&(a=new THREE.Vector3),this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){return a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq()),Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return a=this.z-a.z,b*b+c*c+a*a},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;return this.x=b*Math.sin(a.theta),this.y=Math.cos(a.phi)*a.radius,this.z=b*Math.cos(a.theta),this},setFromMatrixPosition:function(a){return this.setFromMatrixColumn(a,3)},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();return a=this.setFromMatrixColumn(a,2).length(),this.x=b,this.y=c,this.z=a,this},setFromMatrixColumn:function(a,b){return"number"==typeof a&&(console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index )."),b=a=b),this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},fromAttribute:function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this.z=a.array[b+2],this}},THREE.Vector4=function(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=void 0!==d?d:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},setScalar:function(a){return this.w=this.z=this.y=this.x=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setW:function(a){return this.w=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this},add:function(a,b){return void 0!==b?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this},sub:function(a,b){return void 0!==b?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},multiplyScalar:function(a){return isFinite(a)?(this.x*=a,this.y*=a,this.z*=a,this.w*=a):this.w=this.z=this.y=this.x=0,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;return a=a.elements,this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e,this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e,this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e,this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e,this},divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return 1e-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this},setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var e=a[0];d=a[4];var f=a[8],g=a[1],h=a[5],i=a[9];c=a[2],b=a[6];var j=a[10];return.01>Math.abs(d-g)&&.01>Math.abs(f-c)&&.01>Math.abs(i-b)?.1>Math.abs(d+g)&&.1>Math.abs(f+c)&&.1>Math.abs(i+b)&&.1>Math.abs(e+h+j-3)?(this.set(1,0,0,0),this):(a=Math.PI,e=(e+1)/2,h=(h+1)/2,j=(j+1)/2,d=(d+g)/4,f=(f+c)/4,i=(i+b)/4,e>h&&e>j?.01>e?(b=0,d=c=.707106781):(b=Math.sqrt(e),c=d/b,d=f/b):h>j?.01>h?(b=.707106781,c=0,d=.707106781):(c=Math.sqrt(h),b=d/c,d=i/c):.01>j?(c=b=.707106781,d=0):(d=Math.sqrt(j),b=f/d,c=i/d),this.set(b,c,d,a),this):(a=Math.sqrt((b-i)*(b-i)+(f-c)*(f-c)+(g-d)*(g-d)),.001>Math.abs(a)&&(a=1),this.x=(b-i)/a,this.y=(f-c)/a,this.z=(g-d)/a,this.w=Math.acos((e+h+j-1)/2),this)},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this.w=Math.max(a.w,Math.min(b.w,this.w)),this},clampScalar:function(){var a,b;return function(c,d){return void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4),a.set(c,c,c,c),b.set(d,d,d,d),this.clamp(a,b)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a},fromAttribute:function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this.z=a.array[b+2],this.w=a.array[b+3],this}},THREE.Euler=function(a,b,c,d){this._x=a||0,this._y=b||0,this._z=c||0,this._order=d||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(a){this._x=a,this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a,this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a,this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a,this.onChangeCallback()},set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._order=d||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this.onChangeCallback(),this},setFromRotationMatrix:function(a,b,c){var d=THREE.Math.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],i=e[5],j=e[9],k=e[2],l=e[6],e=e[10];return b=b||this._order,"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-j,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(l,i),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(j,-1,1)),.99999>Math.abs(j)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,i)):(this._y=Math.atan2(-k,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(-k,e),this._z=Math.atan2(-f,i)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(k,-1,1)),.99999>Math.abs(k)?(this._x=Math.atan2(l,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,i))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-j,i),this._y=Math.atan2(-k,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(l,i),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-j,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b),this._order=b,!1!==c&&this.onChangeCallback(),this},setFromQuaternion:function(){var a;return function(b,c,d){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationFromQuaternion(b),this.setFromRotationMatrix(a,c,d),this}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this),this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this.onChangeCallback(),this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(a){return this.onChangeCallback=a,this},onChangeCallback:function(){}},THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3,this.end=void 0!==b?b:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){return this.start.copy(a),this.end.copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.start.copy(a.start),this.end.copy(a.end),this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start),b.subVectors(this.end,this.start);var e=b.dot(b),e=b.dot(a)/e;return d&&(e=THREE.Math.clamp(e,0,1)),e}}(),closestPointToPoint:function(a,b,c){return a=this.closestPointToPointParameter(a,b),c=c||new THREE.Vector3,this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}},THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(1/0,1/0),this.max=void 0!==b?b:new THREE.Vector2((-(1/0)),(-(1/0)))},THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(.5);return this.min.copy(b).sub(d),this.max.copy(b).add(d),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}},THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==b?b:new THREE.Vector3((-(1/0)),(-(1/0)),(-(1/0)))},THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromArray:function(a){this.makeEmpty();for(var b=1/0,c=1/0,d=1/0,e=-(1/0),f=-(1/0),g=-(1/0),h=0,i=a.length;h<i;h+=3){var j=a[h],k=a[h+1],l=a[h+2];j<b&&(b=j),k<c&&(c=k),l<d&&(d=l),j>e&&(e=j),k>f&&(f=k),l>g&&(g=l)}this.min.set(b,c,d),this.max.set(e,f,g)},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;return function(b,c){var d=a.copy(c).multiplyScalar(.5);return this.min.copy(b).sub(d),this.max.copy(b).add(d),this}}(),setFromObject:function(){var a;return function(b){void 0===a&&(a=new THREE.Box3);var c=this;return this.makeEmpty(),b.updateMatrixWorld(!0),b.traverse(function(b){var d=b.geometry;void 0!==d&&(null===d.boundingBox&&d.computeBoundingBox(),!1===d.boundingBox.isEmpty()&&(a.copy(d.boundingBox),a.applyMatrix4(b.matrixWorld),c.union(a)))}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},intersectsSphere:function(){var a;return function(b){return void 0===a&&(a=new THREE.Vector3),this.clampPoint(b.center,a),a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){var b,c;return 0<a.normal.x?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x),0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=a.constant&&c>=a.constant},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new THREE.Vector3;return function(b){return b=b||new THREE.Sphere,b.center=this.center(),b.radius=.5*this.size(a).length(),b}}(),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){return a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b),a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b),a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b),a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b),a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b),a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b),a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b),a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b),this.makeEmpty(),this.setFromPoints(a),this}}(),translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}},THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,f,g,h,i){var j=this.elements;return j[0]=a,j[1]=d,j[2]=g,j[3]=b,j[4]=e,j[5]=h,j[6]=c,j[7]=f,j[8]=i,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){return a=a.elements,this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]),this},setFromMatrix4:function(a){return a=a.elements,this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this},applyToVector3Array:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3),void 0===c&&(c=0),void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.fromArray(b,c),a.applyMatrix3(this),a.toArray(b,c);return b}}(),applyToBuffer:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3),void 0===c&&(c=0),void 0===d&&(d=b.length/b.itemSize);for(var e=0;e<d;e++,c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(a.x,a.y,a.z);return b}}(),multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],a=a[8];return b*f*a-b*g*i-c*e*a+c*g*h+d*e*i-d*f*h},getInverse:function(a,b){a instanceof THREE.Matrix4&&console.warn("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var c=a.elements,d=this.elements,e=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],c=c[8],m=c*i-j*l,n=j*k-c*h,o=l*h-i*k,p=e*m+f*n+g*o;if(0===p){if(b)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return d[0]=m,d[1]=g*l-c*f,d[2]=j*f-g*i,d[3]=n,d[4]=c*e-g*k,d[5]=g*h-j*e,d[6]=o,d[7]=f*k-l*e,d[8]=i*e-f*h,this.multiplyScalar(1/p)},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},fromArray:function(a){return this.elements.set(a),this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(a){return this.elements.set(a.elements),this},copyPosition:function(a){var b=this.elements;
return a=a.elements,b[12]=a[12],b[13]=a[13],b[14]=a[14],this},extractBasis:function(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,2),this},makeBasis:function(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this},extractRotation:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);var c=this.elements,d=b.elements,e=1/a.setFromMatrixColumn(b,0).length(),f=1/a.setFromMatrixColumn(b,1).length();return b=1/a.setFromMatrixColumn(b,2).length(),c[0]=d[0]*e,c[1]=d[1]*e,c[2]=d[2]*e,c[4]=d[4]*f,c[5]=d[5]*f,c[6]=d[6]*f,c[8]=d[8]*b,c[9]=d[9]*b,c[10]=d[10]*b,this}}(),makeRotationFromEuler:function(a){!1==a instanceof THREE.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),c=Math.sin(c),g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e);if("XYZ"===a.order){a=f*h;var i=f*e,j=c*h,k=c*e;b[0]=g*h,b[4]=-g*e,b[8]=d,b[1]=i+j*d,b[5]=a-k*d,b[9]=-c*g,b[2]=k-a*d,b[6]=j+i*d,b[10]=f*g}else"YXZ"===a.order?(a=g*h,i=g*e,j=d*h,k=d*e,b[0]=a+k*c,b[4]=j*c-i,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=i*c-j,b[6]=k+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,i=g*e,j=d*h,k=d*e,b[0]=a-k*c,b[4]=-f*e,b[8]=j+i*c,b[1]=i+j*c,b[5]=f*h,b[9]=k-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,i=f*e,j=c*h,k=c*e,b[0]=g*h,b[4]=j*d-i,b[8]=a*d+k,b[1]=g*e,b[5]=k*d+a,b[9]=i*d-j,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,i=f*d,j=c*g,k=c*d,b[0]=g*h,b[4]=k-a*e,b[8]=j*e+i,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=i*e+j,b[10]=a-k*e):"XZY"===a.order&&(a=f*g,i=f*d,j=c*g,k=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+k,b[5]=f*h,b[9]=i*e-j,b[2]=j*e-i,b[6]=c*h,b[10]=k*e+a);return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e;a=c*g;var j=c*h,c=c*i,k=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;return b[0]=1-(k+e),b[4]=j-f,b[8]=c+h,b[1]=j+f,b[5]=1-(a+e),b[9]=d-g,b[2]=c-h,b[6]=d+g,b[10]=1-(a+k),b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},lookAt:function(){var a,b,c;return function(d,e,f){void 0===a&&(a=new THREE.Vector3),void 0===b&&(b=new THREE.Vector3),void 0===c&&(c=new THREE.Vector3);var g=this.elements;return c.subVectors(d,e).normalize(),0===c.lengthSq()&&(c.z=1),a.crossVectors(f,c).normalize(),0===a.lengthSq()&&(c.x+=1e-4,a.crossVectors(f,c).normalize()),b.crossVectors(c,a),g[0]=a.x,g[4]=b.x,g[8]=c.x,g[1]=a.y,g[5]=b.y,g[9]=c.y,g[2]=a.z,g[6]=b.z,g[10]=c.z,this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],c=c[15],u=d[0],v=d[4],w=d[8],x=d[12],y=d[1],z=d[5],A=d[9],B=d[13],C=d[2],D=d[6],E=d[10],F=d[14],G=d[3],H=d[7],I=d[11],d=d[15];return e[0]=f*u+g*y+h*C+i*G,e[4]=f*v+g*z+h*D+i*H,e[8]=f*w+g*A+h*E+i*I,e[12]=f*x+g*B+h*F+i*d,e[1]=j*u+k*y+l*C+m*G,e[5]=j*v+k*z+l*D+m*H,e[9]=j*w+k*A+l*E+m*I,e[13]=j*x+k*B+l*F+m*d,e[2]=n*u+o*y+p*C+q*G,e[6]=n*v+o*z+p*D+q*H,e[10]=n*w+o*A+p*E+q*I,e[14]=n*x+o*B+p*F+q*d,e[3]=r*u+s*y+t*C+c*G,e[7]=r*v+s*z+t*D+c*H,e[11]=r*w+s*A+t*E+c*I,e[15]=r*x+s*B+t*F+c*d,this},multiplyToArray:function(a,b,c){var d=this.elements;return this.multiplyMatrices(a,b),c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},applyToVector3Array:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3),void 0===c&&(c=0),void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.fromArray(b,c),a.applyMatrix4(this),a.toArray(b,c);return b}}(),applyToBuffer:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3),void 0===c&&(c=0),void 0===d&&(d=b.length/b.itemSize);for(var e=0;e<d;e++,c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(a.x,a.y,a.z);return b}}(),determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14];return a[3]*(+e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+a[7]*(+b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},getPosition:function(){var a;return function(){return void 0===a&&(a=new THREE.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),a.setFromMatrixColumn(this,3)}}(),setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5],k=d[6],l=d[7],m=d[8],n=d[9],o=d[10],p=d[11],q=d[12],r=d[13],s=d[14],d=d[15],t=n*s*l-r*o*l+r*k*p-j*s*p-n*k*d+j*o*d,u=q*o*l-m*s*l-q*k*p+i*s*p+m*k*d-i*o*d,v=m*r*l-q*n*l+q*j*p-i*r*p-m*j*d+i*n*d,w=q*n*k-m*r*k-q*j*o+i*r*o+m*j*s-i*n*s,x=e*t+f*u+g*v+h*w;if(0===x){if(b)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return c[0]=t,c[1]=r*o*h-n*s*h-r*g*p+f*s*p+n*g*d-f*o*d,c[2]=j*s*h-r*k*h+r*g*l-f*s*l-j*g*d+f*k*d,c[3]=n*k*h-j*o*h-n*g*l+f*o*l+j*g*p-f*k*p,c[4]=u,c[5]=m*s*h-q*o*h+q*g*p-e*s*p-m*g*d+e*o*d,c[6]=q*k*h-i*s*h-q*g*l+e*s*l+i*g*d-e*k*d,c[7]=i*o*h-m*k*h+m*g*l-e*o*l-i*g*p+e*k*p,c[8]=v,c[9]=q*n*h-m*r*h-q*f*p+e*r*p+m*f*d-e*n*d,c[10]=i*r*h-q*j*h+q*f*l-e*r*l-i*f*d+e*j*d,c[11]=m*j*h-i*n*h-m*f*l+e*n*l+i*f*p-e*j*p,c[12]=w,c[13]=m*r*g-q*n*g+q*f*o-e*r*o-m*f*s+e*n*s,c[14]=q*j*g-i*r*g-q*f*k+e*r*k+i*f*s-e*j*s,c[15]=i*n*g-m*j*g+m*f*k-e*n*k-i*f*o+e*j*o,this.multiplyScalar(1/x)},scale:function(a){var b=this.elements,c=a.x,d=a.y;return a=a.z,b[0]*=c,b[4]*=d,b[8]*=a,b[1]*=c,b[5]*=d,b[9]*=a,b[2]*=c,b[6]*=d,b[10]*=a,b[3]*=c,b[7]*=d,b[11]*=a,this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a);return a=Math.sin(a),this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a);return a=Math.sin(a),this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a);return a=Math.sin(a),this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},compose:function(a,b,c){return this.makeRotationFromQuaternion(b),this.scale(c),this.setPosition(a),this},decompose:function(){var a,b;return function(c,d,e){void 0===a&&(a=new THREE.Vector3),void 0===b&&(b=new THREE.Matrix4);var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),i=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g),c.x=f[12],c.y=f[13],c.z=f[14],b.elements.set(this.elements),c=1/g;var f=1/h,j=1/i;return b.elements[0]*=c,b.elements[1]*=c,b.elements[2]*=c,b.elements[4]*=f,b.elements[5]*=f,b.elements[6]*=f,b.elements[8]*=j,b.elements[9]*=j,b.elements[10]*=j,d.setFromRotationMatrix(b),e.x=g,e.y=h,e.z=i,this}}(),makeFrustum:function(a,b,c,d,e,f){var g=this.elements;return g[0]=2*e/(b-a),g[4]=0,g[8]=(b+a)/(b-a),g[12]=0,g[1]=0,g[5]=2*e/(d-c),g[9]=(d+c)/(d-c),g[13]=0,g[2]=0,g[6]=0,g[10]=-(f+e)/(f-e),g[14]=-2*f*e/(f-e),g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(.5*a));var e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),i=1/(c-d),j=1/(f-e);return g[0]=2*h,g[4]=0,g[8]=0,g[12]=-((b+a)*h),g[1]=0,g[5]=2*i,g[9]=0,g[13]=-((c+d)*i),g[2]=0,g[6]=0,g[10]=-2*j,g[14]=-((f+e)*j),g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a){return this.elements.set(a),this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]}},THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3,this.direction=void 0!==b?b:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){return this.origin.copy(a),this.direction.copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize()},recast:function(){var a=new THREE.Vector3;return function(b){return this.origin.copy(this.at(b,a)),this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);return 0>c?this.origin.distanceToSquared(b):(a.copy(this.direction).multiplyScalar(c).add(this.origin),a.distanceToSquared(b))}}(),distanceSqToSegment:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5),b.copy(e).sub(d).normalize(),c.copy(this.origin).sub(a);var h,i=.5*d.distanceTo(e),j=-this.direction.dot(b),k=c.dot(this.direction),l=-c.dot(b),m=c.lengthSq(),n=Math.abs(1-j*j);return 0<n?(d=j*l-k,e=j*k-l,h=i*n,0<=d?e>=-h?e<=h?(i=1/n,d*=i,e*=i,j=d*(d+j*e+2*k)+e*(j*d+e+2*l)+m):(e=i,d=Math.max(0,-(j*e+k)),j=-d*d+e*(e+2*l)+m):(e=-i,d=Math.max(0,-(j*e+k)),j=-d*d+e*(e+2*l)+m):e<=-h?(d=Math.max(0,-(-j*i+k)),e=0<d?-i:Math.min(Math.max(-i,-l),i),j=-d*d+e*(e+2*l)+m):e<=h?(d=0,e=Math.min(Math.max(-i,-l),i),j=e*(e+2*l)+m):(d=Math.max(0,-(j*i+k)),e=0<d?i:Math.min(Math.max(-i,-l),i),j=-d*d+e*(e+2*l)+m)):(e=0<j?-i:i,d=Math.max(0,-(j*e+k)),j=-d*d+e*(e+2*l)+m),f&&f.copy(this.direction).multiplyScalar(d).add(this.origin),g&&g.copy(b).multiplyScalar(e).add(a),j}}(),intersectSphere:function(){var a=new THREE.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d,f=b.radius*b.radius;return e>f?null:(f=Math.sqrt(f-e),e=d-f,d+=f,0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c))}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);return 0===b?0===a.distanceToPoint(this.origin)?0:null:(a=-(this.origin.dot(a.normal)+a.constant)/b,0<=a?a:null)},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b},intersectBox:function(a,b){var c,d,e,f,g;d=1/this.direction.x,f=1/this.direction.y,g=1/this.direction.z;var h=this.origin;return 0<=d?(c=(a.min.x-h.x)*d,d*=a.max.x-h.x):(c=(a.max.x-h.x)*d,d*=a.min.x-h.x),0<=f?(e=(a.min.y-h.y)*f,f*=a.max.y-h.y):(e=(a.max.y-h.y)*f,f*=a.min.y-h.y),c>f||e>d?null:((e>c||c!==c)&&(c=e),(f<d||d!==d)&&(d=f),0<=g?(e=(a.min.z-h.z)*g,g*=a.max.z-h.z):(e=(a.max.z-h.z)*g,g*=a.min.z-h.z),c>g||e>d?null:((e>c||c!==c)&&(c=e),(g<d||d!==d)&&(d=g),0>d?null:this.at(0<=c?c:d,b)))},intersectsBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h,i){if(b.subVectors(f,e),c.subVectors(g,e),d.crossVectors(b,c),f=this.direction.dot(d),0<f){if(h)return null;h=1}else{if(!(0>f))return null;h=-1,f=-f}return a.subVectors(this.origin,e),e=h*this.direction.dot(c.crossVectors(a,c)),0>e?null:(g=h*this.direction.dot(b.cross(a)),0>g||e+g>f?null:(e=-h*a.dot(d),0>e?null:this.at(e/f,i)))}}(),applyMatrix4:function(a){return this.direction.add(this.origin).applyMatrix4(a),this.origin.applyMatrix4(a),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}},THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3,this.radius=void 0!==b?b:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){return this.center.copy(a),this.radius=b,this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var e=0,f=0,g=b.length;f<g;f++)e=Math.max(e,d.distanceToSquared(b[f]));return this.radius=Math.sqrt(e),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.center.copy(a.center),this.radius=a.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(this.center.dot(a.normal)-a.constant)<=this.radius},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;return d.copy(a),c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center)),d},getBoundingBox:function(a){return a=a||new THREE.Box3,a.set(this.center,this.center),a.expandByScalar(this.radius),a},applyMatrix4:function(a){return this.center.applyMatrix4(a),this.radius*=a.getMaxScaleOnAxis(),this},translate:function(a){return this.center.add(a),this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}},THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,f){var g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],i=c[6],j=c[7],k=c[8],l=c[9],m=c[10],n=c[11],o=c[12],p=c[13],q=c[14],c=c[15];return b[0].setComponents(f-a,j-g,n-k,c-o).normalize(),b[1].setComponents(f+a,j+g,n+k,c+o).normalize(),b[2].setComponents(f+d,j+h,n+l,c+p).normalize(),b[3].setComponents(f-d,j-h,n-l,c-p).normalize(),b[4].setComponents(f-e,j-i,n-m,c-q).normalize(),b[5].setComponents(f+e,j+i,n+m,c+q).normalize(),this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),a.copy(c.boundingSphere),a.applyMatrix4(b.matrixWorld),this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var d=this.planes,e=0;6>e;e++){var f=d[e];a.x=0<f.normal.x?c.min.x:c.max.x,b.x=0<f.normal.x?c.max.x:c.min.x,a.y=0<f.normal.y?c.min.y:c.max.y,b.y=0<f.normal.y?c.max.y:c.min.y,a.z=0<f.normal.z?c.min.z:c.max.z,b.z=0<f.normal.z?c.max.z:c.min.z;var g=f.distanceToPoint(a),f=f.distanceToPoint(b);if(0>g&&0>f)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}},THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0),this.constant=void 0!==b?b:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){return this.normal.copy(a),this.constant=b,this},setComponents:function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},setFromNormalAndCoplanarPoint:function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){return d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize(),this.setFromNormalAndCoplanarPoint(d,c),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},normalize:function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);return 0!==f?(f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:d.copy(e).multiplyScalar(f).add(b.start)):0===this.distanceToPoint(b.start)?d.copy(b.start):void 0}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start);return a=this.distanceToPoint(a.end),0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(d,e){var f=e||c.getNormalMatrix(d),f=a.copy(this.normal).applyMatrix3(f),g=this.coplanarPoint(b);return g.applyMatrix4(d),this.setFromNormalAndCoplanarPoint(f,g),this}}(),translate:function(a){return this.constant-=a.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}},THREE.Spherical=function(a,b,c){return this.radius=void 0!==a?a:1,this.phi=void 0!==b?b:0,this.theta=void 0!==c?c:0,this},THREE.Spherical.prototype={constructor:THREE.Spherical,set:function(a,b,c){this.radius=a,this.phi=b,this.theta=c},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.radius.copy(a.radius),this.phi.copy(a.phi),this.theta.copy(a.theta),this},makeSafe:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))},setFromVector3:function(a){return this.radius=a.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a.x,a.z),this.phi=Math.acos(THREE.Math.clamp(a.y/this.radius,-1,1))),this}},THREE.Math={generateUUID:function(){var a,b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),c=Array(36),d=0;return function(){for(var e=0;36>e;e++)8===e||13===e||18===e||23===e?c[e]="-":14===e?c[e]="4":(2>=d&&(d=33554432+16777216*Math.random()|0),a=15&d,d>>=4,c[e]=b[19===e?3&a|8:a]);return c.join("")}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b),a*a*(3-2*a))},smootherstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b),a*a*a*(a*(6*a-15)+10))},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nearestPowerOfTwo:function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))},nextPowerOfTwo:function(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a++,a}},THREE.Spline=function(a){function b(a,b,c,d,e,f,g){return a=.5*(c-a),d=.5*(d-b),(2*(b-c)+a+d)*g+(-3*(b-c)-2*a-d)*f+a*e+b}this.points=a;var c,d,e,f,g,h,i,j,k,l=[],m={x:0,y:0,z:0};this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}},this.getPoint=function(a){return c=(this.points.length-1)*a,d=Math.floor(c),e=c-d,l[0]=0===d?d:d-1,l[1]=d,l[2]=d>this.points.length-2?this.points.length-1:d+1,l[3]=d>this.points.length-3?this.points.length-1:d+2,h=this.points[l[0]],i=this.points[l[1]],j=this.points[l[2]],k=this.points[l[3]],f=e*e,g=e*f,m.x=b(h.x,i.x,j.x,k.x,e,f,g),m.y=b(h.y,i.y,j.y,k.y,e,f,g),m.z=b(h.z,i.z,j.z,k.z,e,f,g),m},this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d},this.getLength=function(a){var b,c,d,e=b=b=0,f=new THREE.Vector3,g=new THREE.Vector3,h=[],i=0;for(h[0]=0,a||(a=100),c=this.points.length*a,f.copy(this.points[0]),a=1;a<c;a++)b=a/c,d=this.getPoint(b),g.copy(d),i+=g.distanceTo(f),f.copy(d),b*=this.points.length-1,b=Math.floor(b),b!==e&&(h[b]=i,e=b);return h[h.length]=i,{chunks:h,total:i}},this.reparametrizeByArcLength=function(a){var b,c,d,e,f,g,h=[],i=new THREE.Vector3,j=this.getLength();for(h.push(i.copy(this.points[0]).clone()),b=1;b<this.points.length;b++){for(c=j.chunks[b]-j.chunks[b-1],g=Math.ceil(a*c/j.total),e=(b-1)/(this.points.length-1),f=b/(this.points.length-1),c=1;c<g-1;c++)d=e+1/g*c*(f-e),d=this.getPoint(d),h.push(i.copy(d).clone());h.push(i.copy(this.points[b]).clone())}this.points=h}},THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3,this.b=void 0!==b?b:new THREE.Vector3,this.c=void 0!==c?c:new THREE.Vector3},THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){return e=e||new THREE.Vector3,e.subVectors(d,c),a.subVectors(b,c),e.cross(a),b=e.lengthSq(),0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g,h){a.subVectors(g,e),b.subVectors(f,e),c.subVectors(d,e),d=a.dot(a),e=a.dot(b),f=a.dot(c);var i=b.dot(b);g=b.dot(c);var j=d*i-e*e;return h=h||new THREE.Vector3,0===j?h.set(-2,-1,-1):(j=1/j,i=(i*f-e*g)*j,d=(d*g-e*f)*j,h.set(1-i-d,d,i))}}(),THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){return b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a),0<=b.x&&0<=b.y&&1>=b.x+b.y}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this},setFromPointsAndIndices:function(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){return a.subVectors(this.c,this.b),b.subVectors(this.a,this.b),.5*a.cross(b).length()}}(),midpoint:function(a){return(a||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}},THREE.Interpolant=function(a,b,c,d){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==d?d:new b.constructor(c),this.sampleValues=b,this.valueSize=c},THREE.Interpolant.prototype={constructor:THREE.Interpolant,evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;return this._cachedIndex=c=b.length,this.afterEnd_(c-1,a,e)}if(c===f)break;if(e=d,d=b[++c],a<d)break b}d=b.length;break c}if(a>=e)break a;for(f=b[1],a<f&&(c=2,e=f),f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;if(d=e,e=b[--c-1],a>=e)break b}d=c,c=0}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;if(d=b[c],e=b[c-1],void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return this._cachedIndex=c=b.length,this.afterEnd_(c-1,e,a)}this._cachedIndex=c,this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(a,b,c,d){throw Error("call to abstract method")},intervalChanged_:function(a,b,c){}},Object.assign(THREE.Interpolant.prototype,{beforeStart_:THREE.Interpolant.prototype.copySampleValue_,afterEnd_:THREE.Interpolant.prototype.copySampleValue_}),THREE.CubicInterpolant=function(a,b,c,d){THREE.Interpolant.call(this,a,b,c,d),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0},THREE.CubicInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.CubicInterpolant,DefaultSettings_:{endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},intervalChanged_:function(a,b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case THREE.ZeroSlopeEnding:e=a,g=2*b-c;break;case THREE.WrapAroundEnding:e=d.length-2,g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case THREE.ZeroSlopeEnding:f=a,h=2*c-b;break;case THREE.WrapAroundEnding:f=1,h=c+d[1]-d[0];break;default:f=a-1,h=b}a=.5*(c-b),d=this.valueSize,this._weightPrev=a/(b-g),this._weightNext=a/(h-c),this._offsetPrev=e*d,this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,i=this._offsetPrev,j=this._offsetNext,k=this._weightPrev,l=this._weightNext,m=(c-b)/(d-b);for(c=m*m,d=c*m,b=-k*d+2*k*c-k*m,k=(1+k)*d+(-1.5-2*k)*c+(-.5+k)*m+1,m=(-1-l)*d+(1.5+l)*c+.5*m,l=l*d-l*c,c=0;c!==g;++c)e[c]=b*f[i+c]+k*f[h+c]+m*f[a+c]+l*f[j+c];return e}}),THREE.DiscreteInterpolant=function(a,b,c,d){THREE.Interpolant.call(this,a,b,c,d)},THREE.DiscreteInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.DiscreteInterpolant,interpolate_:function(a,b,c,d){return this.copySampleValue_(a-1)}}),THREE.LinearInterpolant=function(a,b,c,d){THREE.Interpolant.call(this,a,b,c,d)},THREE.LinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.LinearInterpolant,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;for(b=(c-b)/(d-b),c=1-b,d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}}),THREE.QuaternionLinearInterpolant=function(a,b,c,d){THREE.Interpolant.call(this,a,b,c,d)},THREE.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.QuaternionLinearInterpolant,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;for(a*=g,b=(c-b)/(d-b),c=a+g;a!==c;a+=4)THREE.Quaternion.slerpFlat(e,0,f,a-g,f,a,b);return e}}),THREE.Clock=function(a){this.autoStart=void 0===a||a,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=performance.now(),this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running&&this.start(),this.running){var b=performance.now(),a=.001*(b-this.oldTime);this.oldTime=b,this.elapsedTime+=a}return a}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener,a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]),-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],d=b.length,e=0;e<d;e++)c[e]=b[e];for(e=0;e<d;e++)c[e].call(this,a)}}}},THREE.Layers=function(){this.mask=1},THREE.Layers.prototype={constructor:THREE.Layers,set:function(a){this.mask=1<<a},enable:function(a){this.mask|=1<<a},toggle:function(a){this.mask^=1<<a},disable:function(a){this.mask&=~(1<<a)},test:function(a){return 0!==(this.mask&a.mask)}},function(a){function b(a,b){return a.distance-b.distance}function c(a,b,d,e){if(!1!==a.visible&&(a.raycast(b,d),!0===e)){a=a.children,e=0;for(var f=a.length;e<f;e++)c(a[e],b,d,!0)}}a.Raycaster=function(b,c,d,e){this.ray=new a.Ray(b,c),this.near=d||0,this.far=e||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})},a.Raycaster.prototype={constructor:a.Raycaster,linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(b,c){c instanceof a.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(b.x,b.y,.5).unproject(c).sub(this.ray.origin).normalize()):c instanceof a.OrthographicCamera?(this.ray.origin.set(b.x,b.y,-1).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,d){var e=[];return c(a,this,e,d),e.sort(b),e},intersectObjects:function(a,d){var e=[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),e;for(var f=0,g=a.length;f<g;f++)c(a[f],this,e,d);return e.sort(b),
e}}}(THREE),THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=THREE.Object3D.DefaultUp.clone();var a=new THREE.Vector3,b=new THREE.Euler,c=new THREE.Quaternion,d=new THREE.Vector3(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)}),c.onChange(function(){b.setFromQuaternion(c,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d},modelViewMatrix:{value:new THREE.Matrix4},normalMatrix:{value:new THREE.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new THREE.Layers,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0),THREE.Object3D.DefaultMatrixAutoUpdate=!0,THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){return a.setFromAxisAngle(b,c),this.quaternion.multiply(a),this}}(),rotateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){return a.copy(b).applyQuaternion(this.quaternion),this.position.add(a.multiplyScalar(c)),this}}(),translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up),this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}return a===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this):(a instanceof THREE.Object3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this)},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a),-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){return a=a||new THREE.Vector3,this.updateMatrixWorld(!0),a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){return c=c||new THREE.Quaternion,this.updateMatrixWorld(!0),this.matrixWorld.decompose(a,c,b),c}}(),getWorldRotation:function(){var a=new THREE.Quaternion;return function(b){return b=b||new THREE.Euler,this.getWorldQuaternion(a),b.setFromQuaternion(a,this.rotation.order,!1)}}(),getWorldScale:function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(c){return c=c||new THREE.Vector3,this.updateMatrixWorld(!0),this.matrixWorld.decompose(a,b,c),c}}(),getWorldDirection:function(){var a=new THREE.Quaternion;return function(b){return b=b||new THREE.Vector3,this.getWorldQuaternion(a),b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==a||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},toJSON:function(a){function b(a){var b,c=[];for(b in a){var d=a[b];delete d.metadata,c.push(d)}return c}var c=void 0===a,d={};c&&(a={geometries:{},materials:{},textures:{},images:{}},d.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var e={};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData),!0===this.castShadow&&(e.castShadow=!0),!0===this.receiveShadow&&(e.receiveShadow=!0),!1===this.visible&&(e.visible=!1),e.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===a.geometries[this.geometry.uuid]&&(a.geometries[this.geometry.uuid]=this.geometry.toJSON(a)),e.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON(a)),e.material=this.material.uuid),0<this.children.length){e.children=[];for(var f=0;f<this.children.length;f++)e.children.push(this.children[f].toJSON(a).object)}if(c){var c=b(a.geometries),f=b(a.materials),g=b(a.textures);a=b(a.images),0<c.length&&(d.geometries=c),0<f.length&&(d.materials=f),0<g.length&&(d.textures=g),0<a.length&&(d.images=a)}return d.object=e,d},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){if(void 0===b&&(b=!0),this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.rotationAutoUpdate=a.rotationAutoUpdate,this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.userData=JSON.parse(JSON.stringify(a.userData)),!0===b)for(var c=0;c<a.children.length;c++)this.add(a.children[c].clone());return this}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Face3=function(a,b,c,d,e,f){this.a=a,this.b=b,this.c=c,this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3,this.vertexNormals=Array.isArray(d)?d:[],this.color=e instanceof THREE.Color?e:new THREE.Color,this.vertexColors=Array.isArray(e)?e:[],this.materialIndex=void 0!==f?f:0},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a,this.b=a.b,this.c=a.c,this.normal.copy(a.normal),this.color.copy(a.color),this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();for(b=0,c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}},THREE.BufferAttribute=function(a,b){this.uuid=THREE.Math.generateUUID(),this.array=a,this.itemSize=b,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){return this.dynamic=a,this},copy:function(a){return this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.dynamic=a.dynamic,this},copyAt:function(a,b,c){a*=this.itemSize,c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){return this.array.set(a),this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),f=new THREE.Color),b[c++]=f.r,b[c++]=f.g,b[c++]=f.b}return this},copyIndicesArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];b[c++]=f.a,b[c++]=f.b,b[c++]=f.c}return this},copyVector2sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",d),f=new THREE.Vector2),b[c++]=f.x,b[c++]=f.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),f=new THREE.Vector3),b[c++]=f.x,b[c++]=f.y,b[c++]=f.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),f=new THREE.Vector4),b[c++]=f.x,b[c++]=f.y,b[c++]=f.z,b[c++]=f.w}return this},set:function(a,b){return void 0===b&&(b=0),this.array.set(a,b),this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){return this.array[a*this.itemSize]=b,this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){return this.array[a*this.itemSize+1]=b,this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){return this.array[a*this.itemSize+2]=b,this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){return this.array[a*this.itemSize+3]=b,this},setXY:function(a,b,c){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this},setXYZ:function(a,b,c,d){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this},setXYZW:function(a,b,c,d,e){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this},clone:function(){return(new this.constructor).copy(this)}},THREE.Int8Attribute=function(a,b){return new THREE.BufferAttribute(new Int8Array(a),b)},THREE.Uint8Attribute=function(a,b){return new THREE.BufferAttribute(new Uint8Array(a),b)},THREE.Uint8ClampedAttribute=function(a,b){return new THREE.BufferAttribute(new Uint8ClampedArray(a),b)},THREE.Int16Attribute=function(a,b){return new THREE.BufferAttribute(new Int16Array(a),b)},THREE.Uint16Attribute=function(a,b){return new THREE.BufferAttribute(new Uint16Array(a),b)},THREE.Int32Attribute=function(a,b){return new THREE.BufferAttribute(new Int32Array(a),b)},THREE.Uint32Attribute=function(a,b){return new THREE.BufferAttribute(new Uint32Array(a),b)},THREE.Float32Attribute=function(a,b){return new THREE.BufferAttribute(new Float32Array(a),b)},THREE.Float64Attribute=function(a,b){return new THREE.BufferAttribute(new Float64Array(a),b)},THREE.DynamicBufferAttribute=function(a,b){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new THREE.BufferAttribute(a,b).setDynamic(!0)},THREE.InstancedBufferAttribute=function(a,b,c){THREE.BufferAttribute.call(this,a,b),this.meshPerAttribute=c||1},THREE.InstancedBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype),THREE.InstancedBufferAttribute.prototype.constructor=THREE.InstancedBufferAttribute,THREE.InstancedBufferAttribute.prototype.copy=function(a){return THREE.BufferAttribute.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this},THREE.InterleavedBuffer=function(a,b){this.uuid=THREE.Math.generateUUID(),this.array=a,this.stride=b,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},THREE.InterleavedBuffer.prototype={constructor:THREE.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){return this.dynamic=a,this},copy:function(a){return this.array=new a.array.constructor(a.array),this.stride=a.stride,this.dynamic=a.dynamic,this},copyAt:function(a,b,c){a*=this.stride,c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){return void 0===b&&(b=0),this.array.set(a,b),this},clone:function(){return(new this.constructor).copy(this)}},THREE.InstancedInterleavedBuffer=function(a,b,c){THREE.InterleavedBuffer.call(this,a,b),this.meshPerAttribute=c||1},THREE.InstancedInterleavedBuffer.prototype=Object.create(THREE.InterleavedBuffer.prototype),THREE.InstancedInterleavedBuffer.prototype.constructor=THREE.InstancedInterleavedBuffer,THREE.InstancedInterleavedBuffer.prototype.copy=function(a){return THREE.InterleavedBuffer.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this},THREE.InterleavedBufferAttribute=function(a,b,c){this.uuid=THREE.Math.generateUUID(),this.data=a,this.itemSize=b,this.offset=c},THREE.InterleavedBufferAttribute.prototype={constructor:THREE.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.count},setX:function(a,b){return this.data.array[a*this.data.stride+this.offset]=b,this},setY:function(a,b){return this.data.array[a*this.data.stride+this.offset+1]=b,this},setZ:function(a,b){return this.data.array[a*this.data.stride+this.offset+2]=b,this},setW:function(a,b){return this.data.array[a*this.data.stride+this.offset+3]=b,this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this},setXYZ:function(a,b,c,d){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this},setXYZW:function(a,b,c,d,e){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this.data.array[a+3]=e,this}},THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);for(c=0,d=this.faces.length;c<d;c++){a=this.faces[c],a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationX(b),this.applyMatrix(a),this}}(),rotateY:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationY(b),this.applyMatrix(a),this}}(),rotateZ:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationZ(b),this.applyMatrix(a),this}}(),translate:function(){var a;return function(b,c,d){return void 0===a&&(a=new THREE.Matrix4),a.makeTranslation(b,c,d),this.applyMatrix(a),this}}(),scale:function(){var a;return function(b,c,d){return void 0===a&&(a=new THREE.Matrix4),a.makeScale(b,c,d),this.applyMatrix(a),this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new THREE.Object3D),a.lookAt(b),a.updateMatrix(),this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,b,d,e){var f=void 0!==g?[k[a].clone(),k[b].clone(),k[d].clone()]:[],n=void 0!==h?[c.colors[a].clone(),c.colors[b].clone(),c.colors[d].clone()]:[];e=new THREE.Face3(a,b,d,f,n,e),c.faces.push(e),void 0!==i&&c.faceVertexUvs[0].push([l[a].clone(),l[b].clone(),l[d].clone()]),void 0!==j&&c.faceVertexUvs[1].push([m[a].clone(),m[b].clone(),m[d].clone()])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,g=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,i=void 0!==e.uv?e.uv.array:void 0,j=void 0!==e.uv2?e.uv2.array:void 0;void 0!==j&&(this.faceVertexUvs[1]=[]);for(var k=[],l=[],m=[],n=e=0;e<f.length;e+=3,n+=2)c.vertices.push(new THREE.Vector3(f[e],f[e+1],f[e+2])),void 0!==g&&k.push(new THREE.Vector3(g[e],g[e+1],g[e+2])),void 0!==h&&c.colors.push(new THREE.Color(h[e],h[e+1],h[e+2])),void 0!==i&&l.push(new THREE.Vector2(i[n],i[n+1])),void 0!==j&&m.push(new THREE.Vector2(j[n],j[n+1]));if(void 0!==d)if(f=a.groups,0<f.length)for(e=0;e<f.length;e++)for(var o=f[e],p=o.start,q=o.count,n=p,p=p+q;n<p;n+=3)b(d[n],d[n+1],d[n+2],o.materialIndex);else for(e=0;e<d.length;e+=3)b(d[e],d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)b(e,e+1,e+2);return this.computeFaceNormals(),null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();return this.translate(a.x,a.y,a.z),a},normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius,b=0===b?1:1/b,c=new THREE.Matrix4;return c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1),this.applyMatrix(c),this},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g),b.subVectors(f,g),a.cross(b),a.normalize(),e.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var b,c,d;for(d=Array(this.vertices.length),b=0,c=this.vertices.length;b<c;b++)d[b]=new THREE.Vector3;if(a){var e,f,g,h=new THREE.Vector3,i=new THREE.Vector3;for(a=0,b=this.faces.length;a<b;a++)c=this.faces[a],e=this.vertices[c.a],f=this.vertices[c.b],g=this.vertices[c.c],h.subVectors(g,f),i.subVectors(e,f),h.cross(i),d[c.a].add(h),d[c.b].add(h),d[c.c].add(h)}else for(a=0,b=this.faces.length;a<b;a++)c=this.faces[a],d[c.a].add(c.normal),d[c.b].add(c.normal),d[c.c].add(c.normal);for(b=0,c=this.vertices.length;b<c;b++)d[b].normalize();for(a=0,b=this.faces.length;a<b;a++)c=this.faces[a],e=c.vertexNormals,3===e.length?(e[0].copy(d[c.a]),e[1].copy(d[c.b]),e[2].copy(d[c.c])):(e[0]=d[c.a].clone(),e[1]=d[c.b].clone(),e[2]=d[c.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,b,c,d,e;for(c=0,d=this.faces.length;c<d;c++)for(e=this.faces[c],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),a=0,b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone();var f=new THREE.Geometry;for(f.faces=this.faces,a=0,b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={},this.morphNormals[a].faceNormals=[],this.morphNormals[a].vertexNormals=[],e=this.morphNormals[a].faceNormals;var g,h,i=this.morphNormals[a].vertexNormals;for(c=0,d=this.faces.length;c<d;c++)g=new THREE.Vector3,h={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},e.push(g),i.push(h)}for(i=this.morphNormals[a],f.vertices=this.morphTargets[a].vertices,f.computeFaceNormals(),f.computeVertexNormals(),c=0,d=this.faces.length;c<d;c++)e=this.faces[c],g=i.faceNormals[c],h=i.vertexNormals[c],g.copy(e.normal),h.a.copy(e.vertexNormals[0]),h.b.copy(e.vertexNormals[1]),h.c.copy(e.vertexNormals[2])}for(c=0,d=this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(!1==a instanceof THREE.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a);else{var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,i=a.faces,j=this.faceVertexUvs[0];a=a.faceVertexUvs[0],void 0===c&&(c=0),void 0!==b&&(d=(new THREE.Matrix3).getNormalMatrix(b));for(var k=0,l=g.length;k<l;k++){var m=g[k].clone();void 0!==b&&m.applyMatrix4(b),f.push(m)}for(k=0,l=i.length;k<l;k++){var n,g=i[k],o=g.vertexNormals,p=g.vertexColors,m=new THREE.Face3(g.a+e,g.b+e,g.c+e);for(m.normal.copy(g.normal),void 0!==d&&m.normal.applyMatrix3(d).normalize(),b=0,f=o.length;b<f;b++)n=o[b].clone(),void 0!==d&&n.applyMatrix3(d).normalize(),m.vertexNormals.push(n);for(m.color.copy(g.color),b=0,f=p.length;b<f;b++)n=p[b],m.vertexColors.push(n.clone());m.materialIndex=g.materialIndex+c,h.push(m)}for(k=0,l=a.length;k<l;k++)if(c=a[k],d=[],void 0!==c){for(b=0,f=c.length;b<f;b++)d.push(c[b].clone());j.push(d)}}},mergeMesh:function(a){!1==a instanceof THREE.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a):(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix))},mergeVertices:function(){var a,b,c,d={},e=[],f=[],g=Math.pow(10,4);for(b=0,c=this.vertices.length;b<c;b++)a=this.vertices[b],a=Math.round(a.x*g)+"_"+Math.round(a.y*g)+"_"+Math.round(a.z*g),void 0===d[a]?(d[a]=b,e.push(this.vertices[b]),f[b]=e.length-1):f[b]=f[d[a]];for(d=[],b=0,c=this.faces.length;b<c;b++)for(g=this.faces[b],g.a=f[g.a],g.b=f[g.b],g.c=f[g.c],g=[g.a,g.b,g.c],a=0;3>a;a++)if(g[a]===g[(a+1)%3]){d.push(b);break}for(b=d.length-1;0<=b;b--)for(g=d[b],this.faces.splice(g,1),f=0,c=this.faceVertexUvs.length;f<c;f++)this.faceVertexUvs[f].splice(g,1);return b=this.vertices.length-e.length,this.vertices=e,b},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d,e,f=this.faceVertexUvs[0],g=this.faceVertexUvs[1];for(f&&f.length===b&&(d=[]),g&&g.length===b&&(e=[]),c=0;c<b;c++){var h=a[c]._id;d&&d.push(f[h]),e&&e.push(g[h])}d&&(this.faceVertexUvs[0]=d),e&&(this.faceVertexUvs[1]=e)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();return void 0!==j[b]?j[b]:(j[b]=i.length/3,i.push(a.x,a.y,a.z),j[b])}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();return void 0!==l[b]?l[b]:(l[b]=k.length,k.push(a.getHex()),l[b])}function d(a){var b=a.x.toString()+a.y.toString();return void 0!==n[b]?n[b]:(n[b]=m.length/2,m.push(a.x,a.y),n[b])}var e={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var f,g=this.parameters;for(f in g)void 0!==g[f]&&(e[f]=g[f]);return e}for(g=[],f=0;f<this.vertices.length;f++){var h=this.vertices[f];g.push(h.x,h.y,h.z)}var h=[],i=[],j={},k=[],l={},m=[],n={};for(f=0;f<this.faces.length;f++){var o=this.faces[f],p=void 0!==this.faceVertexUvs[0][f],q=0<o.normal.length(),r=0<o.vertexNormals.length,s=1!==o.color.r||1!==o.color.g||1!==o.color.b,t=0<o.vertexColors.length,u=0,u=a(u,0,0),u=a(u,1,!0),u=a(u,2,!1),u=a(u,3,p),u=a(u,4,q),u=a(u,5,r),u=a(u,6,s),u=a(u,7,t);h.push(u),h.push(o.a,o.b,o.c),h.push(o.materialIndex),p&&(p=this.faceVertexUvs[0][f],h.push(d(p[0]),d(p[1]),d(p[2]))),q&&h.push(b(o.normal)),r&&(q=o.vertexNormals,h.push(b(q[0]),b(q[1]),b(q[2]))),s&&h.push(c(o.color)),t&&(o=o.vertexColors,h.push(c(o[0]),c(o[1]),c(o[2])))}return e.data={},e.data.vertices=g,e.data.normals=i,0<k.length&&(e.data.colors=k),0<m.length&&(e.data.uvs=[m]),e.data.faces=h,e},clone:function(){return(new THREE.Geometry).copy(this)},copy:function(a){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var b=a.vertices,c=0,d=b.length;c<d;c++)this.vertices.push(b[c].clone());for(b=a.faces,c=0,d=b.length;c<d;c++)this.faces.push(b[c].clone());for(c=0,d=a.faceVertexUvs.length;c<d;c++){b=a.faceVertexUvs[c],void 0===this.faceVertexUvs[c]&&(this.faceVertexUvs[c]=[]);for(var e=0,f=b.length;e<f;e++){for(var g=b[e],h=[],i=0,j=g.length;i<j;i++)h.push(g[i].clone());this.faceVertexUvs[c].push(h)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.DirectGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1},THREE.DirectGeometry.prototype={constructor:THREE.DirectGeometry,computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(a){var b,c,d=[];a=a.faces;for(var e=0;e<a.length;e++){var f=a[e];f.materialIndex!==c&&(c=f.materialIndex,void 0!==b&&(b.count=3*e-b.start,d.push(b)),b={start:3*e,materialIndex:c})}void 0!==b&&(b.count=3*e-b.start,d.push(b)),this.groups=d},fromGeometry:function(a){var b,c=a.faces,d=a.vertices,e=a.faceVertexUvs,f=e[0]&&0<e[0].length,g=e[1]&&0<e[1].length,h=a.morphTargets,i=h.length;if(0<i){b=[];for(var j=0;j<i;j++)b[j]=[];this.morphTargets.position=b}var k,l=a.morphNormals,m=l.length;if(0<m){for(k=[],j=0;j<m;j++)k[j]=[];this.morphTargets.normal=k}for(var n=a.skinIndices,o=a.skinWeights,p=n.length===d.length,q=o.length===d.length,j=0;j<c.length;j++){var r=c[j];this.vertices.push(d[r.a],d[r.b],d[r.c]);var s=r.vertexNormals;for(3===s.length?this.normals.push(s[0],s[1],s[2]):(s=r.normal,this.normals.push(s,s,s)),s=r.vertexColors,3===s.length?this.colors.push(s[0],s[1],s[2]):(s=r.color,this.colors.push(s,s,s)),!0===f&&(s=e[0][j],void 0!==s?this.uvs.push(s[0],s[1],s[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",j),this.uvs.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2))),!0===g&&(s=e[1][j],void 0!==s?this.uvs2.push(s[0],s[1],s[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",j),this.uvs2.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2))),s=0;s<i;s++){var t=h[s].vertices;b[s].push(t[r.a],t[r.b],t[r.c])}for(s=0;s<m;s++)t=l[s].vertexNormals[j],k[s].push(t.a,t.b,t.c);p&&this.skinIndices.push(n[r.a],n[r.b],n[r.c]),q&&this.skinWeights.push(o[r.a],o[r.b],o[r.c])}return this.computeGroups(a),this.verticesNeedUpdate=a.verticesNeedUpdate,this.normalsNeedUpdate=a.normalsNeedUpdate,this.colorsNeedUpdate=a.colorsNeedUpdate,this.uvsNeedUpdate=a.uvsNeedUpdate,this.groupsNeedUpdate=a.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.DirectGeometry.prototype),THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,getIndex:function(){return this.index},setIndex:function(a){this.index=a},addAttribute:function(a,b,c){if(!1==b instanceof THREE.BufferAttribute&&!1==b instanceof THREE.InterleavedBufferAttribute)console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new THREE.BufferAttribute(b,c));else{if("index"!==a)return this.attributes[a]=b,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b)}},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){return delete this.attributes[a],this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a,this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;return void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0),b=this.attributes.normal,void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),b.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationX(b),this.applyMatrix(a),this}}(),rotateY:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationY(b),this.applyMatrix(a),this}}(),rotateZ:function(){var a;return function(b){return void 0===a&&(a=new THREE.Matrix4),a.makeRotationZ(b),this.applyMatrix(a),this}}(),translate:function(){var a;return function(b,c,d){return void 0===a&&(a=new THREE.Matrix4),a.makeTranslation(b,c,d),this.applyMatrix(a),this}}(),scale:function(){var a;return function(b,c,d){return void 0===a&&(a=new THREE.Matrix4),a.makeScale(b,c,d),this.applyMatrix(a),this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new THREE.Object3D),a.lookAt(b),a.updateMatrix(),this.applyMatrix(a.matrix)}}(),center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();return this.translate(a.x,a.y,a.z),a},setFromObject:function(a){var b=a.geometry;if(a instanceof THREE.Points||a instanceof THREE.Line){a=new THREE.Float32Attribute(3*b.vertices.length,3);var c=new THREE.Float32Attribute(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices)),this.addAttribute("color",c.copyColorsArray(b.colors)),b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new THREE.Float32Attribute(b.lineDistances.length,1),
this.addAttribute("lineDistance",a.copyArray(b.lineDistances))),null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone()),null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a instanceof THREE.Mesh&&b instanceof THREE.Geometry&&this.fromGeometry(b);return this},updateFromObject:function(a){var b=a.geometry;if(a instanceof THREE.Mesh){var c=b.__directGeometry;if(void 0===c)return this.fromGeometry(b);c.verticesNeedUpdate=b.verticesNeedUpdate,c.normalsNeedUpdate=b.normalsNeedUpdate,c.colorsNeedUpdate=b.colorsNeedUpdate,c.uvsNeedUpdate=b.uvsNeedUpdate,c.groupsNeedUpdate=b.groupsNeedUpdate,b.verticesNeedUpdate=!1,b.normalsNeedUpdate=!1,b.colorsNeedUpdate=!1,b.uvsNeedUpdate=!1,b.groupsNeedUpdate=!1,b=c}return!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),c.needsUpdate=!0),b.verticesNeedUpdate=!1),!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=!1),!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),c.needsUpdate=!0),b.colorsNeedUpdate=!1),b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1),b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&(c.copyArray(b.lineDistances),c.needsUpdate=!0),b.lineDistancesNeedUpdate=!1),b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1),this},fromGeometry:function(a){return a.__directGeometry=(new THREE.DirectGeometry).fromGeometry(a),this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",new THREE.BufferAttribute(b,3).copyVector3sArray(a.vertices)),0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",new THREE.BufferAttribute(b,3).copyVector3sArray(a.normals))),0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",new THREE.BufferAttribute(b,3).copyColorsArray(a.colors))),0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",new THREE.BufferAttribute(b,2).copyVector2sArray(a.uvs))),0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",new THREE.BufferAttribute(b,2).copyVector2sArray(a.uvs2))),0<a.indices.length&&(b=new(65535<a.vertices.length?Uint32Array:Uint16Array)(3*a.indices.length),this.setIndex(new THREE.BufferAttribute(b,1).copyIndicesArray(a.indices))),this.groups=a.groups;for(var c in a.morphTargets){for(var b=[],d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=d[e],h=new THREE.Float32Attribute(3*g.length,3);b.push(h.copyVector3sArray(g))}this.morphAttributes[c]=b}return 0<a.skinIndices.length&&(c=new THREE.Float32Attribute(4*a.skinIndices.length,4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices))),0<a.skinWeights.length&&(c=new THREE.Float32Attribute(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights))),null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone()),this},computeBoundingBox:function(){return new THREE.Vector3,function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var a=this.attributes.position.array;a&&this.boundingBox.setFromArray(a),void 0!==a&&0!==a.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var a=new THREE.Box3,b=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){var d=this.boundingSphere.center;a.setFromArray(c),a.center(d);for(var e=0,f=0,g=c.length;f<g;f+=3)b.fromArray(c,f),e=Math.max(e,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(e),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes,c=this.groups;if(b.position){var d=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(d.length),3));else for(var e=b.normal.array,f=0,g=e.length;f<g;f++)e[f]=0;var h,i,j,e=b.normal.array,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3;if(a){a=a.array,0===c.length&&this.addGroup(0,a.length);for(var p=0,q=c.length;p<q;++p)for(f=c[p],g=f.start,h=f.count,f=g,g+=h;f<g;f+=3)h=3*a[f+0],i=3*a[f+1],j=3*a[f+2],k.fromArray(d,h),l.fromArray(d,i),m.fromArray(d,j),n.subVectors(m,l),o.subVectors(k,l),n.cross(o),e[h]+=n.x,e[h+1]+=n.y,e[h+2]+=n.z,e[i]+=n.x,e[i+1]+=n.y,e[i+2]+=n.z,e[j]+=n.x,e[j+1]+=n.y,e[j+2]+=n.z}else for(f=0,g=d.length;f<g;f+=9)k.fromArray(d,f),l.fromArray(d,f+3),m.fromArray(d,f+6),n.subVectors(m,l),o.subVectors(k,l),n.cross(o),e[f]=n.x,e[f+1]=n.y,e[f+2]=n.z,e[f+3]=n.x,e[f+4]=n.y,e[f+5]=n.z,e[f+6]=n.x,e[f+7]=n.y,e[f+8]=n.z;this.normalizeNormals(),b.normal.needsUpdate=!0}},merge:function(a,b){if(!1!=a instanceof THREE.BufferGeometry){void 0===b&&(b=0);var c,d=this.attributes;for(c in d)if(void 0!==a.attributes[c])for(var e=d[c].array,f=a.attributes[c],g=f.array,h=0,f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){for(var a,b,c,d=this.attributes.normal.array,e=0,f=d.length;e<f;e+=3)a=d[e],b=d[e+1],c=d[e+2],a=1/Math.sqrt(a*a+b*b+c*c),d[e]*=a,d[e+1]*=a,d[e+2]*=a},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a,b=new THREE.BufferGeometry,c=this.index.array,d=this.attributes;for(a in d){for(var e=d[a],f=e.array,e=e.itemSize,g=new f.constructor(c.length*e),h=0,i=0,j=0,k=c.length;j<k;j++)for(var h=c[j]*e,l=0;l<e;l++)g[i++]=f[h++];b.addAttribute(a,new THREE.BufferAttribute(g,e))}return b},toJSON:function(){var a={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),void 0!==this.parameters){var b,c=this.parameters;for(b in c)void 0!==c[b]&&(a[b]=c[b]);return a}a.data={attributes:{}};var d=this.index;null!==d&&(c=Array.prototype.slice.call(d.array),a.data.index={type:d.array.constructor.name,array:c}),d=this.attributes;for(b in d){var e=d[b],c=Array.prototype.slice.call(e.array);a.data.attributes[b]={itemSize:e.itemSize,type:e.array.constructor.name,array:c}}return b=this.groups,0<b.length&&(a.data.groups=JSON.parse(JSON.stringify(b))),b=this.boundingSphere,null!==b&&(a.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),a},clone:function(){return(new THREE.BufferGeometry).copy(this)},copy:function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var c,b=a.attributes;for(c in b)this.addAttribute(c,b[c].clone());for(a=a.groups,c=0,b=a.length;c<b;c++){var d=a[c];this.addGroup(d.start,d.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.BufferGeometry.MaxIndex=65535,THREE.InstancedBufferGeometry=function(){THREE.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},THREE.InstancedBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.InstancedBufferGeometry.prototype.constructor=THREE.InstancedBufferGeometry,THREE.InstancedBufferGeometry.prototype.addGroup=function(a,b,c){this.groups.push({start:a,count:b,instances:c})},THREE.InstancedBufferGeometry.prototype.copy=function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var c,b=a.attributes;for(c in b)this.addAttribute(c,b[c].clone());for(a=a.groups,c=0,b=a.length;c<b;c++){var d=a[c];this.addGroup(d.start,d.count,d.instances)}return this},THREE.EventDispatcher.prototype.apply(THREE.InstancedBufferGeometry.prototype),THREE.Uniform=function(a,b){this.type=a,this.value=b,this.dynamic=!1},THREE.Uniform.prototype={constructor:THREE.Uniform,onUpdate:function(a){return this.dynamic=!0,this.onUpdateCallback=a,this}},THREE.AnimationClip=function(a,b,c){this.name=a||THREE.Math.generateUUID(),this.tracks=c,this.duration=void 0!==b?b:-1,0>this.duration&&this.resetDuration(),this.trim(),this.optimize()},THREE.AnimationClip.prototype={constructor:THREE.AnimationClip,resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b)var d=this.tracks[b],a=Math.max(a,d.times[d.times.length-1]);this.duration=a},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},optimize:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}},Object.assign(THREE.AnimationClip,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(THREE.KeyframeTrack.parse(c[e]).scale(d));return new THREE.AnimationClip(a.name,a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b};for(var d=0,e=c.length;d!==e;++d)b.push(THREE.KeyframeTrack.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,b,c){for(var d=b.length,e=[],f=0;f<d;f++){var g=[],h=[];g.push((f+d-1)%d,f,(f+1)%d),h.push(0,1,0);var i=THREE.AnimationUtils.getKeyframeOrder(g),g=THREE.AnimationUtils.sortedArray(g,1,i),h=THREE.AnimationUtils.sortedArray(h,1,i);0===g[0]&&(g.push(d),h.push(h[0])),e.push(new THREE.NumberKeyframeTrack(".morphTargetInfluences["+b[f].name+"]",g,h).scale(1/c))}return new THREE.AnimationClip(a,(-1),e)},findByName:function(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return a[c];return null},CreateClipsFromMorphTargetSequences:function(a,b){for(var c={},d=/^([\w-]*?)([\d]+)$/,e=0,f=a.length;e<f;e++){var g=a[e],h=g.name.match(d);if(h&&1<h.length){var i=h[1];(h=c[i])||(c[i]=h=[]),h.push(g)}}d=[];for(i in c)d.push(THREE.AnimationClip.CreateFromMorphTargetSequence(i,c[i],b));return d},parseAnimation:function(a,b,c){if(!a)return console.error("  no animation in JSONLoader data"),null;c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];THREE.AnimationUtils.flattenJSON(c,f,g,d),0!==f.length&&e.push(new a(b,f,g))}};var d=[],e=a.name||"default",f=a.length||-1,g=a.fps||30;a=a.hierarchy||[];for(var h=0;h<a.length;h++){var i=a[h].keys;if(i&&0!=i.length)if(i[0].morphTargets){for(var f={},j=0;j<i.length;j++)if(i[j].morphTargets)for(var k=0;k<i[j].morphTargets.length;k++)f[i[j].morphTargets[k]]=-1;for(var l in f){for(var m=[],n=[],k=0;k!==i[j].morphTargets.length;++k){var o=i[j];m.push(o.time),n.push(o.morphTarget===l?1:0)}d.push(new THREE.NumberKeyframeTrack(".morphTargetInfluence["+l+"]",m,n))}f=f.length*(g||1)}else j=".bones["+b[h].name+"]",c(THREE.VectorKeyframeTrack,j+".position",i,"pos",d),c(THREE.QuaternionKeyframeTrack,j+".quaternion",i,"rot",d),c(THREE.VectorKeyframeTrack,j+".scale",i,"scl",d)}return 0===d.length?null:new THREE.AnimationClip(e,f,d)}}),THREE.AnimationMixer=function(a){this._root=a,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1},THREE.AnimationMixer.prototype={constructor:THREE.AnimationMixer,clipAction:function(a,b){var c,d=(b||this._root).uuid,e="string"==typeof a?a:a.name,f=a!==e?a:null,g=this._actionsByClip[e];if(void 0!==g){if(c=g.actionByRoot[d],void 0!==c)return c;if(c=g.knownActions[0],f=c._clip,a!==e&&a!==f)throw Error("Different clips with the same name detected!")}return null===f?null:(g=new THREE.AnimationMixer._Action(this,f,b),this._bindAction(g,c),this._addInactiveAction(g,e,d),g)},existingAction:function(a,b){var c=(b||this._root).uuid,d=this._actionsByClip["string"==typeof a?a:a.name];return void 0!==d?d.actionByRoot[c]||null:null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==b;++e)a[e].reset();for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g){var h=b[g];h.enabled&&h._update(d,a,e,f)}for(a=this._bindings,b=this._nActiveBindings,g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.name;var c=this._actionsByClip,d=c[a];if(void 0!==d){for(var d=d.knownActions,e=0,f=d.length;e!==f;++e){var g=d[e];this._deactivateAction(g);var h=g._cacheIndex,i=b[b.length-1];g._cacheIndex=null,g._byClipCacheIndex=null,i._cacheIndex=h,b[h]=i,b.pop(),this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=a.uuid;var b,c=this._actionsByClip;for(b in c){var d=c[b].actionByRoot[a];void 0!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}if(b=this._bindingsByRootAndName[a],void 0!==b)for(var e in b)a=b[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(a,b){var c=this.existingAction(a,b);null!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}},THREE.EventDispatcher.prototype.apply(THREE.AnimationMixer.prototype),THREE.AnimationMixer._Action=function(a,b,c){this._mixer=a,this._clip=b,this._localRoot=c||null,a=b.tracks,b=a.length,c=Array(b);for(var d={endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},e=0;e!==b;++e){var f=a[e].createInterpolant(null);c[e]=f,f.settings=d}this._interpolantSettings=d,this._interpolants=c,this._propertyBindings=Array(b),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=THREE.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0},THREE.AnimationMixer._Action.prototype={constructor:THREE.AnimationMixer._Action,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){return this._startTime=a,this},setLoop:function(a,b){return this.loop=a,this.repetitions=b,this},setEffectiveWeight:function(a){return this.weight=a,this._effectiveWeight=this.enabled?a:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,1,0)},crossFadeFrom:function(a,b,c){if(a.fadeOut(b),this.fadeIn(b),c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b),this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;return null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this},setEffectiveTimeScale:function(a){return this.timeScale=a,this._effectiveTimeScale=this.paused?0:a,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(a){return this.timeScale=this._clip.duration/a,this.stopWarping()},syncWith:function(a){return this.time=a.time,this.timeScale=a.timeScale,this.stopWarping()},halt:function(a){return this.warp(this._currentTimeScale,0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;return null===f&&(this._timeScaleInterpolant=f=d._lendControlInterpolant()),d=f.parameterPositions,f=f.sampleValues,d[0]=e,d[1]=e+c,f[0]=a/g,f[1]=b/g,this},stopWarping:function(){var a=this._timeScaleInterpolant;return null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(a,b,c,d){var e=this._startTime;if(null!==e){if(b=(a-e)*c,0>b||0===c)return;this._startTime=null,b*=c}if(b*=this._updateTimeScale(a),c=this._updateTime(b),a=this._updateWeight(a),0<a){b=this._interpolants;for(var e=this._propertyBindings,f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}},_updateWeight:function(a){var b=0;if(this.enabled){var b=this.weight,c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0],b=b*d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){var b=this.timeScale,c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0],b=b*d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.pause=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a;if(0===a)return b;var c=this._clip.duration,d=this.loop,e=this._loopCount,f=!1;switch(d){case THREE.LoopOnce:if(-1===e&&(this.loopCount=0,this._setEndings(!0,!0,!1)),b>=c)b=c;else{if(!(0>b))break;b=0}this.clampWhenFinished?this.pause=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>a?-1:1});break;case THREE.LoopPingPong:f=!0;case THREE.LoopRepeat:if(-1===e&&(0<a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f)),b>=c||0>b){var g=Math.floor(b/c),b=b-c*g,e=e+Math.abs(g),h=this.repetitions-e;if(0>h){this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1});break}0===h?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:g})}if(d===THREE.LoopPingPong&&1===(1&e))return this.time=b,c-b}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=THREE.ZeroSlopeEnding,d.endingEnd=THREE.ZeroSlopeEnding):(d.endingStart=a?this.zeroSlopeAtStart?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:THREE.WrapAroundEnding,d.endingEnd=b?this.zeroSlopeAtEnd?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:THREE.WrapAroundEnding)},_scheduleFading:function(a,b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;return null===f&&(this._weightInterpolant=f=d._lendControlInterpolant()),d=f.parameterPositions,f=f.sampleValues,d[0]=e,f[0]=b,d[1]=e+a,f[1]=c,this}},Object.assign(THREE.AnimationMixer.prototype,{_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings,g=a._interpolants,h=c.uuid,i=this._bindingsByRootAndName,j=i[h];for(void 0===j&&(j={},i[h]=j),i=0;i!==e;++i){var k=d[i],l=k.name,m=j[l];if(void 0===m){if(m=f[i],void 0!==m){null===m._cacheIndex&&(++m.referenceCount,this._addInactiveBinding(m,h,l));continue}m=new THREE.PropertyMixer(THREE.PropertyBinding.create(c,l,b&&b._propertyBindings[i].binding.parsedPath),k.ValueTypeName,k.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,h,l)}f[i]=m,g[i].resultBuffer=m.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.name,d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]),this._addInactiveAction(a,c,b)}for(b=a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){return a=a._cacheIndex,null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a)),a._cacheIndex=d.length,d.push(a),f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d,b[d]=c,b.pop(),a._cacheIndex=null;var c=a._clip.name,d=this._actionsByClip,e=d[c],f=e.knownActions,g=f[f.length-1],h=a._byClipCacheIndex;g._byClipCacheIndex=h,f[h]=g,f.pop(),a._byClipCacheIndex=null,delete e.actionByRoot[(b._localRoot||this._root).uuid],0===f.length&&delete d[c],this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;for(var b=0,c=a.length;b!==c;++b){var d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=e),e[c]=a,a._cacheIndex=f.length,f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid,c=c.path,e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];a=a._cacheIndex,g._cacheIndex=a,b[a]=g,b.pop(),delete f[c];a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];a._cacheIndex=d,b[d]=a,e._cacheIndex=c,b[c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];return void 0===c&&(c=new THREE.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c),c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d,b[d]=a,e.__cacheIndex=c,b[c]=e},_controlInterpolantsResultBuffer:new Float32Array(1)}),THREE.AnimationObjectGroup=function(a){this.uuid=THREE.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var b={};this._indicesByUUID=b;for(var c=0,d=arguments.length;c!==d;++c)b[arguments[c].uuid]=c;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}},THREE.AnimationObjectGroup.prototype={constructor:THREE.AnimationObjectGroup,add:function(a){for(var b=this._objects,c=b.length,d=this.nCachedObjects_,e=this._indicesByUUID,f=this._paths,g=this._parsedPaths,h=this._bindings,i=h.length,j=0,k=arguments.length;j!==k;++j){var l=arguments[j],m=l.uuid,n=e[m];if(void 0===n){n=c++,e[m]=n,b.push(l);for(var m=0,o=i;m!==o;++m)h[m].push(new THREE.PropertyBinding(l,f[m],g[m]))}else if(n<d){var p=b[n],q=--d,o=b[q];for(e[o.uuid]=n,b[n]=o,e[m]=q,b[q]=l,m=0,o=i;m!==o;++m){var r=h[m],s=r[n];r[n]=r[q],void 0===s&&(s=new THREE.PropertyBinding(l,f[m],g[m])),r[q]=s}}else b[n]!==p&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=d},remove:function(a){for(var b=this._objects,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var i=arguments[g],j=i.uuid,k=d[j];if(void 0!==k&&k>=c){var l=c++,m=b[l];for(d[m.uuid]=k,b[k]=m,d[j]=l,b[l]=i,i=0,j=f;i!==j;++i){var m=e[i],n=m[k];m[k]=m[l],m[l]=n}}}this.nCachedObjects_=c},uncache:function(a){for(var b=this._objects,c=b.length,d=this.nCachedObjects_,e=this._indicesByUUID,f=this._bindings,g=f.length,h=0,i=arguments.length;h!==i;++h){var j=arguments[h].uuid,k=e[j];if(void 0!==k)if(delete e[j],k<d){var j=--d,l=b[j],m=--c,n=b[m];for(e[l.uuid]=k,b[k]=l,e[n.uuid]=j,b[j]=n,b.pop(),l=0,n=g;l!==n;++l){var o=f[l],p=o[m];o[k]=o[j],o[j]=p,o.pop()}}else for(m=--c,n=b[m],e[n.uuid]=k,b[k]=n,b.pop(),l=0,n=g;l!==n;++l)o=f[l],o[k]=o[m],o.pop()}this.nCachedObjects_=d},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,i=this.nCachedObjects_,j=Array(h.length),d=e.length;for(c[a]=d,f.push(a),g.push(b),e.push(j),c=i,d=h.length;c!==d;++c)j[c]=new THREE.PropertyBinding(h[c],a,b);return j},unsubscribe_:function(a){var b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c,f[c]=h,f.pop(),e[c]=e[g],e.pop(),d[c]=d[g],d.pop()}}},THREE.AnimationUtils={arraySlice:function(a,b,c){return THREE.AnimationUtils.isTypedArray(a)?new a.constructor(a.subarray(b,c)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;return c.sort(function(b,c){return a[b]-a[c]}),c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,i=0;i!==b;++i)e[g++]=a[h+i];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f)}else do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}}},THREE.KeyframeTrack=function(a,b,c,d){if(void 0===a)throw Error("track name is undefined");if(void 0===b||0===b.length)throw Error("no keyframes in track named "+a);this.name=a,this.times=THREE.AnimationUtils.convertArray(b,this.TimeBufferType),this.values=THREE.AnimationUtils.convertArray(c,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation),this.validate(),this.optimize()},THREE.KeyframeTrack.prototype={constructor:THREE.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(a){return new THREE.DiscreteInterpolant(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new THREE.LinearInterpolant(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new THREE.CubicInterpolant(this.times,this.values,this.getValueSize(),a)},setInterpolation:function(a){var b=void 0;switch(a){case THREE.InterpolateDiscrete:b=this.InterpolantFactoryMethodDiscrete;break;case THREE.InterpolateLinear:b=this.InterpolantFactoryMethodLinear;break;case THREE.InterpolateSmooth:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){if(b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(a===this.DefaultInterpolation)throw Error(b);this.setInterpolation(this.DefaultInterpolation)}console.warn(b)}else this.createInterpolant=b},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return THREE.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return THREE.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return THREE.InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},trim:function(a,b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;return++f,0===e&&f===d||(e>=f&&(f=Math.max(f,1),e=f-1),d=this.getValueSize(),this.times=THREE.AnimationUtils.arraySlice(c,e,f),this.values=THREE.AnimationUtils.arraySlice(this.values,e*d,f*d)),this},validate:function(){var a=!0,b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("invalid value size in track",this),a=!1);var c=this.times,b=this.values,d=c.length;0===d&&(console.error("track is empty",this),a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"==typeof g&&isNaN(g)){console.error("time is not a valid number",this,f,g),a=!1;break}if(null!==e&&e>g){console.error("out of order keys",this,f,g,e),a=!1;break}e=g}if(void 0!==b&&THREE.AnimationUtils.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(d=b[f],isNaN(d)){console.error("value is not a valid number",this,f,d),a=!1;break}return a},optimize:function(){for(var a=this.times,b=this.values,c=this.getValueSize(),d=1,e=1,f=a.length-1;e<=f;++e){var g=!1,h=a[e];if(h!==a[e+1]&&(1!==e||h!==h[0]))for(var i=e*c,j=i-c,k=i+c,h=0;h!==c;++h){var l=b[i+h];if(l!==b[j+h]||l!==b[k+h]){g=!0;break}}if(g){if(e!==d)for(a[d]=a[e],g=e*c,i=d*c,h=0;h!==c;++h)b[i+h]=b[g+h];++d}}return d!==a.length&&(this.times=THREE.AnimationUtils.arraySlice(a,0,d),this.values=THREE.AnimationUtils.arraySlice(b,0,d*c)),this}},Object.assign(THREE.KeyframeTrack,{parse:function(a){if(void 0===a.type)throw Error("track type undefined, can not parse");var b=THREE.KeyframeTrack._getTrackTypeForValueTypeName(a.type);if(void 0===a.times){console.warn("legacy JSON format detected, converting");var c=[],d=[];THREE.AnimationUtils.flattenJSON(a.keys,c,d,"value"),a.times=c,a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)},toJSON:function(a){var b=a.constructor;if(void 0!==b.toJSON)b=b.toJSON(a);else{var b={name:a.name,times:THREE.AnimationUtils.convertArray(a.times,Array),values:THREE.AnimationUtils.convertArray(a.values,Array)},c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}return b.type=a.ValueTypeName,b},_getTrackTypeForValueTypeName:function(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return THREE.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return THREE.VectorKeyframeTrack;case"color":return THREE.ColorKeyframeTrack;case"quaternion":return THREE.QuaternionKeyframeTrack;case"bool":case"boolean":return THREE.BooleanKeyframeTrack;case"string":return THREE.StringKeyframeTrack}throw Error("Unsupported typeName: "+a)}}),THREE.PropertyBinding=function(a,b,c){this.path=b,this.parsedPath=c||THREE.PropertyBinding.parseTrackName(b),this.node=THREE.PropertyBinding.findNode(a,this.parsedPath.nodeName)||a,this.rootNode=a},THREE.PropertyBinding.prototype={constructor:THREE.PropertyBinding,getValue:function(a,b){this.bind(),this.getValue(a,b)},setValue:function(a,b){this.bind(),this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;
if(a||(this.node=a=THREE.PropertyBinding.findNode(this.rootNode,b.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,a){if(c){var f=b.objectIndex;switch(c){case"materials":if(!a.material)return void console.error("  can not bind to material as node does not have a material",this);if(!a.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);a=a.material.materials;break;case"bones":if(!a.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);for(a=a.skeleton.bones,c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c])return void console.error("  can not bind to objectName of node, undefined",this);a=a[c]}if(void 0!==f){if(void 0===a[f])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,a);a=a[f]}}if(f=a[d]){if(b=this.Versioning.None,void 0!==a.needsUpdate?(b=this.Versioning.NeedsUpdate,this.targetObject=a):void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=a),c=this.BindingType.Direct,void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!a.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}c=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):void 0!==f.length?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}else console.error("  trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a)}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(THREE.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:THREE.PropertyBinding.prototype.getValue,_setValue_unbound:THREE.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)a[b++]=c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.node[this.propertyName]=a[b]},function(a,b){this.node[this.propertyName]=a[b],this.targetObject.needsUpdate=!0},function(a,b){this.node[this.propertyName]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),THREE.PropertyBinding.Composite=function(a,b,c){c=c||THREE.PropertyBinding.parseTrackName(b),this._targetGroup=a,this._bindings=a.subscribe_(b,c)},THREE.PropertyBinding.Composite.prototype={constructor:THREE.PropertyBinding.Composite,getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)},setValue:function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)},bind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}},THREE.PropertyBinding.create=function(a,b,c){return a instanceof THREE.AnimationObjectGroup?new THREE.PropertyBinding.Composite(a,b,c):new THREE.PropertyBinding(a,b,c)},THREE.PropertyBinding.parseTrackName=function(a){var b=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,c=b.exec(a);if(!c)throw Error("cannot parse trackName at all: "+a);if(c.index===b.lastIndex&&b.lastIndex++,b={nodeName:c[3],objectName:c[5],objectIndex:c[7],propertyName:c[9],propertyIndex:c[11]},null===b.propertyName||0===b.propertyName.length)throw Error("can not parse propertyName from trackName: "+a);return b},THREE.PropertyBinding.findNode=function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var c=function(a){for(var c=0;c<a.bones.length;c++){var d=a.bones[c];if(d.name===b)return d}return null}(a.skeleton);if(c)return c}if(a.children){var d=function(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null};if(c=d(a.children))return c}return null},THREE.PropertyMixer=function(a,b,c){switch(this.binding=a,this.valueSize=c,a=Float64Array,b){case"quaternion":b=this._slerp;break;case"string":case"bool":a=Array,b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c),this._mixBufferRegion=b,this.referenceCount=this.useCount=this.cumulativeWeight=0},THREE.PropertyMixer.prototype={constructor:THREE.PropertyMixer,accumulate:function(a,b){var c=this.buffer,d=this.valueSize,e=a*d+d,f=this.cumulativeWeight;if(0===f){for(f=0;f!==d;++f)c[e+f]=c[f];f=b}else f+=b,this._mixBufferRegion(c,e,0,b/f,d);this.cumulativeWeight=f},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;this.cumulativeWeight=0,1>d&&this._mixBufferRegion(c,a,3*b,1-d,b);for(var d=b,f=b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d,e){THREE.Quaternion.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+g]*d}}},THREE.BooleanKeyframeTrack=function(a,b,c){THREE.KeyframeTrack.call(this,a,b,c)},THREE.BooleanKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:THREE.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),THREE.NumberKeyframeTrack=function(a,b,c,d){THREE.KeyframeTrack.call(this,a,b,c,d)},THREE.NumberKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.NumberKeyframeTrack,ValueTypeName:"number"}),THREE.QuaternionKeyframeTrack=function(a,b,c,d){THREE.KeyframeTrack.call(this,a,b,c,d)},THREE.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodLinear:function(a){return new THREE.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0}),THREE.StringKeyframeTrack=function(a,b,c,d){THREE.KeyframeTrack.call(this,a,b,c,d)},THREE.StringKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:THREE.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),THREE.VectorKeyframeTrack=function(a,b,c,d){THREE.KeyframeTrack.call(this,a,b,c,d)},THREE.VectorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.VectorKeyframeTrack,ValueTypeName:"vector"}),THREE.Audio=function(a){THREE.Object3D.call(this),this.type="Audio",this.context=a.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(a.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filter=null},THREE.Audio.prototype=Object.create(THREE.Object3D.prototype),THREE.Audio.prototype.constructor=THREE.Audio,THREE.Audio.prototype.getOutput=function(){return this.gain},THREE.Audio.prototype.load=function(a){var b=new THREE.AudioBuffer(this.context);return b.load(a),this.setBuffer(b),this},THREE.Audio.prototype.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},THREE.Audio.prototype.setBuffer=function(a){var b=this;return a.onReady(function(a){b.source.buffer=a,b.sourceType="buffer",b.autoplay&&b.play()}),this},THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var a=this.context.createBufferSource();a.buffer=this.source.buffer,a.loop=this.source.loop,a.onended=this.source.onended,a.start(0,this.startTime),a.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=a,this.connect()}},THREE.Audio.prototype.pause=function(){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime)},THREE.Audio.prototype.stop=function(){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0)},THREE.Audio.prototype.connect=function(){null!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.getOutput())):this.source.connect(this.getOutput())},THREE.Audio.prototype.disconnect=function(){null!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput())):this.source.disconnect(this.getOutput())},THREE.Audio.prototype.getFilter=function(){return this.filter},THREE.Audio.prototype.setFilter=function(a){void 0===a&&(a=null),!0===this.isPlaying?(this.disconnect(),this.filter=a,this.connect()):this.filter=a},THREE.Audio.prototype.setPlaybackRate=function(a){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=a,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate))},THREE.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1},THREE.Audio.prototype.setLoop=function(a){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):this.source.loop=a},THREE.Audio.prototype.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},THREE.Audio.prototype.setVolume=function(a){this.gain.gain.value=a},THREE.Audio.prototype.getVolume=function(){return this.gain.gain.value},THREE.AudioAnalyser=function(a,b){this.analyser=a.context.createAnalyser(),this.analyser.fftSize=void 0!==b?b:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),a.getOutput().connect(this.analyser)},THREE.AudioAnalyser.prototype={constructor:THREE.AudioAnalyser,getData:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},THREE.AudioBuffer=function(a){this.context=a,this.ready=!1,this.readyCallbacks=[]},THREE.AudioBuffer.prototype.load=function(a){var b=this,c=new XMLHttpRequest;return c.open("GET",a,!0),c.responseType="arraybuffer",c.onload=function(a){b.context.decodeAudioData(this.response,function(a){for(b.buffer=a,b.ready=!0,a=0;a<b.readyCallbacks.length;a++)b.readyCallbacks[a](b.buffer);b.readyCallbacks=[]})},c.send(),this},THREE.AudioBuffer.prototype.onReady=function(a){this.ready?a(this.buffer):this.readyCallbacks.push(a)},THREE.PositionalAudio=function(a){THREE.Audio.call(this,a),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},THREE.PositionalAudio.prototype=Object.create(THREE.Audio.prototype),THREE.PositionalAudio.prototype.constructor=THREE.PositionalAudio,THREE.PositionalAudio.prototype.getOutput=function(){return this.panner},THREE.PositionalAudio.prototype.setRefDistance=function(a){this.panner.refDistance=a},THREE.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance},THREE.PositionalAudio.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a},THREE.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},THREE.PositionalAudio.prototype.setDistanceModel=function(a){this.panner.distanceModel=a},THREE.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel},THREE.PositionalAudio.prototype.setMaxDistance=function(a){this.panner.maxDistance=a},THREE.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance},THREE.PositionalAudio.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3;return function(b){THREE.Object3D.prototype.updateMatrixWorld.call(this,b),a.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(a.x,a.y,a.z)}}(),THREE.AudioListener=function(){THREE.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype),THREE.AudioListener.prototype.constructor=THREE.AudioListener,THREE.AudioListener.prototype.getInput=function(){return this.gain},THREE.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},THREE.AudioListener.prototype.setFilter=function(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},THREE.AudioListener.prototype.getFilter=function(){return this.filter},THREE.AudioListener.prototype.setMasterVolume=function(a){this.gain.gain.value=a},THREE.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value},THREE.AudioListener.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3;return function(e){THREE.Object3D.prototype.updateMatrixWorld.call(this,e),e=this.context.listener;var f=this.up;this.matrixWorld.decompose(a,b,c),d.set(0,0,-1).applyQuaternion(b),e.setPosition(a.x,a.y,a.z),e.setOrientation(d.x,d.y,d.z,f.x,f.y,f.z)}}(),THREE.Camera=function(){THREE.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.getWorldDirection=function(){var a=new THREE.Quaternion;return function(b){return b=b||new THREE.Vector3,this.getWorldQuaternion(a),b.set(0,0,-1).applyQuaternion(a)}}(),THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up),this.quaternion.setFromRotationMatrix(a)}}(),THREE.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.Camera.prototype.copy=function(a){return THREE.Object3D.prototype.copy.call(this,a),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this},THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this),this.type="CubeCamera";var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0),d.lookAt(new THREE.Vector3(1,0,0)),this.add(d);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0),e.lookAt(new THREE.Vector3((-1),0,0)),this.add(e);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,1),f.lookAt(new THREE.Vector3(0,1,0)),this.add(f);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,-1),g.lookAt(new THREE.Vector3(0,(-1),0)),this.add(g);var h=new THREE.PerspectiveCamera(90,1,a,b);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,1)),this.add(h);var i=new THREE.PerspectiveCamera(90,1,a,b);i.up.set(0,-1,0),i.lookAt(new THREE.Vector3(0,0,(-1))),this.add(i),this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,j=c.texture.generateMipmaps;c.texture.generateMipmaps=!1,c.activeCubeFace=0,a.render(b,d,c),c.activeCubeFace=1,a.render(b,e,c),c.activeCubeFace=2,a.render(b,f,c),c.activeCubeFace=3,a.render(b,g,c),c.activeCubeFace=4,a.render(b,h,c),c.texture.generateMipmaps=j,c.activeCubeFace=5,a.render(b,i,c),a.setRenderTarget(null)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CubeCamera.prototype.constructor=THREE.CubeCamera,THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=a,this.right=b,this.top=c,this.bottom=d,this.near=void 0!==e?e:.1,this.far=void 0!==f?f:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(c-a,c+a,d+b,d-b,this.near,this.far)},THREE.OrthographicCamera.prototype.copy=function(a){return THREE.Camera.prototype.copy.call(this,a),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this},THREE.OrthographicCamera.prototype.toJSON=function(a){return a=THREE.Object3D.prototype.toJSON.call(this,a),a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,a},THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this),this.type="PerspectiveCamera",this.focalLength=10,this.zoom=1,this.fov=void 0!==a?a:50,this.aspect=void 0!==b?b:1,this.near=void 0!==c?c:.1,this.far=void 0!==d?d:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24),this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a,this.fullHeight=b,this.x=c,this.y=d,this.width=e,this.height=f,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var b=this.fullWidth/this.fullHeight,a=Math.tan(THREE.Math.degToRad(.5*a))*this.near,c=-a,d=b*c,b=Math.abs(b*a-d),c=Math.abs(a-c);this.projectionMatrix.makeFrustum(d+this.x*b/this.fullWidth,d+(this.x+this.width)*b/this.fullWidth,a-(this.y+this.height)*c/this.fullHeight,a-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(a,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.copy=function(a){return THREE.Camera.prototype.copy.call(this,a),this.focalLength=a.focalLength,this.zoom=a.zoom,this.fov=a.fov,this.aspect=a.aspect,this.near=a.near,this.far=a.far,this},THREE.PerspectiveCamera.prototype.toJSON=function(a){return a=THREE.Object3D.prototype.toJSON.call(this,a),a.object.focalLength=this.focalLength,a.object.zoom=this.zoom,a.object.fov=this.fov,a.object.aspect=this.aspect,a.object.near=this.near,a.object.far=this.far,a},THREE.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new THREE.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new THREE.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},THREE.StereoCamera.prototype={constructor:THREE.StereoCamera,update:function(){var a,b,c,d,e,f=new THREE.Matrix4,g=new THREE.Matrix4;return function(h){if(a!==h.focalLength||b!==h.fov||c!==h.aspect*this.aspect||d!==h.near||e!==h.far){a=h.focalLength,b=h.fov,c=h.aspect*this.aspect,d=h.near,e=h.far;var i,j,k=h.projectionMatrix.clone(),l=.032*d/a,m=d*Math.tan(THREE.Math.degToRad(.5*b));g.elements[12]=-.032,f.elements[12]=.032,i=-m*c+l,j=m*c+l,k.elements[0]=2*d/(j-i),k.elements[8]=(j+i)/(j-i),this.cameraL.projectionMatrix.copy(k),i=-m*c-l,j=m*c-l,k.elements[0]=2*d/(j-i),k.elements[8]=(j+i)/(j-i),this.cameraR.projectionMatrix.copy(k)}this.cameraL.matrixWorld.copy(h.matrixWorld).multiply(g),this.cameraR.matrixWorld.copy(h.matrixWorld).multiply(f)}}()},THREE.Light=function(a,b){THREE.Object3D.call(this),this.type="Light",this.color=new THREE.Color(a),this.intensity=void 0!==b?b:1,this.receiveShadow=void 0},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.copy=function(a){return THREE.Object3D.prototype.copy.call(this,a),this.color.copy(a.color),this.intensity=a.intensity,this},THREE.Light.prototype.toJSON=function(a){return a=THREE.Object3D.prototype.toJSON.call(this,a),a.object.color=this.color.getHex(),a.object.intensity=this.intensity,void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(a.object.distance=this.distance),void 0!==this.angle&&(a.object.angle=this.angle),void 0!==this.decay&&(a.object.decay=this.decay),void 0!==this.penumbra&&(a.object.penumbra=this.penumbra),a},THREE.LightShadow=function(a){this.camera=a,this.bias=0,this.radius=1,this.mapSize=new THREE.Vector2(512,512),this.map=null,this.matrix=new THREE.Matrix4},THREE.LightShadow.prototype={constructor:THREE.LightShadow,copy:function(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this},clone:function(){return(new this.constructor).copy(this)}},THREE.AmbientLight=function(a,b){THREE.Light.call(this,a,b),this.type="AmbientLight",this.castShadow=void 0},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a,b),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new THREE.Object3D,this.shadow=new THREE.LightShadow(new THREE.OrthographicCamera((-5),5,5,(-5),.5,500))},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.DirectionalLight.prototype.copy=function(a){return THREE.Light.prototype.copy.call(this,a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this},THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a,c),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new THREE.Color(b)},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight,THREE.HemisphereLight.prototype.copy=function(a){return THREE.Light.prototype.copy.call(this,a),this.groundColor.copy(a.groundColor),this},THREE.PointLight=function(a,b,c,d){THREE.Light.call(this,a,b),this.type="PointLight",this.distance=void 0!==c?c:0,this.decay=void 0!==d?d:1,this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(90,1,.5,500))},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.constructor=THREE.PointLight,Object.defineProperty(THREE.PointLight.prototype,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}}),THREE.PointLight.prototype.copy=function(a){return THREE.Light.prototype.copy.call(this,a),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this},THREE.SpotLight=function(a,b,c,d,e,f){THREE.Light.call(this,a,b),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new THREE.Object3D,this.distance=void 0!==c?c:0,this.angle=void 0!==d?d:Math.PI/3,this.penumbra=void 0!==e?e:0,this.decay=void 0!==f?f:1,this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(50,1,.5,500))},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.constructor=THREE.SpotLight,Object.defineProperty(THREE.SpotLight.prototype,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}}),THREE.SpotLight.prototype.copy=function(a){return THREE.Light.prototype.copy.call(this,a),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this},THREE.Cache={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}},THREE.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,extractUrlBase:function(a){return a=a.split("/"),1===a.length?"./":(a.pop(),a.join("/")+"/")},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a,b,c;return function(d,e,f){function g(a,c,d,g,h){a=e+a;var j=THREE.Loader.Handlers.get(a);return null!==j?a=j.load(a):(b.setCrossOrigin(f),a=b.load(a)),void 0!==c&&(a.repeat.fromArray(c),1!==c[0]&&(a.wrapS=THREE.RepeatWrapping),1!==c[1]&&(a.wrapT=THREE.RepeatWrapping)),void 0!==d&&a.offset.fromArray(d),void 0!==g&&("repeat"===g[0]&&(a.wrapS=THREE.RepeatWrapping),"mirror"===g[0]&&(a.wrapS=THREE.MirroredRepeatWrapping),"repeat"===g[1]&&(a.wrapT=THREE.RepeatWrapping),"mirror"===g[1]&&(a.wrapT=THREE.MirroredRepeatWrapping)),void 0!==h&&(a.anisotropy=h),c=THREE.Math.generateUUID(),i[c]=a,c}void 0===a&&(a=new THREE.Color),void 0===b&&(b=new THREE.TextureLoader),void 0===c&&(c=new THREE.MaterialLoader);var h,i={},j={uuid:THREE.Math.generateUUID(),type:"MeshLambertMaterial"};for(h in d){var k=d[h];switch(h){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":j.name=k;break;case"blending":j.blending=THREE[k];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",h,"is no longer supported.");break;case"colorDiffuse":j.color=a.fromArray(k).getHex();break;case"colorSpecular":j.specular=a.fromArray(k).getHex();break;case"colorEmissive":j.emissive=a.fromArray(k).getHex();break;case"specularCoef":j.shininess=k;break;case"shading":"basic"===k.toLowerCase()&&(j.type="MeshBasicMaterial"),"phong"===k.toLowerCase()&&(j.type="MeshPhongMaterial");break;case"mapDiffuse":j.map=g(k,d.mapDiffuseRepeat,d.mapDiffuseOffset,d.mapDiffuseWrap,d.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":j.lightMap=g(k,d.mapLightRepeat,d.mapLightOffset,d.mapLightWrap,d.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":j.aoMap=g(k,d.mapAORepeat,d.mapAOOffset,d.mapAOWrap,d.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":j.bumpMap=g(k,d.mapBumpRepeat,d.mapBumpOffset,d.mapBumpWrap,d.mapBumpAnisotropy);break;case"mapBumpScale":j.bumpScale=k;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":j.normalMap=g(k,d.mapNormalRepeat,d.mapNormalOffset,d.mapNormalWrap,d.mapNormalAnisotropy);break;case"mapNormalFactor":j.normalScale=[k,k];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":j.specularMap=g(k,d.mapSpecularRepeat,d.mapSpecularOffset,d.mapSpecularWrap,d.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":j.alphaMap=g(k,d.mapAlphaRepeat,d.mapAlphaOffset,d.mapAlphaWrap,d.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":j.side=THREE.BackSide;break;case"doubleSided":j.side=THREE.DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),j.opacity=k;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":j[h]=k;break;case"vertexColors":!0===k&&(j.vertexColors=THREE.VertexColors),"face"===k&&(j.vertexColors=THREE.FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",h,k)}}return"MeshBasicMaterial"===j.type&&delete j.emissive,"MeshPhongMaterial"!==j.type&&delete j.specular,1>j.opacity&&(j.transparent=!0),c.setTextures(i),c.parse(j)}}()},THREE.Loader.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}},THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,d){void 0!==this.path&&(a=this.path+a);var e=this,f=THREE.Cache.get(a);if(void 0!==f)return b&&setTimeout(function(){b(f)},0),f;var g=new XMLHttpRequest;return g.overrideMimeType("text/plain"),g.open("GET",a,!0),g.addEventListener("load",function(c){var f=c.target.response;THREE.Cache.add(a,f),200===this.status?(b&&b(f),e.manager.itemEnd(a)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),b&&b(f),e.manager.itemEnd(a)):(d&&d(c),e.manager.itemError(a))},!1),void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1),g.addEventListener("error",function(b){d&&d(b),e.manager.itemError(a)},!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.send(null),e.manager.itemStart(a),g},setPath:function(a){this.path=a},setResponseType:function(a){this.responseType=a},setWithCredentials:function(a){this.withCredentials=a}},THREE.FontLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.FontLoader.prototype={constructor:THREE.FontLoader,load:function(a,b,c,d){new THREE.XHRLoader(this.manager).load(a,function(a){
b(new THREE.Font(JSON.parse(a.substring(65,a.length-2))))},c,d)}},THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,d){void 0!==this.path&&(a=this.path+a);var e=this,f=THREE.Cache.get(a);if(void 0!==f)return e.manager.itemStart(a),b?setTimeout(function(){b(f),e.manager.itemEnd(a)},0):e.manager.itemEnd(a),f;var g=document.createElement("img");return g.addEventListener("load",function(c){THREE.Cache.add(a,this),b&&b(this),e.manager.itemEnd(a)},!1),void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1),g.addEventListener("error",function(b){d&&d(b),e.manager.itemError(a)},!1),void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),e.manager.itemStart(a),g.src=a,g},setCrossOrigin:function(a){this.crossOrigin=a},setPath:function(a){this.path=a}},THREE.JSONLoader=function(a){"boolean"==typeof a&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),a=void 0),this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this.withCredentials=!1},THREE.JSONLoader.prototype={constructor:THREE.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(a,b,c,d){var e=this,f=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:THREE.Loader.prototype.extractUrlBase(a),g=new THREE.XHRLoader(this.manager);g.setWithCredentials(this.withCredentials),g.load(a,function(c){c=JSON.parse(c);var d=c.metadata;if(void 0!==d&&(d=d.type,void 0!==d)){if("object"===d.toLowerCase())return void console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.");if("scene"===d.toLowerCase())return void console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.SceneLoader instead.")}c=e.parse(c,f),b(c.geometry,c.materials)},c,d)},setTexturePath:function(a){this.texturePath=a},parse:function(a,b){var c=new THREE.Geometry,d=void 0!==a.scale?1/a.scale:1;return function(b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=a.faces;i=a.vertices;var r=a.normals,s=a.colors,t=0;if(void 0!==a.uvs){for(d=0;d<a.uvs.length;d++)a.uvs[d].length&&t++;for(d=0;d<t;d++)c.faceVertexUvs[d]=[]}for(g=0,h=i.length;g<h;)d=new THREE.Vector3,d.x=i[g++]*b,d.y=i[g++]*b,d.z=i[g++]*b,c.vertices.push(d);for(g=0,h=q.length;g<h;)if(b=q[g++],l=1&b,f=2&b,d=8&b,j=16&b,m=32&b,i=64&b,b&=128,l){if(l=new THREE.Face3,l.a=q[g],l.b=q[g+1],l.c=q[g+3],n=new THREE.Face3,n.a=q[g+1],n.b=q[g+2],n.c=q[g+3],g+=4,f&&(f=q[g++],l.materialIndex=f,n.materialIndex=f),f=c.faces.length,d)for(d=0;d<t;d++)for(o=a.uvs[d],c.faceVertexUvs[d][f]=[],c.faceVertexUvs[d][f+1]=[],e=0;4>e;e++)k=q[g++],p=o[2*k],k=o[2*k+1],p=new THREE.Vector2(p,k),2!==e&&c.faceVertexUvs[d][f].push(p),0!==e&&c.faceVertexUvs[d][f+1].push(p);if(j&&(j=3*q[g++],l.normal.set(r[j++],r[j++],r[j]),n.normal.copy(l.normal)),m)for(d=0;4>d;d++)j=3*q[g++],m=new THREE.Vector3(r[j++],r[j++],r[j]),2!==d&&l.vertexNormals.push(m),0!==d&&n.vertexNormals.push(m);if(i&&(i=q[g++],i=s[i],l.color.setHex(i),n.color.setHex(i)),b)for(d=0;4>d;d++)i=q[g++],i=s[i],2!==d&&l.vertexColors.push(new THREE.Color(i)),0!==d&&n.vertexColors.push(new THREE.Color(i));c.faces.push(l),c.faces.push(n)}else{if(l=new THREE.Face3,l.a=q[g++],l.b=q[g++],l.c=q[g++],f&&(f=q[g++],l.materialIndex=f),f=c.faces.length,d)for(d=0;d<t;d++)for(o=a.uvs[d],c.faceVertexUvs[d][f]=[],e=0;3>e;e++)k=q[g++],p=o[2*k],k=o[2*k+1],p=new THREE.Vector2(p,k),c.faceVertexUvs[d][f].push(p);if(j&&(j=3*q[g++],l.normal.set(r[j++],r[j++],r[j])),m)for(d=0;3>d;d++)j=3*q[g++],m=new THREE.Vector3(r[j++],r[j++],r[j]),l.vertexNormals.push(m);if(i&&(i=q[g++],l.color.setHex(s[i])),b)for(d=0;3>d;d++)i=q[g++],l.vertexColors.push(new THREE.Color(s[i]));c.faces.push(l)}}(d),function(){var b=void 0!==a.influencesPerVertex?a.influencesPerVertex:2;if(a.skinWeights)for(var d=0,e=a.skinWeights.length;d<e;d+=b)c.skinWeights.push(new THREE.Vector4(a.skinWeights[d],1<b?a.skinWeights[d+1]:0,2<b?a.skinWeights[d+2]:0,3<b?a.skinWeights[d+3]:0));if(a.skinIndices)for(d=0,e=a.skinIndices.length;d<e;d+=b)c.skinIndices.push(new THREE.Vector4(a.skinIndices[d],1<b?a.skinIndices[d+1]:0,2<b?a.skinIndices[d+2]:0,3<b?a.skinIndices[d+3]:0));c.bones=a.bones,c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.")}(),function(b){if(void 0!==a.morphTargets)for(var d=0,e=a.morphTargets.length;d<e;d++){c.morphTargets[d]={},c.morphTargets[d].name=a.morphTargets[d].name,c.morphTargets[d].vertices=[];for(var f=c.morphTargets[d].vertices,g=a.morphTargets[d].vertices,h=0,i=g.length;h<i;h+=3){var j=new THREE.Vector3;j.x=g[h]*b,j.y=g[h+1]*b,j.z=g[h+2]*b,f.push(j)}}if(void 0!==a.morphColors&&0<a.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),b=c.faces,f=a.morphColors[0].colors,d=0,e=b.length;d<e;d++)b[d].color.fromArray(f,3*d)}(d),function(){var b=[],d=[];void 0!==a.animation&&d.push(a.animation),void 0!==a.animations&&(a.animations.length?d=d.concat(a.animations):d.push(a.animations));for(var e=0;e<d.length;e++){var f=THREE.AnimationClip.parseAnimation(d[e],c.bones);f&&b.push(f)}c.morphTargets&&(d=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(c.morphTargets,10),b=b.concat(d)),0<b.length&&(c.animations=b)}(),c.computeFaceNormals(),c.computeBoundingSphere(),void 0===a.materials||0===a.materials.length?{geometry:c}:(d=THREE.Loader.prototype.initMaterials(a.materials,b,this.crossOrigin),{geometry:c,materials:d})}},THREE.LoadingManager=function(a,b,c){var d=this,e=!1,f=0,g=0;this.onStart=void 0,this.onLoad=a,this.onProgress=b,this.onError=c,this.itemStart=function(a){g++,!1===e&&void 0!==d.onStart&&d.onStart(a,f,g),e=!0},this.itemEnd=function(a){f++,void 0!==d.onProgress&&d.onProgress(a,f,g),f===g&&(e=!1,void 0!==d.onLoad)&&d.onLoad()},this.itemError=function(a){void 0!==d.onError&&d.onError(a)}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(a,b,c,d){var e=this;new THREE.XHRLoader(e.manager).load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){var b=new THREE.BufferGeometry,c=a.data.index,d={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};void 0!==c&&(c=new d[c.type](c.array),b.setIndex(new THREE.BufferAttribute(c,1)));var e,f=a.data.attributes;for(e in f){var g=f[e],c=new d[g.type](g.array);b.addAttribute(e,new THREE.BufferAttribute(c,g.itemSize))}if(d=a.data.groups||a.data.drawcalls||a.data.offsets,void 0!==d)for(e=0,c=d.length;e!==c;++e)f=d[e],b.addGroup(f.start,f.count,f.materialIndex);return a=a.data.boundingSphere,void 0!==a&&(d=new THREE.Vector3,void 0!==a.center&&d.fromArray(a.center),b.boundingSphere=new THREE.Sphere(d,a.radius)),b}},THREE.MaterialLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this.textures={}},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(a,b,c,d){var e=this;new THREE.XHRLoader(e.manager).load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setTextures:function(a){this.textures=a},getTexture:function(a){var b=this.textures;return void 0===b[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a),b[a]},parse:function(a){var b=new THREE[a.type];if(void 0!==a.uuid&&(b.uuid=a.uuid),void 0!==a.name&&(b.name=a.name),void 0!==a.color&&b.color.setHex(a.color),void 0!==a.roughness&&(b.roughness=a.roughness),void 0!==a.metalness&&(b.metalness=a.metalness),void 0!==a.emissive&&b.emissive.setHex(a.emissive),void 0!==a.specular&&b.specular.setHex(a.specular),void 0!==a.shininess&&(b.shininess=a.shininess),void 0!==a.uniforms&&(b.uniforms=a.uniforms),void 0!==a.vertexShader&&(b.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(b.fragmentShader=a.fragmentShader),void 0!==a.vertexColors&&(b.vertexColors=a.vertexColors),void 0!==a.shading&&(b.shading=a.shading),void 0!==a.blending&&(b.blending=a.blending),void 0!==a.side&&(b.side=a.side),void 0!==a.opacity&&(b.opacity=a.opacity),void 0!==a.transparent&&(b.transparent=a.transparent),void 0!==a.alphaTest&&(b.alphaTest=a.alphaTest),void 0!==a.depthTest&&(b.depthTest=a.depthTest),void 0!==a.depthWrite&&(b.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(b.colorWrite=a.colorWrite),void 0!==a.wireframe&&(b.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(b.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.size&&(b.size=a.size),void 0!==a.sizeAttenuation&&(b.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(b.map=this.getTexture(a.map)),void 0!==a.alphaMap&&(b.alphaMap=this.getTexture(a.alphaMap),b.transparent=!0),void 0!==a.bumpMap&&(b.bumpMap=this.getTexture(a.bumpMap)),void 0!==a.bumpScale&&(b.bumpScale=a.bumpScale),void 0!==a.normalMap&&(b.normalMap=this.getTexture(a.normalMap)),void 0!==a.normalScale){var c=a.normalScale;!1===Array.isArray(c)&&(c=[c,c]),b.normalScale=(new THREE.Vector2).fromArray(c)}if(void 0!==a.displacementMap&&(b.displacementMap=this.getTexture(a.displacementMap)),void 0!==a.displacementScale&&(b.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(b.displacementBias=a.displacementBias),void 0!==a.roughnessMap&&(b.roughnessMap=this.getTexture(a.roughnessMap)),void 0!==a.metalnessMap&&(b.metalnessMap=this.getTexture(a.metalnessMap)),void 0!==a.emissiveMap&&(b.emissiveMap=this.getTexture(a.emissiveMap)),void 0!==a.emissiveIntensity&&(b.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(b.specularMap=this.getTexture(a.specularMap)),void 0!==a.envMap&&(b.envMap=this.getTexture(a.envMap),b.combine=THREE.MultiplyOperation),a.reflectivity&&(b.reflectivity=a.reflectivity),void 0!==a.lightMap&&(b.lightMap=this.getTexture(a.lightMap)),void 0!==a.lightMapIntensity&&(b.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(b.aoMap=this.getTexture(a.aoMap)),void 0!==a.aoMapIntensity&&(b.aoMapIntensity=a.aoMapIntensity),void 0!==a.materials)for(var c=0,d=a.materials.length;c<d;c++)b.materials.push(this.parse(a.materials[c]));return b}},THREE.ObjectLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this.texturePath=""},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this;new THREE.XHRLoader(e.manager).load(a,function(a){e.parse(JSON.parse(a),b)},c,d)},setTexturePath:function(a){this.texturePath=a},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a,b){var c=this.parseGeometries(a.geometries),d=this.parseImages(a.images,function(){void 0!==b&&b(e)}),d=this.parseTextures(a.textures,d),d=this.parseMaterials(a.materials,d),e=this.parseObject(a.object,c,d);return a.animations&&(e.animations=this.parseAnimations(a.animations)),void 0!==a.images&&0!==a.images.length||void 0===b||b(e),e},parseGeometries:function(a){var b={};if(void 0!==a)for(var c=new THREE.JSONLoader,d=new THREE.BufferGeometryLoader,e=0,f=a.length;e<f;e++){var g,h=a[e];switch(h.type){case"PlaneGeometry":case"PlaneBufferGeometry":g=new THREE[h.type](h.width,h.height,h.widthSegments,h.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":g=new THREE[h.type](h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":g=new THREE[h.type](h.radius,h.segments,h.thetaStart,h.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":g=new THREE[h.type](h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":g=new THREE[h.type](h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case"DodecahedronGeometry":g=new THREE.DodecahedronGeometry(h.radius,h.detail);break;case"IcosahedronGeometry":g=new THREE.IcosahedronGeometry(h.radius,h.detail);break;case"OctahedronGeometry":g=new THREE.OctahedronGeometry(h.radius,h.detail);break;case"TetrahedronGeometry":g=new THREE.TetrahedronGeometry(h.radius,h.detail);break;case"RingGeometry":case"RingBufferGeometry":g=new THREE[h.type](h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":g=new THREE[h.type](h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":g=new THREE[h.type](h.radius,h.tube,h.tubularSegments,h.radialSegments,h.p,h.q);break;case"LatheGeometry":g=new THREE.LatheGeometry(h.points,h.segments,h.phiStart,h.phiLength);break;case"BufferGeometry":g=d.parse(h);break;case"Geometry":g=c.parse(h.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}g.uuid=h.uuid,void 0!==h.name&&(g.name=h.name),b[h.uuid]=g}return b},parseMaterials:function(a,b){var c={};if(void 0!==a){var d=new THREE.MaterialLoader;d.setTextures(b);for(var e=0,f=a.length;e<f;e++){var g=d.parse(a[e]);c[g.uuid]=g}}return c},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=THREE.AnimationClip.parse(a[c]);b.push(d)}return b},parseImages:function(a,b){function c(a){return d.manager.itemStart(a),g.load(a,function(){d.manager.itemEnd(a)})}var d=this,e={};if(void 0!==a&&0<a.length){var f=new THREE.LoadingManager(b),g=new THREE.ImageLoader(f);g.setCrossOrigin(this.crossOrigin);for(var f=0,h=a.length;f<h;f++){var i=a[f],j=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(i.url)?i.url:d.texturePath+i.url;e[i.uuid]=c(j)}}return e},parseTextures:function(a,b){function c(a){return"number"==typeof a?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),THREE[a])}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid),void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var h=new THREE.Texture(b[g.image]);h.needsUpdate=!0,h.uuid=g.uuid,void 0!==g.name&&(h.name=g.name),void 0!==g.mapping&&(h.mapping=c(g.mapping)),void 0!==g.offset&&(h.offset=new THREE.Vector2(g.offset[0],g.offset[1])),void 0!==g.repeat&&(h.repeat=new THREE.Vector2(g.repeat[0],g.repeat[1])),void 0!==g.minFilter&&(h.minFilter=c(g.minFilter)),void 0!==g.magFilter&&(h.magFilter=c(g.magFilter)),void 0!==g.anisotropy&&(h.anisotropy=g.anisotropy),Array.isArray(g.wrap)&&(h.wrapS=c(g.wrap[0]),h.wrapT=c(g.wrap[1])),d[g.uuid]=h}return d},parseObject:function(){var a=new THREE.Matrix4;return function(b,c,d){function e(a){return void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",a),c[a]}function f(a){if(void 0!==a)return void 0===d[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),d[a]}var g;switch(b.type){case"Scene":g=new THREE.Scene;break;case"PerspectiveCamera":g=new THREE.PerspectiveCamera(b.fov,b.aspect,b.near,b.far);break;case"OrthographicCamera":g=new THREE.OrthographicCamera(b.left,b.right,b.top,b.bottom,b.near,b.far);break;case"AmbientLight":g=new THREE.AmbientLight(b.color,b.intensity);break;case"DirectionalLight":g=new THREE.DirectionalLight(b.color,b.intensity);break;case"PointLight":g=new THREE.PointLight(b.color,b.intensity,b.distance,b.decay);break;case"SpotLight":g=new THREE.SpotLight(b.color,b.intensity,b.distance,b.angle,b.penumbra,b.decay);break;case"HemisphereLight":g=new THREE.HemisphereLight(b.color,b.groundColor,b.intensity);break;case"Mesh":g=e(b.geometry);var h=f(b.material);g=g.bones&&0<g.bones.length?new THREE.SkinnedMesh(g,h):new THREE.Mesh(g,h);break;case"LOD":g=new THREE.LOD;break;case"Line":g=new THREE.Line(e(b.geometry),f(b.material),b.mode);break;case"PointCloud":case"Points":g=new THREE.Points(e(b.geometry),f(b.material));break;case"Sprite":g=new THREE.Sprite(f(b.material));break;case"Group":g=new THREE.Group;break;default:g=new THREE.Object3D}if(g.uuid=b.uuid,void 0!==b.name&&(g.name=b.name),void 0!==b.matrix?(a.fromArray(b.matrix),a.decompose(g.position,g.quaternion,g.scale)):(void 0!==b.position&&g.position.fromArray(b.position),void 0!==b.rotation&&g.rotation.fromArray(b.rotation),void 0!==b.scale&&g.scale.fromArray(b.scale)),void 0!==b.castShadow&&(g.castShadow=b.castShadow),void 0!==b.receiveShadow&&(g.receiveShadow=b.receiveShadow),void 0!==b.visible&&(g.visible=b.visible),void 0!==b.userData&&(g.userData=b.userData),void 0!==b.children)for(var i in b.children)g.add(this.parseObject(b.children[i],c,d));if("LOD"===b.type)for(b=b.levels,h=0;h<b.length;h++){var j=b[h];i=g.getObjectByProperty("uuid",j.object),void 0!==i&&g.addLevel(i,j.distance)}return g}}()},THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b,c,d){var e=new THREE.Texture,f=new THREE.ImageLoader(this.manager);return f.setCrossOrigin(this.crossOrigin),f.setPath(this.path),f.load(a,function(a){e.image=a,e.needsUpdate=!0,void 0!==b&&b(e)},c,d),e},setCrossOrigin:function(a){this.crossOrigin=a},setPath:function(a){this.path=a}},THREE.CubeTextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.CubeTextureLoader.prototype={constructor:THREE.CubeTextureLoader,load:function(a,b,c,d){function e(c){g.load(a[c],function(a){f.images[c]=a,h++,6===h&&(f.needsUpdate=!0,b&&b(f))},void 0,d)}var f=new THREE.CubeTexture,g=new THREE.ImageLoader(this.manager);g.setCrossOrigin(this.crossOrigin),g.setPath(this.path);var h=0;for(c=0;c<a.length;++c)e(c);return f},setCrossOrigin:function(a){this.crossOrigin=a},setPath:function(a){this.path=a}},THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this._parser=null},THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(a,b,c,d){var e=this,f=new THREE.DataTexture,g=new THREE.XHRLoader(this.manager);return g.setResponseType("arraybuffer"),g.load(a,function(a){(a=e._parser(a))&&(void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:THREE.ClampToEdgeWrapping,f.wrapT=void 0!==a.wrapT?a.wrapT:THREE.ClampToEdgeWrapping,f.magFilter=void 0!==a.magFilter?a.magFilter:THREE.LinearFilter,f.minFilter=void 0!==a.minFilter?a.minFilter:THREE.LinearMipMapLinearFilter,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=THREE.LinearFilter),f.needsUpdate=!0,b&&b(f,a))},c,d),f}},THREE.CompressedTextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this._parser=null},THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(a,b,c,d){function e(e){i.load(a[e],function(a){a=f._parser(a,!0),g[e]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps},j+=1,6===j&&(1===a.mipmapCount&&(h.minFilter=THREE.LinearFilter),h.format=a.format,h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new THREE.CompressedTexture;h.image=g;var i=new THREE.XHRLoader(this.manager);if(i.setPath(this.path),i.setResponseType("arraybuffer"),Array.isArray(a))for(var j=0,k=0,l=a.length;k<l;++k)e(k);else i.load(a,function(a){if(a=f._parser(a,!0),a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var e=0;e<a.mipmapCount;e++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+e]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else h.image.width=a.width,h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=THREE.LinearFilter),h.format=a.format,h.needsUpdate=!0,b&&b(h)},c,d);return h},setPath:function(a){this.path=a}},THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Material",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=THREE.LessEqualDepth,this.colorWrite=this.depthWrite=this.depthTest=!0,this.precision=null,this.polygonOffset=!1,this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.premultipliedAlpha=!1,this.overdraw=0,this._needsUpdate=this.visible=!0},THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update(),this._needsUpdate=a},setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else{var d=this[b];void 0===d?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):d instanceof THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]="overdraw"===b?Number(c):c}}},toJSON:function(a){function b(a){var b,c=[];for(b in a){var d=a[b];delete d.metadata,c.push(d)}return c}var c=void 0===a;c&&(a={textures:{},images:{}});var d={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};return d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color instanceof THREE.Color&&(d.color=this.color.getHex()),.5!==this.roughness&&(d.roughness=this.roughness),.5!==this.metalness&&(d.metalness=this.metalness),this.emissive instanceof THREE.Color&&(d.emissive=this.emissive.getHex()),this.specular instanceof THREE.Color&&(d.specular=this.specular.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),this.map instanceof THREE.Texture&&(d.map=this.map.toJSON(a).uuid),this.alphaMap instanceof THREE.Texture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap instanceof THREE.Texture&&(d.lightMap=this.lightMap.toJSON(a).uuid),this.bumpMap instanceof THREE.Texture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale),this.normalMap instanceof THREE.Texture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalScale=this.normalScale.toArray()),this.displacementMap instanceof THREE.Texture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap instanceof THREE.Texture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap instanceof THREE.Texture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap instanceof THREE.Texture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap instanceof THREE.Texture&&(d.specularMap=this.specularMap.toJSON(a).uuid),this.envMap instanceof THREE.Texture&&(d.envMap=this.envMap.toJSON(a).uuid,d.reflectivity=this.reflectivity),void 0!==this.size&&(d.size=this.size),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==THREE.NoColors&&(d.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==THREE.SmoothShading&&(d.shading=this.shading),void 0!==this.blending&&this.blending!==THREE.NormalBlending&&(d.blending=this.blending),void 0!==this.side&&this.side!==THREE.FrontSide&&(d.side=this.side),1>this.opacity&&(d.opacity=this.opacity),!0===this.transparent&&(d.transparent=this.transparent),0<this.alphaTest&&(d.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),1<this.wireframeLinewidth&&(d.wireframeLinewidth=this.wireframeLinewidth),c&&(c=b(a.textures),a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a)),d},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.name=a.name,this.side=a.side,this.opacity=a.opacity,this.transparent=a.transparent,this.blending=a.blending,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.alphaTest=a.alphaTest,this.premultipliedAlpha=a.premultipliedAlpha,this.overdraw=a.overdraw,this.visible=a.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(a){THREE.Material.call(this),this.type="LineBasicMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.blending=THREE.NormalBlending,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(a)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.LineBasicMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.vertexColors=a.vertexColors,this.fog=a.fog,this},THREE.LineDashedMaterial=function(a){THREE.Material.call(this),this.type="LineDashedMaterial",this.color=new THREE.Color(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.blending=THREE.NormalBlending,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(a)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial,THREE.LineDashedMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this.vertexColors=a.vertexColors,this.fog=a.fog,this},THREE.MeshBasicMaterial=function(a){THREE.Material.call(this),this.type="MeshBasicMaterial",this.color=new THREE.Color(16777215),this.aoMap=this.map=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphTargets=this.skinning=!1,this.setValues(a)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshBasicMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.fog=a.fog,this.shading=a.shading,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.vertexColors=a.vertexColors,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this},THREE.MeshLambertMaterial=function(a){THREE.Material.call(this),this.type="MeshLambertMaterial",this.color=new THREE.Color(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(a)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshLambertMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.fog=a.fog,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.vertexColors=a.vertexColors,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},THREE.MeshPhongMaterial=function(a){THREE.Material.call(this),this.type="MeshPhongMaterial",this.color=new THREE.Color(16777215),this.specular=new THREE.Color(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(a)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshPhongMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.fog=a.fog,this.shading=a.shading,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.vertexColors=a.vertexColors,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},THREE.MeshStandardMaterial=function(a){
THREE.Material.call(this),this.type="MeshStandardMaterial",this.color=new THREE.Color(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(a)},THREE.MeshStandardMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshStandardMaterial.prototype.constructor=THREE.MeshStandardMaterial,THREE.MeshStandardMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=a.refractionRatio,this.fog=a.fog,this.shading=a.shading,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.vertexColors=a.vertexColors,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},THREE.MeshDepthMaterial=function(a){THREE.Material.call(this),this.type="MeshDepthMaterial",this.wireframe=this.morphTargets=!1,this.wireframeLinewidth=1,this.setValues(a)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshDepthMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this},THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(a)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshNormalMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this},THREE.MultiMaterial=function(a){this.uuid=THREE.Math.generateUUID(),this.type="MultiMaterial",this.materials=a instanceof Array?a:[],this.visible=!0},THREE.MultiMaterial.prototype={constructor:THREE.MultiMaterial,toJSON:function(a){for(var b={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},c=this.materials,d=0,e=c.length;d<e;d++){var f=c[d].toJSON(a);delete f.metadata,b.materials.push(f)}return b.visible=this.visible,b},clone:function(){for(var a=new this.constructor,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());return a.visible=this.visible,a}},THREE.PointsMaterial=function(a){THREE.Material.call(this),this.type="PointsMaterial",this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.blending=THREE.NormalBlending,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(a)},THREE.PointsMaterial.prototype=Object.create(THREE.Material.prototype),THREE.PointsMaterial.prototype.constructor=THREE.PointsMaterial,THREE.PointsMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.vertexColors=a.vertexColors,this.fog=a.fog,this},THREE.ShaderMaterial=function(a){THREE.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.ShaderMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=THREE.UniformsUtils.clone(a.uniforms),this.defines=a.defines,this.shading=a.shading,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.fog=a.fog,this.lights=a.lights,this.vertexColors=a.vertexColors,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.extensions=a.extensions,this},THREE.ShaderMaterial.prototype.toJSON=function(a){return a=THREE.Material.prototype.toJSON.call(this,a),a.uniforms=this.uniforms,a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader,a},THREE.RawShaderMaterial=function(a){THREE.ShaderMaterial.call(this,a),this.type="RawShaderMaterial"},THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial,THREE.SpriteMaterial=function(a){THREE.Material.call(this),this.type="SpriteMaterial",this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(a)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial,THREE.SpriteMaterial.prototype.copy=function(a){return THREE.Material.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.rotation=a.rotation,this.fog=a.fog,this},THREE.Texture=function(a,b,c,d,e,f,g,h,i){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++}),this.uuid=THREE.Math.generateUUID(),this.sourceFile=this.name="",this.image=void 0!==a?a:THREE.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==b?b:THREE.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==e?e:THREE.LinearFilter,this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==i?i:1,this.format=void 0!==g?g:THREE.RGBAFormat,this.type=void 0!==h?h:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=THREE.LinearEncoding,this.version=0,this.onUpdate=null},THREE.Texture.DEFAULT_IMAGE=void 0,THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping,THREE.Texture.prototype={constructor:THREE.Texture,set needsUpdate(a){!0===a&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.image=a.image,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.encoding=a.encoding,this},toJSON:function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var b={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var c=this.image;if(void 0===c.uuid&&(c.uuid=THREE.Math.generateUUID()),void 0===a.images[c.uuid]){var d,e=a.images,f=c.uuid,g=c.uuid;void 0!==c.toDataURL?d=c:(d=document.createElement("canvas"),d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0,c.width,c.height)),d=2048<d.width||2048<d.height?d.toDataURL("image/jpeg",.6):d.toDataURL("image/png"),e[f]={uuid:g,url:d}}b.image=c.uuid}return a.textures[this.uuid]=b},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(this.mapping===THREE.UVMapping){if(a.multiply(this.repeat),a.add(this.offset),0>a.x||1<a.x)switch(this.wrapS){case THREE.RepeatWrapping:a.x-=Math.floor(a.x);break;case THREE.ClampToEdgeWrapping:a.x=0>a.x?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case THREE.RepeatWrapping:a.y-=Math.floor(a.y);break;case THREE.ClampToEdgeWrapping:a.y=0>a.y?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CanvasTexture=function(a,b,c,d,e,f,g,h,i){THREE.Texture.call(this,a,b,c,d,e,f,g,h,i),this.needsUpdate=!0},THREE.CanvasTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CanvasTexture.prototype.constructor=THREE.CanvasTexture,THREE.CubeTexture=function(a,b,c,d,e,f,g,h,i){a=void 0!==a?a:[],b=void 0!==b?b:THREE.CubeReflectionMapping,THREE.Texture.call(this,a,b,c,d,e,f,g,h,i),this.flipY=!1},THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CubeTexture.prototype.constructor=THREE.CubeTexture,Object.defineProperty(THREE.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}}),THREE.CompressedTexture=function(a,b,c,d,e,f,g,h,i,j,k){THREE.Texture.call(this,null,f,g,h,i,j,d,e,k),this.image={width:b,height:c},this.mipmaps=a,this.generateMipmaps=this.flipY=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture,THREE.DataTexture=function(a,b,c,d,e,f,g,h,i,j,k){THREE.Texture.call(this,null,f,g,h,i,j,d,e,k),this.image={data:a,width:b,height:c},this.magFilter=void 0!==i?i:THREE.NearestFilter,this.minFilter=void 0!==j?j:THREE.NearestFilter,this.generateMipmaps=this.flipY=!1},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.VideoTexture=function(a,b,c,d,e,f,g,h,i){function j(){requestAnimationFrame(j),a.readyState===a.HAVE_ENOUGH_DATA&&(k.needsUpdate=!0)}THREE.Texture.call(this,a,b,c,d,e,f,g,h,i),this.generateMipmaps=!1;var k=this;j()},THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype),THREE.VideoTexture.prototype.constructor=THREE.VideoTexture,THREE.Group=function(){THREE.Object3D.call(this),this.type="Group"},THREE.Group.prototype=Object.create(THREE.Object3D.prototype),THREE.Group.prototype.constructor=THREE.Group,THREE.Points=function(a,b){THREE.Object3D.call(this),this.type="Points",this.geometry=void 0!==a?a:new THREE.Geometry,this.material=void 0!==b?b:new THREE.PointsMaterial({color:16777215*Math.random()})},THREE.Points.prototype=Object.create(THREE.Object3D.prototype),THREE.Points.prototype.constructor=THREE.Points,THREE.Points.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere;return function(d,e){function f(a,c){var f=b.distanceSqToPoint(a);if(f<k){var h=b.closestPointToPoint(a);h.applyMatrix4(i);var j=d.ray.origin.distanceTo(h);j<d.near||j>d.far||e.push({distance:j,distanceToRay:Math.sqrt(f),point:h.clone(),index:c,face:null,object:g})}}var g=this,h=this.geometry,i=this.matrixWorld,j=d.params.Points.threshold;if(null===h.boundingSphere&&h.computeBoundingSphere(),c.copy(h.boundingSphere),c.applyMatrix4(i),!1!==d.ray.intersectsSphere(c)){a.getInverse(i),b.copy(d.ray).applyMatrix4(a);var j=j/((this.scale.x+this.scale.y+this.scale.z)/3),k=j*j,j=new THREE.Vector3;if(h instanceof THREE.BufferGeometry){var l=h.index,h=h.attributes.position.array;if(null!==l)for(var m=l.array,l=0,n=m.length;l<n;l++){var o=m[l];j.fromArray(h,3*o),f(j,o)}else for(l=0,m=h.length/3;l<m;l++)j.fromArray(h,3*l),f(j,l)}else for(j=h.vertices,l=0,m=j.length;l<m;l++)f(j[l],l)}}}(),THREE.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},THREE.Line=function(a,b,c){return 1===c?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new THREE.LineSegments(a,b)):(THREE.Object3D.call(this),this.type="Line",this.geometry=void 0!==a?a:new THREE.Geometry,void(this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()})))},THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.constructor=THREE.Line,THREE.Line.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere;return function(d,e){var f=d.linePrecision,f=f*f,g=this.geometry,h=this.matrixWorld;if(null===g.boundingSphere&&g.computeBoundingSphere(),c.copy(g.boundingSphere),c.applyMatrix4(h),!1!==d.ray.intersectsSphere(c)){a.getInverse(h),b.copy(d.ray).applyMatrix4(a);var i=new THREE.Vector3,j=new THREE.Vector3,h=new THREE.Vector3,k=new THREE.Vector3,l=this instanceof THREE.LineSegments?2:1;if(g instanceof THREE.BufferGeometry){var m=g.index,n=g.attributes.position.array;if(null!==m)for(var m=m.array,g=0,o=m.length-1;g<o;g+=l){var p=m[g+1];i.fromArray(n,3*m[g]),j.fromArray(n,3*p),p=b.distanceSqToSegment(i,j,k,h),p>f||(k.applyMatrix4(this.matrixWorld),p=d.ray.origin.distanceTo(k),p<d.near||p>d.far||e.push({distance:p,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else for(g=0,o=n.length/3-1;g<o;g+=l)i.fromArray(n,3*g),j.fromArray(n,3*g+3),p=b.distanceSqToSegment(i,j,k,h),p>f||(k.applyMatrix4(this.matrixWorld),p=d.ray.origin.distanceTo(k),p<d.near||p>d.far||e.push({distance:p,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(g instanceof THREE.Geometry)for(i=g.vertices,j=i.length,g=0;g<j-1;g+=l)p=b.distanceSqToSegment(i[g],i[g+1],k,h),p>f||(k.applyMatrix4(this.matrixWorld),p=d.ray.origin.distanceTo(k),p<d.near||p>d.far||e.push({distance:p,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}}}(),THREE.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},THREE.LineStrip=0,THREE.LinePieces=1,THREE.LineSegments=function(a,b){THREE.Line.call(this,a,b),this.type="LineSegments"},THREE.LineSegments.prototype=Object.create(THREE.Line.prototype),THREE.LineSegments.prototype.constructor=THREE.LineSegments,THREE.Mesh=function(a,b){THREE.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==a?a:new THREE.Geometry,this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=THREE.TrianglesDrawMode,this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.setDrawMode=function(a){this.drawMode=a},THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){return void 0!==this.morphTargetDictionary[a]?this.morphTargetDictionary[a]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.raycast=function(){function a(a,b,c,d,e,f,g){return THREE.Triangle.barycoordFromPoint(a,b,c,d,p),e.multiplyScalar(p.x),f.multiplyScalar(p.y),g.multiplyScalar(p.z),e.add(f).add(g),e.clone()}function b(a,b,c,d,e,f,g){var h=a.material;return null===(h.side===THREE.BackSide?c.intersectTriangle(f,e,d,!0,g):c.intersectTriangle(d,e,f,h.side!==THREE.DoubleSide,g))?null:(r.copy(g),r.applyMatrix4(a.matrixWorld),c=b.ray.origin.distanceTo(r),c<b.near||c>b.far?null:{distance:c,point:r.clone(),object:a})}function c(c,d,e,f,j,k,l,p){return g.fromArray(f,3*k),h.fromArray(f,3*l),i.fromArray(f,3*p),(c=b(c,d,e,g,h,i,q))&&(j&&(m.fromArray(j,2*k),n.fromArray(j,2*l),o.fromArray(j,2*p),c.uv=a(q,g,h,i,m,n,o)),c.face=new THREE.Face3(k,l,p,THREE.Triangle.normal(g,h,i)),c.faceIndex=k),c}var d=new THREE.Matrix4,e=new THREE.Ray,f=new THREE.Sphere,g=new THREE.Vector3,h=new THREE.Vector3,i=new THREE.Vector3,j=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector2,n=new THREE.Vector2,o=new THREE.Vector2,p=new THREE.Vector3,q=new THREE.Vector3,r=new THREE.Vector3;return function(p,r){var s=this.geometry,t=this.material,u=this.matrixWorld;if(void 0!==t&&(null===s.boundingSphere&&s.computeBoundingSphere(),f.copy(s.boundingSphere),f.applyMatrix4(u),!1!==p.ray.intersectsSphere(f)&&(d.getInverse(u),e.copy(p.ray).applyMatrix4(d),null===s.boundingBox||!1!==e.intersectsBox(s.boundingBox)))){var v,w;if(s instanceof THREE.BufferGeometry){var x,y,t=s.index,u=s.attributes,s=u.position.array;if(void 0!==u.uv&&(v=u.uv.array),null!==t)for(var u=t.array,z=0,A=u.length;z<A;z+=3)t=u[z],x=u[z+1],y=u[z+2],(w=c(this,p,e,s,v,t,x,y))&&(w.faceIndex=Math.floor(z/3),r.push(w));else for(z=0,A=s.length;z<A;z+=9)t=z/3,x=t+1,y=t+2,(w=c(this,p,e,s,v,t,x,y))&&(w.index=t,r.push(w))}else if(s instanceof THREE.Geometry){var B,C,u=t instanceof THREE.MultiMaterial,z=!0===u?t.materials:null,A=s.vertices;x=s.faces,y=s.faceVertexUvs[0],0<y.length&&(v=y);for(var D=0,E=x.length;D<E;D++){var F=x[D];if(w=!0===u?z[F.materialIndex]:t,void 0!==w){if(y=A[F.a],B=A[F.b],C=A[F.c],!0===w.morphTargets){w=s.morphTargets;var G=this.morphTargetInfluences;g.set(0,0,0),h.set(0,0,0),i.set(0,0,0);for(var H=0,I=w.length;H<I;H++){var J=G[H];if(0!==J){var K=w[H].vertices;g.addScaledVector(j.subVectors(K[F.a],y),J),h.addScaledVector(k.subVectors(K[F.b],B),J),i.addScaledVector(l.subVectors(K[F.c],C),J)}}g.add(y),h.add(B),i.add(C),y=g,B=h,C=i}(w=b(this,p,e,y,B,C,q))&&(v&&(G=v[D],m.copy(G[0]),n.copy(G[1]),o.copy(G[2]),w.uv=a(q,y,B,C,m,n,o)),w.face=F,w.faceIndex=D,r.push(w))}}}}}}(),THREE.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},THREE.Bone=function(a){THREE.Object3D.call(this),this.type="Bone",this.skin=a},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.constructor=THREE.Bone,THREE.Bone.prototype.copy=function(a){return THREE.Object3D.prototype.copy.call(this,a),this.skin=a.skin,this},THREE.Skeleton=function(a,b,c){if(this.useVertexTexture=void 0===c||c,this.identityMatrix=new THREE.Matrix4,a=a||[],this.bones=a.slice(0),this.useVertexTexture?(a=Math.sqrt(4*this.bones.length),a=THREE.Math.nextPowerOfTwo(Math.ceil(a)),this.boneTextureHeight=this.boneTextureWidth=a=Math.max(a,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType)):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],b=0,a=this.bones.length;b<a;b++)this.boneInverses.push(new THREE.Matrix4)},THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new THREE.Matrix4;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld),this.boneInverses.push(c)}},THREE.Skeleton.prototype.pose=function(){for(var a,b=0,c=this.bones.length;b<c;b++)(a=this.bones[b])&&a.matrixWorld.getInverse(this.boneInverses[b]);for(b=0,c=this.bones.length;b<c;b++)(a=this.bones[b])&&(a.parent?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))},THREE.Skeleton.prototype.update=function(){var a=new THREE.Matrix4;return function(){for(var b=0,c=this.bones.length;b<c;b++)a.multiplyMatrices(this.bones[b]?this.bones[b].matrixWorld:this.identityMatrix,this.boneInverses[b]),a.flattenToArrayOffset(this.boneMatrices,16*b);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.Skeleton.prototype.clone=function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},THREE.SkinnedMesh=function(a,b,c){if(THREE.Mesh.call(this,a,b),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new THREE.Matrix4,this.bindMatrixInverse=new THREE.Matrix4,a=[],this.geometry&&void 0!==this.geometry.bones){for(var d,e=0,f=this.geometry.bones.length;e<f;++e)d=this.geometry.bones[e],b=new THREE.Bone(this),a.push(b),b.name=d.name,b.position.fromArray(d.pos),b.quaternion.fromArray(d.rotq),void 0!==d.scl&&b.scale.fromArray(d.scl);for(e=0,f=this.geometry.bones.length;e<f;++e)d=this.geometry.bones[e],-1!==d.parent&&null!==d.parent?a[d.parent].add(a[e]):this.add(a[e])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new THREE.Skeleton(a,(void 0),c),this.matrixWorld)},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh,THREE.SkinnedMesh.prototype.bind=function(a,b){this.skeleton=a,void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld),this.bindMatrix.copy(b),this.bindMatrixInverse.getInverse(b)},THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var a=0;a<this.geometry.skinWeights.length;a++){var b=this.geometry.skinWeights[a],c=1/b.lengthManhattan();1/0!==c?b.multiplyScalar(c):b.set(1,0,0,0)}else if(this.geometry instanceof THREE.BufferGeometry)for(var b=new THREE.Vector4,d=this.geometry.attributes.skinWeight,a=0;a<d.count;a++)b.x=d.getX(a),b.y=d.getY(a),b.z=d.getZ(a),b.w=d.getW(a),c=1/b.lengthManhattan(),1/0!==c?b.multiplyScalar(c):b.set(1,0,0,0),d.setXYZW(a,b.x,b.y,b.z,b.w)},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(a){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},THREE.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},THREE.LOD=function(){THREE.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}})},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0),b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a}),this.add(a)},THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},THREE.LOD.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}(),THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld),b.setFromMatrixPosition(this.matrixWorld),c=a.distanceTo(b),d[0].object.visible=!0;for(var e=1,f=d.length;e<f&&c>=d[e].distance;e++)d[e-1].object.visible=!1,d[e].object.visible=!0;for(;e<f;e++)d[e].object.visible=!1}}}(),THREE.LOD.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a,!1),a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},THREE.LOD.prototype.toJSON=function(a){a=THREE.Object3D.prototype.toJSON.call(this,a),a.object.levels=[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a},THREE.Sprite=function(){var a=new Uint16Array([0,1,2,0,2,3]),b=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),c=new Float32Array([0,0,1,0,1,1,0,1]),d=new THREE.BufferGeometry;return d.setIndex(new THREE.BufferAttribute(a,1)),d.addAttribute("position",new THREE.BufferAttribute(b,3)),d.addAttribute("uv",new THREE.BufferAttribute(c,2)),function(a){THREE.Object3D.call(this),this.type="Sprite",this.geometry=d,this.material=void 0!==a?a:new THREE.SpriteMaterial}}(),THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.distanceSqToPoint(a);d>this.scale.x*this.scale.y||c.push({distance:Math.sqrt(d),point:this.position,face:null,object:this})}}(),THREE.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},THREE.Particle=THREE.Sprite,THREE.LensFlare=function(a,b,c,d,e){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==a&&this.add(a,b,c,d,e)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.constructor=THREE.LensFlare,THREE.LensFlare.prototype.add=function(a,b,c,d,e,f){void 0===b&&(b=-1),void 0===c&&(c=0),void 0===f&&(f=1),void 0===e&&(e=new THREE.Color(16777215)),void 0===d&&(d=THREE.NormalBlending),c=Math.min(c,Math.max(0,c)),this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:0,opacity:f,color:e,blending:d})},THREE.LensFlare.prototype.updateLensFlares=function(){var a,b,c=this.lensFlares.length,d=2*-this.positionScreen.x,e=2*-this.positionScreen.y;for(a=0;a<c;a++)b=this.lensFlares[a],b.x=this.positionScreen.x+d*b.distance,b.y=this.positionScreen.y+e*b.distance,b.wantedRotation=b.x*Math.PI*.25,b.rotation+=.25*(b.wantedRotation-b.rotation)},THREE.LensFlare.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a),this.positionScreen.copy(a.positionScreen),this.customUpdateCallback=a.customUpdateCallback;for(var b=0,c=a.lensFlares.length;b<c;b++)this.lensFlares.push(a.lensFlares[b]);return this},THREE.Scene=function(){THREE.Object3D.call(this),this.type="Scene",this.overrideMaterial=this.fog=null,this.autoUpdate=!0},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.copy=function(a,b){return THREE.Object3D.prototype.copy.call(this,a,b),null!==a.fog&&(this.fog=a.fog.clone()),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.autoUpdate=a.autoUpdate,this.matrixAutoUpdate=a.matrixAutoUpdate,this},THREE.Fog=function(a,b,c){this.name="",this.color=new THREE.Color(a),this.near=void 0!==b?b:1,this.far=void 0!==c?c:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(a,b){this.name="",this.color=new THREE.Color(a),this.density=void 0!==b?b:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.ShaderChunk={},THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",THREE.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",THREE.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",THREE.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",THREE.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",THREE.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_Smith( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",
THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",THREE.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",THREE.ShaderChunk.cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\nconst float cubeUV_textureSize = 1024.0;\nint getFaceFromDirection(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    int face = -1;\n    if( absDirection.x > absDirection.z ) {\n        if(absDirection.x > absDirection.y )\n            face = direction.x > 0.0 ? 0 : 3;\n        else\n            face = direction.y > 0.0 ? 1 : 4;\n    }\n    else {\n        if(absDirection.z > absDirection.y )\n            face = direction.z > 0.0 ? 2 : 5;\n        else\n            face = direction.y > 0.0 ? 1 : 4;\n    }\n    return face;\n}\nconst float cubeUV_maxLods1 = log2(cubeUV_textureSize*0.25) - 1.0;\nconst float cubeUV_rangeClamp = exp2((6.0 - 1.0) * 2.0);\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n    float scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n    float dxRoughness = dFdx(roughness);\n    float dyRoughness = dFdy(roughness);\n    vec3 dx = dFdx( vec * scale * dxRoughness );\n    vec3 dy = dFdy( vec * scale * dyRoughness );\n    float d = max( dot( dx, dx ), dot( dy, dy ) );\n    d = clamp(d, 1.0, cubeUV_rangeClamp);\n    float mipLevel = 0.5 * log2(d);\n    return vec2(floor(mipLevel), fract(mipLevel));\n}\nconst float cubeUV_maxLods2 = log2(cubeUV_textureSize*0.25) - 2.0;\nconst float cubeUV_rcpTextureSize = 1.0 / cubeUV_textureSize;\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n    mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n    float a = 16.0 * cubeUV_rcpTextureSize;\n    vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n    vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n    float powScale = exp2_packed.x * exp2_packed.y;\n    float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n    float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n    bool bRes = mipLevel == 0.0;\n    scale =  bRes && (scale < a) ? a : scale;\n    vec3 r;\n    vec2 offset;\n    int face = getFaceFromDirection(direction);\n    float rcpPowScale = 1.0 / powScale;\n    if( face == 0) {\n        r = vec3(direction.x, -direction.z, direction.y);\n        offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 1) {\n        r = vec3(direction.y, direction.x, direction.z);\n        offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 2) {\n        r = vec3(direction.z, direction.x, direction.y);\n        offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 3) {\n        r = vec3(direction.x, direction.z, direction.y);\n        offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    else if( face == 4) {\n        r = vec3(direction.y, direction.x, -direction.z);\n        offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    else {\n        r = vec3(direction.z, -direction.x, direction.y);\n        offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    r = normalize(r);\n    float texelOffset = 0.5 * cubeUV_rcpTextureSize;\n    vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n    vec2 base = offset + vec2( texelOffset );\n    return base + s * ( scale - 2.0 * texelOffset );\n}\nconst float cubeUV_maxLods3 = log2(cubeUV_textureSize*0.25) - 3.0;\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n    float roughnessVal = roughness* cubeUV_maxLods3;\n    float r1 = floor(roughnessVal);\n    float r2 = r1 + 1.0;\n    float t = fract(roughnessVal);\n    vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n    float s = mipInfo.y;\n    float level0 = mipInfo.x;\n    float level1 = level0 + 1.0;\n    level1 = level1 > 5.0 ? 5.0 : level1;\n    level0 += min( floor( s + 0.5 ), 5.0 );\n    vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n    vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n    vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n    vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n    vec4 result = mix(color10, color20, t);\n    return vec4(result.rgb, 1.0);\n}\n#endif\n",THREE.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",THREE.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",THREE.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",THREE.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",THREE.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",THREE.ShaderChunk.encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",THREE.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( STANDARD )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( STANDARD )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvarying vec3 vReflect;\n\tuniform float refractionRatio;\n#endif\n",THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t#ifdef ENVMAP_MODE_REFLECTION\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t#else\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t#endif\n#endif\n",THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",THREE.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tdirectLight = getPointDirectLightIrradiance( pointLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tdirectLight = getSpotDirectLightIrradiance( spotLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectLight = getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",THREE.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tIncidentLight getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tIncidentLight getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tIncidentLight getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( STANDARD )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",THREE.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",THREE.ShaderChunk.lights_phong_pars_fragment="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",THREE.ShaderChunk.lights_phong_pars_vertex="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\n",THREE.ShaderChunk.lights_phong_vertex="#ifdef USE_ENVMAP\n\tvWorldPosition = worldPosition.xyz;\n#endif\n",THREE.ShaderChunk.lights_standard_fragment="StandardMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\nmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n",THREE.ShaderChunk.lights_standard_pars_fragment="struct StandardMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n};\nvoid RE_Direct_Standard( const in IncidentLight directLight, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Standard( const in vec3 irradiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Standard( const in vec3 radiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Standard\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Standard\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Standard\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",THREE.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tdirectLight = getPointDirectLightIrradiance( pointLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tdirectLight = getSpotDirectLightIrradiance( spotLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tdirectLight = getDirectionalDirectLightIrradiance( directionalLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n",THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",
THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",THREE.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",THREE.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",THREE.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",THREE.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",THREE.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",THREE.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",THREE.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",THREE.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\treturn dot( rgba_depth, bit_shift );\n\t}\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",THREE.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",THREE.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",THREE.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",THREE.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",THREE.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",THREE.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",THREE.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( STANDARD ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",THREE.UniformsUtils={merge:function(a){for(var b={},c=0;c<a.length;c++){var d,e=this.clone(a[c]);for(d in e)b[d]=e[d]}return b},clone:function(a){var b,c={};for(b in a){c[b]={};for(var d in a[b]){var e=a[b][d];e instanceof THREE.Color||e instanceof THREE.Vector2||e instanceof THREE.Vector3||e instanceof THREE.Vector4||e instanceof THREE.Matrix3||e instanceof THREE.Matrix4||e instanceof THREE.Texture?c[b][d]=e.clone():Array.isArray(e)?c[b][d]=e.slice():c[b][d]=e}}return c}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"f"},coneCos:{type:"f"},penumbraCos:{type:"f"},decay:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"f"},distance:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}}},THREE.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t#include <logdepthbuf_vertex>\n}\n",THREE.ShaderChunk.depth_frag="uniform float mNear;\nuniform float mFar;\nuniform float opacity;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}\n",THREE.ShaderChunk.depth_vert="#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n}\n",THREE.ShaderChunk.depthRGBA_frag="#include <common>\n#include <logdepthbuf_pars_fragment>\nvec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}\n",THREE.ShaderChunk.depthRGBA_vert="#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n}\n",THREE.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\nvec4 pack1K ( float depth ) {\n\tdepth /= 1000.0;\n\tconst vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bitSh * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bitMsk;\n\treturn res;\n}\nfloat unpack1K ( vec4 color ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}\n",THREE.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\tvWorldPosition = worldPosition;\n}\n",THREE.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t#include <logdepthbuf_vertex>\n}\n",THREE.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n}\n",THREE.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n}\n",THREE.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",
THREE.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <lights_phong_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_phong_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.meshstandard_frag="#define STANDARD\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_standard_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_standard_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshstandard_vert="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n\t#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n}\n",THREE.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.fog]),vertexShader:THREE.ShaderChunk.meshbasic_vert,fragmentShader:THREE.ShaderChunk.meshbasic_frag},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)}}]),vertexShader:THREE.ShaderChunk.meshlambert_vert,fragmentShader:THREE.ShaderChunk.meshlambert_frag},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:THREE.ShaderChunk.meshphong_vert,fragmentShader:THREE.ShaderChunk.meshphong_frag},standard:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.roughnessmap,THREE.UniformsLib.metalnessmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},roughness:{type:"f",value:.5},metalness:{type:"f",value:0},envMapIntensity:{type:"f",value:1}}]),vertexShader:THREE.ShaderChunk.meshstandard_vert,fragmentShader:THREE.ShaderChunk.meshstandard_frag},points:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.points,THREE.UniformsLib.fog]),vertexShader:THREE.ShaderChunk.points_vert,fragmentShader:THREE.ShaderChunk.points_frag},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:THREE.ShaderChunk.linedashed_vert,fragmentShader:THREE.ShaderChunk.linedashed_frag},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:THREE.ShaderChunk.depth_vert,fragmentShader:THREE.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:THREE.ShaderChunk.normal_vert,fragmentShader:THREE.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:THREE.ShaderChunk.cube_vert,fragmentShader:THREE.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:THREE.ShaderChunk.equirect_vert,fragmentShader:THREE.ShaderChunk.equirect_frag},depthRGBA:{uniforms:{},vertexShader:THREE.ShaderChunk.depthRGBA_vert,fragmentShader:THREE.ShaderChunk.depthRGBA_frag},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new THREE.Vector3(0,0,0)}},vertexShader:THREE.ShaderChunk.distanceRGBA_vert,fragmentShader:THREE.ShaderChunk.distanceRGBA_frag}},THREE.WebGLRenderer=function(a){function b(a,b,c,d){!0===J&&(a*=d,b*=d,c*=d),ua.clearColor(a,b,c,d)}function c(){ua.init(),ua.scissor($.copy(ha).multiplyScalar(ga)),ua.viewport(aa.copy(ja).multiplyScalar(ga)),b(ca.r,ca.g,ca.b,da)}function d(){Z=U=null,Y="",X=-1,ua.reset()}function e(a){a.preventDefault(),d(),c(),va.clear()}function f(a){a=a.target,a.removeEventListener("dispose",f);a:{var b=va.get(a);if(a.image&&b.__image__webglTextureCube)qa.deleteTexture(b.__image__webglTextureCube);else{if(void 0===b.__webglInit)break a;qa.deleteTexture(b.__webglTexture)}va["delete"](a)}oa.textures--}function g(a){a=a.target,a.removeEventListener("dispose",g);var b=va.get(a),c=va.get(a.texture);if(a&&void 0!==c.__webglTexture){if(qa.deleteTexture(c.__webglTexture),a instanceof THREE.WebGLRenderTargetCube)for(c=0;6>c;c++)qa.deleteFramebuffer(b.__webglFramebuffer[c]),qa.deleteRenderbuffer(b.__webglDepthbuffer[c]);else qa.deleteFramebuffer(b.__webglFramebuffer),qa.deleteRenderbuffer(b.__webglDepthbuffer);va["delete"](a.texture),va["delete"](a)}oa.textures--}function h(a){a=a.target,a.removeEventListener("dispose",h),i(a),va["delete"](a)}function i(a){var b=va.get(a).program;a.program=void 0,void 0!==b&&xa.releaseProgram(b)}function j(a,b){return Math.abs(b[0])-Math.abs(a[0])}function k(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function l(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function m(a,b,c,d,e){var f;c.transparent?(d=O,f=++P):(d=M,f=++N),f=d[f],void 0!==f?(f.id=a.id,f.object=a,f.geometry=b,f.material=c,f.z=ma.z,f.group=e):(f={id:a.id,object:a,geometry:b,material:c,z:ma.z,group:e},d.push(f))}function n(a,b){if(!1!==a.visible){if(a.layers.test(b.layers))if(a instanceof THREE.Light)L.push(a);else if(a instanceof THREE.Sprite)!1!==a.frustumCulled&&!0!==ka.intersectsObject(a)||R.push(a);else if(a instanceof THREE.LensFlare)S.push(a);else if(a instanceof THREE.ImmediateRenderObject)!0===T.sortObjects&&(ma.setFromMatrixPosition(a.matrixWorld),ma.applyProjection(la)),m(a,null,a.material,ma.z,null);else if((a instanceof THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Points)&&(a instanceof THREE.SkinnedMesh&&a.skeleton.update(),!1===a.frustumCulled||!0===ka.intersectsObject(a))){var c=a.material;if(!0===c.visible){!0===T.sortObjects&&(ma.setFromMatrixPosition(a.matrixWorld),ma.applyProjection(la));var d=wa.update(a);if(c instanceof THREE.MultiMaterial)for(var e=d.groups,f=c.materials,c=0,g=e.length;c<g;c++){var h=e[c],i=f[h.materialIndex];!0===i.visible&&m(a,d,i,ma.z,h)}else m(a,d,c,ma.z,null)}}for(d=a.children,c=0,g=d.length;c<g;c++)n(d[c],b)}}function o(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e],h=g.object,i=g.geometry,j=void 0===d?g.material:d,g=g.group;if(h.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),h instanceof THREE.ImmediateRenderObject){p(j);var k=q(b,c,j,h);Y="",h.render(function(a){T.renderBufferImmediate(a,k,j)})}else T.renderBufferDirect(b,c,i,j,h,g)}}function p(a){a.side!==THREE.DoubleSide?ua.enable(qa.CULL_FACE):ua.disable(qa.CULL_FACE),ua.setFlipSided(a.side===THREE.BackSide),!0===a.transparent?ua.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha,a.premultipliedAlpha):ua.setBlending(THREE.NoBlending),ua.setDepthFunc(a.depthFunc),ua.setDepthTest(a.depthTest),ua.setDepthWrite(a.depthWrite),ua.setColorWrite(a.colorWrite),ua.setPolygonOffset(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}function q(a,b,c,d){ba=0;var e=va.get(c);if(void 0===e.program&&(c.needsUpdate=!0),void 0!==e.lightsHash&&e.lightsHash!==na.hash&&(c.needsUpdate=!0),c.needsUpdate){a:{var f=va.get(c),g=xa.getParameters(c,na,b,d),j=xa.getProgramCode(c,g),k=f.program,l=!0;if(void 0===k)c.addEventListener("dispose",h);else if(k.code!==j)i(c);else{if(void 0!==g.shaderID)break a;l=!1}if(l&&(g.shaderID?(k=THREE.ShaderLib[g.shaderID],f.__webglShader={name:c.type,uniforms:THREE.UniformsUtils.clone(k.uniforms),vertexShader:k.vertexShader,fragmentShader:k.fragmentShader}):f.__webglShader={name:c.type,uniforms:c.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader},c.__webglShader=f.__webglShader,k=xa.acquireProgram(c,g,j),f.program=k,c.program=k),g=k.getAttributes(),c.morphTargets)for(j=c.numSupportedMorphTargets=0;j<T.maxMorphTargets;j++)0<=g["morphTarget"+j]&&c.numSupportedMorphTargets++;if(c.morphNormals)for(j=c.numSupportedMorphNormals=0;j<T.maxMorphNormals;j++)0<=g["morphNormal"+j]&&c.numSupportedMorphNormals++;f.uniformsList=[];var m,g=f.__webglShader.uniforms,j=f.program.getUniforms();for(m in g)(k=j[m])&&f.uniformsList.push([f.__webglShader.uniforms[m],k]);for((c instanceof THREE.MeshPhongMaterial||c instanceof THREE.MeshLambertMaterial||c instanceof THREE.MeshStandardMaterial||c.lights)&&(f.lightsHash=na.hash,g.ambientLightColor.value=na.ambient,g.directionalLights.value=na.directional,g.spotLights.value=na.spot,g.pointLights.value=na.point,g.hemisphereLights.value=na.hemi,g.directionalShadowMap.value=na.directionalShadowMap,g.directionalShadowMatrix.value=na.directionalShadowMatrix,g.spotShadowMap.value=na.spotShadowMap,g.spotShadowMatrix.value=na.spotShadowMatrix,g.pointShadowMap.value=na.pointShadowMap,g.pointShadowMatrix.value=na.pointShadowMatrix),f.hasDynamicUniforms=!1,m=0,g=f.uniformsList.length;m<g;m++)if(!0===f.uniformsList[m][0].dynamic){f.hasDynamicUniforms=!0;break}}c.needsUpdate=!1}if(k=j=l=!1,f=e.program,m=f.getUniforms(),g=e.__webglShader.uniforms,f.id!==U&&(qa.useProgram(f.program),U=f.id,k=j=l=!0),c.id!==X&&(X=c.id,j=!0),(l||a!==Z)&&(qa.uniformMatrix4fv(m.projectionMatrix,!1,a.projectionMatrix.elements),ta.logarithmicDepthBuffer&&qa.uniform1f(m.logDepthBufFC,2/(Math.log(a.far+1)/Math.LN2)),a!==Z&&(Z=a,k=j=!0),(c instanceof THREE.ShaderMaterial||c instanceof THREE.MeshPhongMaterial||c instanceof THREE.MeshStandardMaterial||c.envMap)&&void 0!==m.cameraPosition&&(ma.setFromMatrixPosition(a.matrixWorld),qa.uniform3f(m.cameraPosition,ma.x,ma.y,ma.z)),(c instanceof THREE.MeshPhongMaterial||c instanceof THREE.MeshLambertMaterial||c instanceof THREE.MeshBasicMaterial||c instanceof THREE.MeshStandardMaterial||c instanceof THREE.ShaderMaterial||c.skinning)&&void 0!==m.viewMatrix&&qa.uniformMatrix4fv(m.viewMatrix,!1,a.matrixWorldInverse.elements),void 0!==m.toneMappingExposure&&qa.uniform1f(m.toneMappingExposure,T.toneMappingExposure),void 0!==m.toneMappingWhitePoint&&qa.uniform1f(m.toneMappingWhitePoint,T.toneMappingWhitePoint)),c.skinning&&(d.bindMatrix&&void 0!==m.bindMatrix&&qa.uniformMatrix4fv(m.bindMatrix,!1,d.bindMatrix.elements),d.bindMatrixInverse&&void 0!==m.bindMatrixInverse&&qa.uniformMatrix4fv(m.bindMatrixInverse,!1,d.bindMatrixInverse.elements),ta.floatVertexTextures&&d.skeleton&&d.skeleton.useVertexTexture?(void 0!==m.boneTexture&&(l=r(),qa.uniform1i(m.boneTexture,l),T.setTexture(d.skeleton.boneTexture,l)),void 0!==m.boneTextureWidth&&qa.uniform1i(m.boneTextureWidth,d.skeleton.boneTextureWidth),void 0!==m.boneTextureHeight&&qa.uniform1i(m.boneTextureHeight,d.skeleton.boneTextureHeight)):d.skeleton&&d.skeleton.boneMatrices&&void 0!==m.boneGlobalMatrices&&qa.uniformMatrix4fv(m.boneGlobalMatrices,!1,d.skeleton.boneMatrices)),j){if((c instanceof THREE.MeshPhongMaterial||c instanceof THREE.MeshLambertMaterial||c instanceof THREE.MeshStandardMaterial||c.lights)&&(j=k,g.ambientLightColor.needsUpdate=j,g.directionalLights.needsUpdate=j,g.pointLights.needsUpdate=j,g.spotLights.needsUpdate=j,g.hemisphereLights.needsUpdate=j),b&&c.fog&&(g.fogColor.value=b.color,b instanceof THREE.Fog?(g.fogNear.value=b.near,g.fogFar.value=b.far):b instanceof THREE.FogExp2&&(g.fogDensity.value=b.density)),c instanceof THREE.MeshBasicMaterial||c instanceof THREE.MeshLambertMaterial||c instanceof THREE.MeshPhongMaterial||c instanceof THREE.MeshStandardMaterial){g.opacity.value=c.opacity,g.diffuse.value=c.color,c.emissive&&g.emissive.value.copy(c.emissive).multiplyScalar(c.emissiveIntensity),g.map.value=c.map,g.specularMap.value=c.specularMap,g.alphaMap.value=c.alphaMap,c.aoMap&&(g.aoMap.value=c.aoMap,g.aoMapIntensity.value=c.aoMapIntensity);var n;c.map?n=c.map:c.specularMap?n=c.specularMap:c.displacementMap?n=c.displacementMap:c.normalMap?n=c.normalMap:c.bumpMap?n=c.bumpMap:c.roughnessMap?n=c.roughnessMap:c.metalnessMap?n=c.metalnessMap:c.alphaMap?n=c.alphaMap:c.emissiveMap&&(n=c.emissiveMap),void 0!==n&&(n instanceof THREE.WebGLRenderTarget&&(n=n.texture),b=n.offset,n=n.repeat,g.offsetRepeat.value.set(b.x,b.y,n.x,n.y)),g.envMap.value=c.envMap,g.flipEnvMap.value=c.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,g.reflectivity.value=c.reflectivity,g.refractionRatio.value=c.refractionRatio}c instanceof THREE.LineBasicMaterial?(g.diffuse.value=c.color,g.opacity.value=c.opacity):c instanceof THREE.LineDashedMaterial?(g.diffuse.value=c.color,g.opacity.value=c.opacity,g.dashSize.value=c.dashSize,g.totalSize.value=c.dashSize+c.gapSize,g.scale.value=c.scale):c instanceof THREE.PointsMaterial?(g.diffuse.value=c.color,g.opacity.value=c.opacity,g.size.value=c.size*ga,g.scale.value=D.clientHeight/2,g.map.value=c.map,null!==c.map&&(n=c.map.offset,c=c.map.repeat,g.offsetRepeat.value.set(n.x,n.y,c.x,c.y))):c instanceof THREE.MeshLambertMaterial?(c.lightMap&&(g.lightMap.value=c.lightMap,g.lightMapIntensity.value=c.lightMapIntensity),c.emissiveMap&&(g.emissiveMap.value=c.emissiveMap)):c instanceof THREE.MeshPhongMaterial?(g.specular.value=c.specular,g.shininess.value=Math.max(c.shininess,1e-4),c.lightMap&&(g.lightMap.value=c.lightMap,g.lightMapIntensity.value=c.lightMapIntensity),c.emissiveMap&&(g.emissiveMap.value=c.emissiveMap),c.bumpMap&&(g.bumpMap.value=c.bumpMap,g.bumpScale.value=c.bumpScale),c.normalMap&&(g.normalMap.value=c.normalMap,g.normalScale.value.copy(c.normalScale)),c.displacementMap&&(g.displacementMap.value=c.displacementMap,g.displacementScale.value=c.displacementScale,g.displacementBias.value=c.displacementBias)):c instanceof THREE.MeshStandardMaterial?(g.roughness.value=c.roughness,g.metalness.value=c.metalness,c.roughnessMap&&(g.roughnessMap.value=c.roughnessMap),c.metalnessMap&&(g.metalnessMap.value=c.metalnessMap),c.lightMap&&(g.lightMap.value=c.lightMap,g.lightMapIntensity.value=c.lightMapIntensity),c.emissiveMap&&(g.emissiveMap.value=c.emissiveMap),c.bumpMap&&(g.bumpMap.value=c.bumpMap,g.bumpScale.value=c.bumpScale),c.normalMap&&(g.normalMap.value=c.normalMap,g.normalScale.value.copy(c.normalScale)),c.displacementMap&&(g.displacementMap.value=c.displacementMap,g.displacementScale.value=c.displacementScale,g.displacementBias.value=c.displacementBias),c.envMap&&(g.envMapIntensity.value=c.envMapIntensity)):c instanceof THREE.MeshDepthMaterial?(g.mNear.value=a.near,g.mFar.value=a.far,g.opacity.value=c.opacity):c instanceof THREE.MeshNormalMaterial&&(g.opacity.value=c.opacity),t(e.uniformsList)}if(qa.uniformMatrix4fv(m.modelViewMatrix,!1,d.modelViewMatrix.elements),m.normalMatrix&&qa.uniformMatrix3fv(m.normalMatrix,!1,d.normalMatrix.elements),void 0!==m.modelMatrix&&qa.uniformMatrix4fv(m.modelMatrix,!1,d.matrixWorld.elements),!0===e.hasDynamicUniforms){for(e=e.uniformsList,c=[],n=0,b=e.length;n<b;n++)m=e[n][0],g=m.onUpdateCallback,void 0!==g&&(g.bind(m)(d,a),c.push(e[n]));t(c)}return f}function r(){var a=ba;return a>=ta.maxTextures&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+ta.maxTextures),ba+=1,a}function s(a,b,c,d){var e;if("1i"===b)qa.uniform1i(c,d);else if("1f"===b)qa.uniform1f(c,d);else if("2f"===b)qa.uniform2f(c,d[0],d[1]);else if("3f"===b)qa.uniform3f(c,d[0],d[1],d[2]);else if("4f"===b)qa.uniform4f(c,d[0],d[1],d[2],d[3]);else if("1iv"===b)qa.uniform1iv(c,d);else if("3iv"===b)qa.uniform3iv(c,d);else if("1fv"===b)qa.uniform1fv(c,d);else if("2fv"===b)qa.uniform2fv(c,d);else if("3fv"===b)qa.uniform3fv(c,d);else if("4fv"===b)qa.uniform4fv(c,d);else if("Matrix2fv"===b)qa.uniformMatrix2fv(c,!1,d);else if("Matrix3fv"===b)qa.uniformMatrix3fv(c,!1,d);else if("Matrix4fv"===b)qa.uniformMatrix4fv(c,!1,d);else if("i"===b)qa.uniform1i(c,d);else if("f"===b)qa.uniform1f(c,d);else if("v2"===b)qa.uniform2f(c,d.x,d.y);else if("v3"===b)qa.uniform3f(c,d.x,d.y,d.z);else if("v4"===b)qa.uniform4f(c,d.x,d.y,d.z,d.w);else if("c"===b)qa.uniform3f(c,d.r,d.g,d.b);else if("s"===b){a=a.properties;for(var f in a){e=a[f];var g=c[f],h=d[f];s(e,e.type,g,h)}}else if("sa"===b){a=a.properties,b=0;for(var i=d.length;b<i;b++)for(f in a)e=a[f],g=c[b][f],h=d[b][f],s(e,e.type,g,h)}else if("iv1"===b)qa.uniform1iv(c,d);else if("iv"===b)qa.uniform3iv(c,d);else if("fv1"===b)qa.uniform1fv(c,d);else if("fv"===b)qa.uniform3fv(c,d);else if("v2v"===b){for(void 0===a._array&&(a._array=new Float32Array(2*d.length)),e=b=0,f=d.length;b<f;b++,e+=2)a._array[e+0]=d[b].x,a._array[e+1]=d[b].y;qa.uniform2fv(c,a._array)}else if("v3v"===b){for(void 0===a._array&&(a._array=new Float32Array(3*d.length)),e=b=0,f=d.length;b<f;b++,e+=3)a._array[e+0]=d[b].x,a._array[e+1]=d[b].y,a._array[e+2]=d[b].z;qa.uniform3fv(c,a._array)}else if("v4v"===b){for(void 0===a._array&&(a._array=new Float32Array(4*d.length)),e=b=0,f=d.length;b<f;b++,e+=4)a._array[e+0]=d[b].x,a._array[e+1]=d[b].y,a._array[e+2]=d[b].z,a._array[e+3]=d[b].w;qa.uniform4fv(c,a._array)}else if("m2"===b)qa.uniformMatrix2fv(c,!1,d.elements);else if("m3"===b)qa.uniformMatrix3fv(c,!1,d.elements);else if("m3v"===b){for(void 0===a._array&&(a._array=new Float32Array(9*d.length)),b=0,f=d.length;b<f;b++)d[b].flattenToArrayOffset(a._array,9*b);qa.uniformMatrix3fv(c,!1,a._array)}else if("m4"===b)qa.uniformMatrix4fv(c,!1,d.elements);else if("m4v"===b){for(void 0===a._array&&(a._array=new Float32Array(16*d.length)),b=0,f=d.length;b<f;b++)d[b].flattenToArrayOffset(a._array,16*b);qa.uniformMatrix4fv(c,!1,a._array)}else if("t"===b)e=r(),qa.uniform1i(c,e),d&&(d instanceof THREE.CubeTexture||Array.isArray(d.image)&&6===d.image.length?x(d,e):d instanceof THREE.WebGLRenderTargetCube?y(d.texture,e):d instanceof THREE.WebGLRenderTarget?T.setTexture(d.texture,e):T.setTexture(d,e));else if("tv"===b){for(void 0===a._array&&(a._array=[]),b=0,f=a.value.length;b<f;b++)a._array[b]=r();for(qa.uniform1iv(c,a._array),b=0,f=a.value.length;b<f;b++)d=a.value[b],e=a._array[b],d&&(d instanceof THREE.CubeTexture||d.image instanceof Array&&6===d.image.length?x(d,e):d instanceof THREE.WebGLRenderTarget?T.setTexture(d.texture,e):d instanceof THREE.WebGLRenderTargetCube?y(d.texture,e):T.setTexture(d,e))}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+b)}function t(a){for(var b=0,c=a.length;b<c;b++){var d=a[b][0];!1!==d.needsUpdate&&s(d,d.type,a[b][1],d.value)}}function u(a,b,c){c?(qa.texParameteri(a,qa.TEXTURE_WRAP_S,C(b.wrapS)),qa.texParameteri(a,qa.TEXTURE_WRAP_T,C(b.wrapT)),qa.texParameteri(a,qa.TEXTURE_MAG_FILTER,C(b.magFilter)),qa.texParameteri(a,qa.TEXTURE_MIN_FILTER,C(b.minFilter))):(qa.texParameteri(a,qa.TEXTURE_WRAP_S,qa.CLAMP_TO_EDGE),qa.texParameteri(a,qa.TEXTURE_WRAP_T,qa.CLAMP_TO_EDGE),b.wrapS===THREE.ClampToEdgeWrapping&&b.wrapT===THREE.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",b),qa.texParameteri(a,qa.TEXTURE_MAG_FILTER,B(b.magFilter)),qa.texParameteri(a,qa.TEXTURE_MIN_FILTER,B(b.minFilter)),b.minFilter!==THREE.NearestFilter&&b.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",b)),!(c=sa.get("EXT_texture_filter_anisotropic"))||b.type===THREE.FloatType&&null===sa.get("OES_texture_float_linear")||b.type===THREE.HalfFloatType&&null===sa.get("OES_texture_half_float_linear")||!(1<b.anisotropy||va.get(b).__currentAnisotropy)||(qa.texParameterf(a,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,T.getMaxAnisotropy())),va.get(b).__currentAnisotropy=b.anisotropy)}function v(a,b){if(a.width>b||a.height>b){var c=b/Math.max(a.width,a.height),d=document.createElement("canvas");return d.width=Math.floor(a.width*c),d.height=Math.floor(a.height*c),d.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,d.width,d.height),console.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+d.width+"x"+d.height,a),d}return a}function w(a){return THREE.Math.isPowerOfTwo(a.width)&&THREE.Math.isPowerOfTwo(a.height)}function x(a,b){var c=va.get(a);if(6===a.image.length)if(0<a.version&&c.__version!==a.version){c.__image__webglTextureCube||(a.addEventListener("dispose",f),c.__image__webglTextureCube=qa.createTexture(),oa.textures++),ua.activeTexture(qa.TEXTURE0+b),ua.bindTexture(qa.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),qa.pixelStorei(qa.UNPACK_FLIP_Y_WEBGL,a.flipY);for(var d=a instanceof THREE.CompressedTexture,e=a.image[0]instanceof THREE.DataTexture,g=[],h=0;6>h;h++)g[h]=!T.autoScaleCubemaps||d||e?e?a.image[h].image:a.image[h]:v(a.image[h],ta.maxCubemapSize);var i=w(g[0]),j=C(a.format),k=C(a.type);for(u(qa.TEXTURE_CUBE_MAP,a,i),h=0;6>h;h++)if(d)for(var l,m=g[h].mipmaps,n=0,o=m.length;n<o;n++)l=m[n],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?-1<ua.getCompressedTextureFormats().indexOf(j)?ua.compressedTexImage2D(qa.TEXTURE_CUBE_MAP_POSITIVE_X+h,n,j,l.width,l.height,0,l.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):ua.texImage2D(qa.TEXTURE_CUBE_MAP_POSITIVE_X+h,n,j,l.width,l.height,0,j,k,l.data);else e?ua.texImage2D(qa.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,j,g[h].width,g[h].height,0,j,k,g[h].data):ua.texImage2D(qa.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,j,j,k,g[h]);a.generateMipmaps&&i&&qa.generateMipmap(qa.TEXTURE_CUBE_MAP),c.__version=a.version,a.onUpdate&&a.onUpdate(a)}else ua.activeTexture(qa.TEXTURE0+b),ua.bindTexture(qa.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)}function y(a,b){ua.activeTexture(qa.TEXTURE0+b),ua.bindTexture(qa.TEXTURE_CUBE_MAP,va.get(a).__webglTexture)}function z(a,b,c,d){var e=C(b.texture.format),f=C(b.texture.type);ua.texImage2D(d,0,e,b.width,b.height,0,e,f,null),qa.bindFramebuffer(qa.FRAMEBUFFER,a),qa.framebufferTexture2D(qa.FRAMEBUFFER,c,d,va.get(b.texture).__webglTexture,0),qa.bindFramebuffer(qa.FRAMEBUFFER,null)}function A(a,b){qa.bindRenderbuffer(qa.RENDERBUFFER,a),b.depthBuffer&&!b.stencilBuffer?(qa.renderbufferStorage(qa.RENDERBUFFER,qa.DEPTH_COMPONENT16,b.width,b.height),qa.framebufferRenderbuffer(qa.FRAMEBUFFER,qa.DEPTH_ATTACHMENT,qa.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(qa.renderbufferStorage(qa.RENDERBUFFER,qa.DEPTH_STENCIL,b.width,b.height),qa.framebufferRenderbuffer(qa.FRAMEBUFFER,qa.DEPTH_STENCIL_ATTACHMENT,qa.RENDERBUFFER,a)):qa.renderbufferStorage(qa.RENDERBUFFER,qa.RGBA4,b.width,b.height),qa.bindRenderbuffer(qa.RENDERBUFFER,null)}function B(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?qa.NEAREST:qa.LINEAR}function C(a){var b;if(a===THREE.RepeatWrapping)return qa.REPEAT;if(a===THREE.ClampToEdgeWrapping)return qa.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return qa.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return qa.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return qa.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return qa.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return qa.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return qa.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return qa.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return qa.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return qa.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return qa.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return qa.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return qa.BYTE;if(a===THREE.ShortType)return qa.SHORT;if(a===THREE.UnsignedShortType)return qa.UNSIGNED_SHORT;if(a===THREE.IntType)return qa.INT;if(a===THREE.UnsignedIntType)return qa.UNSIGNED_INT;if(a===THREE.FloatType)return qa.FLOAT;if(b=sa.get("OES_texture_half_float"),null!==b&&a===THREE.HalfFloatType)return b.HALF_FLOAT_OES;if(a===THREE.AlphaFormat)return qa.ALPHA;if(a===THREE.RGBFormat)return qa.RGB;if(a===THREE.RGBAFormat)return qa.RGBA;if(a===THREE.LuminanceFormat)return qa.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return qa.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return qa.FUNC_ADD;if(a===THREE.SubtractEquation)return qa.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return qa.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return qa.ZERO;if(a===THREE.OneFactor)return qa.ONE;if(a===THREE.SrcColorFactor)return qa.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return qa.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return qa.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return qa.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return qa.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return qa.ONE_MINUS_DST_ALPHA;
if(a===THREE.DstColorFactor)return qa.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return qa.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return qa.SRC_ALPHA_SATURATE;if(b=sa.get("WEBGL_compressed_texture_s3tc"),null!==b){if(a===THREE.RGB_S3TC_DXT1_Format)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(b=sa.get("WEBGL_compressed_texture_pvrtc"),null!==b){if(a===THREE.RGB_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===THREE.RGB_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===THREE.RGBA_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===THREE.RGBA_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(b=sa.get("WEBGL_compressed_texture_etc1"),null!==b&&a===THREE.RGB_ETC1_Format)return b.COMPRESSED_RGB_ETC1_WEBGL;if(b=sa.get("EXT_blend_minmax"),null!==b){if(a===THREE.MinEquation)return b.MIN_EXT;if(a===THREE.MaxEquation)return b.MAX_EXT}return 0}a=a||{};var D=void 0!==a.canvas?a.canvas:document.createElement("canvas"),E=void 0!==a.context?a.context:null,F=void 0!==a.alpha&&a.alpha,G=void 0===a.depth||a.depth,H=void 0===a.stencil||a.stencil,I=void 0!==a.antialias&&a.antialias,J=void 0===a.premultipliedAlpha||a.premultipliedAlpha,K=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,L=[],M=[],N=-1,O=[],P=-1,Q=new Float32Array(8),R=[],S=[];this.domElement=D,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMapping=THREE.LinearToneMapping,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var T=this,U=null,V=null,W=null,X=-1,Y="",Z=null,$=new THREE.Vector4,_=null,aa=new THREE.Vector4,ba=0,ca=new THREE.Color(0),da=0,ea=D.width,fa=D.height,ga=1,ha=new THREE.Vector4(0,0,ea,fa),ia=!1,ja=new THREE.Vector4(0,0,ea,fa),ka=new THREE.Frustum,la=new THREE.Matrix4,ma=new THREE.Vector3,na={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[],shadowsPointLight:0},oa={geometries:0,textures:0},pa={calls:0,vertices:0,faces:0,points:0};this.info={render:pa,memory:oa,programs:null};var qa;try{if(F={alpha:F,depth:G,stencil:H,antialias:I,premultipliedAlpha:J,preserveDrawingBuffer:K},qa=E||D.getContext("webgl",F)||D.getContext("experimental-webgl",F),null===qa){if(null!==D.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}void 0===qa.getShaderPrecisionFormat&&(qa.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),D.addEventListener("webglcontextlost",e,!1)}catch(ra){console.error("THREE.WebGLRenderer: "+ra)}var sa=new THREE.WebGLExtensions(qa);sa.get("OES_texture_float"),sa.get("OES_texture_float_linear"),sa.get("OES_texture_half_float"),sa.get("OES_texture_half_float_linear"),sa.get("OES_standard_derivatives"),sa.get("ANGLE_instanced_arrays"),sa.get("OES_element_index_uint")&&(THREE.BufferGeometry.MaxIndex=4294967296);var ta=new THREE.WebGLCapabilities(qa,sa,a),ua=new THREE.WebGLState(qa,sa,C),va=new THREE.WebGLProperties,wa=new THREE.WebGLObjects(qa,va,this.info),xa=new THREE.WebGLPrograms(this,ta),ya=new THREE.WebGLLights;this.info.programs=xa.programs;var za=new THREE.WebGLBufferRenderer(qa,sa,pa),Aa=new THREE.WebGLIndexedBufferRenderer(qa,sa,pa);c(),this.context=qa,this.capabilities=ta,this.extensions=sa,this.properties=va,this.state=ua;var Ba=new THREE.WebGLShadowMap(this,na,wa);this.shadowMap=Ba;var Ca=new THREE.SpritePlugin(this,R),Da=new THREE.LensFlarePlugin(this,S);this.getContext=function(){return qa},this.getContextAttributes=function(){return qa.getContextAttributes()},this.forceContextLoss=function(){sa.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var a;return function(){if(void 0!==a)return a;var b=sa.get("EXT_texture_filter_anisotropic");return a=null!==b?qa.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return ta.precision},this.getPixelRatio=function(){return ga},this.setPixelRatio=function(a){void 0!==a&&(ga=a,this.setSize(ja.z,ja.w,!1))},this.getSize=function(){return{width:ea,height:fa}},this.setSize=function(a,b,c){ea=a,fa=b,D.width=a*ga,D.height=b*ga,!1!==c&&(D.style.width=a+"px",D.style.height=b+"px"),this.setViewport(0,0,a,b)},this.setViewport=function(a,b,c,d){ua.viewport(ja.set(a,b,c,d))},this.setScissor=function(a,b,c,d){ua.scissor(ha.set(a,b,c,d))},this.setScissorTest=function(a){ua.setScissorTest(ia=a)},this.getClearColor=function(){return ca},this.setClearColor=function(a,c){ca.set(a),da=void 0!==c?c:1,b(ca.r,ca.g,ca.b,da)},this.getClearAlpha=function(){return da},this.setClearAlpha=function(a){da=a,b(ca.r,ca.g,ca.b,da)},this.clear=function(a,b,c){var d=0;(void 0===a||a)&&(d|=qa.COLOR_BUFFER_BIT),(void 0===b||b)&&(d|=qa.DEPTH_BUFFER_BIT),(void 0===c||c)&&(d|=qa.STENCIL_BUFFER_BIT),qa.clear(d)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(a,b,c,d){this.setRenderTarget(a),this.clear(b,c,d)},this.resetGLState=d,this.dispose=function(){D.removeEventListener("webglcontextlost",e,!1)},this.renderBufferImmediate=function(a,b,c){ua.initAttributes();var d=va.get(a);if(a.hasPositions&&!d.position&&(d.position=qa.createBuffer()),a.hasNormals&&!d.normal&&(d.normal=qa.createBuffer()),a.hasUvs&&!d.uv&&(d.uv=qa.createBuffer()),a.hasColors&&!d.color&&(d.color=qa.createBuffer()),b=b.getAttributes(),a.hasPositions&&(qa.bindBuffer(qa.ARRAY_BUFFER,d.position),qa.bufferData(qa.ARRAY_BUFFER,a.positionArray,qa.DYNAMIC_DRAW),ua.enableAttribute(b.position),qa.vertexAttribPointer(b.position,3,qa.FLOAT,!1,0,0)),a.hasNormals){if(qa.bindBuffer(qa.ARRAY_BUFFER,d.normal),"MeshPhongMaterial"!==c.type&&"MeshStandardMaterial"!==c.type&&c.shading===THREE.FlatShading)for(var e=0,f=3*a.count;e<f;e+=9){var g=a.normalArray,h=(g[e+0]+g[e+3]+g[e+6])/3,i=(g[e+1]+g[e+4]+g[e+7])/3,j=(g[e+2]+g[e+5]+g[e+8])/3;g[e+0]=h,g[e+1]=i,g[e+2]=j,g[e+3]=h,g[e+4]=i,g[e+5]=j,g[e+6]=h,g[e+7]=i,g[e+8]=j}qa.bufferData(qa.ARRAY_BUFFER,a.normalArray,qa.DYNAMIC_DRAW),ua.enableAttribute(b.normal),qa.vertexAttribPointer(b.normal,3,qa.FLOAT,!1,0,0)}a.hasUvs&&c.map&&(qa.bindBuffer(qa.ARRAY_BUFFER,d.uv),qa.bufferData(qa.ARRAY_BUFFER,a.uvArray,qa.DYNAMIC_DRAW),ua.enableAttribute(b.uv),qa.vertexAttribPointer(b.uv,2,qa.FLOAT,!1,0,0)),a.hasColors&&c.vertexColors!==THREE.NoColors&&(qa.bindBuffer(qa.ARRAY_BUFFER,d.color),qa.bufferData(qa.ARRAY_BUFFER,a.colorArray,qa.DYNAMIC_DRAW),ua.enableAttribute(b.color),qa.vertexAttribPointer(b.color,3,qa.FLOAT,!1,0,0)),ua.disableUnusedAttributes(),qa.drawArrays(qa.TRIANGLES,0,a.count),a.count=0},this.renderBufferDirect=function(a,b,c,d,e,f){p(d);var g=q(a,b,d,e),h=!1;if(a=c.id+"_"+g.id+"_"+d.wireframe,a!==Y&&(Y=a,h=!0),b=e.morphTargetInfluences,void 0!==b){a=[];for(var i=0,h=b.length;i<h;i++){var k=b[i];a.push([k,i])}a.sort(j),8<a.length&&(a.length=8);for(var l=c.morphAttributes,i=0,h=a.length;i<h;i++)k=a[i],Q[i]=k[0],0!==k[0]?(b=k[1],!0===d.morphTargets&&l.position&&c.addAttribute("morphTarget"+i,l.position[b]),!0===d.morphNormals&&l.normal&&c.addAttribute("morphNormal"+i,l.normal[b])):(!0===d.morphTargets&&c.removeAttribute("morphTarget"+i),!0===d.morphNormals&&c.removeAttribute("morphNormal"+i));a=g.getUniforms(),null!==a.morphTargetInfluences&&qa.uniform1fv(a.morphTargetInfluences,Q),h=!0}if(b=c.index,i=c.attributes.position,!0===d.wireframe&&(b=wa.getWireframeAttribute(c)),null!==b?(a=Aa,a.setIndex(b)):a=za,h){var m,h=void 0;if(c instanceof THREE.InstancedBufferGeometry&&(m=sa.get("ANGLE_instanced_arrays"),null===m))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===h&&(h=0),ua.initAttributes();var n,k=c.attributes,g=g.getAttributes(),l=d.defaultAttributeValues;for(n in g){var o=g[n];if(0<=o){var r=k[n];if(void 0!==r){var s=r.itemSize,t=wa.getAttributeBuffer(r);if(r instanceof THREE.InterleavedBufferAttribute){var u=r.data,v=u.stride,r=r.offset;u instanceof THREE.InstancedInterleavedBuffer?(ua.enableAttributeAndDivisor(o,u.meshPerAttribute,m),void 0===c.maxInstancedCount&&(c.maxInstancedCount=u.meshPerAttribute*u.count)):ua.enableAttribute(o),qa.bindBuffer(qa.ARRAY_BUFFER,t),qa.vertexAttribPointer(o,s,qa.FLOAT,!1,v*u.array.BYTES_PER_ELEMENT,(h*v+r)*u.array.BYTES_PER_ELEMENT)}else r instanceof THREE.InstancedBufferAttribute?(ua.enableAttributeAndDivisor(o,r.meshPerAttribute,m),void 0===c.maxInstancedCount&&(c.maxInstancedCount=r.meshPerAttribute*r.count)):ua.enableAttribute(o),qa.bindBuffer(qa.ARRAY_BUFFER,t),qa.vertexAttribPointer(o,s,qa.FLOAT,!1,0,h*s*4)}else if(void 0!==l&&(s=l[n],void 0!==s))switch(s.length){case 2:qa.vertexAttrib2fv(o,s);break;case 3:qa.vertexAttrib3fv(o,s);break;case 4:qa.vertexAttrib4fv(o,s);break;default:qa.vertexAttrib1fv(o,s)}}}ua.disableUnusedAttributes()}null!==b&&qa.bindBuffer(qa.ELEMENT_ARRAY_BUFFER,wa.getAttributeBuffer(b))}if(m=1/0,null!==b?m=b.count:void 0!==i&&(m=i.count),n=c.drawRange.start,b=c.drawRange.count,i=null!==f?f.start:0,h=null!==f?f.count:1/0,f=Math.max(0,n,i),m=Math.min(0+m,n+b,i+h)-1,m=Math.max(0,m-f+1),e instanceof THREE.Mesh)if(!0===d.wireframe)ua.setLineWidth(d.wireframeLinewidth*(null===V?ga:1)),a.setMode(qa.LINES);else switch(e.drawMode){case THREE.TrianglesDrawMode:a.setMode(qa.TRIANGLES);break;case THREE.TriangleStripDrawMode:a.setMode(qa.TRIANGLE_STRIP);break;case THREE.TriangleFanDrawMode:a.setMode(qa.TRIANGLE_FAN)}else e instanceof THREE.Line?(d=d.linewidth,void 0===d&&(d=1),ua.setLineWidth(d*(null===V?ga:1)),e instanceof THREE.LineSegments?a.setMode(qa.LINES):a.setMode(qa.LINE_STRIP)):e instanceof THREE.Points&&a.setMode(qa.POINTS);c instanceof THREE.InstancedBufferGeometry?0<c.maxInstancedCount&&a.renderInstances(c,f,m):a.render(f,m)},this.render=function(a,b,c,d){if(!1==b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var e=a.fog;Y="",X=-1,Z=null,!0===a.autoUpdate&&a.updateMatrixWorld(),null===b.parent&&b.updateMatrixWorld(),b.matrixWorldInverse.getInverse(b.matrixWorld),la.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),ka.setFromMatrix(la),L.length=0,P=N=-1,R.length=0,S.length=0,n(a,b),M.length=N+1,O.length=P+1,!0===T.sortObjects&&(M.sort(k),O.sort(l));var f,g,h,i,j,m,p=L,q=0,r=0,s=0,t=b.matrixWorldInverse,u=0,v=0,x=0,y=0,z=0;for(f=na.shadowsPointLight=0,g=p.length;f<g;f++)if(h=p[f],i=h.color,j=h.intensity,m=h.distance,h instanceof THREE.AmbientLight)q+=i.r*j,r+=i.g*j,s+=i.b*j;else if(h instanceof THREE.DirectionalLight){var A=ya.get(h);A.color.copy(h.color).multiplyScalar(h.intensity),A.direction.setFromMatrixPosition(h.matrixWorld),ma.setFromMatrixPosition(h.target.matrixWorld),A.direction.sub(ma),A.direction.transformDirection(t),(A.shadow=h.castShadow)&&(A.shadowBias=h.shadow.bias,A.shadowRadius=h.shadow.radius,A.shadowMapSize=h.shadow.mapSize,na.shadows[z++]=h),na.directionalShadowMap[u]=h.shadow.map,na.directionalShadowMatrix[u]=h.shadow.matrix,na.directional[u++]=A}else h instanceof THREE.SpotLight?(A=ya.get(h),A.position.setFromMatrixPosition(h.matrixWorld),A.position.applyMatrix4(t),A.color.copy(i).multiplyScalar(j),A.distance=m,A.direction.setFromMatrixPosition(h.matrixWorld),ma.setFromMatrixPosition(h.target.matrixWorld),A.direction.sub(ma),A.direction.transformDirection(t),A.coneCos=Math.cos(h.angle),A.penumbraCos=Math.cos(h.angle*(1-h.penumbra)),A.decay=0===h.distance?0:h.decay,(A.shadow=h.castShadow)&&(A.shadowBias=h.shadow.bias,A.shadowRadius=h.shadow.radius,A.shadowMapSize=h.shadow.mapSize,na.shadows[z++]=h),na.spotShadowMap[x]=h.shadow.map,na.spotShadowMatrix[x]=h.shadow.matrix,na.spot[x++]=A):h instanceof THREE.PointLight?(A=ya.get(h),A.position.setFromMatrixPosition(h.matrixWorld),A.position.applyMatrix4(t),A.color.copy(h.color).multiplyScalar(h.intensity),A.distance=h.distance,A.decay=0===h.distance?0:h.decay,(A.shadow=h.castShadow)&&(A.shadowBias=h.shadow.bias,A.shadowRadius=h.shadow.radius,A.shadowMapSize=h.shadow.mapSize,na.shadows[z++]=h),na.pointShadowMap[v]=h.shadow.map,void 0===na.pointShadowMatrix[v]&&(na.pointShadowMatrix[v]=new THREE.Matrix4),ma.setFromMatrixPosition(h.matrixWorld).negate(),na.pointShadowMatrix[v].identity().setPosition(ma),na.point[v++]=A):h instanceof THREE.HemisphereLight&&(A=ya.get(h),A.direction.setFromMatrixPosition(h.matrixWorld),A.direction.transformDirection(t),A.direction.normalize(),A.skyColor.copy(h.color).multiplyScalar(j),A.groundColor.copy(h.groundColor).multiplyScalar(j),na.hemi[y++]=A);na.ambient[0]=q,na.ambient[1]=r,na.ambient[2]=s,na.directional.length=u,na.spot.length=x,na.point.length=v,na.hemi.length=y,na.shadows.length=z,na.hash=u+","+v+","+x+","+y+","+z,Ba.render(a,b),pa.calls=0,pa.vertices=0,pa.faces=0,pa.points=0,void 0===c&&(c=null),this.setRenderTarget(c),(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),a.overrideMaterial?(d=a.overrideMaterial,o(M,b,e,d),o(O,b,e,d)):(ua.setBlending(THREE.NoBlending),o(M,b,e),o(O,b,e)),Ca.render(a,b),Da.render(a,b,aa),c&&(a=c.texture,a.generateMipmaps&&w(c)&&a.minFilter!==THREE.NearestFilter&&a.minFilter!==THREE.LinearFilter&&(a=c instanceof THREE.WebGLRenderTargetCube?qa.TEXTURE_CUBE_MAP:qa.TEXTURE_2D,c=va.get(c.texture).__webglTexture,ua.bindTexture(a,c),qa.generateMipmap(a),ua.bindTexture(a,null))),ua.setDepthTest(!0),ua.setDepthWrite(!0),ua.setColorWrite(!0)}},this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?ua.disable(qa.CULL_FACE):(b===THREE.FrontFaceDirectionCW?qa.frontFace(qa.CW):qa.frontFace(qa.CCW),a===THREE.CullFaceBack?qa.cullFace(qa.BACK):a===THREE.CullFaceFront?qa.cullFace(qa.FRONT):qa.cullFace(qa.FRONT_AND_BACK),ua.enable(qa.CULL_FACE))},this.setTexture=function(a,b){var c=va.get(a);if(0<a.version&&c.__version!==a.version){var d=a.image;if(void 0===d)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",a);else if(!1===d.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",a);else{void 0===c.__webglInit&&(c.__webglInit=!0,a.addEventListener("dispose",f),c.__webglTexture=qa.createTexture(),oa.textures++),ua.activeTexture(qa.TEXTURE0+b),ua.bindTexture(qa.TEXTURE_2D,c.__webglTexture),qa.pixelStorei(qa.UNPACK_FLIP_Y_WEBGL,a.flipY),qa.pixelStorei(qa.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),qa.pixelStorei(qa.UNPACK_ALIGNMENT,a.unpackAlignment);var e=v(a.image,ta.maxTextureSize);if((a.wrapS!==THREE.ClampToEdgeWrapping||a.wrapT!==THREE.ClampToEdgeWrapping||a.minFilter!==THREE.NearestFilter&&a.minFilter!==THREE.LinearFilter)&&!1===w(e))if(d=e,d instanceof HTMLImageElement||d instanceof HTMLCanvasElement){var g=document.createElement("canvas");g.width=THREE.Math.nearestPowerOfTwo(d.width),g.height=THREE.Math.nearestPowerOfTwo(d.height),g.getContext("2d").drawImage(d,0,0,g.width,g.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+d.width+"x"+d.height+"). Resized to "+g.width+"x"+g.height,d),e=g}else e=d;var d=w(e),g=C(a.format),h=C(a.type);u(qa.TEXTURE_2D,a,d);var i=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<i.length&&d){for(var j=0,k=i.length;j<k;j++)e=i[j],ua.texImage2D(qa.TEXTURE_2D,j,g,e.width,e.height,0,g,h,e.data);a.generateMipmaps=!1}else ua.texImage2D(qa.TEXTURE_2D,0,g,e.width,e.height,0,g,h,e.data);else if(a instanceof THREE.CompressedTexture)for(j=0,k=i.length;j<k;j++)e=i[j],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?-1<ua.getCompressedTextureFormats().indexOf(g)?ua.compressedTexImage2D(qa.TEXTURE_2D,j,g,e.width,e.height,0,e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ua.texImage2D(qa.TEXTURE_2D,j,g,e.width,e.height,0,g,h,e.data);else if(0<i.length&&d){for(j=0,k=i.length;j<k;j++)e=i[j],ua.texImage2D(qa.TEXTURE_2D,j,g,g,h,e);a.generateMipmaps=!1}else ua.texImage2D(qa.TEXTURE_2D,0,g,g,h,e);a.generateMipmaps&&d&&qa.generateMipmap(qa.TEXTURE_2D),c.__version=a.version,a.onUpdate&&a.onUpdate(a)}}else ua.activeTexture(qa.TEXTURE0+b),ua.bindTexture(qa.TEXTURE_2D,c.__webglTexture)},this.getCurrentRenderTarget=function(){return V},this.setRenderTarget=function(a){if((V=a)&&void 0===va.get(a).__webglFramebuffer){var b=va.get(a),c=va.get(a.texture);a.addEventListener("dispose",g),c.__webglTexture=qa.createTexture(),oa.textures++;var d=a instanceof THREE.WebGLRenderTargetCube,e=THREE.Math.isPowerOfTwo(a.width)&&THREE.Math.isPowerOfTwo(a.height);if(d){b.__webglFramebuffer=[];for(var f=0;6>f;f++)b.__webglFramebuffer[f]=qa.createFramebuffer()}else b.__webglFramebuffer=qa.createFramebuffer();if(d){for(ua.bindTexture(qa.TEXTURE_CUBE_MAP,c.__webglTexture),u(qa.TEXTURE_CUBE_MAP,a.texture,e),f=0;6>f;f++)z(b.__webglFramebuffer[f],a,qa.COLOR_ATTACHMENT0,qa.TEXTURE_CUBE_MAP_POSITIVE_X+f);a.texture.generateMipmaps&&e&&qa.generateMipmap(qa.TEXTURE_CUBE_MAP),ua.bindTexture(qa.TEXTURE_CUBE_MAP,null)}else ua.bindTexture(qa.TEXTURE_2D,c.__webglTexture),u(qa.TEXTURE_2D,a.texture,e),z(b.__webglFramebuffer,a,qa.COLOR_ATTACHMENT0,qa.TEXTURE_2D),a.texture.generateMipmaps&&e&&qa.generateMipmap(qa.TEXTURE_2D),ua.bindTexture(qa.TEXTURE_2D,null);if(a.depthBuffer){if(b=va.get(a),a instanceof THREE.WebGLRenderTargetCube)for(b.__webglDepthbuffer=[],c=0;6>c;c++)qa.bindFramebuffer(qa.FRAMEBUFFER,b.__webglFramebuffer[c]),b.__webglDepthbuffer[c]=qa.createRenderbuffer(),A(b.__webglDepthbuffer[c],a);else qa.bindFramebuffer(qa.FRAMEBUFFER,b.__webglFramebuffer),b.__webglDepthbuffer=qa.createRenderbuffer(),A(b.__webglDepthbuffer,a);qa.bindFramebuffer(qa.FRAMEBUFFER,null)}}b=a instanceof THREE.WebGLRenderTargetCube,a?(c=va.get(a),c=b?c.__webglFramebuffer[a.activeCubeFace]:c.__webglFramebuffer,$.copy(a.scissor),_=a.scissorTest,aa.copy(a.viewport)):(c=null,$.copy(ha).multiplyScalar(ga),_=ia,aa.copy(ja).multiplyScalar(ga)),W!==c&&(qa.bindFramebuffer(qa.FRAMEBUFFER,c),W=c),ua.scissor($),ua.setScissorTest(_),ua.viewport(aa),b&&(b=va.get(a.texture),qa.framebufferTexture2D(qa.FRAMEBUFFER,qa.COLOR_ATTACHMENT0,qa.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,b.__webglTexture,a.activeMipMapLevel))},this.readRenderTargetPixels=function(a,b,c,d,e,f){if(!1==a instanceof THREE.WebGLRenderTarget)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var g=va.get(a).__webglFramebuffer;if(g){var h=!1;g!==W&&(qa.bindFramebuffer(qa.FRAMEBUFFER,g),h=!0);try{var i=a.texture;i.format!==THREE.RGBAFormat&&C(i.format)!==qa.getParameter(qa.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):i.type===THREE.UnsignedByteType||C(i.type)===qa.getParameter(qa.IMPLEMENTATION_COLOR_READ_TYPE)||i.type===THREE.FloatType&&sa.get("WEBGL_color_buffer_float")||i.type===THREE.HalfFloatType&&sa.get("EXT_color_buffer_half_float")?qa.checkFramebufferStatus(qa.FRAMEBUFFER)===qa.FRAMEBUFFER_COMPLETE?qa.readPixels(b,c,d,e,C(i.format),C(i.type),f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{h&&qa.bindFramebuffer(qa.FRAMEBUFFER,W)}}}}},THREE.WebGLRenderTarget=function(a,b,c){this.uuid=THREE.Math.generateUUID(),this.width=a,this.height=b,this.scissor=new THREE.Vector4(0,0,a,b),this.scissorTest=!1,this.viewport=new THREE.Vector4(0,0,a,b),c=c||{},void 0===c.minFilter&&(c.minFilter=THREE.LinearFilter),this.texture=new THREE.Texture((void 0),(void 0),c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy),this.depthBuffer=void 0===c.depthBuffer||c.depthBuffer,this.stencilBuffer=void 0===c.stencilBuffer||c.stencilBuffer},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(a,b){this.width===a&&this.height===b||(this.width=a,this.height=b,this.dispose()),this.viewport.set(0,0,a,b),this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.width=a.width,this.height=a.height,this.viewport.copy(a.viewport),this.texture=a.texture.clone(),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c),this.activeMipMapLevel=this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.WebGLBufferRenderer=function(a,b,c){var d;this.setMode=function(a){d=a},this.render=function(b,e){a.drawArrays(d,b,e),c.calls++,c.vertices+=e,d===a.TRIANGLES&&(c.faces+=e/3)},this.renderInstances=function(e){var f=b.get("ANGLE_instanced_arrays");if(null===f)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var g=e.attributes.position,h=0,h=g instanceof THREE.InterleavedBufferAttribute?g.data.count:g.count;f.drawArraysInstancedANGLE(d,0,h,e.maxInstancedCount),c.calls++,c.vertices+=h*e.maxInstancedCount,d===a.TRIANGLES&&(c.faces+=e.maxInstancedCount*h/3)}}},THREE.WebGLIndexedBufferRenderer=function(a,b,c){var d,e,f;this.setMode=function(a){d=a},this.setIndex=function(c){c.array instanceof Uint32Array&&b.get("OES_element_index_uint")?(e=a.UNSIGNED_INT,f=4):(e=a.UNSIGNED_SHORT,f=2)},this.render=function(b,g){a.drawElements(d,g,e,b*f),c.calls++,c.vertices+=g,d===a.TRIANGLES&&(c.faces+=g/3)},this.renderInstances=function(g,h,i){var j=b.get("ANGLE_instanced_arrays");null===j?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(j.drawElementsInstancedANGLE(d,i,e,h*f,g.maxInstancedCount),c.calls++,c.vertices+=i*g.maxInstancedCount,d===a.TRIANGLES&&(c.faces+=g.maxInstancedCount*i/3))}},THREE.WebGLExtensions=function(a){var b={};this.get=function(c){if(void 0!==b[c])return b[c];var d;switch(c){case"EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":d=a.getExtension("WEBGL_compressed_texture_etc1");break;default:d=a.getExtension(c)}return null===d&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported."),b[c]=d}},THREE.WebGLCapabilities=function(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=d,this.precision=void 0!==c.precision?c.precision:"highp",this.logarithmicDepthBuffer=void 0!==c.logarithmicDepthBuffer&&c.logarithmicDepthBuffer,this.maxTextures=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),this.maxCubemapSize=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=a.getParameter(a.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=a.getParameter(a.MAX_VARYING_VECTORS),this.maxFragmentUniforms=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!b.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures,c=d(this.precision),c!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",c,"instead."),this.precision=c),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!b.get("EXT_frag_depth"))},THREE.WebGLGeometries=function(a,b,c){function d(a){var g=a.target;a=f[g.id],null!==a.index&&e(a.index);var h,i=a.attributes;for(h in i)e(i[h]);g.removeEventListener("dispose",d),delete f[g.id],h=b.get(g),h.wireframe&&e(h.wireframe),b["delete"](g),g=b.get(a),g.wireframe&&e(g.wireframe),b["delete"](a),c.memory.geometries--}function e(c){var d;d=c instanceof THREE.InterleavedBufferAttribute?b.get(c.data).__webglBuffer:b.get(c).__webglBuffer,void 0!==d&&(a.deleteBuffer(d),c instanceof THREE.InterleavedBufferAttribute?b["delete"](c.data):b["delete"](c))}var f={};this.get=function(a){var b=a.geometry;if(void 0!==f[b.id])return f[b.id];b.addEventListener("dispose",d);var e;return b instanceof THREE.BufferGeometry?e=b:b instanceof THREE.Geometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new THREE.BufferGeometry).setFromObject(a)),e=b._bufferGeometry),f[b.id]=e,c.memory.geometries++,e}},THREE.WebGLLights=function(){var a={};this.get=function(b){if(void 0!==a[b.id])return a[b.id];var c;switch(b.type){case"DirectionalLight":c={direction:new THREE.Vector3,color:new THREE.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"SpotLight":c={position:new THREE.Vector3,direction:new THREE.Vector3,color:new THREE.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"PointLight":c={position:new THREE.Vector3,color:new THREE.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"HemisphereLight":c={direction:new THREE.Vector3,skyColor:new THREE.Color,groundColor:new THREE.Color}}return a[b.id]=c}},THREE.WebGLObjects=function(a,b,c){function d(c,d){var e=c instanceof THREE.InterleavedBufferAttribute?c.data:c,f=b.get(e);void 0===f.__webglBuffer?(f.__webglBuffer=a.createBuffer(),a.bindBuffer(d,f.__webglBuffer),a.bufferData(d,e.array,e.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW),f.version=e.version):f.version!==e.version&&(a.bindBuffer(d,f.__webglBuffer),!1===e.dynamic||-1===e.updateRange.count?a.bufferSubData(d,0,e.array):0===e.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(a.bufferSubData(d,e.updateRange.offset*e.array.BYTES_PER_ELEMENT,e.array.subarray(e.updateRange.offset,e.updateRange.offset+e.updateRange.count)),e.updateRange.count=0),f.version=e.version)}function e(a,b,c){if(b>c){var d=b;b=c,c=d}return d=a[b],void 0===d?(a[b]=[c],!0):-1===d.indexOf(c)&&(d.push(c),!0)}var f=new THREE.WebGLGeometries(a,b,c);this.getAttributeBuffer=function(a){return a instanceof THREE.InterleavedBufferAttribute?b.get(a.data).__webglBuffer:b.get(a).__webglBuffer},this.getWireframeAttribute=function(c){var f=b.get(c);if(void 0!==f.wireframe)return f.wireframe;var g=[],h=c.index,i=c.attributes;if(c=i.position,null!==h)for(var i={},h=h.array,j=0,k=h.length;j<k;j+=3){var l=h[j+0],m=h[j+1],n=h[j+2];e(i,l,m)&&g.push(l,m),e(i,m,n)&&g.push(m,n),e(i,n,l)&&g.push(n,l)}else for(h=i.position.array,j=0,k=h.length/3-1;j<k;j+=3)l=j+0,m=j+1,n=j+2,g.push(l,m,m,n,n,l);return g=new THREE.BufferAttribute(new(65535<c.count?Uint32Array:Uint16Array)(g),1),d(g,a.ELEMENT_ARRAY_BUFFER),f.wireframe=g},this.update=function(b){var c=f.get(b);b.geometry instanceof THREE.Geometry&&c.updateFromObject(b),b=c.index;var e=c.attributes;null!==b&&d(b,a.ELEMENT_ARRAY_BUFFER);for(var g in e)d(e[g],a.ARRAY_BUFFER);b=c.morphAttributes;for(g in b)for(var e=b[g],h=0,i=e.length;h<i;h++)d(e[h],a.ARRAY_BUFFER);return c}},THREE.WebGLProgram=function(){function a(a){switch(a){case THREE.LinearEncoding:return["Linear","( value )"];case THREE.sRGBEncoding:return["sRGB","( value )"];case THREE.RGBEEncoding:return["RGBE","( value )"];case THREE.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case THREE.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case THREE.RGBDEncoding:return["RGBD","( value, 256.0 )"];case THREE.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a)}}function b(b,c){var d=a(c);return"vec4 "+b+"( vec4 value ) { return "+d[0]+"ToLinear"+d[1]+"; }"}function c(b,c){var d=a(c);return"vec4 "+b+"( vec4 value ) { return LinearTo"+d[0]+d[1]+"; }"}function d(a,b){var c;switch(b){case THREE.LinearToneMapping:c="Linear";break;case THREE.ReinhardToneMapping:c="Reinhard";break;case THREE.Uncharted2ToneMapping:c="Uncharted2";break;case THREE.CineonToneMapping:c="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+b)}return"vec3 "+a+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function e(a,b,c){return a=a||{},[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(g).join("\n")}function f(a){var b,c=[];for(b in a){var d=a[b];!1!==d&&c.push("#define "+b+" "+d)}return c.join("\n")}function g(a){return""!==a}function h(a,b){return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights)}function i(a){return a.replace(/#include +<([\w\d.]+)>/g,function(a,b){var c=THREE.ShaderChunk[b];if(void 0===c)throw Error("Can not resolve #include <"+b+">");return i(c)})}function j(a){return a.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,b,c,d){for(a="",b=parseInt(b);b<parseInt(c);b++)a+=d.replace(/\[ i \]/g,"[ "+b+" ]");return a})}var k=0,l=/^([\w\d_]+)\.([\w\d_]+)$/,m=/^([\w\d_]+)\[(\d+)\]\.([\w\d_]+)$/,n=/^([\w\d_]+)\[0\]$/;return function(a,o,p,q){var r=a.context,s=p.extensions,t=p.defines,u=p.__webglShader.vertexShader,v=p.__webglShader.fragmentShader,w="SHADOWMAP_TYPE_BASIC";q.shadowMapType===THREE.PCFShadowMap?w="SHADOWMAP_TYPE_PCF":q.shadowMapType===THREE.PCFSoftShadowMap&&(w="SHADOWMAP_TYPE_PCF_SOFT");var x="ENVMAP_TYPE_CUBE",y="ENVMAP_MODE_REFLECTION",z="ENVMAP_BLENDING_MULTIPLY";if(q.envMap){switch(p.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:x="ENVMAP_TYPE_CUBE";break;case THREE.CubeUVReflectionMapping:case THREE.CubeUVRefractionMapping:x="ENVMAP_TYPE_CUBE_UV";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:x="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:x="ENVMAP_TYPE_SPHERE"}switch(p.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:y="ENVMAP_MODE_REFRACTION"}switch(p.combine){case THREE.MultiplyOperation:z="ENVMAP_BLENDING_MULTIPLY";
break;case THREE.MixOperation:z="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:z="ENVMAP_BLENDING_ADD"}}var A=0<a.gammaFactor?a.gammaFactor:1,s=e(s,q,a.extensions),B=f(t),C=r.createProgram();p instanceof THREE.RawShaderMaterial?a=t="":(t=["precision "+q.precision+" float;","precision "+q.precision+" int;","#define SHADER_NAME "+p.__webglShader.name,B,q.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+q.maxBones,q.map?"#define USE_MAP":"",q.envMap?"#define USE_ENVMAP":"",q.envMap?"#define "+y:"",q.lightMap?"#define USE_LIGHTMAP":"",q.aoMap?"#define USE_AOMAP":"",q.emissiveMap?"#define USE_EMISSIVEMAP":"",q.bumpMap?"#define USE_BUMPMAP":"",q.normalMap?"#define USE_NORMALMAP":"",q.displacementMap&&q.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",q.specularMap?"#define USE_SPECULARMAP":"",q.roughnessMap?"#define USE_ROUGHNESSMAP":"",q.metalnessMap?"#define USE_METALNESSMAP":"",q.alphaMap?"#define USE_ALPHAMAP":"",q.vertexColors?"#define USE_COLOR":"",q.flatShading?"#define FLAT_SHADED":"",q.skinning?"#define USE_SKINNING":"",q.useVertexTexture?"#define BONE_TEXTURE":"",q.morphTargets?"#define USE_MORPHTARGETS":"",q.morphNormals&&!1===q.flatShading?"#define USE_MORPHNORMALS":"",q.doubleSided?"#define DOUBLE_SIDED":"",q.flipSided?"#define FLIP_SIDED":"",q.shadowMapEnabled?"#define USE_SHADOWMAP":"",q.shadowMapEnabled?"#define "+w:"",0<q.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",q.sizeAttenuation?"#define USE_SIZEATTENUATION":"",q.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",q.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(g).join("\n"),a=[s,"precision "+q.precision+" float;","precision "+q.precision+" int;","#define SHADER_NAME "+p.__webglShader.name,B,q.alphaTest?"#define ALPHATEST "+q.alphaTest:"","#define GAMMA_FACTOR "+A,q.useFog&&q.fog?"#define USE_FOG":"",q.useFog&&q.fogExp?"#define FOG_EXP2":"",q.map?"#define USE_MAP":"",q.envMap?"#define USE_ENVMAP":"",q.envMap?"#define "+x:"",q.envMap?"#define "+y:"",q.envMap?"#define "+z:"",q.lightMap?"#define USE_LIGHTMAP":"",q.aoMap?"#define USE_AOMAP":"",q.emissiveMap?"#define USE_EMISSIVEMAP":"",q.bumpMap?"#define USE_BUMPMAP":"",q.normalMap?"#define USE_NORMALMAP":"",q.specularMap?"#define USE_SPECULARMAP":"",q.roughnessMap?"#define USE_ROUGHNESSMAP":"",q.metalnessMap?"#define USE_METALNESSMAP":"",q.alphaMap?"#define USE_ALPHAMAP":"",q.vertexColors?"#define USE_COLOR":"",q.flatShading?"#define FLAT_SHADED":"",q.doubleSided?"#define DOUBLE_SIDED":"",q.flipSided?"#define FLIP_SIDED":"",q.shadowMapEnabled?"#define USE_SHADOWMAP":"",q.shadowMapEnabled?"#define "+w:"",0<q.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",q.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",q.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",q.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",q.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",q.envMap&&a.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",q.toneMapping!==THREE.NoToneMapping?"#define TONE_MAPPING":"",q.toneMapping!==THREE.NoToneMapping?THREE.ShaderChunk.tonemapping_pars_fragment:"",q.toneMapping!==THREE.NoToneMapping?d("toneMapping",q.toneMapping):"",q.outputEncoding||q.mapEncoding||q.envMapEncoding||q.emissiveMapEncoding?THREE.ShaderChunk.encodings_pars_fragment:"",q.mapEncoding?b("mapTexelToLinear",q.mapEncoding):"",q.envMapEncoding?b("envMapTexelToLinear",q.envMapEncoding):"",q.emissiveMapEncoding?b("emissiveMapTexelToLinear",q.emissiveMapEncoding):"",q.outputEncoding?c("linearToOutputTexel",q.outputEncoding):"","\n"].filter(g).join("\n")),u=i(u,q),u=h(u,q),v=i(v,q),v=h(v,q),!1==p instanceof THREE.ShaderMaterial&&(u=j(u),v=j(v)),v=a+v,u=THREE.WebGLShader(r,r.VERTEX_SHADER,t+u),v=THREE.WebGLShader(r,r.FRAGMENT_SHADER,v),r.attachShader(C,u),r.attachShader(C,v),void 0!==p.index0AttributeName?r.bindAttribLocation(C,0,p.index0AttributeName):!0===q.morphTargets&&r.bindAttribLocation(C,0,"position"),r.linkProgram(C),q=r.getProgramInfoLog(C),w=r.getShaderInfoLog(u),x=r.getShaderInfoLog(v),z=y=!0,!1===r.getProgramParameter(C,r.LINK_STATUS)?(y=!1,console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(C,r.VALIDATE_STATUS),"gl.getProgramInfoLog",q,w,x)):""!==q?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",q):""!==w&&""!==x||(z=!1),z&&(this.diagnostics={runnable:y,material:p,programLog:q,vertexShader:{log:w,prefix:t},fragmentShader:{log:x,prefix:a}}),r.deleteShader(u),r.deleteShader(v);var D;this.getUniforms=function(){if(void 0===D){for(var a={},b=r.getProgramParameter(C,r.ACTIVE_UNIFORMS),c=0;c<b;c++){var d=r.getActiveUniform(C,c).name,e=r.getUniformLocation(C,d),f=l.exec(d);if(f){var d=f[1],f=f[2],g=a[d];g||(g=a[d]={}),g[f]=e}else if(f=m.exec(d)){var g=f[1],d=f[2],f=f[3],h=a[g];h||(h=a[g]=[]),(g=h[d])||(g=h[d]={}),g[f]=e}else(f=n.exec(d))?(g=f[1],a[g]=e):a[d]=e}D=a}return D};var E;return this.getAttributes=function(){if(void 0===E){for(var a={},b=r.getProgramParameter(C,r.ACTIVE_ATTRIBUTES),c=0;c<b;c++){var d=r.getActiveAttrib(C,c).name;a[d]=r.getAttribLocation(C,d)}E=a}return E},this.destroy=function(){r.deleteProgram(C),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=k++,this.code=o,this.usedTimes=1,this.program=C,this.vertexShader=u,this.fragmentShader=v,this}}(),THREE.WebGLPrograms=function(a,b){function c(a,b){var c;return a?a instanceof THREE.Texture?c=a.encoding:a instanceof THREE.WebGLRenderTarget&&(c=a.texture.encoding):c=THREE.LinearEncoding,c===THREE.LinearEncoding&&b&&(c=THREE.GammaEncoding),c}var d=[],e={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"standard",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},f="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights shadowMapEnabled pointLightShadows toneMapping physicallyCorrectLights shadowMapType alphaTest doubleSided flipSided".split(" ");this.getParameters=function(d,f,g,h){var i,j=e[d.type];b.floatVertexTextures&&h&&h.skeleton&&h.skeleton.useVertexTexture?i=1024:(i=Math.floor((b.maxVertexUniforms-20)/4),void 0!==h&&h instanceof THREE.SkinnedMesh&&(i=Math.min(h.skeleton.bones.length,i),i<h.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+h.skeleton.bones.length+", this GPU supports just "+i+" (try OpenGL instead of ANGLE)")));var k=a.getPrecision();return null!==d.precision&&(k=b.getMaxPrecision(d.precision),k!==d.precision&&console.warn("THREE.WebGLProgram.getParameters:",d.precision,"not supported, using",k,"instead.")),{shaderID:j,precision:k,supportsVertexTextures:b.vertexTextures,outputEncoding:c(a.getCurrentRenderTarget(),a.gammaOutput),map:!!d.map,mapEncoding:c(d.map,a.gammaInput),envMap:!!d.envMap,envMapMode:d.envMap&&d.envMap.mapping,envMapEncoding:c(d.envMap,a.gammaInput),envMapCubeUV:!!d.envMap&&(d.envMap.mapping===THREE.CubeUVReflectionMapping||d.envMap.mapping===THREE.CubeUVRefractionMapping),lightMap:!!d.lightMap,aoMap:!!d.aoMap,emissiveMap:!!d.emissiveMap,emissiveMapEncoding:c(d.emissiveMap,a.gammaInput),bumpMap:!!d.bumpMap,normalMap:!!d.normalMap,displacementMap:!!d.displacementMap,roughnessMap:!!d.roughnessMap,metalnessMap:!!d.metalnessMap,specularMap:!!d.specularMap,alphaMap:!!d.alphaMap,combine:d.combine,vertexColors:d.vertexColors,fog:g,useFog:d.fog,fogExp:g instanceof THREE.FogExp2,flatShading:d.shading===THREE.FlatShading,sizeAttenuation:d.sizeAttenuation,logarithmicDepthBuffer:b.logarithmicDepthBuffer,skinning:d.skinning,maxBones:i,useVertexTexture:b.floatVertexTextures&&h&&h.skeleton&&h.skeleton.useVertexTexture,morphTargets:d.morphTargets,morphNormals:d.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:f.directional.length,numPointLights:f.point.length,numSpotLights:f.spot.length,numHemiLights:f.hemi.length,pointLightShadows:f.shadowsPointLight,shadowMapEnabled:a.shadowMap.enabled&&h.receiveShadow&&0<f.shadows.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:d.premultipliedAlpha,alphaTest:d.alphaTest,doubleSided:d.side===THREE.DoubleSide,flipSided:d.side===THREE.BackSide}},this.getProgramCode=function(a,b){var c=[];if(b.shaderID?c.push(b.shaderID):(c.push(a.fragmentShader),c.push(a.vertexShader)),void 0!==a.defines)for(var d in a.defines)c.push(d),c.push(a.defines[d]);for(d=0;d<f.length;d++){var e=f[d];c.push(e),c.push(b[e])}return c.join()},this.acquireProgram=function(b,c,e){for(var f,g=0,h=d.length;g<h;g++){var i=d[g];if(i.code===e){f=i,++f.usedTimes;break}}return void 0===f&&(f=new THREE.WebGLProgram(a,e,b,c),d.push(f)),f},this.releaseProgram=function(a){if(0===--a.usedTimes){var b=d.indexOf(a);d[b]=d[d.length-1],d.pop(),a.destroy()}},this.programs=d},THREE.WebGLProperties=function(){var a={};this.get=function(b){b=b.uuid;var c=a[b];return void 0===c&&(c={},a[b]=c),c},this["delete"]=function(b){delete a[b.uuid]},this.clear=function(){a={}}},THREE.WebGLShader=function(){function a(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}return function(b,c,d){var e=b.createShader(c);return b.shaderSource(e,d),b.compileShader(e),!1===b.getShaderParameter(e,b.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==b.getShaderInfoLog(e)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",c===b.VERTEX_SHADER?"vertex":"fragment",b.getShaderInfoLog(e),a(d)),e}}(),THREE.WebGLShadowMap=function(a,b,c){function d(a,b,c,d){var e=a.geometry,f=null,f=n,g=a.customDepthMaterial;return c&&(f=o,g=a.customDistanceMaterial),g?f=g:(a=a instanceof THREE.SkinnedMesh&&b.skinning,g=0,void 0!==e.morphTargets&&0<e.morphTargets.length&&b.morphTargets&&(g|=1),a&&(g|=2),f=f[g]),f.visible=b.visible,f.wireframe=b.wireframe,f.wireframeLinewidth=b.wireframeLinewidth,c&&void 0!==f.uniforms.lightPos&&f.uniforms.lightPos.value.copy(d),f}function e(a,b,c){if(!1!==a.visible){a.layers.test(b.layers)&&(a instanceof THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Points)&&a.castShadow&&(!1===a.frustumCulled||!0===h.intersectsObject(a))&&!0===a.material.visible&&(a.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,a.matrixWorld),m.push(a)),a=a.children;for(var d=0,f=a.length;d<f;d++)e(a[d],b,c)}}for(var f=a.context,g=a.state,h=new THREE.Frustum,i=new THREE.Matrix4,j=new THREE.Vector2,k=new THREE.Vector3,l=new THREE.Vector3,m=[],n=Array(4),o=Array(4),p=[new THREE.Vector3(1,0,0),new THREE.Vector3((-1),0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,(-1)),new THREE.Vector3(0,1,0),new THREE.Vector3(0,(-1),0)],q=[new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,(-1))],r=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],s=THREE.ShaderLib.depthRGBA,t=THREE.UniformsUtils.clone(s.uniforms),u=THREE.ShaderLib.distanceRGBA,v=THREE.UniformsUtils.clone(u.uniforms),w=0;4!==w;++w){var x=0!==(1&w),y=0!==(2&w),z=new THREE.ShaderMaterial({uniforms:t,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,morphTargets:x,skinning:y});n[w]=z,x=new THREE.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:v,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,morphTargets:x,skinning:y}),o[w]=x}var A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=THREE.PCFShadowMap,this.cullFace=THREE.CullFaceFront,this.render=function(n,o){var s,t,u=b.shadows;if(0!==u.length&&!1!==A.enabled&&(!1!==A.autoUpdate||!1!==A.needsUpdate)){g.clearColor(1,1,1,1),g.disable(f.BLEND),g.enable(f.CULL_FACE),f.frontFace(f.CCW),f.cullFace(A.cullFace===THREE.CullFaceFront?f.FRONT:f.BACK),g.setDepthTest(!0),g.setScissorTest(!1);for(var v=0,w=u.length;v<w;v++){var x=u[v],y=x.shadow,z=y.camera;if(j.copy(y.mapSize),x instanceof THREE.PointLight){s=6,t=!0;var B=j.x,C=j.y;r[0].set(2*B,C,B,C),r[1].set(0,C,B,C),r[2].set(3*B,C,B,C),r[3].set(B,C,B,C),r[4].set(3*B,0,B,C),r[5].set(B,0,B,C),j.x*=4,j.y*=2}else s=1,t=!1;for(null===y.map&&(y.map=new THREE.WebGLRenderTarget(j.x,j.y,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),x instanceof THREE.SpotLight&&(z.aspect=j.x/j.y),z.updateProjectionMatrix()),B=y.map,y=y.matrix,l.setFromMatrixPosition(x.matrixWorld),z.position.copy(l),a.setRenderTarget(B),a.clear(),B=0;B<s;B++){t?(k.copy(z.position),k.add(p[B]),z.up.copy(q[B]),z.lookAt(k),g.viewport(r[B])):(k.setFromMatrixPosition(x.target.matrixWorld),z.lookAt(k)),z.updateMatrixWorld(),z.matrixWorldInverse.getInverse(z.matrixWorld),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(z.projectionMatrix),y.multiply(z.matrixWorldInverse),i.multiplyMatrices(z.projectionMatrix,z.matrixWorldInverse),h.setFromMatrix(i),m.length=0,e(n,o,z);for(var C=0,D=m.length;C<D;C++){var E=m[C],F=c.update(E),G=E.material;if(G instanceof THREE.MultiMaterial)for(var H=F.groups,G=G.materials,I=0,J=H.length;I<J;I++){var K=H[I],L=G[K.materialIndex];!0===L.visible&&(L=d(E,L,t,l),a.renderBufferDirect(z,null,F,L,E,K))}else L=d(E,G,t,l),a.renderBufferDirect(z,null,F,L,E,null)}}}s=a.getClearColor(),t=a.getClearAlpha(),a.setClearColor(s,t),g.enable(f.BLEND),A.cullFace===THREE.CullFaceFront&&f.cullFace(f.BACK),A.needsUpdate=!1}}},THREE.WebGLState=function(a,b,c){var d=this,e=new THREE.Vector4,f=new Uint8Array(16),g=new Uint8Array(16),h=new Uint8Array(16),i={},j=null,k=null,l=null,m=null,n=null,o=null,p=null,q=null,r=!1,s=null,t=null,u=null,v=null,w=null,x=null,y=null,z=null,A=null,B=null,C=null,D=null,E=null,F=null,G=null,H=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),I=void 0,J={},K=new THREE.Vector4,L=null,M=null,N=new THREE.Vector4,O=new THREE.Vector4,P=a.createTexture();a.bindTexture(a.TEXTURE_2D,P),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGB,1,1,0,a.RGB,a.UNSIGNED_BYTE,new Uint8Array(3)),this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),a.frontFace(a.CCW),a.cullFace(a.BACK),this.enable(a.CULL_FACE),this.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var a=0,b=f.length;a<b;a++)f[a]=0},this.enableAttribute=function(c){f[c]=1,0===g[c]&&(a.enableVertexAttribArray(c),g[c]=1),0!==h[c]&&(b.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(c,0),h[c]=0)},this.enableAttributeAndDivisor=function(b,c,d){f[b]=1,0===g[b]&&(a.enableVertexAttribArray(b),g[b]=1),h[b]!==c&&(d.vertexAttribDivisorANGLE(b,c),h[b]=c)},this.disableUnusedAttributes=function(){for(var b=0,c=g.length;b<c;b++)g[b]!==f[b]&&(a.disableVertexAttribArray(b),g[b]=0)},this.enable=function(b){!0!==i[b]&&(a.enable(b),i[b]=!0)},this.disable=function(b){!1!==i[b]&&(a.disable(b),i[b]=!1)},this.getCompressedTextureFormats=function(){if(null===j&&(j=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")))for(var c=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),d=0;d<c.length;d++)j.push(c[d]);return j},this.setBlending=function(b,d,e,f,g,h,i,j){b===THREE.NoBlending?this.disable(a.BLEND):this.enable(a.BLEND),b===k&&j===r||(b===THREE.AdditiveBlending?j?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE,a.ONE,a.ONE)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE)):b===THREE.SubtractiveBlending?j?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR)):b===THREE.MultiplyBlending?j?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.SRC_COLOR,a.SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR)):j?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)),k=b,r=j),b===THREE.CustomBlending?(g=g||d,h=h||e,i=i||f,d===l&&g===o||(a.blendEquationSeparate(c(d),c(g)),l=d,o=g),e===m&&f===n&&h===p&&i===q||(a.blendFuncSeparate(c(e),c(f),c(h),c(i)),m=e,n=f,p=h,q=i)):q=p=o=n=m=l=null},this.setDepthFunc=function(b){if(s!==b){if(b)switch(b){case THREE.NeverDepth:a.depthFunc(a.NEVER);break;case THREE.AlwaysDepth:a.depthFunc(a.ALWAYS);break;case THREE.LessDepth:a.depthFunc(a.LESS);break;case THREE.LessEqualDepth:a.depthFunc(a.LEQUAL);break;case THREE.EqualDepth:a.depthFunc(a.EQUAL);break;case THREE.GreaterEqualDepth:a.depthFunc(a.GEQUAL);break;case THREE.GreaterDepth:a.depthFunc(a.GREATER);break;case THREE.NotEqualDepth:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);s=b}},this.setDepthTest=function(b){b?this.enable(a.DEPTH_TEST):this.disable(a.DEPTH_TEST)},this.setDepthWrite=function(b){t!==b&&(a.depthMask(b),t=b)},this.setColorWrite=function(b){u!==b&&(a.colorMask(b,b,b,b),u=b)},this.setStencilFunc=function(b,c,d){w===b&&x===c&&y===d||(a.stencilFunc(b,c,d),w=b,x=c,y=d)},this.setStencilOp=function(b,c,d){z===b&&A===c&&B===d||(a.stencilOp(b,c,d),z=b,A=c,B=d)},this.setStencilTest=function(b){b?this.enable(a.STENCIL_TEST):this.disable(a.STENCIL_TEST)},this.setStencilWrite=function(b){v!==b&&(a.stencilMask(b),v=b)},this.setFlipSided=function(b){C!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),C=b)},this.setLineWidth=function(b){b!==D&&(a.lineWidth(b),D=b)},this.setPolygonOffset=function(b,c,d){b?this.enable(a.POLYGON_OFFSET_FILL):this.disable(a.POLYGON_OFFSET_FILL),!b||E===c&&F===d||(a.polygonOffset(c,d),E=c,F=d)},this.getScissorTest=function(){return G},this.setScissorTest=function(b){(G=b)?this.enable(a.SCISSOR_TEST):this.disable(a.SCISSOR_TEST)},this.activeTexture=function(b){void 0===b&&(b=a.TEXTURE0+H-1),I!==b&&(a.activeTexture(b),I=b)},this.bindTexture=function(b,c){void 0===I&&d.activeTexture();var e=J[I];void 0===e&&(e={type:void 0,texture:void 0},J[I]=e),e.type===b&&e.texture===c||(a.bindTexture(b,c||P),e.type=b,e.texture=c)},this.compressedTexImage2D=function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(b){console.error(b)}},this.texImage2D=function(){try{a.texImage2D.apply(a,arguments)}catch(b){console.error(b)}},this.clearColor=function(b,c,d,f){e.set(b,c,d,f),!1===K.equals(e)&&(a.clearColor(b,c,d,f),K.copy(e))},this.clearDepth=function(b){L!==b&&(a.clearDepth(b),L=b)},this.clearStencil=function(b){M!==b&&(a.clearStencil(b),M=b)},this.scissor=function(b){!1===N.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),N.copy(b))},this.viewport=function(b){!1===O.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),O.copy(b))},this.reset=function(){for(var b=0;b<g.length;b++)1===g[b]&&(a.disableVertexAttribArray(b),g[b]=0);i={},j=null,I=void 0,J={},C=v=t=u=k=null}},THREE.LensFlarePlugin=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=a.context,t=a.state;this.render=function(u,v,w){if(0!==b.length){u=new THREE.Vector3;var x=w.w/w.z,y=.5*w.z,z=.5*w.w,A=16/w.w,B=new THREE.Vector2(A*x,A),C=new THREE.Vector3(1,1,0),D=new THREE.Vector2(1,1);if(void 0===o){var A=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),E=new Uint16Array([0,1,2,0,2,3]);m=s.createBuffer(),n=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,m),s.bufferData(s.ARRAY_BUFFER,A,s.STATIC_DRAW),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),s.bufferData(s.ELEMENT_ARRAY_BUFFER,E,s.STATIC_DRAW),q=s.createTexture(),r=s.createTexture(),t.bindTexture(s.TEXTURE_2D,q),s.texImage2D(s.TEXTURE_2D,0,s.RGB,16,16,0,s.RGB,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),t.bindTexture(s.TEXTURE_2D,r),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,16,16,0,s.RGBA,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST);var A=(p=0<s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},E=s.createProgram(),F=s.createShader(s.FRAGMENT_SHADER),G=s.createShader(s.VERTEX_SHADER),H="precision "+a.getPrecision()+" float;\n";s.shaderSource(F,H+A.fragmentShader),s.shaderSource(G,H+A.vertexShader),s.compileShader(F),s.compileShader(G),s.attachShader(E,F),s.attachShader(E,G),s.linkProgram(E),o=E,k=s.getAttribLocation(o,"position"),l=s.getAttribLocation(o,"uv"),c=s.getUniformLocation(o,"renderType"),d=s.getUniformLocation(o,"map"),e=s.getUniformLocation(o,"occlusionMap"),f=s.getUniformLocation(o,"opacity"),g=s.getUniformLocation(o,"color"),h=s.getUniformLocation(o,"scale"),i=s.getUniformLocation(o,"rotation"),j=s.getUniformLocation(o,"screenPosition")}for(s.useProgram(o),t.initAttributes(),t.enableAttribute(k),t.enableAttribute(l),t.disableUnusedAttributes(),s.uniform1i(e,0),s.uniform1i(d,1),s.bindBuffer(s.ARRAY_BUFFER,m),s.vertexAttribPointer(k,2,s.FLOAT,!1,16,0),s.vertexAttribPointer(l,2,s.FLOAT,!1,16,8),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),t.disable(s.CULL_FACE),t.setDepthWrite(!1),E=0,F=b.length;E<F;E++)if(A=16/w.w,B.set(A*x,A),G=b[E],u.set(G.matrixWorld.elements[12],G.matrixWorld.elements[13],G.matrixWorld.elements[14]),u.applyMatrix4(v.matrixWorldInverse),u.applyProjection(v.projectionMatrix),C.copy(u),D.x=C.x*y+y,D.y=C.y*z+z,p||0<D.x&&D.x<w.z&&0<D.y&&D.y<w.w){t.activeTexture(s.TEXTURE0),t.bindTexture(s.TEXTURE_2D,null),t.activeTexture(s.TEXTURE1),t.bindTexture(s.TEXTURE_2D,q),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGB,w.x+D.x-8,w.y+D.y-8,16,16,0),s.uniform1i(c,0),s.uniform2f(h,B.x,B.y),s.uniform3f(j,C.x,C.y,C.z),t.disable(s.BLEND),t.enable(s.DEPTH_TEST),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),t.activeTexture(s.TEXTURE0),t.bindTexture(s.TEXTURE_2D,r),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,w.x+D.x-8,w.y+D.y-8,16,16,0),s.uniform1i(c,1),t.disable(s.DEPTH_TEST),t.activeTexture(s.TEXTURE1),t.bindTexture(s.TEXTURE_2D,q),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),G.positionScreen.copy(C),G.customUpdateCallback?G.customUpdateCallback(G):G.updateLensFlares(),s.uniform1i(c,2),t.enable(s.BLEND);for(var H=0,I=G.lensFlares.length;H<I;H++){var J=G.lensFlares[H];.001<J.opacity&&.001<J.scale&&(C.x=J.x,C.y=J.y,C.z=J.z,A=J.size*J.scale/w.w,B.x=A*x,B.y=A,s.uniform3f(j,C.x,C.y,C.z),s.uniform2f(h,B.x,B.y),s.uniform1f(i,J.rotation),s.uniform1f(f,J.opacity),s.uniform3f(g,J.color.r,J.color.g,J.color.b),t.setBlending(J.blending,J.blendEquation,J.blendSrc,J.blendDst),a.setTexture(J.texture,1),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0))}}t.enable(s.CULL_FACE),t.enable(s.DEPTH_TEST),t.setDepthWrite(!0),a.resetGLState()}}},THREE.SpritePlugin=function(a,b){function c(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:b.id-a.id}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=a.context,z=a.state,A=new THREE.Vector3,B=new THREE.Quaternion,C=new THREE.Vector3;this.render=function(D,E){if(0!==b.length){if(void 0===w){var F=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),G=new Uint16Array([0,1,2,0,2,3]);u=y.createBuffer(),v=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,u),y.bufferData(y.ARRAY_BUFFER,F,y.STATIC_DRAW),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,v),y.bufferData(y.ELEMENT_ARRAY_BUFFER,G,y.STATIC_DRAW);var F=y.createProgram(),G=y.createShader(y.VERTEX_SHADER),H=y.createShader(y.FRAGMENT_SHADER);y.shaderSource(G,["precision "+a.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),y.shaderSource(H,["precision "+a.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),y.compileShader(G),y.compileShader(H),y.attachShader(F,G),y.attachShader(F,H),y.linkProgram(F),w=F,s=y.getAttribLocation(w,"position"),t=y.getAttribLocation(w,"uv"),d=y.getUniformLocation(w,"uvOffset"),e=y.getUniformLocation(w,"uvScale"),f=y.getUniformLocation(w,"rotation"),g=y.getUniformLocation(w,"scale"),h=y.getUniformLocation(w,"color"),i=y.getUniformLocation(w,"map"),j=y.getUniformLocation(w,"opacity"),k=y.getUniformLocation(w,"modelViewMatrix"),l=y.getUniformLocation(w,"projectionMatrix"),m=y.getUniformLocation(w,"fogType"),n=y.getUniformLocation(w,"fogDensity"),o=y.getUniformLocation(w,"fogNear"),p=y.getUniformLocation(w,"fogFar"),q=y.getUniformLocation(w,"fogColor"),r=y.getUniformLocation(w,"alphaTest"),F=document.createElement("canvas"),F.width=8,F.height=8,G=F.getContext("2d"),G.fillStyle="white",G.fillRect(0,0,8,8),x=new THREE.Texture(F),x.needsUpdate=!0}y.useProgram(w),z.initAttributes(),z.enableAttribute(s),z.enableAttribute(t),z.disableUnusedAttributes(),z.disable(y.CULL_FACE),z.enable(y.BLEND),y.bindBuffer(y.ARRAY_BUFFER,u),y.vertexAttribPointer(s,2,y.FLOAT,!1,16,0),y.vertexAttribPointer(t,2,y.FLOAT,!1,16,8),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,v),y.uniformMatrix4fv(l,!1,E.projectionMatrix.elements),z.activeTexture(y.TEXTURE0),y.uniform1i(i,0),G=F=0,(H=D.fog)?(y.uniform3f(q,H.color.r,H.color.g,H.color.b),H instanceof THREE.Fog?(y.uniform1f(o,H.near),y.uniform1f(p,H.far),y.uniform1i(m,1),G=F=1):H instanceof THREE.FogExp2&&(y.uniform1f(n,H.density),y.uniform1i(m,2),G=F=2)):(y.uniform1i(m,0),G=F=0);for(var H=0,I=b.length;H<I;H++){var J=b[H];J.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,J.matrixWorld),J.z=-J.modelViewMatrix.elements[14]}b.sort(c);for(var K=[],H=0,I=b.length;H<I;H++){var J=b[H],L=J.material;y.uniform1f(r,L.alphaTest),y.uniformMatrix4fv(k,!1,J.modelViewMatrix.elements),J.matrixWorld.decompose(A,B,C),K[0]=C.x,K[1]=C.y,
J=0,D.fog&&L.fog&&(J=G),F!==J&&(y.uniform1i(m,J),F=J),null!==L.map?(y.uniform2f(d,L.map.offset.x,L.map.offset.y),y.uniform2f(e,L.map.repeat.x,L.map.repeat.y)):(y.uniform2f(d,0,0),y.uniform2f(e,1,1)),y.uniform1f(j,L.opacity),y.uniform3f(h,L.color.r,L.color.g,L.color.b),y.uniform1f(f,L.rotation),y.uniform2fv(g,K),z.setBlending(L.blending,L.blendEquation,L.blendSrc,L.blendDst),z.setDepthTest(L.depthTest),z.setDepthWrite(L.depthWrite),L.map&&L.map.image&&L.map.image.width?a.setTexture(L.map,0):a.setTexture(x,0),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0)}z.enable(y.CULL_FACE),a.resetGLState()}}},Object.defineProperties(THREE.Box2.prototype,{empty:{value:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()}},isIntersectionBox:{value:function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)}}}),Object.defineProperties(THREE.Box3.prototype,{empty:{value:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()}},isIntersectionBox:{value:function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)}},isIntersectionSphere:{value:function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)}}}),Object.defineProperties(THREE.Matrix3.prototype,{multiplyVector3:{value:function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)}},multiplyVector3Array:{value:function(a){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(a)}}}),Object.defineProperties(THREE.Matrix4.prototype,{extractPosition:{value:function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)}},setRotationFromQuaternion:{value:function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)}},multiplyVector3:{value:function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),a.applyProjection(this)}},multiplyVector4:{value:function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)}},multiplyVector3Array:{value:function(a){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(a)}},rotateAxis:{value:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)}},crossVector:{value:function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)}},translate:{value:function(a){console.error("THREE.Matrix4: .translate() has been removed.")}},rotateX:{value:function(a){console.error("THREE.Matrix4: .rotateX() has been removed.")}},rotateY:{value:function(a){console.error("THREE.Matrix4: .rotateY() has been removed.")}},rotateZ:{value:function(a){console.error("THREE.Matrix4: .rotateZ() has been removed.")}},rotateByAxis:{value:function(a,b){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}}),Object.defineProperties(THREE.Plane.prototype,{isIntersectionLine:{value:function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)}}}),Object.defineProperties(THREE.Quaternion.prototype,{multiplyVector3:{value:function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)}}}),Object.defineProperties(THREE.Ray.prototype,{isIntersectionBox:{value:function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)}},isIntersectionPlane:{value:function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)}},isIntersectionSphere:{value:function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)}}}),Object.defineProperties(THREE.Vector3.prototype,{setEulerFromRotationMatrix:{value:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")}},setEulerFromQuaternion:{value:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")}},getPositionFromMatrix:{value:function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)}},getScaleFromMatrix:{value:function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)}},getColumnFromMatrix:{value:function(a,b){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(a,b)}}}),THREE.Face4=function(a,b,c,d,e,f,g){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(a,b,c,e,f,g)},THREE.Vertex=function(a,b,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new THREE.Vector3(a,b,c)},Object.defineProperties(THREE.Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=a}},getChildByName:{value:function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)}},renderDepth:{set:function(a){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")}},translate:{value:function(a,b){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(b,a)}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(a){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(THREE,{PointCloud:{value:function(a,b){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new THREE.Points(a,b)}},ParticleSystem:{value:function(a,b){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new THREE.Points(a,b)}}}),Object.defineProperties(THREE.Light.prototype,{onlyShadow:{set:function(a){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=a}},shadowCameraVisible:{set:function(a){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=a}},shadowDarkness:{set:function(a){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=a}}}),Object.defineProperties(THREE.BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.defineProperties(THREE.BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}},addIndex:{value:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(a)}},addDrawCall:{value:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(a,b)}},clearDrawCalls:{value:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()}},computeTangents:{value:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")}},computeOffsets:{value:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}}),Object.defineProperties(THREE.Material.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(a){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new THREE.Color}}}),Object.defineProperties(THREE,{PointCloudMaterial:{value:function(a){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(a)}},ParticleBasicMaterial:{value:function(a){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(a)}},ParticleSystemMaterial:{value:function(a){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(a)}}}),Object.defineProperties(THREE.MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(a){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(THREE.ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=a}}}),Object.defineProperties(THREE.WebGLRenderer.prototype,{supportsFloatTextures:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")}},supportsHalfFloatTextures:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")}},supportsStandardDerivatives:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")}},supportsCompressedTextureS3TC:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")}},supportsCompressedTexturePVRTC:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")}},supportsBlendMinMax:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")}},supportsVertexTextures:{value:function(){return this.capabilities.vertexTextures}},supportsInstancedArrays:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")}},enableScissorTest:{value:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(a)}},initMaterial:{value:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")}},addPrePlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")}},addPostPlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")}},updateShadowMap:{value:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=a}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=a}}}),Object.defineProperties(THREE.WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=a}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=a}}}),THREE.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry),a.merge(b,d,c)},center:function(a){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),a.center()}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var e=new THREE.TextureLoader;return e.setCrossOrigin(this.crossOrigin),a=e.load(a,c,void 0,d),b&&(a.mapping=b),a},loadTextureCube:function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var e=new THREE.CubeTextureLoader;return e.setCrossOrigin(this.crossOrigin),a=e.load(a,c,void 0,d),b&&(a.mapping=b),a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project()."),a.project(b)},this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),a.unproject(b)},this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},THREE.MeshFaceMaterial=THREE.MultiMaterial,THREE.CurveUtils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a,b,c,d,e){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,e){a=.5*(c-a),d=.5*(d-b);var f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}},THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Group,d=0,e=b.length;d<e;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld),b.remove(a),c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld),a.applyMatrix(d),b.remove(a),c.add(a)}},THREE.ShapeUtils={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},triangulate:function(){return function(a,b){var c=a.length;if(3>c)return null;var d,e,f,g=[],h=[],i=[];if(0<THREE.ShapeUtils.area(a))for(e=0;e<c;e++)h[e]=e;else for(e=0;e<c;e++)h[e]=c-1-e;var j=2*c;for(e=c-1;2<c;){if(0>=j--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}d=e,c<=d&&(d=0),e=d+1,c<=e&&(e=0),f=e+1,c<=f&&(f=0);var k;a:{var l=k=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,l=a[h[d]].x,m=a[h[d]].y,n=a[h[e]].x,o=a[h[e]].y,p=a[h[f]].x,q=a[h[f]].y;if(Number.EPSILON>(n-l)*(q-m)-(o-m)*(p-l))k=!1;else{var t=void 0,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,B=A=z=s=r=void 0,t=p-n,u=q-o,v=l-p,w=m-q,x=n-l,y=o-m;for(k=0;k<c;k++)if(r=a[h[k]].x,s=a[h[k]].y,!(r===l&&s===m||r===n&&s===o||r===p&&s===q)&&(z=r-l,A=s-m,B=r-n,C=s-o,r-=p,s-=q,B=t*C-u*B,z=x*A-y*z,A=v*s-w*r,B>=-Number.EPSILON&&A>=-Number.EPSILON&&z>=-Number.EPSILON)){k=!1;break a}k=!0}}if(k){for(g.push([a[h[d]],a[h[e]],a[h[f]]]),i.push([h[d],h[e],h[f]]),d=e,f=e+1;f<c;d++,f++)h[d]=h[f];c--,j=2*c}}return b?i:g}}(),triangulateShape:function(a,b){function c(a,b,c){return a.x!==b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function d(a,b,d,e,f){var g=b.x-a.x,h=b.y-a.y,i=e.x-d.x,j=e.y-d.y,k=a.x-d.x,l=a.y-d.y,m=h*i-g*j,n=h*k-g*l;if(Math.abs(m)>Number.EPSILON){if(0<m){if(0>n||n>m)return[];if(i=j*k-i*l,0>i||i>m)return[]}else{if(0<n||n<m)return[];if(i=j*k-i*l,0<i||i<m)return[]}return 0===i?!f||0!==n&&n!==m?[a]:[]:i===m?!f||0!==n&&n!==m?[b]:[]:0===n?[d]:n===m?[e]:(f=i/m,[{x:a.x+f*g,y:a.y+f*h}])}return 0!==n||j*k!==i*l?[]:(h=0===g&&0===h,i=0===i&&0===j,h&&i?a.x!==d.x||a.y!==d.y?[]:[a]:h?c(d,e,a)?[a]:[]:i?c(a,b,d)?[d]:[]:(0!==g?(a.x<b.x?(g=a,i=a.x,h=b,a=b.x):(g=b,i=b.x,h=a,a=a.x),d.x<e.x?(b=d,m=d.x,j=e,d=e.x):(b=e,m=e.x,j=d,d=d.x)):(a.y<b.y?(g=a,i=a.y,h=b,a=b.y):(g=b,i=b.y,h=a,a=a.y),d.y<e.y?(b=d,m=d.y,j=e,d=e.y):(b=e,m=e.y,j=d,d=d.y)),i<=m?a<m?[]:a===m?f?[]:[b]:a<=d?[b,h]:[b,j]:i>d?[]:i===d?f?[]:[g]:a<=d?[g,h]:[g,j]))}function e(a,b,c,d){var e=b.x-a.x,f=b.y-a.y;b=c.x-a.x,c=c.y-a.y;var g=d.x-a.x;return d=d.y-a.y,a=e*c-f*b,e=e*d-f*g,Math.abs(a)>Number.EPSILON?(b=g*c-d*b,0<a?0<=e&&0<=b:0<=e||0<=b):0<e}var f,g,h,i,j,k={};for(h=a.concat(),f=0,g=b.length;f<g;f++)Array.prototype.push.apply(h,b[f]);for(f=0,g=h.length;f<g;f++)j=h[f].x+":"+h[f].y,void 0!==k[j]&&console.warn("THREE.Shape: Duplicate point",j),k[j]=f;f=function(a,b){function c(a,b){var c=q.length-1,d=a-1;0>d&&(d=c);var f=a+1;return f>c&&(f=0),!!(c=e(q[a],q[d],q[f],h[b]))&&(c=h.length-1,d=b-1,0>d&&(d=c),f=b+1,f>c&&(f=0),!!(c=e(h[b],h[d],h[f],q[a])))}function f(a,b){var c,e;for(c=0;c<q.length;c++)if(e=c+1,e%=q.length,e=d(a,b,q[c],q[e],!0),0<e.length)return!0;return!1}function g(a,c){var e,f,g,h;for(e=0;e<r.length;e++)for(f=b[r[e]],g=0;g<f.length;g++)if(h=g+1,h%=f.length,h=d(a,c,f[g],f[h],!0),0<h.length)return!0;return!1}var h,i,j,k,l,m,n,o,p,q=a.concat(),r=[],s=[],t=0;for(i=b.length;t<i;t++)r.push(t);n=0;for(var u=2*r.length;0<r.length;){if(u--,0>u){console.log("Infinite Loop! Holes left:"+r.length+", Probably Hole outside Shape!");break}for(j=n;j<q.length;j++){for(k=q[j],i=-1,t=0;t<r.length;t++)if(l=r[t],m=k.x+":"+k.y+":"+l,void 0===s[m]){for(h=b[l],o=0;o<h.length;o++)if(l=h[o],c(j,o)&&!f(k,l)&&!g(k,l)){i=o,r.splice(t,1),n=q.slice(0,j+1),l=q.slice(j),o=h.slice(i),p=h.slice(0,i+1),q=n.concat(o).concat(p).concat(l),n=j;break}if(0<=i)break;s[m]=!0}if(0<=i)break}}return q}(a,b);var l=THREE.ShapeUtils.triangulate(f,!1);for(f=0,g=l.length;f<g;f++)for(i=l[f],h=0;3>h;h++)j=i[h].x+":"+i[h].y,j=k[j],void 0!==j&&(i[h]=j);return l.concat()},isClockWise:function(a){return 0>THREE.ShapeUtils.area(a)},b2:function(){return function(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}}(),b3:function(){return function(a,b,c,d,e){var f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}}()},THREE.Curve=function(){},THREE.Curve.prototype={constructor:THREE.Curve,getPoint:function(a){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(a){return a=this.getUtoTmapping(a),this.getPoint(a)},getPoints:function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c},getSpacedPoints:function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b,c,d=[],e=this.getPoint(0),f=0;for(d.push(0),c=1;c<=a;c++)b=this.getPoint(c/a),f+=b.distanceTo(e),d.push(f),e=b;return this.cacheArcLengths=d},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(a,b){var c,d=this.getLengths(),e=0,f=d.length;c=b?b:a*d[f-1];for(var g,h=0,i=f-1;h<=i;)if(e=Math.floor(h+(i-h)/2),g=d[e]-c,0>g)h=e+1;else{if(!(0<g)){i=e;break}i=e-1}return e=i,d[e]===c?e/(f-1):(h=d[e],d=(e+(c-h)/(d[e+1]-h))/(f-1))},getTangent:function(a){var b=a-1e-4;return a+=1e-4,0>b&&(b=0),1<a&&(a=1),b=this.getPoint(b),this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){return a=this.getUtoTmapping(a),this.getTangent(a)}},THREE.Curve.create=function(a,b){return a.prototype=Object.create(THREE.Curve.prototype),a.prototype.constructor=a,a.prototype.getPoint=b,a},THREE.CurvePath=function(){this.curves=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.constructor=THREE.CurvePath,THREE.CurvePath.prototype.add=function(a){this.curves.push(a)},THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))},THREE.CurvePath.prototype.getPoint=function(a){for(var b=a*this.getLength(),c=this.getCurveLengths(),d=0;d<c.length;){if(c[d]>=b)return a=this.curves[d],b=1-(c[d]-b)/a.getLength(),a.getPointAt(b);d++}return null},THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},THREE.CurvePath.prototype.createPointsGeometry=function(a){return a=this.getPoints(a),this.createGeometry(a)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){return a=this.getSpacedPoints(a),this.createGeometry(a)},THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new THREE.Vector3(e.x,e.y,e.z||0))}return b},THREE.Font=function(a){this.data=a},THREE.Font.prototype={constructor:THREE.Font,generateShapes:function(a,b,c){void 0===b&&(b=100),void 0===c&&(c=4);var d=this.data;a=String(a).split("");var e=b/d.resolution,f=0;b=[];for(var g=0;g<a.length;g++){var h;h=e;var i=f,j=d.glyphs[a[g]]||d.glyphs["?"];if(j){var k=new THREE.Path,l=[],m=THREE.ShapeUtils.b2,n=THREE.ShapeUtils.b3,o=void 0,p=void 0,q=p=o=void 0,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,r=void 0;if(j.o)for(var w=j._cachedOutline||(j._cachedOutline=j.o.split(" ")),x=0,y=w.length;x<y;)switch(w[x++]){case"m":o=w[x++]*h+i,p=w[x++]*h,k.moveTo(o,p);break;case"l":o=w[x++]*h+i,p=w[x++]*h,k.lineTo(o,p);break;case"q":if(o=w[x++]*h+i,p=w[x++]*h,s=w[x++]*h+i,t=w[x++]*h,k.quadraticCurveTo(s,t,o,p),r=l[l.length-1])for(var q=r.x,r=r.y,z=1;z<=c;z++){var A=z/c;m(A,q,s,o),m(A,r,t,p)}break;case"b":if(o=w[x++]*h+i,p=w[x++]*h,s=w[x++]*h+i,t=w[x++]*h,u=w[x++]*h+i,v=w[x++]*h,k.bezierCurveTo(s,t,u,v,o,p),r=l[l.length-1])for(q=r.x,r=r.y,z=1;z<=c;z++)A=z/c,n(A,q,s,u,o),n(A,r,t,v,p)}h={offset:j.ha*h,path:k}}else h=void 0;f+=h.offset,b.push(h.path)}for(c=[],d=0,a=b.length;d<a;d++)Array.prototype.push.apply(c,b[d].toShapes());return c}},THREE.Path=function(a){THREE.CurvePath.call(this),this.actions=[],a&&this.fromPoints(a)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.Path.prototype.constructor=THREE.Path,THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},THREE.Path.prototype.moveTo=function(a,b){this.actions.push({action:"moveTo",args:[a,b]})},THREE.Path.prototype.lineTo=function(a,b){var c=this.actions[this.actions.length-1].args,c=new THREE.LineCurve(new THREE.Vector2(c[c.length-2],c[c.length-1]),new THREE.Vector2(a,b));this.curves.push(c),this.actions.push({action:"lineTo",args:[a,b]})},THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var e=this.actions[this.actions.length-1].args,e=new THREE.QuadraticBezierCurve(new THREE.Vector2(e[e.length-2],e[e.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(e),this.actions.push({action:"quadraticCurveTo",args:[a,b,c,d]})},THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,e,f){var g=this.actions[this.actions.length-1].args,g=new THREE.CubicBezierCurve(new THREE.Vector2(g[g.length-2],g[g.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(e,f));this.curves.push(g),this.actions.push({action:"bezierCurveTo",args:[a,b,c,d,e,f]})},THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a),c=new THREE.SplineCurve(c),this.curves.push(c),this.actions.push({action:"splineThru",args:b})},THREE.Path.prototype.arc=function(a,b,c,d,e,f){var g=this.actions[this.actions.length-1].args;this.absarc(a+g[g.length-2],b+g[g.length-1],c,d,e,f)},THREE.Path.prototype.absarc=function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},THREE.Path.prototype.ellipse=function(a,b,c,d,e,f,g,h){var i=this.actions[this.actions.length-1].args;this.absellipse(a+i[i.length-2],b+i[i.length-1],c,d,e,f,g,h)},THREE.Path.prototype.absellipse=function(a,b,c,d,e,f,g,h){var i=[a,b,c,d,e,f,g,h||0];a=new THREE.EllipseCurve(a,b,c,d,e,f,g,h),this.curves.push(a),a=a.getPoint(1),i.push(a.x),i.push(a.y),this.actions.push({action:"ellipse",args:i})},THREE.Path.prototype.getSpacedPoints=function(a){a||(a=40);for(var b=[],c=0;c<a;c++)b.push(this.getPoint(c/a));return this.autoClose&&b.push(b[0]),b},THREE.Path.prototype.getPoints=function(a){a=a||12;for(var b,c,d,e,f,g,h,i,j,k,l=THREE.ShapeUtils.b2,m=THREE.ShapeUtils.b3,n=[],o=0,p=this.actions.length;o<p;o++){j=this.actions[o];var q=j.args;switch(j.action){case"moveTo":n.push(new THREE.Vector2(q[0],q[1]));break;case"lineTo":n.push(new THREE.Vector2(q[0],q[1]));break;case"quadraticCurveTo":for(b=q[2],c=q[3],f=q[0],g=q[1],0<n.length?(j=n[n.length-1],h=j.x,i=j.y):(j=this.actions[o-1].args,h=j[j.length-2],i=j[j.length-1]),q=1;q<=a;q++)k=q/a,j=l(k,h,f,b),k=l(k,i,g,c),n.push(new THREE.Vector2(j,k));break;case"bezierCurveTo":for(b=q[4],c=q[5],f=q[0],g=q[1],d=q[2],e=q[3],0<n.length?(j=n[n.length-1],h=j.x,i=j.y):(j=this.actions[o-1].args,h=j[j.length-2],i=j[j.length-1]),q=1;q<=a;q++)k=q/a,j=m(k,h,f,d,b),k=m(k,i,g,e,c),n.push(new THREE.Vector2(j,k));break;case"splineThru":for(j=this.actions[o-1].args,k=[new THREE.Vector2(j[j.length-2],j[j.length-1])],j=a*q[0].length,k=k.concat(q[0]),k=new THREE.SplineCurve(k),q=1;q<=j;q++)n.push(k.getPointAt(q/j));break;case"arc":for(b=q[0],c=q[1],g=q[2],d=q[3],j=q[4],f=!!q[5],h=j-d,i=2*a,q=1;q<=i;q++)k=q/i,f||(k=1-k),k=d+k*h,j=b+g*Math.cos(k),k=c+g*Math.sin(k),n.push(new THREE.Vector2(j,k));break;case"ellipse":b=q[0],c=q[1],g=q[2],e=q[3],d=q[4],j=q[5],f=!!q[6];var r=q[7];h=j-d,i=2*a;var s,t;for(0!==r&&(s=Math.cos(r),t=Math.sin(r)),q=1;q<=i;q++){if(k=q/i,f||(k=1-k),k=d+k*h,j=b+g*Math.cos(k),k=c+e*Math.sin(k),0!==r){var u=j;j=(u-b)*s-(k-c)*t+b,k=(u-b)*t+(k-c)*s+c}n.push(new THREE.Vector2(j,k))}}}return a=n[n.length-1],Math.abs(a.x-n[0].x)<Number.EPSILON&&Math.abs(a.y-n[0].y)<Number.EPSILON&&n.splice(n.length-1,1),this.autoClose&&n.push(n[0]),
n},THREE.Path.prototype.toShapes=function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new THREE.Shape;f.actions=e.actions,f.curves=e.curves,b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],i=h.x-g.x,j=h.y-g.y;if(Math.abs(j)>Number.EPSILON){if(0>j&&(g=b[f],i=-i,h=b[e],j=-j),!(a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{if(e=j*(a.x-g.x)-i*(a.y-g.y),0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x))return!0}return d}var e=THREE.ShapeUtils.isClockWise,f=function(a){for(var b=[],c=new THREE.Path,d=0,e=a.length;d<e;d++){var f=a[d],g=f.args,f=f.action;"moveTo"===f&&0!==c.actions.length&&(b.push(c),c=new THREE.Path),c[f].apply(c,g)}return 0!==c.actions.length&&b.push(c),b}(this.actions);if(0===f.length)return[];if(!0===b)return c(f);var g,h,i,j=[];if(1===f.length)return h=f[0],i=new THREE.Shape,i.actions=h.actions,i.curves=h.curves,j.push(i),j;var k=!e(f[0].getPoints()),k=a?!k:k;i=[];var l,m=[],n=[],o=0;m[o]=void 0,n[o]=[];for(var p=0,q=f.length;p<q;p++)h=f[p],l=h.getPoints(),g=e(l),(g=a?!g:g)?(!k&&m[o]&&o++,m[o]={s:new THREE.Shape,p:l},m[o].s.actions=h.actions,m[o].s.curves=h.curves,k&&o++,n[o]=[]):n[o].push({h:h,p:l[0]});if(!m[0])return c(f);if(1<m.length){for(p=!1,h=[],e=0,f=m.length;e<f;e++)i[e]=[];for(e=0,f=m.length;e<f;e++)for(g=n[e],k=0;k<g.length;k++){for(o=g[k],l=!0,q=0;q<m.length;q++)d(o.p,m[q].p)&&(e!==q&&h.push({froms:e,tos:q,hole:k}),l?(l=!1,i[q].push(o)):p=!0);l&&i[e].push(o)}0<h.length&&(p||(n=i))}for(p=0,e=m.length;p<e;p++)for(i=m[p].s,j.push(i),h=n[p],f=0,g=h.length;f<g;f++)i.holes.push(h[f].h);return j},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.constructor=THREE.Shape,THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)},THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)},THREE.Shape.prototype.getPointsHoles=function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b},THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},THREE.Shape.prototype.extractPoints=function(a){return this.extractAllPoints(a)},THREE.LineCurve=function(a,b){this.v1=a,this.v2=b},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.constructor=THREE.LineCurve,THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);return b.multiplyScalar(a).add(this.v1),b},THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)},THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()},THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a,this.v1=b,this.v2=c},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve,THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b=THREE.ShapeUtils.b2;return new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x),b(a,this.v0.y,this.v1.y,this.v2.y))},THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b=THREE.CurveUtils.tangentQuadraticBezier;return new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x),b(a,this.v0.y,this.v1.y,this.v2.y)).normalize()},THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a,this.v1=b,this.v2=c,this.v3=d},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve,THREE.CubicBezierCurve.prototype.getPoint=function(a){var b=THREE.ShapeUtils.b3;return new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},THREE.CubicBezierCurve.prototype.getTangent=function(a){var b=THREE.CurveUtils.tangentCubicBezier;return new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},THREE.SplineCurve=function(a){this.points=void 0==a?[]:a},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.constructor=THREE.SplineCurve,THREE.SplineCurve.prototype.getPoint=function(a){var b=this.points;a*=b.length-1;var c=Math.floor(a);a-=c;var d=b[0===c?c:c-1],e=b[c],f=b[c>b.length-2?b.length-1:c+1],b=b[c>b.length-3?b.length-1:c+2],c=THREE.CurveUtils.interpolate;return new THREE.Vector2(c(d.x,e.x,f.x,b.x,a),c(d.y,e.y,f.y,b.y,a))},THREE.EllipseCurve=function(a,b,c,d,e,f,g,h){this.aX=a,this.aY=b,this.xRadius=c,this.yRadius=d,this.aStartAngle=e,this.aEndAngle=f,this.aClockwise=g,this.aRotation=h||0},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve,THREE.EllipseCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;0>b&&(b+=2*Math.PI),b>2*Math.PI&&(b-=2*Math.PI),b=!0===this.aClockwise?this.aEndAngle+(1-a)*(2*Math.PI-b):this.aStartAngle+a*b,a=this.aX+this.xRadius*Math.cos(b);var c=this.aY+this.yRadius*Math.sin(b);if(0!==this.aRotation){var b=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a;a=(e-this.aX)*b-(c-this.aY)*d+this.aX,c=(e-this.aX)*d+(c-this.aY)*b+this.aY}return new THREE.Vector2(a,c)},THREE.ArcCurve=function(a,b,c,d,e,f){THREE.EllipseCurve.call(this,a,b,c,c,d,e,f)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.ArcCurve.prototype.constructor=THREE.ArcCurve,THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a,this.v2=b},function(a){var b=new THREE.Vector3;return b.subVectors(this.v2,this.v1),b.multiplyScalar(a),b.add(this.v1),b}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a,this.v1=b,this.v2=c},function(a){var b=THREE.ShapeUtils.b2;return new THREE.Vector3(b(a,this.v0.x,this.v1.x,this.v2.x),b(a,this.v0.y,this.v1.y,this.v2.y),b(a,this.v0.z,this.v1.z,this.v2.z))}),THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a,this.v1=b,this.v2=c,this.v3=d},function(a){var b=THREE.ShapeUtils.b3;return new THREE.Vector3(b(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),b(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),THREE.SplineCurve3=THREE.Curve.create(function(a){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0==a?[]:a},function(a){var b=this.points;a*=b.length-1;var c=Math.floor(a);a-=c;var d=b[0==c?c:c-1],e=b[c],f=b[c>b.length-2?b.length-1:c+1],b=b[c>b.length-3?b.length-1:c+2],c=THREE.CurveUtils.interpolate;return new THREE.Vector3(c(d.x,e.x,f.x,b.x,a),c(d.y,e.y,f.y,b.y,a),c(d.z,e.z,f.z,b.z,a))}),THREE.CatmullRomCurve3=function(){function a(){}var b=new THREE.Vector3,c=new a,d=new a,e=new a;return a.prototype.init=function(a,b,c,d){this.c0=a,this.c1=c,this.c2=-3*a+3*b-2*c-d,this.c3=2*a-2*b+c+d},a.prototype.initNonuniformCatmullRom=function(a,b,c,d,e,f,g){a=((b-a)/e-(c-a)/(e+f)+(c-b)/f)*f,d=((c-b)/f-(d-b)/(f+g)+(d-c)/g)*f,this.init(b,c,a,d)},a.prototype.initCatmullRom=function(a,b,c,d,e){this.init(b,c,e*(c-a),e*(d-b))},a.prototype.calc=function(a){var b=a*a;return this.c0+this.c1*a+this.c2*b+this.c3*b*a},THREE.Curve.create(function(a){this.points=a||[],this.closed=!1},function(a){var f,g,h=this.points;g=h.length,2>g&&console.log("duh, you need at least 2 points"),a*=g-(this.closed?0:1),f=Math.floor(a),a-=f,this.closed?f+=0<f?0:(Math.floor(Math.abs(f)/h.length)+1)*h.length:0===a&&f===g-1&&(f=g-2,a=1);var i,j,k;if(this.closed||0<f?i=h[(f-1)%g]:(b.subVectors(h[0],h[1]).add(h[0]),i=b),j=h[f%g],k=h[(f+1)%g],this.closed||f+2<g?h=h[(f+2)%g]:(b.subVectors(h[g-1],h[g-2]).add(h[g-1]),h=b),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var l="chordal"===this.type?.5:.25;g=Math.pow(i.distanceToSquared(j),l),f=Math.pow(j.distanceToSquared(k),l),l=Math.pow(k.distanceToSquared(h),l),1e-4>f&&(f=1),1e-4>g&&(g=f),1e-4>l&&(l=f),c.initNonuniformCatmullRom(i.x,j.x,k.x,h.x,g,f,l),d.initNonuniformCatmullRom(i.y,j.y,k.y,h.y,g,f,l),e.initNonuniformCatmullRom(i.z,j.z,k.z,h.z,g,f,l)}else"catmullrom"===this.type&&(g=void 0!==this.tension?this.tension:.5,c.initCatmullRom(i.x,j.x,k.x,h.x,g),d.initCatmullRom(i.y,j.y,k.y,h.y,g),e.initCatmullRom(i.z,j.z,k.z,h.z,g));return new THREE.Vector3(c.calc(a),d.calc(a),e.calc(a))})}(),THREE.ClosedSplineCurve3=function(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),THREE.CatmullRomCurve3.call(this,a),this.type="catmullrom",this.closed=!0},THREE.ClosedSplineCurve3.prototype=Object.create(THREE.CatmullRomCurve3.prototype),THREE.BoxGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f},this.fromBufferGeometry(new THREE.BoxBufferGeometry(a,b,c,d,e,f)),this.mergeVertices()},THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry,THREE.CubeGeometry=THREE.BoxGeometry,THREE.BoxBufferGeometry=function(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,i,j,t,u){var v=f/j,w=g/t,x=f/2,y=g/2,z=i/2;g=j+1;for(var A=t+1,B=f=0,C=new THREE.Vector3,D=0;D<A;D++)for(var E=D*w-y,F=0;F<g;F++)C[a]=(F*v-x)*d,C[b]=E*e,C[c]=z,l[o]=C.x,l[o+1]=C.y,l[o+2]=C.z,C[a]=0,C[b]=0,C[c]=0<i?1:-1,m[o]=C.x,m[o+1]=C.y,m[o+2]=C.z,n[p]=F/j,n[p+1]=1-D/t,o+=3,p+=2,f+=1;for(D=0;D<t;D++)for(F=0;F<j;F++)a=r+F+g*(D+1),b=r+(F+1)+g*(D+1),c=r+(F+1)+g*D,k[q]=r+F+g*D,k[q+1]=a,k[q+2]=c,k[q+3]=a,k[q+4]=b,k[q+5]=c,q+=6,B+=6;h.addGroup(s,B,u),s+=B,r+=f}THREE.BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};var h=this;d=Math.floor(d)||1,e=Math.floor(e)||1,f=Math.floor(f)||1;var i=function(a,b,c){return a=0+a*b*2+a*c*2,a+=c*b*2,4*a}(d,e,f),j=i/4*6,k=new(65535<j?Uint32Array:Uint16Array)(j),l=new Float32Array(3*i),m=new Float32Array(3*i),n=new Float32Array(2*i),o=0,p=0,q=0,r=0,s=0;g("z","y","x",-1,-1,c,b,a,f,e,0),g("z","y","x",1,-1,c,b,-a,f,e,1),g("x","z","y",1,1,a,c,b,d,f,2),g("x","z","y",1,-1,a,c,-b,d,f,3),g("x","y","z",1,-1,a,b,c,d,e,4),g("x","y","z",-1,-1,a,b,-c,d,e,5),this.setIndex(new THREE.BufferAttribute(k,1)),this.addAttribute("position",new THREE.BufferAttribute(l,3)),this.addAttribute("normal",new THREE.BufferAttribute(m,3)),this.addAttribute("uv",new THREE.BufferAttribute(n,2))},THREE.BoxBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.BoxBufferGeometry.prototype.constructor=THREE.BoxBufferGeometry,THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d},this.fromBufferGeometry(new THREE.CircleBufferGeometry(a,b,c,d))},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry,THREE.CircleBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d},a=a||50,b=void 0!==b?Math.max(3,b):8,c=void 0!==c?c:0,d=void 0!==d?d:2*Math.PI;var e=b+2,f=new Float32Array(3*e),g=new Float32Array(3*e),e=new Float32Array(2*e);g[2]=1,e[0]=.5,e[1]=.5;for(var h=0,i=3,j=2;h<=b;h++,i+=3,j+=2){var k=c+h/b*d;f[i]=a*Math.cos(k),f[i+1]=a*Math.sin(k),g[i+2]=1,e[j]=(f[i]/a+1)/2,e[j+1]=(f[i+1]/a+1)/2}for(c=[],i=1;i<=b;i++)c.push(i,i+1,0);this.setIndex(new THREE.BufferAttribute(new Uint16Array(c),1)),this.addAttribute("position",new THREE.BufferAttribute(f,3)),this.addAttribute("normal",new THREE.BufferAttribute(g,3)),this.addAttribute("uv",new THREE.BufferAttribute(e,2)),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)},THREE.CircleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.CircleBufferGeometry.prototype.constructor=THREE.CircleBufferGeometry,THREE.CylinderBufferGeometry=function(a,b,c,d,e,f,g,h){function i(c){var e,f,i;i=new THREE.Vector2;var j=new THREE.Vector3,k=!0===c?a:b,r=!0===c?1:-1;for(f=p,e=1;e<=d;e++)m.setXYZ(p,0,s*r,0),n.setXYZ(p,0,r,0),!0===c?(i.x=e/d,i.y=0):(i.x=(e-1)/d,i.y=1),o.setXY(p,i.x,i.y),p++;for(i=p,e=0;e<=d;e++){var t=e/d;j.x=k*Math.sin(t*h+g),j.y=s*r,j.z=k*Math.cos(t*h+g),m.setXYZ(p,j.x,j.y,j.z),n.setXYZ(p,0,r,0),o.setXY(p,t,!0===c?1:0),p++}for(e=0;e<d;e++)j=f+e,k=i+e,!0===c?(l.setX(q,k),q++,l.setX(q,k+1)):(l.setX(q,k+1),q++,l.setX(q,k)),q++,l.setX(q,j),q++}THREE.BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h},a=void 0!==a?a:20,b=void 0!==b?b:20,c=void 0!==c?c:100,d=Math.floor(d)||8,e=Math.floor(e)||1,f=void 0!==f&&f,g=void 0!==g?g:0,h=void 0!==h?h:2*Math.PI;var j=function(){var a=(d+1)*(e+1);return!1===f&&(a+=2*(d+1)+2*d),a}(),k=function(){var a=d*e*6;return!1===f&&(a+=6*d),a}(),l=new THREE.BufferAttribute(new(65535<k?Uint32Array:Uint16Array)(k),1),m=new THREE.BufferAttribute(new Float32Array(3*j),3),n=new THREE.BufferAttribute(new Float32Array(3*j),3),o=new THREE.BufferAttribute(new Float32Array(2*j),2),p=0,q=0,r=[],s=c/2;!function(){var f,i,j=new THREE.Vector3,k=new THREE.Vector3,t=(b-a)/c;for(i=0;i<=e;i++){var u=[],v=i/e,w=v*(b-a)+a;for(f=0;f<=d;f++){var x=f/d;k.x=w*Math.sin(x*h+g),k.y=-v*c+s,k.z=w*Math.cos(x*h+g),m.setXYZ(p,k.x,k.y,k.z),j.copy(k),(0===a&&0===i||0===b&&i===e)&&(j.x=Math.sin(x*h+g),j.z=Math.cos(x*h+g)),j.setY(Math.sqrt(j.x*j.x+j.z*j.z)*t).normalize(),n.setXYZ(p,j.x,j.y,j.z),o.setXY(p,x,1-v),u.push(p),p++}r.push(u)}for(f=0;f<d;f++)for(i=0;i<e;i++)j=r[i+1][f],k=r[i+1][f+1],t=r[i][f+1],l.setX(q,r[i][f]),q++,l.setX(q,j),q++,l.setX(q,t),q++,l.setX(q,j),q++,l.setX(q,k),q++,l.setX(q,t),q++}(),!1===f&&(0<a&&i(!0),0<b&&i(!1)),this.setIndex(l),this.addAttribute("position",m),this.addAttribute("normal",n),this.addAttribute("uv",o)},THREE.CylinderBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.CylinderBufferGeometry.prototype.constructor=THREE.CylinderBufferGeometry,THREE.CylinderGeometry=function(a,b,c,d,e,f,g,h){THREE.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h},this.fromBufferGeometry(new THREE.CylinderBufferGeometry(a,b,c,d,e,f,g,h)),this.mergeVertices()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.EdgesGeometry=function(a,b){function c(a,b){return a-b}THREE.BufferGeometry.call(this);var d,e=Math.cos(THREE.Math.degToRad(void 0!==b?b:1)),f=[0,0],g={},h=["a","b","c"];a instanceof THREE.BufferGeometry?(d=new THREE.Geometry,d.fromBufferGeometry(a)):d=a.clone(),d.mergeVertices(),d.computeFaceNormals();var i=d.vertices;d=d.faces;for(var j=0,k=d.length;j<k;j++)for(var l=d[j],m=0;3>m;m++){f[0]=l[h[m]],f[1]=l[h[(m+1)%3]],f.sort(c);var n=f.toString();void 0===g[n]?g[n]={vert1:f[0],vert2:f[1],face1:j,face2:void 0}:g[n].face2=j}f=[];for(n in g)h=g[n],(void 0===h.face2||d[h.face1].normal.dot(d[h.face2].normal)<=e)&&(j=i[h.vert1],f.push(j.x),f.push(j.y),f.push(j.z),j=i[h.vert2],f.push(j.x),f.push(j.y),f.push(j.z));this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(f),3))},THREE.EdgesGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.EdgesGeometry.prototype.constructor=THREE.EdgesGeometry,THREE.ExtrudeGeometry=function(a,b){"undefined"!=typeof a&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",a=Array.isArray(a)?a:[a],this.addShapeList(a,b),this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry,THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)},THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){return b||console.error("THREE.ExtrudeGeometry: vec does not exist"),b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=1,d=a.x-b.x,e=a.y-b.y,f=c.x-a.x,g=c.y-a.y,h=d*d+e*e;if(Math.abs(d*g-e*f)>Number.EPSILON){var i=Math.sqrt(h),j=Math.sqrt(f*f+g*g),h=b.x-e/i;if(b=b.y+d/i,f=((c.x-g/j-h)*g-(c.y+f/j-b)*f)/(d*g-e*f),c=h+d*f-a.x,a=b+e*f-a.y,d=c*c+a*a,2>=d)return new THREE.Vector2(c,a);d=Math.sqrt(d/2)}else a=!1,d>Number.EPSILON?f>Number.EPSILON&&(a=!0):d<-Number.EPSILON?f<-Number.EPSILON&&(a=!0):Math.sign(e)===Math.sign(g)&&(a=!0),a?(c=-e,a=d,d=Math.sqrt(h)):(c=d,a=e,d=Math.sqrt(h/2));return new THREE.Vector2(c/d,a/d)}function e(a,b){var c,d;for(M=a.length;0<=--M;){c=M,d=M-1,0>d&&(d=a.length-1);for(var e=0,f=s+2*p,e=0;e<f;e++){var g=K*e,h=K*(e+1),i=b+c+g,g=b+d+g,j=b+d+h,h=b+c+h,i=i+A,g=g+A,j=j+A,h=h+A;z.faces.push(new THREE.Face3(i,g,h,null,null,1)),z.faces.push(new THREE.Face3(g,j,h,null,null,1)),i=v.generateSideWallUV(z,i,g,j,h),z.faceVertexUvs[0].push([i[0],i[1],i[3]]),z.faceVertexUvs[0].push([i[1],i[2],i[3]])}}}function f(a,b,c){z.vertices.push(new THREE.Vector3(a,b,c))}function g(a,b,c){a+=A,b+=A,c+=A,z.faces.push(new THREE.Face3(a,b,c,null,null,0)),a=v.generateTopUV(z,a,b,c),z.faceVertexUvs[0].push(a)}var h,i,j,k,l,m=void 0!==b.amount?b.amount:100,n=void 0!==b.bevelThickness?b.bevelThickness:6,o=void 0!==b.bevelSize?b.bevelSize:n-2,p=void 0!==b.bevelSegments?b.bevelSegments:3,q=void 0===b.bevelEnabled||b.bevelEnabled,r=void 0!==b.curveSegments?b.curveSegments:12,s=void 0!==b.steps?b.steps:1,t=b.extrudePath,u=!1,v=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;t&&(h=t.getSpacedPoints(s),u=!0,q=!1,i=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(t,s,(!1)),j=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3),q||(o=n=p=0);var w,x,y,z=this,A=this.vertices.length,t=a.extractPoints(r),r=t.shape,B=t.holes;if(t=!THREE.ShapeUtils.isClockWise(r)){for(r=r.reverse(),x=0,y=B.length;x<y;x++)w=B[x],THREE.ShapeUtils.isClockWise(w)&&(B[x]=w.reverse());t=!1}var C=THREE.ShapeUtils.triangulateShape(r,B),D=r;for(x=0,y=B.length;x<y;x++)w=B[x],r=r.concat(w);var E,F,G,H,I,J,K=r.length,L=C.length,t=[],M=0;for(G=D.length,E=G-1,F=M+1;M<G;M++,E++,F++)E===G&&(E=0),F===G&&(F=0),t[M]=d(D[M],D[E],D[F]);var N,O=[],P=t.concat();for(x=0,y=B.length;x<y;x++){for(w=B[x],N=[],M=0,G=w.length,E=G-1,F=M+1;M<G;M++,E++,F++)E===G&&(E=0),F===G&&(F=0),N[M]=d(w[M],w[E],w[F]);O.push(N),P=P.concat(N)}for(E=0;E<p;E++){for(G=E/p,H=n*(1-G),F=o*Math.sin(G*Math.PI/2),M=0,G=D.length;M<G;M++)I=c(D[M],t[M],F),f(I.x,I.y,-H);for(x=0,y=B.length;x<y;x++)for(w=B[x],N=O[x],M=0,G=w.length;M<G;M++)I=c(w[M],N[M],F),f(I.x,I.y,-H)}for(F=o,M=0;M<K;M++)I=q?c(r[M],P[M],F):r[M],u?(k.copy(i.normals[0]).multiplyScalar(I.x),j.copy(i.binormals[0]).multiplyScalar(I.y),l.copy(h[0]).add(k).add(j),f(l.x,l.y,l.z)):f(I.x,I.y,0);for(G=1;G<=s;G++)for(M=0;M<K;M++)I=q?c(r[M],P[M],F):r[M],u?(k.copy(i.normals[G]).multiplyScalar(I.x),j.copy(i.binormals[G]).multiplyScalar(I.y),l.copy(h[G]).add(k).add(j),f(l.x,l.y,l.z)):f(I.x,I.y,m/s*G);for(E=p-1;0<=E;E--){for(G=E/p,H=n*(1-G),F=o*Math.sin(G*Math.PI/2),M=0,G=D.length;M<G;M++)I=c(D[M],t[M],F),f(I.x,I.y,m+H);for(x=0,y=B.length;x<y;x++)for(w=B[x],N=O[x],M=0,G=w.length;M<G;M++)I=c(w[M],N[M],F),u?f(I.x,I.y+h[s-1].y,h[s-1].x+H):f(I.x,I.y,m+H)}!function(){if(q){var a;for(a=0*K,M=0;M<L;M++)J=C[M],g(J[2]+a,J[1]+a,J[0]+a);for(a=s+2*p,a*=K,M=0;M<L;M++)J=C[M],g(J[0]+a,J[1]+a,J[2]+a)}else{for(M=0;M<L;M++)J=C[M],g(J[2],J[1],J[0]);for(M=0;M<L;M++)J=C[M],g(J[0]+K*s,J[1]+K*s,J[2]+K*s)}}(),function(){var a=0;for(e(D,a),a+=D.length,x=0,y=B.length;x<y;x++)w=B[x],e(w,a),a+=w.length}()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d){return a=a.vertices,b=a[b],c=a[c],d=a[d],[new THREE.Vector2(b.x,b.y),new THREE.Vector2(c.x,c.y),new THREE.Vector2(d.x,d.y)]},generateSideWallUV:function(a,b,c,d,e){return a=a.vertices,b=a[b],c=a[c],d=a[d],e=a[e],.01>Math.abs(b.y-c.y)?[new THREE.Vector2(b.x,1-b.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(d.x,1-d.z),new THREE.Vector2(e.x,1-e.z)]:[new THREE.Vector2(b.y,1-b.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(d.y,1-d.z),new THREE.Vector2(e.y,1-e.z)]}},THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this),this.type="ShapeGeometry",!1===Array.isArray(a)&&(a=[a]),this.addShapeList(a,b),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry,THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this},THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c,d,e,f=b.material,g=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,h=this.vertices.length;c=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var i=c.shape,j=c.holes;if(!THREE.ShapeUtils.isClockWise(i))for(i=i.reverse(),c=0,d=j.length;c<d;c++)e=j[c],THREE.ShapeUtils.isClockWise(e)&&(j[c]=e.reverse());var k=THREE.ShapeUtils.triangulateShape(i,j);for(c=0,d=j.length;c<d;c++)e=j[c],i=i.concat(e);for(j=i.length,d=k.length,c=0;c<j;c++)e=i[c],this.vertices.push(new THREE.Vector3(e.x,e.y,0));for(c=0;c<d;c++)j=k[c],i=j[0]+h,e=j[1]+h,j=j[2]+h,this.faces.push(new THREE.Face3(i,e,j,null,null,f)),this.faceVertexUvs[0].push(g.generateTopUV(this,i,e,j))},THREE.LatheBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:a,segments:b,phiStart:c,phiLength:d},b=Math.floor(b)||12,c=c||0,d=d||2*Math.PI,d=THREE.Math.clamp(d,0,2*Math.PI);for(var e=(b+1)*a.length,f=b*a.length*6,g=new THREE.BufferAttribute(new(65535<f?Uint32Array:Uint16Array)(f),1),h=new THREE.BufferAttribute(new Float32Array(3*e),3),i=new THREE.BufferAttribute(new Float32Array(2*e),2),j=0,k=0,l=1/b,m=new THREE.Vector3,n=new THREE.Vector2,e=0;e<=b;e++)for(var f=c+e*l*d,o=Math.sin(f),p=Math.cos(f),f=0;f<=a.length-1;f++)m.x=a[f].x*o,m.y=a[f].y,m.z=a[f].x*p,h.setXYZ(j,m.x,m.y,m.z),n.x=e/b,n.y=f/(a.length-1),i.setXY(j,n.x,n.y),j++;for(e=0;e<b;e++)for(f=0;f<a.length-1;f++)c=f+e*a.length,j=c+a.length,l=c+a.length+1,m=c+1,g.setX(k,c),k++,g.setX(k,j),k++,g.setX(k,m),k++,g.setX(k,j),k++,g.setX(k,l),k++,g.setX(k,m),k++;if(this.setIndex(g),this.addAttribute("position",h),this.addAttribute("uv",i),this.computeVertexNormals(),d===2*Math.PI)for(d=this.attributes.normal.array,g=new THREE.Vector3,h=new THREE.Vector3,i=new THREE.Vector3,c=b*a.length*3,f=e=0;e<a.length;e++,f+=3)g.x=d[f+0],g.y=d[f+1],g.z=d[f+2],h.x=d[c+f+0],h.y=d[c+f+1],h.z=d[c+f+2],i.addVectors(g,h).normalize(),d[f+0]=d[c+f+0]=i.x,d[f+1]=d[c+f+1]=i.y,d[f+2]=d[c+f+2]=i.z},THREE.LatheBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.LatheBufferGeometry.prototype.constructor=THREE.LatheBufferGeometry,THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:a,segments:b,phiStart:c,phiLength:d},this.fromBufferGeometry(new THREE.LatheBufferGeometry(a,b,c,d)),this.mergeVertices()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry,THREE.PlaneGeometry=function(a,b,c,d){THREE.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:a,height:b,widthSegments:c,heightSegments:d},this.fromBufferGeometry(new THREE.PlaneBufferGeometry(a,b,c,d))},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var e=a/2,f=b/2;c=Math.floor(c)||1,d=Math.floor(d)||1;var g=c+1,h=d+1,i=a/c,j=b/d;b=new Float32Array(g*h*3),a=new Float32Array(g*h*3);for(var k=new Float32Array(g*h*2),l=0,m=0,n=0;n<h;n++)for(var o=n*j-f,p=0;p<g;p++)b[l]=p*i-e,b[l+1]=-o,a[l+2]=1,k[m]=p/c,k[m+1]=1-n/d,l+=3,m+=2;for(l=0,e=new(65535<b.length/3?Uint32Array:Uint16Array)(c*d*6),n=0;n<d;n++)for(p=0;p<c;p++)f=p+g*(n+1),h=p+1+g*(n+1),i=p+1+g*n,e[l]=p+g*n,e[l+1]=f,e[l+2]=i,e[l+3]=f,e[l+4]=h,e[l+5]=i,l+=6;this.setIndex(new THREE.BufferAttribute(e,1)),this.addAttribute("position",new THREE.BufferAttribute(b,3)),this.addAttribute("normal",new THREE.BufferAttribute(a,3)),this.addAttribute("uv",new THREE.BufferAttribute(k,2))},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry,THREE.RingBufferGeometry=function(a,b,c,d,e,f){THREE.BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f},a=a||20,b=b||50,e=void 0!==e?e:0,f=void 0!==f?f:2*Math.PI,c=void 0!==c?Math.max(3,c):8,d=void 0!==d?Math.max(1,d):1;var g,h,i=(c+1)*(d+1),j=c*d*6,j=new THREE.BufferAttribute(new(65535<j?Uint32Array:Uint16Array)(j),1),k=new THREE.BufferAttribute(new Float32Array(3*i),3),l=new THREE.BufferAttribute(new Float32Array(3*i),3),i=new THREE.BufferAttribute(new Float32Array(2*i),2),m=0,n=0,o=a,p=(b-a)/d,q=new THREE.Vector3,r=new THREE.Vector2;for(a=0;a<=d;a++){for(h=0;h<=c;h++)g=e+h/c*f,q.x=o*Math.cos(g),q.y=o*Math.sin(g),k.setXYZ(m,q.x,q.y,q.z),l.setXYZ(m,0,0,1),r.x=(q.x/b+1)/2,r.y=(q.y/b+1)/2,i.setXY(m,r.x,r.y),m++;o+=p}for(a=0;a<d;a++)for(b=a*(c+1),h=0;h<c;h++)e=g=h+b,f=g+c+1,m=g+c+2,g+=1,j.setX(n,e),n++,j.setX(n,f),n++,j.setX(n,m),n++,j.setX(n,e),n++,j.setX(n,m),n++,j.setX(n,g),n++;this.setIndex(j),this.addAttribute("position",k),this.addAttribute("normal",l),this.addAttribute("uv",i)},THREE.RingBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.RingBufferGeometry.prototype.constructor=THREE.RingBufferGeometry,THREE.RingGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f},this.fromBufferGeometry(new THREE.RingBufferGeometry(a,b,c,d,e,f))},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry.prototype.constructor=THREE.RingGeometry,THREE.SphereGeometry=function(a,b,c,d,e,f,g){THREE.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},this.fromBufferGeometry(new THREE.SphereBufferGeometry(a,b,c,d,e,f,g))},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.SphereBufferGeometry=function(a,b,c,d,e,f,g){THREE.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},a=a||50,b=Math.max(3,Math.floor(b)||8),c=Math.max(2,Math.floor(c)||6),d=void 0!==d?d:0,e=void 0!==e?e:2*Math.PI,f=void 0!==f?f:0,g=void 0!==g?g:Math.PI;for(var h=f+g,i=(b+1)*(c+1),j=new THREE.BufferAttribute(new Float32Array(3*i),3),k=new THREE.BufferAttribute(new Float32Array(3*i),3),i=new THREE.BufferAttribute(new Float32Array(2*i),2),l=0,m=[],n=new THREE.Vector3,o=0;o<=c;o++){for(var p=[],q=o/c,r=0;r<=b;r++){var s=r/b,t=-a*Math.cos(d+s*e)*Math.sin(f+q*g),u=a*Math.cos(f+q*g),v=a*Math.sin(d+s*e)*Math.sin(f+q*g);n.set(t,u,v).normalize(),j.setXYZ(l,t,u,v),k.setXYZ(l,n.x,n.y,n.z),i.setXY(l,s,1-q),p.push(l),l++}m.push(p)}for(d=[],o=0;o<c;o++)for(r=0;r<b;r++)e=m[o][r+1],g=m[o][r],l=m[o+1][r],n=m[o+1][r+1],(0!==o||0<f)&&d.push(e,g,n),(o!==c-1||h<Math.PI)&&d.push(g,l,n);this.setIndex(new(65535<j.count?THREE.Uint32Attribute:THREE.Uint16Attribute)(d,1)),this.addAttribute("position",j),this.addAttribute("normal",k),this.addAttribute("uv",i),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)},THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry,THREE.TextGeometry=function(a,b){b=b||{};var c=b.font;return!1==c instanceof THREE.Font?(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new THREE.Geometry):(c=c.generateShapes(a,b.size,b.curveSegments),b.amount=void 0!==b.height?b.height:50,void 0===b.bevelThickness&&(b.bevelThickness=10),void 0===b.bevelSize&&(b.bevelSize=8),void 0===b.bevelEnabled&&(b.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,c,b),void(this.type="TextGeometry"))},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TextGeometry.prototype.constructor=THREE.TextGeometry,THREE.TorusBufferGeometry=function(a,b,c,d,e){THREE.BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e},a=a||100,b=b||40,c=Math.floor(c)||8,d=Math.floor(d)||6,e=e||2*Math.PI;var f,g,h=(c+1)*(d+1),i=c*d*6,i=new(65535<i?Uint32Array:Uint16Array)(i),j=new Float32Array(3*h),k=new Float32Array(3*h),h=new Float32Array(2*h),l=0,m=0,n=0,o=new THREE.Vector3,p=new THREE.Vector3,q=new THREE.Vector3;for(f=0;f<=c;f++)for(g=0;g<=d;g++){var r=g/d*e,s=f/c*Math.PI*2;p.x=(a+b*Math.cos(s))*Math.cos(r),p.y=(a+b*Math.cos(s))*Math.sin(r),p.z=b*Math.sin(s),j[l]=p.x,j[l+1]=p.y,j[l+2]=p.z,o.x=a*Math.cos(r),o.y=a*Math.sin(r),q.subVectors(p,o).normalize(),k[l]=q.x,k[l+1]=q.y,k[l+2]=q.z,h[m]=g/d,h[m+1]=f/c,l+=3,m+=2}for(f=1;f<=c;f++)for(g=1;g<=d;g++)a=(d+1)*(f-1)+g-1,b=(d+1)*(f-1)+g,e=(d+1)*f+g,i[n]=(d+1)*f+g-1,i[n+1]=a,i[n+2]=e,i[n+3]=a,i[n+4]=b,i[n+5]=e,n+=6;this.setIndex(new THREE.BufferAttribute(i,1)),this.addAttribute("position",new THREE.BufferAttribute(j,3)),this.addAttribute("normal",new THREE.BufferAttribute(k,3)),this.addAttribute("uv",new THREE.BufferAttribute(h,2))},THREE.TorusBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.TorusBufferGeometry.prototype.constructor=THREE.TorusBufferGeometry,THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e},this.fromBufferGeometry(new THREE.TorusBufferGeometry(a,b,c,d,e))},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry,THREE.TorusKnotBufferGeometry=function(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.cos(a),g=Math.sin(a);a*=c/b,b=Math.cos(a),e.x=d*(2+b)*.5*f,e.y=d*(2+b)*g*.5,e.z=d*Math.sin(a)*.5}THREE.BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f},a=a||100,b=b||40,c=Math.floor(c)||64,d=Math.floor(d)||8,e=e||2,f=f||3;var h,i,j=(d+1)*(c+1),k=d*c*6,k=new THREE.BufferAttribute(new(65535<k?Uint32Array:Uint16Array)(k),1),l=new THREE.BufferAttribute(new Float32Array(3*j),3),m=new THREE.BufferAttribute(new Float32Array(3*j),3),j=new THREE.BufferAttribute(new Float32Array(2*j),2),n=0,o=0,p=new THREE.Vector3,q=new THREE.Vector3,r=new THREE.Vector2,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector3,v=new THREE.Vector3,w=new THREE.Vector3;for(h=0;h<=c;++h)for(i=h/c*e*Math.PI*2,g(i,e,f,a,s),g(i+.01,e,f,a,t),v.subVectors(t,s),w.addVectors(t,s),u.crossVectors(v,w),w.crossVectors(u,v),u.normalize(),w.normalize(),i=0;i<=d;++i){var x=i/d*Math.PI*2,y=-b*Math.cos(x),x=b*Math.sin(x);p.x=s.x+(y*w.x+x*u.x),p.y=s.y+(y*w.y+x*u.y),p.z=s.z+(y*w.z+x*u.z),l.setXYZ(n,p.x,p.y,p.z),q.subVectors(p,s).normalize(),m.setXYZ(n,q.x,q.y,q.z),r.x=h/c,r.y=i/d,j.setXY(n,r.x,r.y),n++}for(i=1;i<=c;i++)for(h=1;h<=d;h++)a=(d+1)*i+(h-1),b=(d+1)*i+h,e=(d+1)*(i-1)+h,k.setX(o,(d+1)*(i-1)+(h-1)),o++,k.setX(o,a),o++,k.setX(o,e),o++,k.setX(o,a),o++,k.setX(o,b),o++,k.setX(o,e),o++;this.setIndex(k),this.addAttribute("position",l),this.addAttribute("normal",m),this.addAttribute("uv",j)},THREE.TorusKnotBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),
THREE.TorusKnotBufferGeometry.prototype.constructor=THREE.TorusKnotBufferGeometry,THREE.TorusKnotGeometry=function(a,b,c,d,e,f,g){THREE.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f},void 0!==g&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new THREE.TorusKnotBufferGeometry(a,b,c,d,e,f)),this.mergeVertices()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry,THREE.TubeGeometry=function(a,b,c,d,e,f){THREE.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:a,segments:b,radius:c,radialSegments:d,closed:e,taper:f},b=b||64,c=c||1,d=d||8,e=e||!1,f=f||THREE.TubeGeometry.NoTaper;var g,h,i,j,k,l,m,n,o,p,q=[],r=b+1,s=new THREE.Vector3;for(n=new THREE.TubeGeometry.FrenetFrames(a,b,e),o=n.normals,p=n.binormals,this.tangents=n.tangents,this.normals=o,this.binormals=p,n=0;n<r;n++)for(q[n]=[],i=n/(r-1),m=a.getPointAt(i),g=o[n],h=p[n],k=c*f(i),i=0;i<d;i++)j=i/d*2*Math.PI,l=-k*Math.cos(j),j=k*Math.sin(j),s.copy(m),s.x+=l*g.x+j*h.x,s.y+=l*g.y+j*h.y,s.z+=l*g.z+j*h.z,q[n][i]=this.vertices.push(new THREE.Vector3(s.x,s.y,s.z))-1;for(n=0;n<b;n++)for(i=0;i<d;i++)f=e?(n+1)%b:n+1,r=(i+1)%d,a=q[n][i],c=q[f][i],f=q[f][r],r=q[n][r],s=new THREE.Vector2(n/b,i/d),o=new THREE.Vector2((n+1)/b,i/d),p=new THREE.Vector2((n+1)/b,(i+1)/d),g=new THREE.Vector2(n/b,(i+1)/d),this.faces.push(new THREE.Face3(a,c,r)),this.faceVertexUvs[0].push([s,o,g]),this.faces.push(new THREE.Face3(c,f,r)),this.faceVertexUvs[0].push([o.clone(),p,g.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry,THREE.TubeGeometry.NoTaper=function(a){return 1},THREE.TubeGeometry.SinusoidalTaper=function(a){return Math.sin(Math.PI*a)},THREE.TubeGeometry.FrenetFrames=function(a,b,c){var d=new THREE.Vector3,e=[],f=[],g=[],h=new THREE.Vector3,i=new THREE.Matrix4;b+=1;var j,k,l;for(this.tangents=e,this.normals=f,this.binormals=g,j=0;j<b;j++)k=j/(b-1),e[j]=a.getTangentAt(k),e[j].normalize();for(f[0]=new THREE.Vector3,g[0]=new THREE.Vector3,a=Number.MAX_VALUE,j=Math.abs(e[0].x),k=Math.abs(e[0].y),l=Math.abs(e[0].z),j<=a&&(a=j,d.set(1,0,0)),k<=a&&(a=k,d.set(0,1,0)),l<=a&&d.set(0,0,1),h.crossVectors(e[0],d).normalize(),f[0].crossVectors(e[0],h),g[0].crossVectors(e[0],f[0]),j=1;j<b;j++)f[j]=f[j-1].clone(),g[j]=g[j-1].clone(),h.crossVectors(e[j-1],e[j]),h.length()>Number.EPSILON&&(h.normalize(),d=Math.acos(THREE.Math.clamp(e[j-1].dot(e[j]),-1,1)),f[j].applyMatrix4(i.makeRotationAxis(h,d))),g[j].crossVectors(e[j],f[j]);if(c)for(d=Math.acos(THREE.Math.clamp(f[0].dot(f[b-1]),-1,1)),d/=b-1,0<e[0].dot(h.crossVectors(f[0],f[b-1]))&&(d=-d),j=1;j<b;j++)f[j].applyMatrix4(i.makeRotationAxis(e[j],d*j)),g[j].crossVectors(e[j],f[j])},THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=i.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+.5;return a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5,b.uv=new THREE.Vector2(c,1-a),b}function f(a,b,c,d){d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()],(void 0),d),i.faces.push(d),q.copy(a).add(b).add(c).divideScalar(3),d=Math.atan2(q.z,-q.x),i.faceVertexUvs[0].push([h(a.uv,a,d),h(b.uv,b,d),h(c.uv,c,d)])}function g(a,b){for(var c=Math.pow(2,b),d=e(i.vertices[a.a]),g=e(i.vertices[a.b]),h=e(i.vertices[a.c]),j=[],k=a.materialIndex,l=0;l<=c;l++){j[l]=[];for(var m=e(d.clone().lerp(h,l/c)),n=e(g.clone().lerp(h,l/c)),o=c-l,p=0;p<=o;p++)j[l][p]=0===p&&l===c?m:e(m.clone().lerp(n,p/o))}for(l=0;l<c;l++)for(p=0;p<2*(c-l)-1;p++)d=Math.floor(p/2),0===p%2?f(j[l][d+1],j[l+1][d],j[l][d],k):f(j[l][d+1],j[l+1][d+1],j[l+1][d],k)}function h(a,b,c){return 0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y)),0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+.5,a.y)),a.clone()}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:a,indices:b,radius:c,detail:d},c=c||1,d=d||0;for(var i=this,j=0,k=a.length;j<k;j+=3)e(new THREE.Vector3(a[j],a[j+1],a[j+2]));a=this.vertices;for(var l=[],m=j=0,k=b.length;j<k;j+=3,m++){var n=a[b[j]],o=a[b[j+1]],p=a[b[j+2]];l[m]=new THREE.Face3(n.index,o.index,p.index,[n.clone(),o.clone(),p.clone()],(void 0),m)}for(var q=new THREE.Vector3,j=0,k=l.length;j<k;j++)g(l[j],d);for(j=0,k=this.faceVertexUvs[0].length;j<k;j++)b=this.faceVertexUvs[0][j],d=b[0].x,a=b[1].x,l=b[2].x,m=Math.max(d,a,l),n=Math.min(d,a,l),.9<m&&.1>n&&(.2>d&&(b[0].x+=1),.2>a&&(b[1].x+=1),.2>l&&(b[2].x+=1));for(j=0,k=this.vertices.length;j<k;j++)this.vertices[j].multiplyScalar(c);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.DodecahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2,d=1/c;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b),this.type="DodecahedronGeometry",this.parameters={radius:a,detail:b}},THREE.DodecahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry,THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b),this.type="IcosahedronGeometry",this.parameters={radius:a,detail:b}},THREE.IcosahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,THREE.OctahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b),this.type="OctahedronGeometry",this.parameters={radius:a,detail:b}},THREE.OctahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry,THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b),this.type="TetrahedronGeometry",this.parameters={radius:a,detail:b}},THREE.TetrahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry,THREE.ParametricGeometry=function(a,b,c){THREE.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:a,slices:b,stacks:c};var d,e,f,g,h=this.vertices,i=this.faces,j=this.faceVertexUvs[0],k=b+1;for(d=0;d<=c;d++)for(g=d/c,e=0;e<=b;e++)f=e/b,f=a(f,g),h.push(f);var l,m,n,o;for(d=0;d<c;d++)for(e=0;e<b;e++)a=d*k+e,h=d*k+e+1,g=(d+1)*k+e+1,f=(d+1)*k+e,l=new THREE.Vector2(e/b,d/c),m=new THREE.Vector2((e+1)/b,d/c),n=new THREE.Vector2((e+1)/b,(d+1)/c),o=new THREE.Vector2(e/b,(d+1)/c),i.push(new THREE.Face3(a,h,f)),j.push([l,m,o]),i.push(new THREE.Face3(h,g,f)),j.push([m.clone(),n,o.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry,THREE.WireframeGeometry=function(a){function b(a,b){return a-b}THREE.BufferGeometry.call(this);var c=[0,0],d={},e=["a","b","c"];if(a instanceof THREE.Geometry){var f=a.vertices,g=a.faces,h=0,i=new Uint32Array(6*g.length);a=0;for(var j=g.length;a<j;a++)for(var k=g[a],l=0;3>l;l++){c[0]=k[e[l]],c[1]=k[e[(l+1)%3]],c.sort(b);var m=c.toString();void 0===d[m]&&(i[2*h]=c[0],i[2*h+1]=c[1],d[m]=!0,h++)}for(c=new Float32Array(6*h),a=0,j=h;a<j;a++)for(l=0;2>l;l++)d=f[i[2*a+l]],h=6*a+3*l,c[h+0]=d.x,c[h+1]=d.y,c[h+2]=d.z;this.addAttribute("position",new THREE.BufferAttribute(c,3))}else if(a instanceof THREE.BufferGeometry){if(null!==a.index){for(j=a.index.array,f=a.attributes.position,e=a.groups,h=0,0===e.length&&a.addGroup(0,j.length),i=new Uint32Array(2*j.length),g=0,k=e.length;g<k;++g){a=e[g],l=a.start,m=a.count,a=l;for(var n=l+m;a<n;a+=3)for(l=0;3>l;l++)c[0]=j[a+l],c[1]=j[a+(l+1)%3],c.sort(b),m=c.toString(),void 0===d[m]&&(i[2*h]=c[0],i[2*h+1]=c[1],d[m]=!0,h++)}for(c=new Float32Array(6*h),a=0,j=h;a<j;a++)for(l=0;2>l;l++)h=6*a+3*l,d=i[2*a+l],c[h+0]=f.getX(d),c[h+1]=f.getY(d),c[h+2]=f.getZ(d)}else for(f=a.attributes.position.array,h=f.length/3,i=h/3,c=new Float32Array(6*h),a=0,j=i;a<j;a++)for(l=0;3>l;l++)h=18*a+6*l,i=9*a+3*l,c[h+0]=f[i],c[h+1]=f[i+1],c[h+2]=f[i+2],d=9*a+(l+1)%3*3,c[h+3]=f[d],c[h+4]=f[d+1],c[h+5]=f[d+2];this.addAttribute("position",new THREE.BufferAttribute(c,3))}},THREE.WireframeGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.WireframeGeometry.prototype.constructor=THREE.WireframeGeometry,THREE.AxisHelper=function(a){a=a||1;var b=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),c=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);a=new THREE.BufferGeometry,a.addAttribute("position",new THREE.BufferAttribute(b,3)),a.addAttribute("color",new THREE.BufferAttribute(c,3)),b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),THREE.LineSegments.call(this,a,b)},THREE.AxisHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.AxisHelper.prototype.constructor=THREE.AxisHelper,THREE.ArrowHelper=function(){var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var b=new THREE.CylinderGeometry(0,.5,1,5,1);return b.translate(0,-.5,0),function(c,d,e,f,g,h){THREE.Object3D.call(this),void 0===f&&(f=16776960),void 0===e&&(e=1),void 0===g&&(g=.2*e),void 0===h&&(h=.2*g),this.position.copy(d),this.line=new THREE.Line(a,new THREE.LineBasicMaterial({color:f})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:f})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(c),this.setLength(e,g,h)}}(),THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper,THREE.ArrowHelper.prototype.setDirection=function(){var a,b=new THREE.Vector3;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(b.set(c.z,0,-c.x).normalize(),a=Math.acos(c.y),this.quaternion.setFromAxisAngle(b,a))}}(),THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a),void 0===c&&(c=.2*b),this.line.scale.set(1,Math.max(0,a-b),1),this.line.updateMatrix(),this.cone.scale.set(c,b,c),this.cone.position.y=a,this.cone.updateMatrix()},THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a),this.cone.material.color.set(a)},THREE.BoxHelper=function(a){var b=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=new Float32Array(24),d=new THREE.BufferGeometry;d.setIndex(new THREE.BufferAttribute(b,1)),d.addAttribute("position",new THREE.BufferAttribute(c,3)),THREE.LineSegments.call(this,d,new THREE.LineBasicMaterial({color:16776960})),void 0!==a&&this.update(a)},THREE.BoxHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.BoxHelper.prototype.constructor=THREE.BoxHelper,THREE.BoxHelper.prototype.update=function(){var a=new THREE.Box3;return function(b){if(a.setFromObject(b),!a.isEmpty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x,e[1]=c.y,e[2]=c.z,e[3]=b.x,e[4]=c.y,e[5]=c.z,e[6]=b.x,e[7]=b.y,e[8]=c.z,e[9]=c.x,e[10]=b.y,e[11]=c.z,e[12]=c.x,e[13]=c.y,e[14]=b.z,e[15]=b.x,e[16]=c.y,e[17]=b.z,e[18]=b.x,e[19]=b.y,e[20]=b.z,e[21]=c.x,e[22]=b.y,e[23]=b.z,d.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper,THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(a){function b(a,b,d){c(a,d),c(b,d)}function c(a,b){d.vertices.push(new THREE.Vector3),d.colors.push(new THREE.Color(b)),void 0===f[a]&&(f[a]=[]),f[a].push(d.vertices.length-1)}var d=new THREE.Geometry,e=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),f={};b("n1","n2",16755200),b("n2","n4",16755200),b("n4","n3",16755200),b("n3","n1",16755200),b("f1","f2",16755200),b("f2","f4",16755200),b("f4","f3",16755200),b("f3","f1",16755200),b("n1","f1",16755200),b("n2","f2",16755200),b("n3","f3",16755200),b("n4","f4",16755200),b("p","n1",16711680),b("p","n2",16711680),b("p","n3",16711680),b("p","n4",16711680),b("u1","u2",43775),b("u2","u3",43775),b("u3","u1",43775),b("c","t",16777215),b("p","c",3355443),b("cn1","cn2",3355443),b("cn3","cn4",3355443),b("cf1","cf2",3355443),b("cf3","cf4",3355443),THREE.LineSegments.call(this,d,e),this.camera=a,this.camera.updateProjectionMatrix(),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=f,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.CameraHelper.prototype.constructor=THREE.CameraHelper,THREE.CameraHelper.prototype.update=function(){function a(a,f,g,h){if(d.set(f,g,h).unproject(e),a=c[a],void 0!==a)for(f=0,g=a.length;f<g;f++)b.vertices[a[f]].copy(d)}var b,c,d=new THREE.Vector3,e=new THREE.Camera;return function(){b=this.geometry,c=this.pointMap,e.projectionMatrix.copy(this.camera.projectionMatrix),a("c",0,0,-1),a("t",0,0,1),a("n1",-1,-1,-1),a("n2",1,-1,-1),a("n3",-1,1,-1),a("n4",1,1,-1),a("f1",-1,-1,1),a("f2",1,-1,1),a("f3",-1,1,1),a("f4",1,1,1),a("u1",.7,1.1,-1),a("u2",-.7,1.1,-1),a("u3",0,2,-1),a("cf1",-1,0,1),a("cf2",1,0,1),a("cf3",0,-1,1),a("cf4",0,1,1),a("cn1",-1,0,-1),a("cn2",1,0,-1),a("cn3",0,-1,-1),a("cn4",0,1,-1),b.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this),this.light=a,this.light.updateMatrixWorld(),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,b=b||1;var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3((-b),b,0),new THREE.Vector3(b,b,0),new THREE.Vector3(b,(-b),0),new THREE.Vector3((-b),(-b),0),new THREE.Vector3((-b),b,0));var d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Line(c,d),this.add(this.lightPlane),c=new THREE.Geometry,c.vertices.push(new THREE.Vector3,new THREE.Vector3),d=new THREE.LineBasicMaterial({fog:!1}),d.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(c,d),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper,THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld),b.setFromMatrixPosition(this.light.target.matrixWorld),c.subVectors(b,a),this.lightPlane.lookAt(c),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(c),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.EdgesHelper=function(a,b,c){b=void 0!==b?b:16777215,THREE.LineSegments.call(this,new THREE.EdgesGeometry(a.geometry,c),new THREE.LineBasicMaterial({color:b})),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1},THREE.EdgesHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper,THREE.FaceNormalsHelper=function(a,b,c,d){this.object=a,this.size=void 0!==b?b:1,a=void 0!==c?c:16776960,d=void 0!==d?d:1,b=0,c=this.object.geometry,c instanceof THREE.Geometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),c=new THREE.BufferGeometry,b=new THREE.Float32Attribute(6*b,3),c.addAttribute("position",b),THREE.LineSegments.call(this,c,new THREE.LineBasicMaterial({color:a,linewidth:d})),this.matrixAutoUpdate=!1,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper,THREE.FaceNormalsHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(){this.object.updateMatrixWorld(!0),c.getNormalMatrix(this.object.matrixWorld);for(var d=this.object.matrixWorld,e=this.geometry.attributes.position,f=this.object.geometry,g=f.vertices,f=f.faces,h=0,i=0,j=f.length;i<j;i++){var k=f[i],l=k.normal;a.copy(g[k.a]).add(g[k.b]).add(g[k.c]).divideScalar(3).applyMatrix4(d),b.copy(l).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),e.setXYZ(h,a.x,a.y,a.z),h+=1,e.setXYZ(h,b.x,b.y,b.z),h+=1}return e.needsUpdate=!0,this}}(),THREE.GridHelper=function(a,b){var c=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var e=-a;e<=a;e+=b){c.vertices.push(new THREE.Vector3((-a),0,e),new THREE.Vector3(a,0,e),new THREE.Vector3(e,0,(-a)),new THREE.Vector3(e,0,a));var f=0===e?this.color1:this.color2;c.colors.push(f,f,f,f)}THREE.LineSegments.call(this,c,d)},THREE.GridHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.GridHelper.prototype.constructor=THREE.GridHelper,THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a),this.color2.set(b),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(a,b){THREE.Object3D.call(this),this.light=a,this.light.updateMatrixWorld(),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color];var c=new THREE.SphereGeometry(b,4,2);c.rotateX(-Math.PI/2);for(var d=0;8>d;d++)c.faces[d].color=this.colors[4>d?0:1];d=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0}),this.lightSphere=new THREE.Mesh(c,d),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper,THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(a,b){this.light=a,this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,c,d),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper,THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SkeletonHelper=function(a){this.bones=this.getBoneList(a);for(var b=new THREE.Geometry,c=0;c<this.bones.length;c++)this.bones[c].parent instanceof THREE.Bone&&(b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3),b.colors.push(new THREE.Color(0,0,1)),b.colors.push(new THREE.Color(0,1,0)));b.dynamic=!0,c=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0}),THREE.LineSegments.call(this,b,c),this.root=a,this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,this.update()},THREE.SkeletonHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper,THREE.SkeletonHelper.prototype.getBoneList=function(a){var b=[];a instanceof THREE.Bone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,this.getBoneList(a.children[c]));return b},THREE.SkeletonHelper.prototype.update=function(){for(var a=this.geometry,b=(new THREE.Matrix4).getInverse(this.root.matrixWorld),c=new THREE.Matrix4,d=0,e=0;e<this.bones.length;e++){var f=this.bones[e];f.parent instanceof THREE.Bone&&(c.multiplyMatrices(b,f.matrixWorld),a.vertices[d].setFromMatrixPosition(c),c.multiplyMatrices(b,f.parent.matrixWorld),a.vertices[d+1].setFromMatrixPosition(c),d+=2)}a.verticesNeedUpdate=!0,a.computeBoundingSphere()},THREE.SpotLightHelper=function(a){THREE.Object3D.call(this),this.light=a,this.light.updateMatrixWorld(),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1,a=new THREE.CylinderGeometry(0,1,1,8,1,(!0)),a.translate(0,-.5,0),a.rotateX(-Math.PI/2);var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper,THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1e4,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c),a.setFromMatrixPosition(this.light.matrixWorld),b.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(b.sub(a)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(a,b,c,d){this.object=a,this.size=void 0!==b?b:1,a=void 0!==c?c:16711680,d=void 0!==d?d:1,b=0,c=this.object.geometry,c instanceof THREE.Geometry?b=3*c.faces.length:c instanceof THREE.BufferGeometry&&(b=c.attributes.normal.count),c=new THREE.BufferGeometry,b=new THREE.Float32Attribute(6*b,3),c.addAttribute("position",b),THREE.LineSegments.call(this,c,new THREE.LineBasicMaterial({color:a,linewidth:d})),this.matrixAutoUpdate=!1,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper,THREE.VertexNormalsHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(){var d=["a","b","c"];this.object.updateMatrixWorld(!0),c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,f=this.geometry.attributes.position,g=this.object.geometry;if(g instanceof THREE.Geometry)for(var h=g.vertices,i=g.faces,j=g=0,k=i.length;j<k;j++)for(var l=i[j],m=0,n=l.vertexNormals.length;m<n;m++){var o=l.vertexNormals[m];a.copy(h[l[d[m]]]).applyMatrix4(e),b.copy(o).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,b.z),g+=1}else if(g instanceof THREE.BufferGeometry)for(d=g.attributes.position,h=g.attributes.normal,m=g=0,n=d.count;m<n;m++)a.set(d.getX(m),d.getY(m),d.getZ(m)).applyMatrix4(e),b.set(h.getX(m),h.getY(m),h.getZ(m)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,b.z),g+=1;return f.needsUpdate=!0,this}}(),THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215;THREE.LineSegments.call(this,new THREE.WireframeGeometry(a.geometry),new THREE.LineBasicMaterial({color:c})),this.matrix=a.matrixWorld,this.matrixAutoUpdate=!1},THREE.WireframeHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper,THREE.ImmediateRenderObject=function(a){THREE.Object3D.call(this),this.material=a,this.render=function(a){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject,THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b),this.animationsMap={},this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1),this.setAnimationWeight("__default",1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh,THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={start:b,end:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[a]=b,this.animationsList.push(b)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b,c=/([a-z]+)_?(\d+)/i,d={},e=this.geometry,f=0,g=e.morphTargets.length;f<g;f++){var h=e.morphTargets[f].name.match(c);if(h&&1<h.length){var i=h[1];d[i]||(d[i]={start:1/0,end:-(1/0)}),h=d[i],f<h.start&&(h.start=f),f>h.end&&(h.end=f),b||(b=i)}}for(i in d)h=d[i],this.createAnimation(i,h.start,h.end,a);this.firstAnimation=b},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){(a=this.animationsMap[a])&&(a.direction=1,a.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){(a=this.animationsMap[a])&&(a.direction=-1,a.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;return(a=this.animationsMap[a])&&(b=a.time),b},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;return(a=this.animationsMap[a])&&(b=a.duration),b},THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("THREE.MorphBlendMesh: animation["+a+"] undefined in .playAnimation()")},THREE.MorphBlendMesh.prototype.stopAnimation=function(a){(a=this.animationsMap[a])&&(a.active=!1)},THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var e=d.duration/d.length;d.time+=d.direction*a,d.mirroredLoop?(d.time>d.duration||0>d.time)&&(d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)):(d.time%=d.duration,0>d.time&&(d.time+=d.duration));var f=d.start+THREE.Math.clamp(Math.floor(d.time/e),0,d.length-1),g=d.weight;f!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[f]=0,d.lastFrame=d.currentFrame,d.currentFrame=f),e=d.time%e/e,d.directionBackwards&&(e=1-e),d.currentFrame!==d.lastFrame?(this.morphTargetInfluences[d.currentFrame]=e*g,this.morphTargetInfluences[d.lastFrame]=(1-e)*g):this.morphTargetInfluences[d.currentFrame]=g}}},THREE.OrbitControls=function(a,b){function c(){return 2*Math.PI/60/60*J.autoRotateSpeed}function d(){return Math.pow(.95,J.zoomSpeed)}function e(a){R.theta-=a}function f(a){R.phi-=a}function g(a){J.object instanceof THREE.PerspectiveCamera?S/=a:J.object instanceof THREE.OrthographicCamera?(J.object.zoom=Math.max(J.minZoom,Math.min(J.maxZoom,J.object.zoom*a)),J.object.updateProjectionMatrix(),U=!0):J.enableZoom=!1}function h(a){J.object instanceof THREE.PerspectiveCamera?S*=a:J.object instanceof THREE.OrthographicCamera?(J.object.zoom=Math.max(J.minZoom,Math.min(J.maxZoom,J.object.zoom/a)),J.object.updateProjectionMatrix(),U=!0):J.enableZoom=!1}function i(a){V.set(a.clientX,a.clientY)}function j(a){_.set(a.clientX,a.clientY)}function k(a){Y.set(a.clientX,a.clientY)}function l(a){W.set(a.clientX,a.clientY),X.subVectors(W,V);var b=J.domElement===document?J.domElement.body:J.domElement;e(2*Math.PI*-X.x/b.clientWidth*J.rotateSpeed),f(2*Math.PI*-X.y/b.clientHeight*J.rotateSpeedY),V.copy(W),J.update()}function m(a){aa.set(a.clientX,a.clientY),ba.subVectors(aa,_),ba.y>0?g(d()):ba.y<0&&h(d()),_.copy(aa),J.update()}function n(a){Z.set(a.clientX,a.clientY),$.subVectors(Z,Y),ga($.x,$.y),Y.copy(Z),J.update()}function o(a){}function p(a){var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail),b>0?h(d()):b<0&&g(d()),J.update()}function q(a){switch((J.keyUpEvent=!0)&&null===J.keyInteractionStart,null===J.keyInteractionStart&&(J.keyInteractionStart=(new Date).getTime()),a.keyCode){case J.keys.UP:ca=0,da=3,orbitPlugin.handleRemote(ca,da),ga(0,J.keyPanSpeed),J.update();break;case J.keys.BOTTOM:ca=0,da=-3,orbitPlugin.handleRemote(ca,da),ga(0,-J.keyPanSpeed),J.update();break;case J.keys.LEFT:ca=10,da=0,orbitPlugin.handleRemote(ca,da),ga(J.keyPanSpeed,0),J.update();break;case J.keys.RIGHT:ca=-10,da=0,orbitPlugin.handleRemote(ca,da),ga(-J.keyPanSpeed,0),J.update()}}function r(a){J.keyUpEvent=!0,J.keyInteractionEnd=(new Date).getTime(),J.totalKeyInteractTime+=J.keyInteractionEnd-J.keyInteractionStart,J.keyInteractionStart=null}function s(a){V.set(a.touches[0].pageX,a.touches[0].pageY)}function t(a){var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);_.set(0,d)}function u(a){Y.set(a.touches[0].pageX,a.touches[0].pageY)}function v(a){W.set(a.touches[0].pageX,a.touches[0].pageY),X.subVectors(W,V);var b=J.domElement===document?J.domElement.body:J.domElement;e(2*Math.PI*-X.x/b.clientWidth*J.rotateSpeed),f(2*Math.PI*-X.y/b.clientHeight*J.rotateSpeed),V.copy(W),J.update()}function w(a){var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,e=Math.sqrt(b*b+c*c);aa.set(0,e),ba.subVectors(aa,_),ba.y>0?h(d()):ba.y<0&&g(d()),_.copy(aa),J.update()}function x(a){Z.set(a.touches[0].pageX,a.touches[0].pageY),$.subVectors(Z,Y),ga($.x,$.y),Y.copy(Z),J.update()}function y(a){}function z(a){if(J.mouseInteractionStart=(new Date).getTime(),J.enabled!==!1){if(a.preventDefault(),a.button===J.mouseButtons.ORBIT){if(J.enableRotate===!1)return;i(a),O=N.ROTATE}else if(a.button===J.mouseButtons.ZOOM){if(J.enableZoom===!1)return;j(a),O=N.DOLLY}else if(a.button===J.mouseButtons.PAN){if(J.enablePan===!1)return;k(a),O=N.PAN}O!==N.NONE&&(document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",B,!1),J.dispatchEvent(L))}}function A(a){if(J.enabled!==!1)if(a.preventDefault(),O===N.ROTATE){if(J.enableRotate===!1)return;l(a)}else if(O===N.DOLLY){if(J.enableZoom===!1)return;m(a)}else if(O===N.PAN){if(J.enablePan===!1)return;n(a)}}function B(a){J.mouseInteractionEnd=(new Date).getTime(),
J.totalMouseMoveInteractTime+=J.mouseInteractionEnd-J.mouseInteractionStart,J.enabled!==!1&&(o(a),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",B,!1),document.removeEventListener("mouseout",B,!1),J.dispatchEvent(M),O=N.NONE)}function C(a){J.enabled===!1||J.enableZoom===!1||O!==N.NONE&&O!==N.ROTATE||(a.preventDefault(),a.stopPropagation(),p(a),J.dispatchEvent(L),J.dispatchEvent(M))}function D(a){J.enabled!==!1&&J.enableKeys!==!1&&J.enablePan!==!1&&q(a)}function E(a){J.enabled!==!1&&J.enableKeys!==!1&&J.enablePan!==!1&&r(a)}function F(a){if(J.touchInteractionStart=(new Date).getTime(),J.enabled!==!1){switch(a.touches.length){case 1:if(J.enableRotate===!1)return;s(a),O=N.TOUCH_ROTATE;break;case 2:if(J.enableZoom===!1)return;t(a),O=N.TOUCH_DOLLY;break;case 3:if(J.enablePan===!1)return;u(a),O=N.TOUCH_PAN;break;default:O=N.NONE}O!==N.NONE&&J.dispatchEvent(L)}}function G(a){if(J.enabled!==!1)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:if(J.enableRotate===!1)return;if(O!==N.TOUCH_ROTATE)return;v(a);break;case 2:if(J.enableZoom===!1)return;if(O!==N.TOUCH_DOLLY)return;w(a);break;case 3:if(J.enablePan===!1)return;if(O!==N.TOUCH_PAN)return;x(a);break;default:O=N.NONE}}function H(a){J.touchInteractionEnd=(new Date).getTime(),J.totalTouchInteractTime+=J.touchInteractionEnd-J.touchInteractionStart,J.enabled!==!1&&(y(a),J.dispatchEvent(M),O=N.NONE)}function I(a){a.preventDefault()}orbitPlugin=this,this.totalMouseMoveInteractTime=0,this.totalKeyInteractTime=0,this.totalTouchInteractTime=0,this.touchInteractionStart=null,this.touchInteractionEnd=null,this.mouseInteractionStart=null,this.mouseInteractionEnd=null,this.keyInteractionStart=null,this.keyInteractionEnd=null,this.keyUpEvent=!1,this.object=a,this.name="OrbitControls",this.domElement=void 0!==b?b:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.rotateSpeedY=this.rotateSpeed,this.enablePan=!0,this.keyPanSpeed=0,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.target1=null,this.position1=null,this.zoom1=null,this.handleRemote=function(a,b){e(2*Math.PI*-a/1200*.3),f(2*Math.PI*-b/300*.3),J.update()},this.getPolarAngle=function(){return Q.phi},this.getAzimuthalAngle=function(){return Q.theta},this.getAzimuthalAngleInDegrees=function(){return parseInt(Q.theta*(180/Math.PI))},this.setAzimuthalAngleInDegrees=function(a){J.update(parseInt(a)*(Math.PI/180))},this.reset=function(){J.target.copy(J.target0),J.object.position.copy(J.position0),J.object.zoom=J.zoom0,J.object.updateProjectionMatrix(),J.dispatchEvent(K),J.update(),O=N.NONE},this.store=function(){J.target1=J.target.clone(),J.position1=J.object.position.clone(),J.zoom1=J.object.zoom},this.clearStored=function(){J.target1=null,J.position1=null,J.zoom1=null},this.restore=function(){J.target1&&J.position1&&J.zoom1&&(J.target.copy(J.target1),J.object.position.copy(J.position1),J.object.zoom=J.zoom1,J.object.updateProjectionMatrix(),J.dispatchEvent(K),J.update(),O=N.NONE,J.clearStored())},this.update=function(b){var d=new THREE.Vector3,f=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),g=f.clone().inverse(),h=new THREE.Vector3,i=new THREE.Quaternion;return function(a){var b=J.object.position;return d.copy(b).sub(J.target),d.applyQuaternion(f),Q.setFromVector3(d),J.autoRotate&&O===N.NONE&&e(c()),"number"==typeof a?Q.theta+=a:Q.theta+=R.theta,Q.phi+=R.phi,Q.theta=Math.max(J.minAzimuthAngle,Math.min(J.maxAzimuthAngle,Q.theta)),Q.phi=Math.max(J.minPolarAngle,Math.min(J.maxPolarAngle,Q.phi)),Q.makeSafe(),Q.radius*=S,Q.radius=Math.max(J.minDistance,Math.min(J.maxDistance,Q.radius)),J.target.add(T),d.setFromSpherical(Q),d.applyQuaternion(g),b.copy(J.target).add(d),J.object.lookAt(J.target),J.enableDamping===!0?(R.theta*=1-J.dampingFactor,R.phi*=1-J.dampingFactor):R.set(0,0,0),S=1,T.set(0,0,0),!!(U||h.distanceToSquared(J.object.position)>P||8*(1-i.dot(J.object.quaternion))>P)&&(J.dispatchEvent(K),h.copy(J.object.position),i.copy(J.object.quaternion),U=!1,!0)}}(),this.dispose=function(){J.domElement.removeEventListener("contextmenu",I,!1),J.domElement.removeEventListener("mousedown",z,!1),J.domElement.removeEventListener("mousewheel",C,!1),J.domElement.removeEventListener("MozMousePixelScroll",C,!1),J.domElement.removeEventListener("touchstart",F,!1),J.domElement.removeEventListener("touchend",H,!1),J.domElement.removeEventListener("touchmove",G,!1),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",B,!1),document.removeEventListener("mouseout",B,!1),window.removeEventListener("keydown",D,!1),window.removeEventListener("keyup",E,!1)};var J=this,K={type:"change"},L={type:"start"},M={type:"end"},N={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},O=N.NONE,P=1e-6,Q=new THREE.Spherical,R=new THREE.Spherical,S=1,T=new THREE.Vector3,U=!1,V=new THREE.Vector2,W=new THREE.Vector2,X=new THREE.Vector2,Y=new THREE.Vector2,Z=new THREE.Vector2,$=new THREE.Vector2,_=new THREE.Vector2,aa=new THREE.Vector2,ba=new THREE.Vector2,ca=0,da=0,ea=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,0),a.multiplyScalar(-b),T.add(a)}}(),fa=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,1),a.multiplyScalar(b),T.add(a)}}(),ga=function(){var a=new THREE.Vector3;return function(b,c){var d=J.domElement===document?J.domElement.body:J.domElement;if(J.object instanceof THREE.PerspectiveCamera){var e=J.object.position;a.copy(e).sub(J.target);var f=a.length();f*=Math.tan(J.object.fov/2*Math.PI/180),ea(2*b*f/d.clientHeight,J.object.matrix),fa(2*c*f/d.clientHeight,J.object.matrix)}else J.object instanceof THREE.OrthographicCamera?(ea(b*(J.object.right-J.object.left)/J.object.zoom/d.clientWidth,J.object.matrix),fa(c*(J.object.top-J.object.bottom)/J.object.zoom/d.clientHeight,J.object.matrix)):J.enablePan=!1}}();J.domElement.addEventListener("contextmenu",I,!1),J.domElement.addEventListener("mousedown",z,!1),J.domElement.addEventListener("MozMousePixelScroll",C,!1),J.domElement.addEventListener("touchstart",F,!1),J.domElement.addEventListener("touchend",H,!1),J.domElement.addEventListener("touchmove",G,!1),window.addEventListener("keydown",D,!1),window.addEventListener("keyup",E,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return this.target}},noZoom:{get:function(){return!this.enableZoom},set:function(a){this.enableZoom=!a}},noRotate:{get:function(){return!this.enableRotate},set:function(a){this.enableRotate=!a}},noPan:{get:function(){return!this.enablePan},set:function(a){this.enablePan=!a}},noKeys:{get:function(){return!this.enableKeys},set:function(a){this.enableKeys=!a}},staticMoving:{get:function(){return!this.enableDamping},set:function(a){this.enableDamping=!a}},dynamicDampingFactor:{get:function(){return this.dampingFactor},set:function(a){this.dampingFactor=a}}}),THREE.DeviceOrientationControls=function(a){var b=this;this.name="DeviceOrientationControls",this.object=a,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.beta=0,this.alphaOffsetAngle=0,this.betaOffsetAngle=0;var c=function(a){b.deviceOrientation=a},d=function(){b.screenOrientation=window.orientation||0},e=function(){var a=new THREE.Vector3(0,0,1),b=new THREE.Euler,c=new THREE.Quaternion,d=new THREE.Quaternion((-Math.sqrt(.5)),0,0,Math.sqrt(.5));return function(e,f,g,h,i){b.set(g,f,-h,"YXZ"),e.setFromEuler(b),e.multiply(d),e.multiply(c.setFromAxisAngle(a,-i))}}();this.connect=function(){d(),window.addEventListener("orientationchange",d,!1),window.addEventListener("deviceorientation",c,!1),b.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",d,!1),window.removeEventListener("deviceorientation",c,!1),b.enabled=!1},this.update=function(){if(b.enabled!==!1){var a=b.deviceOrientation.alpha?THREE.Math.degToRad(b.deviceOrientation.alpha)+this.alphaOffsetAngle:0,c=b.deviceOrientation.beta?THREE.Math.degToRad(b.deviceOrientation.beta)+this.betaOffsetAngle:0,d=b.deviceOrientation.gamma?THREE.Math.degToRad(b.deviceOrientation.gamma):0,f=b.screenOrientation?THREE.Math.degToRad(b.screenOrientation):0;e(b.object.quaternion,a,c,d,f),this.alpha=a,this.beta=c}},this.updateAlphaOffsetAngle=function(a){this.alphaOffsetAngle=a},this.updateBetaOffsetAngle=function(a){this.betaOffsetAngle=a},this.dispose=function(){this.disconnect()},this.connect()},THREE.StereoEffect=function(a){var b=new THREE.StereoCamera;b.aspect=.5,this.setSize=function(b,c){a.setSize(b,c)},this.render=function(c,d){c.updateMatrixWorld(),null===d.parent&&d.updateMatrixWorld(),b.update(d);var e=a.getSize();a.setScissorTest(!0),a.clear(),a.setScissor(0,0,e.width/2,e.height),a.setViewport(50,50,e.width/2-70,e.height-100),a.render(c,b.cameraL),a.setScissor(e.width/2,0,e.width/2,e.height),a.setViewport(e.width/2+20,50,e.width/2-70,e.height-100),a.render(c,b.cameraR),a.setScissorTest(!1)}},THREE.OculusRiftEffect=function(a,b){var c=b&&b.worldFactor?b.worldFactor:1,d=b&&b.HMD?b.HMD:{hResolution:1280,vResolution:800,hScreenSize:.14976,vScreenSize:.0936,interpupillaryDistance:.064,lensSeparationDistance:.064,eyeToScreenDistance:.041,distortionK:[1,.22,.24,0],chromaAbParameter:[.996,-.004,1.014,0]},e=new THREE.PerspectiveCamera;e.matrixAutoUpdate=!1,e.target=new THREE.Vector3;var f=new THREE.OrthographicCamera((-1),1,1,(-1),1,1e3);f.position.z=1,this.preLeftRender=function(){},this.preRightRender=function(){},a.autoClear=!1;var g=new THREE.Color("black"),h={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},i=new THREE.WebGLRenderTarget(640,800,h),j=new THREE.ShaderMaterial({uniforms:{texid:{type:"t",value:i},scale:{type:"v2",value:new THREE.Vector2(1,1)},scaleIn:{type:"v2",value:new THREE.Vector2(1,1)},lensCenter:{type:"v2",value:new THREE.Vector2(0,0)},hmdWarpParam:{type:"v4",value:new THREE.Vector4(1,0,0,0)},chromAbParam:{type:"v4",value:new THREE.Vector4(1,0,0,0)}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 scale;","uniform vec2 scaleIn;","uniform vec2 lensCenter;","uniform vec4 hmdWarpParam;","uniform vec4 chromAbParam;","uniform sampler2D texid;","varying vec2 vUv;","void main()","{","  vec2 uv = (vUv*2.0)-1.0;","  vec2 theta = (uv-lensCenter)*scaleIn;","  float rSq = theta.x*theta.x + theta.y*theta.y;","  vec2 rvector = theta*(hmdWarpParam.x + hmdWarpParam.y*rSq + hmdWarpParam.z*rSq*rSq + hmdWarpParam.w*rSq*rSq*rSq);","  vec2 rBlue = rvector * (chromAbParam.z + chromAbParam.w * rSq);","  vec2 tcBlue = (lensCenter + scale * rBlue);","  tcBlue = (tcBlue+1.0)/2.0;","  if (any(bvec2(clamp(tcBlue, vec2(0.0,0.0), vec2(1.0,1.0))-tcBlue))) {","    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","    return;}","  vec2 tcGreen = lensCenter + scale * rvector;","  tcGreen = (tcGreen+1.0)/2.0;","  vec2 rRed = rvector * (chromAbParam.x + chromAbParam.y * rSq);","  vec2 tcRed = lensCenter + scale * rRed;","  tcRed = (tcRed+1.0)/2.0;","  gl_FragColor = vec4(texture2D(texid, tcRed).r, texture2D(texid, tcGreen).g, texture2D(texid, tcBlue).b, 1);","}"].join("\n")}),k=new THREE.Mesh(new THREE.PlaneGeometry(2,2),j),l=new THREE.Scene;l.add(f),l.add(k);var m={},n={},o=1;this.setHMD=function(a){d=a;var b=d.hResolution/(2*d.vResolution),e=-1-4*(d.hScreenSize/4-d.lensSeparationDistance/2)/d.hScreenSize;o=d.distortionK[0]+d.distortionK[1]*Math.pow(e,2)+d.distortionK[2]*Math.pow(e,4)+d.distortionK[3]*Math.pow(e,6);var f=THREE.Math.radToDeg(2*Math.atan2(d.vScreenSize*o,2*d.eyeToScreenDistance)),g=(new THREE.Matrix4).makePerspective(f,b,.3,1e4),k=4*(d.hScreenSize/4-d.interpupillaryDistance/2)/d.hScreenSize;m.proj=(new THREE.Matrix4).makeTranslation(k,0,0).multiply(g),n.proj=(new THREE.Matrix4).makeTranslation(-k,0,0).multiply(g),m.tranform=(new THREE.Matrix4).makeTranslation(-c*d.interpupillaryDistance/2,0,0),n.tranform=(new THREE.Matrix4).makeTranslation(c*d.interpupillaryDistance/2,0,0),m.viewport=[0,0,d.hResolution/2,d.vResolution],n.viewport=[d.hResolution/2,0,d.hResolution/2,d.vResolution];var l=4*(d.hScreenSize/4-d.lensSeparationDistance/2)/d.hScreenSize;m.lensCenter=new THREE.Vector2(l,0),n.lensCenter=new THREE.Vector2((-l),0),j.uniforms.hmdWarpParam.value=new THREE.Vector4(d.distortionK[0],d.distortionK[1],d.distortionK[2],d.distortionK[3]),j.uniforms.chromAbParam.value=new THREE.Vector4(d.chromaAbParameter[0],d.chromaAbParameter[1],d.chromaAbParameter[2],d.chromaAbParameter[3]),j.uniforms.scaleIn.value=new THREE.Vector2(1,1/b),j.uniforms.scale.value=new THREE.Vector2(1/o,1*b/o),i&&i.dispose(),i=new THREE.WebGLRenderTarget(d.hResolution*o/2,d.vResolution*o,h),j.uniforms.texid.value=i},this.getHMD=function(){return d},this.setHMD(d),this.setSize=function(b,c){m.viewport=[b/2-d.hResolution/2,c/2-d.vResolution/2,d.hResolution/2,d.vResolution],n.viewport=[b/2,c/2-d.vResolution/2,d.hResolution/2,d.vResolution],a.setSize(b,c)},this.render=function(b,c){var d=a.getClearColor().clone();a.setClearColor(g),a.clear(),a.setClearColor(d),c.matrixAutoUpdate&&c.updateMatrix(),this.preLeftRender(),e.projectionMatrix.copy(m.proj),e.matrix.copy(c.matrix).multiply(m.tranform),e.matrixWorldNeedsUpdate=!0,a.setViewport(m.viewport[0],m.viewport[1],m.viewport[2],m.viewport[3]),j.uniforms.lensCenter.value=m.lensCenter,a.render(b,e,i,!0),a.render(l,f),this.preRightRender(),e.projectionMatrix.copy(n.proj),e.matrix.copy(c.matrix).multiply(n.tranform),e.matrixWorldNeedsUpdate=!0,a.setViewport(n.viewport[0],n.viewport[1],n.viewport[2],n.viewport[3]),j.uniforms.lensCenter.value=n.lensCenter,a.render(b,e,i,!0),a.render(l,f)},this.dispose=function(){j&&j.dispose(),i&&i.dispose()}},function(a,b,c){"use strict";var d=function(a){var c=a.el();return{lowFPSIntervalID:0,lowFPSIntervalCountFrames:!1,lowFPSHandle:{minFPSLimit:12,underLimitCounter:0,underLimitThreshold:10},prevTime:0,renderedFrames:0,errorLowFpsBoard:b.createElement("div"),init:function(){var a=this;a.bindEvents(),a.errorLowFpsBoard.innerHTML=errorLowProcessorPerformance()},bindEvents:function(){var b=this;a.on("bufferingStart",function(){b.reset()}),a.on("video360LowFPS",function(){b.errorLowFpsBoard&&c.appendChild(b.errorLowFpsBoard),a.stop()})},reset:function(){var a=this;a.lowFPSIntervalCountFrames=!1,a.lowFPSHandle.underLimitCounter=0,a.renderedFrames=0,a.prevTime=0},updateUnderLimitCounter:function(){var b=this;b.lowFPSIntervalCountFrames?(b.lowFPSHandle.underLimitCounter++,a.debug("FPS Counter","underLimitCounter | underLimitThreshold",b.lowFPSHandle.underLimitCounter+" | "+b.lowFPSHandle.underLimitThreshold),b.lowFPSHandle.underLimitCounter>=b.lowFPSHandle.underLimitThreshold&&(a.debug("FPS Counter","Low FPS Event Triggered"),b.lowFPSIntervalCountFrames=!1,a.trigger("video360LowFPS"))):(clearInterval(b.lowFPSIntervalID),b.lowFPSIntervalID=0)},count:function(){var b,c=this,d=(performance||Date).now();c.renderedFrames++,d>c.prevTime+1e3&&(b=1e3*c.renderedFrames/(d-c.prevTime),a.debug("FPS Counter","Current FPS",b),b<c.lowFPSHandle.minFPSLimit?(c.lowFPSIntervalCountFrames=!0,0===c.lowFPSIntervalID&&(c.lowFPSIntervalID=setInterval(c.updateUnderLimitCounter.bind(c),1e3))):(c.lowFPSIntervalCountFrames=!1,c.lowFPSHandle.underLimitCounter>0&&c.lowFPSHandle.underLimitCounter--),c.renderedFrames=0,c.prevTime=0)},update:function(){var a=this;0===a.prevTime&&(a.prevTime=(performance||Date).now()),a.count()}}},e=function(a){var b=this;a&&(b.video360FpsCounter=new d(b),b.video360FpsCounter.init())};c.plugin("video360FpsCounter",e)}(window,document,videojs),function(a,b,c){"use strict";var d=function(a){function b(){var b=this;b.time=0,b.lastTime=0,b.lastSendTime=0,b.currentTime=0,b.watchingPaused=!1,a.on("timeupdate",function(){b.watchingPaused||(b.currentTime=roundToHalf(a.currentTime()),b.currentTime!==b.lastTime&&(b.lastTime=b.currentTime,b.time++))}),this.continueWatching=function(){b.watchingPaused=!1},this.pauseWatching=function(){b.watchingPaused=!0},this.getWatchingTime=function(){return b.time/2},this.resetWatchingTime=function(){b.time=0,b.pauseWatching()},this.sendHit=function(){if("tvn24"!==PLAYER5_ID&&a.advertInProgress===!1){var c=parseInt(a.currentTime(),10);a.overlayHandler&&a.overlayHandler.handleOverlays(c),isDefined(a.options().activeMovie)&&a.options().activeMovie!==!1&&a.isUserLogged()&&c%7===0&&b.lastSendTime!=c&&a.options().continueWatchingEnabled&&(b.lastSendTime=c,$.post("/user/player.json",{isWatched:0,moveId:a.options().activeMovie.id,playbackTime:c,save:1,totalTime:makeSeconds(a.options().activeMovie.run_time)}))}}}function c(){a.on("videoPlaying",d.continueWatching),a.on("videoCompleteAd",d.continueWatching),a.on("videoPlayingAd",d.pauseWatching),a.on("videoMainComplete",d.resetWatchingTime),a.on("videoStopped",d.resetWatchingTime),a.on("timeupdate",d.sendHit),a.on("videoPlayingAd",e.continueWatching),a.on("videoAdEnded",e.resetWatchingTime),a.on("videoMainComplete",e.resetWatchingTime),a.on("videoPlaying",e.resetWatchingTime)}var d=new b,e=new b;return a.getInformation=function(){var b={watchingTime:-1,playbackTime:-1,totalTime:-1,moveId:-1,getMovieId:-1};return a&&(b.watchingTime=d.getWatchingTime(),b.playbackTime=a.getFixedCurrentTime(),a.options().isLive?b.totalTime=-1:b.totalTime=a.duration(),b.moveId=a.clipId,b.getMovieId=a.clipId),b},a.getAdsInformation=function(){var b={watchingTime:-1,playbackTime:-1,totalTime:-1};return a&&(b.watchingTime=e.getWatchingTime(),b.playbackTime=a.currentTime(),b.totalTime=a.duration()),b},{init:function(){c()}}},e=function(){var a=this;a.timeWatcher=new d(a),a.one("loadedmetadata",function(){a.timeWatcher.init()})};c.plugin("timeWatcher",e)}(window,document,videojs),function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=a("../lib/Detector"),f=d(e),g=4,h=function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return{constructor:function(c,d){a.call(this,c,d),c.panoramaPlugin=this,this.width=c.el().offsetWidth,this.height=c.el().offsetHeight,this.lon=0,this.lat=0,this.phi=0,this.theta=0,this.gyroAvailable=!1,this.mouseDown=!1,this.isUserInteracting=!1,this.player=c,this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(75,this.width/this.height,1,2e3),this.camera.target=new THREE.Vector3(0,0,0),this.camera.zoom=1.2,c.options().zoom360&&(this.camera.zoom=c.options().zoom360),this.camera.updateProjectionMatrix(),this.buildBackButton(),window.p5Camera=this.camera,this.renderer=f["default"].webgl?new THREE.WebGLRenderer:new THREE.CanvasRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.autoClear=!1,this.renderer.setClearColor(0,1);var e=b.getTech(c);this.texture=new THREE.Texture(e),e.style.display="none",this.texture.generateMipmaps=!1,this.texture.minFilter=THREE.LinearFilter,this.texture.maxFilter=THREE.LinearFilter,this.texture.format=THREE.RGBFormat,this.mesh=new THREE.Mesh(new THREE.SphereGeometry(500,60,40),new THREE.MeshBasicMaterial({map:this.texture})),this.mesh.scale.x=-1,this.scene.add(this.mesh),this.el_=this.renderer.domElement,this.el_.classList.add("vjs-video-360-canvas"),this.el_.style.width="100%",this.el_.style.height="100%",this.el_.style.position="relative",this.touchStartTime=0,this.touchEndTime=0,this.defaultTapDuration=300,this.gyroEnabled=!1,this.VRwasEnabled=!1,this.d2r=Math.PI/180,this.camera.position.z=5,this.rotType="YXZ",this.setOrbitControls(),this.alphaOffset=0,this.betaOffset=0,this.alpha=0,this.beta=90,this.gamma=0,this.VRenabled=!1,this.player.on("start360",function(){window.uDevice&&"Desktop"===window.uDevice&&this.player.advertInProgress&&this.controls&&this.controls.store&&this.controls.reset&&(this.controls.store(),this.controls.reset()),this.time=(new Date).getTime(),this.animate(),this.VRwasEnabled&&(this.VRwasEnabled=!1,this.startVR())}.bind(this)),this.player.on("toggleVR",this.toggleVR.bind(this)),this.player.on("toggleGyro",this.toggleGyro.bind(this)),this.player.on("stop360",this.stopAnimate.bind(this)),d.callback&&d.callback(),this.vrButton=this.player.controlBar.getNestedChild("vrButton"),this.gyroButton=this.player.controlBar.getNestedChild("gyroButton");var g=$(this.player.node).attr("data-video-360-offset-x");isDefined(g)&&this.controls.setAzimuthalAngleInDegrees(parseInt(g,10)),c.on("start360",videojs.bind(this,function(){this.errorCheckInterval=setInterval(videojs.bind(this,this.handleWebGlErrors),250)})),c.on("stop360",videojs.bind(this,function(){clearInterval(this.errorCheckInterval)}))},attachControlEvents:function(a){$(window).on("resize orientationchange onorientationchange",this.handleFullscreen.bind(this)),a.on("fullscreenchange2",this.handleFullscreen.bind(this)),this.on("touchmove",this.handleTouchMove.bind(this)),this.on("touchstart",this.handleTouchDown.bind(this)),this.on("touchend",this.handleTouchUp.bind(this)),window.addEventListener("deviceorientation",this.handleGyro.bind(this),!1)},buildBackButton:function(){this.backButton=document.createElement("div"),this.backButton.className="vjs-vr-back-button",this.backButton.onclick=this.stopVR.bind(this),this.player.el().appendChild(this.backButton)},toggleVR:function(){this.VRenabled?this.stopVR():this.startVR()},startVR:function(){this.VRenabled=!0,$(this.player.el()).addClass("vjs-vr-enabled"),this.player.isFullScreen()||this.player.requestFullscreen(),this.gyroEnabled||this.startGyro(),this.player.paused()&&this.player.play(),this.effect=new THREE.OculusRiftEffect(this.renderer,{worldFactor:100,HMD:this.getHmd()}),this.effect.setSize(this.width,this.height)},stopVR:function(){this.VRenabled=!1,this.player.removeClass("vjs-vr-enabled"),"undefined"!=typeof this.effect&&this.effect.dispose(),this.renderer.setSize(this.width,this.height)},toggleGyro:function(){this.gyroEnabled?this.stopGyro():this.startGyro()},startGyro:function(){this.gyroEnabled=!0,this.controls&&this.controls.dispose(),this.controls=new THREE.DeviceOrientationControls(this.camera)},stopGyro:function(){this.gyroEnabled=!1,this.setOrbitControls()},setOrbitControls:function(){this.controls&&this.controls.dispose(),this.controls=new THREE.OrbitControls(this.camera,this.el_),this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.enableZoom=!1,this.controls.rotateSpeed=.05,this.controls.rotateSpeedY=.03},handleGyro:function(a){if(a.preventDefault(),a.alpha&&a.beta&&a.gamma)"undefined"!=typeof this.vrButton&&this.vrButton.hasClass("vjs-hidden")&&this.vrButton.show(),"undefined"!=typeof this.gyroButton&&this.gyroButton.hasClass("vjs-hidden")&&this.gyroButton.show();else try{this.vrButton&&this.vrButton.hide(),this.gyroButton&&this.gyroButton.hide()}catch(b){this.vrButton=this.player.controlBar.getNestedChild("vrButton"),this.gyroButton=this.player.controlBar.getNestedChild("gyroButton")}},getOrientation:function(){return window.screen.orientation?window.screen.orientation.angle:"number"==typeof window.orientation?window.orientation:window.screen.mozOrientation?{"portrait-primary":0,"portrait-secondary":180,"landscape-primary":90,"landscape-secondary":270}[window.screen.mozOrientation]:0},handleFullscreen:function(){var a=this.player.getAdsRescaleInfo({baseWidth:960,baseHeight:540});this.width=this.player.el().offsetWidth,this.height=this.player.el().offsetHeight,this.player.isFullscreen()?(this.el_.style.width=a.trueWidth+"px",this.el_.style.height=a.trueHeight+"px",this.el_.style.top=a.verticalOffset+"px",this.VRenabled&&(this.effect.setHMD(this.getHmd()),this.effect.setSize(this.width,this.height))):(this.el_.style.width="100%",this.el_.style.height="100%",this.el_.style.top="0px",this.VRenabled&&this.stopVR())},getHmd:function(){return{hResolution:this.width,vResolution:this.height,hScreenSize:.14976,vScreenSize:.0936,interpupillaryDistance:.078,lensSeparationDistance:.078,eyeToScreenDistance:.041,distortionK:[1,.22,.24,0],chromaAbParameter:[.996,-.004,1.014,0]}},handleMouseUp:function(){this.mouseDown=!1,this.touchEndTime=new Date,this.touchEndTime-this.touchStartTime<this.defaultTapDuration&&this.player.userActive(!0)},handleTouchUp:function(){this.mouseDown=!1,this.touchEndTime=new Date,this.touchEndTime-this.touchStartTime<this.defaultTapDuration&&this.player.userActive(!0)},handleMouseDown:function(a){a.preventDefault(),this.mouseDown=!0,this.onPointerDownPointerX=a.clientX,this.onPointerDownPointerY=a.clientY,this.onPointerDownLon=this.lon,this.onPointerDownLat=this.lat},handleTouchDown:function(a){a.preventDefault(),this.mouseDown=!0,this.onPointerDownPointerX=a.touches[0].clientX,this.onPointerDownPointerY=a.touches[0].clientY,this.onPointerDownLon=this.lon,this.onPointerDownLat=this.lat,this.touchStartTime=new Date},handleMouseMove:function(a){if(this.options_.clickAndDrag)this.mouseDown&&(this.lon=.2*(this.onPointerDownPointerX-a.clientX)+this.onPointerDownLon,this.lat=.2*(a.clientY-this.onPointerDownPointerY)+this.onPointerDownLat,this.controls&&"DeviceOrientationControls"==this.controls.name?this.controls.updateAlphaOffsetAngle(-this.lon/100):(this.lat>90&&(this.lat=90),this.lat<-90&&(this.lat=-90),this.betaOffset=this.lat,this.alphaOffset=-this.lon));else{var b=a.pageX-this.el_.offsetLeft,c=a.pageY-this.el_.offsetTop;this.lon=b/this.width*430-225,this.lat=c/this.height*-180+90}},handleTouchMove:function(a){if(this.options_.clickAndDrag)this.mouseDown&&(this.lon=.2*(this.onPointerDownPointerX-a.touches[0].clientX)+this.onPointerDownLon,this.lat=.2*(a.touches[0].clientY-this.onPointerDownPointerY)+this.onPointerDownLat,this.controls&&"DeviceOrientationControls"==this.controls.name&&this.controls.updateAlphaOffsetAngle(-this.lon/50));else{var b=a.pageX-this.el_.offsetLeft,c=a.pageY-this.el_.offsetTop;this.lon=b/this.width*430-225,this.lat=c/this.height*-180+90}},handleMouseWheel:function(a){a.wheelDeltaY?this.camera.fov-=.05*a.wheelDeltaY:a.wheelDelta?this.camera.fov-=.05*a.wheelDelta:a.detail&&(this.camera.fov+=1*a.detail),this.camera.updateProjectionMatrix()},handleMouseEnter:function(a){this.isUserInteracting=!0},handleMouseLease:function(a){this.isUserInteracting=!1},animate:function(){if(this.requestAnimationId=requestAnimationFrame(this.animate.bind(this)),this.player.paused())this.player.video360FpsCounter.reset();else if("undefined"!=typeof this.texture&&this.player.readyState()===g){var a=(new Date).getTime();a-this.time>=30&&(this.texture.needsUpdate=!0,this.time=a,this.player.video360FpsCounter.update())}this.render()},stopAnimate:function(){window.uDevice&&"Desktop"===window.uDevice&&this.player.advertInProgress&&this.controls&&this.controls.restore&&this.controls.restore(),this.VRenabled&&(this.VRwasEnabled=!0,this.stopVR()),cancelAnimationFrame(this.requestAnimationId),this.renderer.clear(),this.requestAnimationId=void 0,this.player.video360FpsCounter.reset()},render:function(){this.controls&&this.controls.update(),this.renderer.clear(),this.VRenabled?this.effect.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera)},el:function(){return this.el_},handleWebGlErrors:function(){if(this.renderer&&this.renderer.context){var a=this.renderer.context.getError();switch(a){case this.renderer.context.NO_ERROR:return;case this.renderer.context.INVALID_ENUM:case this.renderer.context.INVALID_VALUE:case this.renderer.context.INVALID_OPERATION:case this.renderer.context.OUT_OF_MEMORY:player.trigger("video360LowFPS");break;case this.renderer.context.INVALID_FRAMEBUFFER_OPERATION:case this.renderer.context.CONTEXT_LOST_MEMORY:break;default:return}}}}};b.exports=h},{"../lib/Detector":2}],2:[function(a,b,c){"use strict";var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},e={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var a=document.createElement("canvas");return!(!window.WebGLRenderingContext||!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(b){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var a=document.createElement("div");return a.id="webgl-error-message",a.style.fontFamily="monospace",a.style.fontSize="13px",a.style.fontWeight="normal",a.style.textAlign="center",a.style.background="#fff",a.style.color="#000",a.style.padding="1.5em",a.style.width="400px",a.style.margin="5em auto 0",this.webgl||(a.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),a},addGetWebGLMessage:function(a){var b,c,d;a=a||{},b=void 0!==a.parent?a.parent:document.body,c=void 0!==a.id?a.id:"oldie",d=e.getWebGLErrorMessage(),d.id=c,b.appendChild(d)}};"object"===("undefined"==typeof b?"undefined":d(b))&&(b.exports=e)},{}],3:[function(a,b,c){"use strict";var d=document.createElement("div");d.className="vjs-video-360-notice-label",d.innerHTML="";var e=function(a){return{constructor:function(b,c){c.el=d,a.call(this,b,c)},el:function(){return d}}};b.exports=e},{}],4:[function(a,b,c){"use strict";function d(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a]}b.exports={whichTransitionEvent:d}},{}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./lib/Util"),f=d(e),g={clickAndDrag:!1,showNotice:!0,autoHideNotice:3e3,returnStep:.5},h=function(a,b){a.addClass("vjs-panorama"),a.addChild("Canvas",b),b.showNotice&&(a.addChild("Notice",b),a.on("play",function(){var c=a.getChild("Notice");b.autoHideNotice>0&&setTimeout(function(){c.addClass("vjs-video-notice-fadeOut");var a=f["default"].whichTransitionEvent(),b=function d(){c.hide(),c.removeClass("vjs-video-notice-fadeOut"),c.off(a,d)};c.on(a,b)},b.autoHideNotice)})),a.on("play",function(){var b=a.getChild("Canvas");b.attachControlEvents(a)})},i=function(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=function(b){var c=this;a.mergeOption&&(b=a.mergeOption(g,b),this.ready(function(){h(c,b)}))};return b.VERSION="0.0.1",b};c["default"]=i},{"./lib/Util":4}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a};
}var e=a("./lib/Canvas"),f=d(e),g=a("./lib/Notice"),h=d(g),i=a("./plugin"),j=d(i),k=videojs.Component,l=function(a,b){this.constructor(a,b)},m=f["default"](k,{getTech:function(a){return a.tech.el()}});m.init=l,videojs.Canvas=k.extend(m);var n=h["default"](k);n.init=l,videojs.Notice=k.extend(n),videojs.plugin("panorama",j["default"]({mergeOption:function(a,b){return videojs.util.mergeOptions(a,b)}}))},{"./lib/Canvas":1,"./lib/Notice":3,"./plugin":5}]},{},[6]);var entitySpace={productPlacement:{type:"sprite",url:"img/pp.png",items:{0:{backgroundPosition:"-1px -0px",backgroundSize:"339px 69px",width:"337px",height:"33px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-1px -0px",backgroundSize:"339px 69px",width:"337px",height:"33px",x:"20px",y:"30px"}},1:{backgroundPosition:"-1px -34px",backgroundSize:"339px 69px",width:"320px",height:"33px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-1px -34px",backgroundSize:"339px 69px",width:"320px",height:"33px",x:"20px",y:"30px"}}}},parentalRating:{type:"sprite",url:"img/parental-rating.png",items:{0:{backgroundPosition:"-2px -0px",width:"30px",height:"30px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-3px -0px",backgroundSize:"113px 160px",width:"50px",height:"50px",x:"33px",y:"50px"}},12:{backgroundPosition:"-34px -0px",width:"30px",height:"30px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-57px -0px",backgroundSize:"113px 160px",width:"50px",height:"50px",x:"33px",y:"50px"}},16:{backgroundPosition:"-2px -32px",width:"30px",height:"30px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-3px -53px",backgroundSize:"113px 160px",width:"50px",height:"50px",x:"33px",y:"50px"}},18:{backgroundPosition:"-34px -32px",width:"30px",height:"30px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-57px -53px",backgroundSize:"113px 160px",width:"50px",height:"50px",x:"33px",y:"50px"}},7:{backgroundPosition:"-2px -64px",width:"30px",height:"30px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-3px -107px",backgroundSize:"113px 160px",width:"50px",height:"50px",x:"33px",y:"50px"}},off:{backgroundPosition:"-34px -64px",width:"30px",height:"30px",x:"20px",y:"30px",fullscreen:{backgroundPosition:"-57px -107px",backgroundSize:"113px 160px",width:"50px",height:"50px",x:"3px",y:"50px"}}}}};videojs.plugin("spawnEntityTvn",spawnEntityTvn),videojs.plugin("eventsTvn",eventsTvn),videojs.plugin("statsTvn",statsTvn),function(a,b,c){"use strict";var d=function(a){return{enabled:!1,breakTime:!1,breakActivated:!1,breakInProgress:!1,breakFinished:!1,breakOnVideoComplete:!1,current:"standard",standard:{},standardIndex:0,standardPlayerId:null,alternative:{},alternativeIndex:0,alternativePlayerId:null,init:function(){var b=a.options().playlistData;b!==!1&&(this.enabled=!0,this.standardPlayerId=a.playerId,b.playlist.hasOwnProperty("breaklist")&&(b.playlist.breaklist.hasOwnProperty("time")?this.breakTime=b.playlist.breaklist.time:this.breakOnVideoComplete=!0,this.alternative=b.playlist.breaklist.movies,this.alternativeIndex=parseInt(this._findIndex(b.playlist.breaklist.movies),10)),this.standard=b.playlist.movies,this.standardIndex=parseInt(a.options().playlistIndex,10))},checkBreakTime:function(){if("standard"==this.current&&!this.breakActivated){var b=this.breakTime>0&&a.getFixedCurrentTime()>=this.breakTime&&"undefined"!=typeof this.alternative,c=this.breakOnVideoComplete&&"undefined"!=typeof this.alternative;(b||c)&&(this.breakActivated=!0,this.breakInProgress=!0,this._changePlaylist())}},handleVideoComplete:function(){this.breakFinished||"alternative"==this.current&&(this._isCurrentVideoLastOne()?this._changePlaylist(!0):this.playNextVideo())},getCurrentPlaylistAndIndex:function(){var a="standard"==this.current?this.standard:this.alternative,b="standard"==this.current?this.standardIndex:this.alternativeIndex;return{playlist:a,index:b}},playNextVideo:function(b){b="undefined"==typeof b||b;var c="standard"==this.current?this.standard:this.alternative,d="standard"==this.current?parseInt(this.standardIndex,10)+1:parseInt(this.alternativeIndex,10)+1;return"undefined"!=typeof c[d]&&(this._prepareMovie(c,d),"standard"==this.current?this.standardIndex++:(this.alternativeIndex++,a.playerId=this._generatePlayerId()),this._playVideo(b),void 0)},_changePlaylist:function(b){this.current="standard"==this.current?"alternative":"standard";var c="standard"==this.current?this.standard:this.alternative,d="standard"==this.current?this.standardIndex:this.alternativeIndex;return this._prepareMovie(c,d),"alternative"==this.current&&(a.sendBreakStats("changePlaylist"),a.playerId=this._generatePlayerId(),a.one("canplay",function(){a.sendBreakStats("playing")})),isDefined(b)&&b===!0?(this._playVideo(!1,this.breakTime),this.breakInProgress=!1,void(this.breakFinished=!0)):void this._playVideo(!1)},_findIndex:function(a){for(var b in a){var c=a[b];if(c.hasOwnProperty("start")&&1==c.start)break}return parseInt(b,10)},_playVideo:function(b,c){if(b){var d=$(a.el()).find(".vjs-restboard-container");a.restboardHandler&&(a.restboardHandler.showElHandler(d),a.restboardHandler.handleTimer(d))}else a.resetPlayerAds(),a.play();a.one("canplay",function(){a.playlistManager._prepareControls()}),"undefined"!=typeof c&&c>0&&(a.playerId=this.standardPlayerId,a.one("canplay",function(){a.currentTime(parseInt(c,10)),a.sendBreakStats("end")}))},_prepareMovie:function(b,c){a.options().prevMovie=b[c-1]||!1,a.options().activeMovie=b[c],a.options().nextMovie=b[c+1]||!1,a.playbackOrigin=a.options().activeMovie.profiles.wv.url},_prepareControls:function(){var b=a.controlBar.getNestedChild("playNextButton");a.options().nextMovie!==!1?($(a.el()).find(".vjs-play-next-href").attr("href",a.options().nextMovie.detail_path+"#play"),b&&b.show()):b&&b.hide()},_isCurrentVideoLastOne:function(){var a=this.getCurrentPlaylistAndIndex();return"undefined"==typeof a.playlist[a.index+1]},_generatePlayerId:function(){return"player_"+Math.round(1e6*Math.random())}}},e=function(){var a=this;a.playlistManager=new d(a),a.options().playlistData!==!1&&a.playlistManager.init()};videojs.plugin("playlistManager",e)}(window,document,videojs),function(a,b,c){"use strict";var d=function(c){var d=$(c.el());return{adType:null,tapGoTypes:["wipe","tapAction","multitouch","hold","move","shape","forcetouch","shakeBlow","draw"],enabled:!1,vastItem:null,video_wrapper:$(c.el()),isAdvertInProgress:!1,adDuration:0,skipMainVideo:!1,DEBUG:!1,isVideoPlaying:!1,isTapGoPlaying:!0,tapGoTimer:0,tapGoTimerInterval:!1,tapGoTimerFrequency:250,tapGoBoardsTimes:[],firstCounterStarted:!1,timeElements:{other:[]},tapGoElIdCounter:0,isPaused:!1,preloadedElements:[],preloadedElementsCounter:0,isTapGoReady:!1,hasSpot:!0,stopSpotUsed:{},rescaleRatio:null,priority:!0,supportedEvents:"mouse",breakBoards:{group:[],groupIds:[],addHandler:!0},groupsTimeouts:[],zIndex:{board:1e4,action:2e4,goal:3e4,button:4e4,"break":8e4,imageSlider:5e4},endTapGo:!1,getRescaleRatio:function(a){if(a="undefined"!=typeof a&&a,this.rescaleRatio&&!a)return this.rescaleRatio;if(c.currentAdGroupIndex===!1||c.currentAdItemIndex===!1)return!1;var b=$("#vjs-cfullscreen-test"),d=c.getAdsRescaleInfo({baseWidth:720,baseHeight:404,scale_down:"true",scale_up:"true"});return c.isFullscreen()&&detectIE()&&adHandler.find(".vjs-tech").height()===d.trueHeight&&b.length&&(d.verticalOffset=(b.height()-d.trueHeight)/2),this.rescaleRatio=d?d.ratio:null,this.rescaleRatio},rescale:function(){function a(){var a,b;f.find(".vjs-tapgo-board").each(function(){a=$(this),a.css({width:i.roundNum(a.attr("data-width")*e),height:i.roundNum(a.attr("data-height")*e),top:i.roundNum(a.attr("data-y")*e),left:i.roundNum(a.attr("data-x")*e)}),a.hasClass("vjs-goal")&&(b=h[a.data("group-id")].goals[a.data("index")],b.realWidth=parseFloat(a.css("width")),b.realHeight=parseFloat(a.css("height")),b.minX=i.roundNum(i.offsetLeft+parseFloat(a.css("left"))),b.maxX=i.roundNum(b.minX+b.realWidth),b.minY=i.roundNum(i.offsetTop+parseFloat(a.css("top"))),b.maxY=i.roundNum(b.minY+b.realHeight))}),b=null,a=null}function b(){var a,b,c;f.find(".vjs-tapgo-slides").each(function(){for(a=$(this),a.css({position:"absolute",width:i.roundNum(a.attr("data-width")*e),height:i.roundNum(a.attr("data-height")*e),top:i.roundNum(a.attr("data-y")*e),left:i.roundNum(a.attr("data-x")*e),overflow:"hidden"}),a.find(".vjs-image, img").css({position:"absolute",overflow:"hidden",width:i.roundNum(a.attr("data-width")*e),height:i.roundNum(a.attr("data-height")*e)}),b=h[a.data("group-id")].slidesIds,c=b.length||0;c--;){var d=h[a.data("group-id")].slides[b[c]];d.realWidth=parseFloat(a.css("width")),d.realHeight=parseFloat(a.css("height")),d.minX=i.roundNum(i.offsetLeft+parseFloat(a.css("left"))),d.maxX=i.roundNum(d.minX+d.realWidth),d.minY=i.roundNum(i.offsetTop+parseFloat(a.css("top"))),d.maxY=i.roundNum(d.minY+d.realHeight)}}),a=null}function d(){var a,b;f.find(".vjs-tapgo-button").each(function(){a=$(this),a.css({width:i.roundNum(a.attr("data-width")*e),height:i.roundNum(a.attr("data-height")*e),top:i.roundNum(a.attr("data-y")*e),left:i.roundNum(a.attr("data-x")*e)}),b=h[a.data("group-id")].buttons[a.data("index")],b.realWidth=parseFloat(a.css("width")),b.realHeight=parseFloat(a.css("height")),b.minX=i.roundNum(i.offsetLeft+parseFloat(a.css("left"))),b.maxX=i.roundNum(b.minX+b.realWidth),b.minY=i.roundNum(i.offsetTop+parseFloat(a.css("top"))),b.maxY=i.roundNum(b.minY+b.realHeight)}),b=null,a=null}var e,f,g,h,i=this;null===this.video_wrapper&&(this.video_wrapper=$(c.el())),f=this.video_wrapper.find(".vjs-tapgo"),f.length&&(g=f.offset(),this.offsetLeft=this.roundNum(g.left),this.offsetTop=this.roundNum(g.top),g=null,e=this.getRescaleRatio(!0),e&&(h=this.vastItem.buttonsGroups,a(),d(),b(),f.trigger("tapGoRescaleEvent")))},setBrowserSupportedEvents:function(){"ontouchstart"in a?this.supportedEvents="touch":a.PointerEvent||a.msPointerEvent?this.supportedEvents="pointer":this.supportedEvents="mouse"},clear:function(){var a,e,f,g=this,h=c.tapGoManager,i=h.video_wrapper,j=h.tapGoTypes.length;for(this.breakBoardHandler().clearAll(),h.counter().clearTimerInterval(),h.clearAllGroupsTimeouts(),i.find(".vjs-tapgo").off("tapGoTimerUpdateEvent"),i.find(".vjs-tapgo").off(g.getEventToHandleIt("down","tapGoBreakBoard")),i.find(".vjs-tapgo").off("click.catchEvent");j--;){for(a=h[h.tapGoTypes[j]],e=a.length;e--;)f=a[e],"function"==typeof f.clear&&f.clear();h[h.tapGoTypes[j]]=null,h[h.tapGoTypes[j]]=[]}$(b).off("touchstart mousedown touchend mouseup mousemove touchmove touchdown",".vjs-tapgo-button"),i.off("touchstart mousedown touchend mouseup mousemove touchmove touchdown",".vjs-tapgo-button"),h.isAdvertInProgress=!1,h.skipMainVideo=!1,h.firstCounterStarted=!1,h.vastItem=null,h.adDuration=0,h.isVideoPlaying=!1,h.isTapGoPlaying=!0,h.tapGoTimer=0,h.timeElements={other:[]},h.tapGoBoardsTimes=[],h.tapGoElIdCounter=0,h.isPaused=!1,h.preloadedElements=[],h.preloadedElementsCounter=0,h.isTapGoReady=!1,h.hasSpot=!0,h.stopSpotUsed={},h.priority=!0,h.breakBoards={group:[],groupIds:[],addHandler:!0},h.zIndex={board:1e4,action:2e4,goal:3e4,button:4e4,"break":8e4,imageSlider:5e4},h.endTapGo=!1,i.find(".vjs-tapgo").remove(),c.off("isTapGoReadyInit"),c.removeClass("vjs-tg-waiting"),d.removeClass("vjs-tg-playing"),c.removeClass("vjs-tg-no-spot")},getTapGoAdType:function(a){return"tap_action"===a?"tapAction":"blow"===a||"shake"===a?"shakeBlow":a},initTapGoAd:function(a){function b(a){var b=a.target.attribs;b.showTime&&b.showTime.length?b.showTime=makeMilliSeconds(b.showTime)||0:b.showTime=0,b.duration&&b.duration.length?b.duration=makeMilliSeconds(b.duration)||!1:b.duration=!1,b.hideTime=!!b.duration&&b.showTime+b.duration}if(!a||!a.type)return!1;var d,e=this.getTapGoAdType(a.type),f=c.tapGoManager.timeElements,g=c.tapGoManager.tapGoBoardsTimes;c.tapGoManager.groupsTimeouts[a.index]={pendingActionsCount:0,elements:[]},d=c.tapGoManager[e].length?c.tapGoManager[e].length:0,b(a),c.tapGoManager[e][d]=new adHandlers.tapGo[e](a,d,c),"undefined"==typeof f[a.target.attribs.showTime]&&(f[a.target.attribs.showTime]=[],g.push(a.target.attribs.showTime)),f[a.target.attribs.showTime].push({timeEvent:"initTapGoEvents",tapGoType:e,tapGoId:d}),a.target.attribs.hideTime!==!1&&("undefined"==typeof f[a.target.attribs.hideTime]&&(f[a.target.attribs.hideTime]=[],g.push(a.target.attribs.hideTime)),f[a.target.attribs.hideTime].push({timeEvent:"hideTapGo",tapGoType:e,tapGoId:d,groupId:a.index})),g.sort(function(a,b){return a-b})},buildView:function(){var a,b,e,f,g,h,i,j=this,k=c.tapGoManager,l='<div class="vjs-tapgo" data-selectarea style="opacity:'+this.vastItem.attribs.backgroundAlfa+'"></div>',m=this.vastItem.buttonsGroups,n=this.vastItem.groupsIds,o=n.length||0;if(this.isAdvertInProgress=!0,d.find(".vjs-control-bar-wrapper").length?d.find(".vjs-control-bar-wrapper").append(l):d.append(l),c.addClass("vjs-tg-waiting"),c.addClass("vjs-tg-playing"),d.find(".vjs-tapgo-boards").length||d.find(".vjs-tapgo").append('<div class="vjs-tapgo-boards"></div>'),d.find(".vjs-tapgo-buttons").length||d.find(".vjs-tapgo").append('<div class="vjs-tapgo-buttons"></div>'),this.vastItem.boards)for(b=this.vastItem.boards,f=b.length;f--;)c.tapGoManager.buildItem(b[f]);for(;o--;){if(a=m[n[o]],b=a.goals)for(e=a.goalsIds,f=e.length;f--;)c.tapGoManager.buildItem(b[e[f]]);if(b=a.buttons)for(e=a.buttonsIds,f=e.length;f--;)c.tapGoManager.buildItem(b[e[f]]);if(a.target){for(i=a.target,e=i.actionsIds,f=e.length;f--;)c.tapGoManager.buildItem(i.actions[e[f]]);for(e=a.buttonsIds,f=e.length;f--;)for(b=i.buttonActions[e[f]],g=b?b.buttonActionsIds:[],h=g.length;h--;)c.tapGoManager.buildItem(b[g[h]]);for(e=i.finishActionsIds,f=e.length;f--;)c.tapGoManager.buildItem(i.finishAction[e[f]])}j.initTapGoAd(a)}d.find(".vjs-tapgo").css({visibility:"hidden",opacity:"0"}).show(),c.refreshButtonAds(),this.rescale(),this.preloadElements();var p=d.find(".vjs-tapgo");p.on(k.getEventToHandleIt("down","sharebtn"),".vjs-tapgo-share",function(a){c.callFromWebview("share",{x:120,y:70,width:300,height:250})}),d.find(".vjs-tapgo").css({visibility:"visible",opacity:"1"}),c.currentAdTime=makeSeconds(this.vastItem.attribs.duration),d.find(".vjs-tapgo").on(j.getEventToHandleIt("down","tapGoBreakBoard"),".vjs-tapgo-break",function(){j.breakBoardHandler().stop($(this).data("group-id"),$(this).data("button-id")||0),j.breakBoardHandler().start($(this).data("group-id"),$(this).data("button-id")||0)}),d.find(".vjs-tapgo").on("click.catchEvent",function(a){a.preventDefault(),a.stopPropagation()})},fadeTime:function(a){if(isDefined(a))if("string"==typeof a){var b=a.split(".");if(2==b.length)return 1e3*parseInt(b[0],10)+parseInt(b[1],10)}else if(!isNaN(a))return a;return 0},buildAd:function(a,b){if("undefined"==typeof a)return!1;c.tapGoManager.clear(),c.addClass("vjs-tg-no-spot"),c.addClass("vjs-tg-waiting"),b&&(a.lvlsMaxDurations=b);var d=c.getCurrentAd(),e=parseInt(a.lvlsMaxDurations[a.level]-makeSeconds(a.attribs.duration),10);return a.lvlsMaxDurations[a.level]=a.lvlsMaxDurations[a.level]-e,d.tapGoTime=0,c.currentTime(0),this.vastItem=a,this.adDuration=a.lvlsMaxDurations[a.level],d.fullObj.TapGo=a,a.level>0&&(d.fullObj.Duration=secondsToHms(parseInt(makeSeconds(d.fullObj.Duration),10)-a.lvlsMaxDurations[a.level-1]-e),c.videoAdsHandler.recalculateTotalTimeOfCurrentGroup(),c.currentAdTime=c.tapGoManager.adDuration,c.remainingWrap.text(c.videoAdsHandler.getRemainingTime()),a.spot&&a.spot.MediaFile?(d.source=a.spot.MediaFile,c.tapGoManager.hasSpot=!0):c.tapGoManager.hasSpot=!1),this.buildView(),c.one("isTapGoReadyInit",function(){c.removeClass("vjs-tg-waiting"),c.tapGoManager.hasSpot?(c.removeClass("vjs-tg-no-spot"),c.tapGoManager.counter().setVideoPlaying(!0)):(c.tapGoManager.counter().setVideoPlaying(!1),c.endOfClip=!0),c.tapGoManager.counter().init()}),a.level>0&&c.playSingleAd(),!1},movieEndedEvent:function(){var a=d.find(".vjs-pause-overlay");a.length&&!a.hasClass("vjs-hidden")&&a.addClass("vjs-hidden"),c.pause(),d.hasClass("vjs-playing")&&d.removeClass("vjs-playing");var b=self.player.controlBar.getNestedChild("playToggle");b&&b.onClick(),setTimeout(function(){d.addClass("vjs-playing")},5)},init:function(){if(this.enabled)return!1;this.enabled=!0,this.video_wrapper=$(c.el());var a=c.tapGoManager;a.wipe=[],a.tapAction=[],a.multitouch=[],a.hold=[],a.move=[],a.shape=[],a.shakeBlow=[],a.draw=[],a.forcetouch=[],a.imageSlider=[],this.setBrowserSupportedEvents()},debug:function(a,b){var d=!0;if(this.DEBUG&&("undefined"!=typeof b&&b?console.log("%c "+a,"color:#bada55; background-color: black;"):console.log(a),d)){var e=c.tapGoManager.video_wrapper;e.parent().find("#tapgo-debug").length?e.parent().find("#tapgo-debug").prepend((new Date).toLocaleTimeString()+": "+a+"<br>"):(e.find(".vjs-tapgo").length&&(e=e.find(".vjs-tapgo")),e=e.parent(),e.append('<div id="tapgo-debug">'+(new Date).toLocaleTimeString()+": "+a+"<br></div>"),e.append('<div id="tapgo-debug-btn"></div><div id="tapgo-debug-video-ctrl"></div><div id="tapgo-debug-clear">CLR</div>'),c.tapGoManager.handleDebuggerButtons())}},handleDebuggerButtons:function(){function a(a){c.tapGoManager.preventEventAction(a),$(this).hasClass("debug-showed")?($(this).removeClass("debug-showed"),$(this).siblings("#tapgo-debug, #tapgo-debug-video-ctrl, #tapgo-debug-clear").addClass("hidden")):($(this).addClass("debug-showed"),$(this).siblings("#tapgo-debug, #tapgo-debug-video-ctrl, #tapgo-debug-clear").removeClass("hidden"))}function d(a){c.tapGoManager.preventEventAction(a),$(this).hasClass("paused")?(c.tapGoManager.counter().setPause(!1),c.endOfClip||(c.tapGoManager.enabled?Object.keys(c.tapGoManager.stopSpotUsed).length||c.play():c.play()),$(this).removeClass("paused")):(c.pause(),c.tapGoManager.counter().setPause(!0),$(this).addClass("paused"))}var e,f=$("#tapgo-debug-btn");return!!f.length&&(f.hasClass("debug-showed")?f.siblings("#tapgo-debug, #tapgo-debug-video-ctrl, #tapgo-debug-clear").removeClass("hidden"):f.siblings("#tapgo-debug, #tapgo-debug-video-ctrl, #tapgo-debug-clear").addClass("hidden"),e=c.tapGoManager.getEventToHandleIt("down","tapGoDebugger"),$(b).off(e),$(b).on(e,"#tapgo-debug-btn",a),$(b).on(e,"#tapgo-debug-video-ctrl",d),$(b).on(e,"#tapgo-debug-clear",function(){$(this).siblings("#tapgo-debug").html("")}),void(f=e=null))},triggerSingleTapGoUpEvent:function(a){var c,d;if(a.upEvent){if("undefined"!=typeof a.upEvent.eventIndex)$(b).trigger(a.upEvent),a.upEvent=null;else{for(c=Object.keys(a.upEvent),d=c.length;d--;)a.upEvent[c[d]]&&($(b).trigger(a.upEvent[c[d]]),a.upEvent[c[d]]=null);a.upEvent={}}return!0}return!1},triggerUpEvents:function(){for(var a,b,c=this,d=c.tapGoTypes.length;d--;)for(a=c[c.tapGoTypes[d]],b=a.length;b--;)c.triggerSingleTapGoUpEvent(a[b])},finishTapGo:function(){c.tapGoManager.triggerUpEvents(),c.tapGoManager.counter().clearTimerInterval(),c.tapGoManager.isAdvertInProgress=!1,c.tapGoManager.clear(),c.trigger("ended")},resetGroupTimeouts:function(a,b){b=b||c.tapGoManager.groupsTimeouts[a],b.pendingActionsCount=0,b.elements=[]},decrementGroupesPendingTimeouts:function(a,b){b=b||c.tapGoManager.groupsTimeouts[a],b.pendingActionsCount--,b.pendingActionsCount<=0&&this.resetGroupTimeouts(a,b)},clearGroupTimeouts:function(a,b){var d,e;if(b=b||c.tapGoManager.groupsTimeouts[a],b&&b.pendingActionsCount)for(d=b.elements.length;d--;)e=b.elements[d],e&&clearTimeout(e);b.elements=[],b.pendingActionsCount=0},clearAllGroupsTimeouts:function(){for(var a=!!c.tapGoManager.vastItem&&c.tapGoManager.vastItem.groupsIds,b=a?a.length:0;b--;)c.tapGoManager.clearGroupTimeouts(a[b]);c.tapGoManager.groupsTimeouts=[]},soundAction:function(a,b){var d;b=b||c.tapGoManager.groupsTimeouts[a.groupId],d=b.elements.length,b.pendingActionsCount++,b.elements[d]=setTimeout(function(d){new Audio(a.sound.url).play(),b.elements[d]=null,c.tapGoManager.decrementGroupesPendingTimeouts(a.groupId,b)},a.sound.attribs.delay||0,parseInt(d,10))},redirectAction:function(b,d){var e;d=d||c.tapGoManager.groupsTimeouts[b.groupId],e=d.elements.length,d.pendingActionsCount++,d.elements[e]=setTimeout(function(e){c.tapGoManager.triggerUpEvents(),c.callFromWebview("openUrl",b.redirect.url),c.isWebviewMode()||(c.setAppActivation(!1),a.open(b.redirect.url,"_blank"),$(a).on("focus.tapGoRedirect",function(){c.setAppActivation(!0),c.tapGoManager.endTapGo&&c.tapGoManager.finishTapGo(),$(a).off("focus.tapGoRedirect")})),d.elements[e]=null,c.tapGoManager.decrementGroupesPendingTimeouts(b.groupId,d)},b.redirect.attribs.delay||0,parseInt(e,10))},startTapGoAction:function(a,b){var d;b=b||c.tapGoManager.groupsTimeouts[a.groupId],d=b.elements.length,b.pendingActionsCount++,b.elements[d]=setTimeout(function(d){c.tapGoManager.triggerUpEvents(),c.tapGoManager.buildAd(a.tapGo,c.tapGoManager.vastItem.lvlsMaxDurations),b.elements[d]=null,c.tapGoManager.decrementGroupesPendingTimeouts(a.groupId,b)},a.tapGo.attribs.delay||0,parseInt(d,10))},playAction:function(a){var b=c.tapGoManager.groupsTimeouts[a.groupId];(a.attribs.successX||a.attribs.successY)&&c.tapGoManager.setElementPosition(a),a.background&&c.tapGoManager.showElement(a,b),a.sound&&c.tapGoManager.soundAction(a,b),c.runTracking(a.statUrl),a.tapGo?c.tapGoManager.startTapGoAction(a,b):(a.attribs.endTapGo&&(c.tapGoManager.endTapGo=!0),a.redirect?c.tapGoManager.redirectAction(a,b):c.tapGoManager.endTapGo&&c.tapGoManager.finishTapGo())},roundNearQtr:function(a){return(Math.round(4*a)/4).toFixed(3)},counter:function(){var a=c.tapGoManager.video_wrapper.find(".vjs-tapgo"),b=c.tapGoManager;return{setVideoPlaying:function(a){b.isVideoPlaying=a},setTapGoPlaying:function(a){b.isTapGoPlaying=a},setPause:function(a){b.isPaused=a},updateRemainingTime:function(){c.newAdStock[c.currentAdGroupIndex].items[c.currentAdItemIndex].tapGoTime+=1,c.remainingWrap.text(c.videoAdsHandler.getRemainingTime())},clearTimerInterval:function(){b.tapGoTimerInterval&&(clearInterval(b.tapGoTimerInterval),b.tapGoTimerInterval=!1),b.tapGoTimer=0},getCurrTime:function(){return parseInt(1e3*b.roundNearQtr(c.currentTime())+b.tapGoTimer,10)},init:function(){b.counter().clearTimerInterval(),b.firstCounterStarted||(b.hasSpot&&b.isVideoPlaying&&c.paused()&&c.play(),b.firstCounterStarted=!0,b.counter().timeAction(0)),b.tapGoTimerInterval=setInterval(function(){if(!b.isTapGoPlaying||b.isVideoPlaying||b.isPaused||(b.tapGoTimer+=b.tapGoTimerFrequency,b.tapGoTimer%1e3===0&&b.counter().updateRemainingTime()),1e3*c.currentTime()+b.tapGoTimer>=1e3*b.adDuration)return void b.finishTapGo();var d=b.counter().getCurrTime();b.counter().timeAction(d),a.trigger({type:"tapGoTimerUpdateEvent",time:d})},b.tapGoTimerFrequency)},timeAction:function(a){for(var c,d,e=b.tapGoBoardsTimes;"undefined"!=typeof e[0]&&e[0]<=a;){for(c=b.timeElements[e[0]],d="undefined"!=typeof c?c.length:0;d--;){switch(c[d].timeEvent){case"show":b.showElement(c[d]);break;case"hide":b.hideElement(c[d]);break;case"initTapGoEvents":b.initTapGoEvents(c[d]);break;case"hideTapGo":b.hideTapGo(c[d])}c.splice(d,1)}e.splice(0,1)}}}},preloadElements:function(){var a=this,b=1e3*parseInt(this.vastItem.attribs.buffer,10)||0;if(a.priority){var d=!1;Object.keys(c.tapGoManager.timeElements).forEach(function(e,f){if("other"!=e&&parseInt(e,10)<=b)for(var g=c.tapGoManager.timeElements[e],h=0,i=g.length;h<i;h++)"show"==g[h].timeEvent&&(a.preload(g[h]),d=!0)}),d||(a.isTapGoReady=!0,c.trigger("isTapGoReady"),a.priority=!1,a.preloadElements())}else Object.keys(c.tapGoManager.timeElements).forEach(function(d,e){if(parseInt(d,10)>b||"other"==d)for(var f=c.tapGoManager.timeElements[d],g=0,h=f.length;g<h;g++)"initTapGoEvents"!=f[g].timeEvent&&"hideTapGo"!=f[g].timeEvent&&a.preload(f[g])})},preload:function(a){function b(a){var b=f.preloadedElements.length;f.preloadedElements[b]=new Image,f.preloadedElements[b].onload=function(){f.preloadedElementsCounter++,e()},f.preloadedElements[b].onerror=function(){f.preloadedElementsCounter++,e()},f.preloadedElements[b].src=a}function d(a){var b=f.preloadedElements.length;f.preloadedElements[b]=new Audio,f.preloadedElements[b].preload="auto",f.preloadedElements[b].autoPlay=!1,f.preloadedElements[b].oncanplay=function(){f.preloadedElementsCounter++,e()},f.preloadedElements[b].onerror=function(){f.preloadedElementsCounter++,e()},f.preloadedElements[b].src=a,f.preloadedElements[b].load()}function e(){f.priority&&f.preloadedElementsCounter===f.preloadedElements.length&&(f.isTapGoReady=!0,c.trigger("isTapGoReady"),f.priority=!1,f.preloadElements())}var f=this;a.background.image&&b(a.background.image),a.background.hover&&b(a.background.hover),a.background.selected&&b(a.background.selected),a.sound&&a.sound.url&&d(a.sound.url)},breakBoardHandler:function(){var a=c.tapGoManager,b=a.breakBoards;return{init:function(c){if("undefined"==typeof c.attribs.groupId)return!1;var d,e,f=a.vastItem.buttonsGroups[c.attribs.groupId],g=!1;if(!f)return!1;if("undefined"==typeof b.group[c.attribs.groupId]&&(b.groupIds.push(c.attribs.groupId),b.group[c.attribs.groupId]={type:f.type,boards:[],boardsIds:[]}),d=b.group[c.attribs.groupId],"undefined"==typeof c.attribs.buttonId)switch(d.type){case"shape":case"draw":case"shake":case"blow":c.attribs.buttonId=0,c.hasButtonIdParam=!1,g=makeMilliSeconds(f.target.attribs.breakTime);break;default:return!1}else f.target.buttonActions&&(e=f.target.buttonActions[c.attribs.buttonId],c.hasButtonIdParam=!0,g=!!e&&makeMilliSeconds(e.attribs.breakTime));return!!g&&(c.index=c.attribs.buttonId,c.enable=!1,c.time=0,c.limit=g,d.boardsIds.push(c.index),d.boards[c.index]=c,void(b.addHandler&&(b.addHandler=!1,a.video_wrapper.find(".vjs-tapgo").on("tapGoTimerUpdateEvent.breakBoard",function(){a.breakBoardHandler().check()}))))},start:function(a,c){b.group[a]&&b.group[a].boards[c]&&(b.group[a].boards[c].enable=!0)},stop:function(a,c){b.group[a]&&b.group[a].boards[c]&&(this.hide(a,c),b.group[a].boards[c].enable=!1)},show:function(b){a.showElement(b)},hide:function(c,d){b.group[c]&&b.group[c].boards[d]&&(a.video_wrapper.find("#"+b.group[c].boards[d].itemId).hide(),b.group[c].boards[d].time=0)},check:function(){var d,e,f,g=b.groupIds.length;if(!g)return a.video_wrapper.find(".vjs-tapgo").off("tapGoTimerUpdateEvent.breakBoard"),!1;for(;g--;)for(d=b.group[b.groupIds[g]],e=d.boardsIds.length;e--;)f=d.boards[d.boardsIds[e]],f.enable&&(f.time+=a.tapGoTimerFrequency,f.time>=f.limit&&(f.enable=!1,this.show(f),c.runTracking(f.statUrl)))},removeBoard:function(c,d){this.stop(c,d);var e=b.group[c],f=e?e.boardsIds.indexOf(d):-1;f>-1&&(e.boardsIds.splice(f,1),e.boards[d]=null,e.boardsIds.length||(e.boards=null,f=b.groupIds.indexOf(c),b.groupIds.splice(f,1),b.group[c]=null,b.groupIds.length||(a.breakBoards={group:[],groupIds:[],addHandler:!0},a.video_wrapper.find(".vjs-tapgo").off("tapGoTimerUpdateEvent.breakBoard"))))},clearGroup:function(a){for(var c=b.group[a]?b.group[a].boardsIds:[],d=c.length;d--;)this.removeBoard(a,c[d])},clearAll:function(){for(var a=b.groupIds.length;a--;)this.clearGroup(b.groupIds[a])}}},buildItem:function(a){var b=c.tapGoManager,d=b.video_wrapper,e=b.tapGoBoardsTimes;if(a.itemId=c.id()+"_tapGoEl"+c.tapGoManager.tapGoElIdCounter++,"action"!=a.type){var f="break"!==a.attribs.showTime?makeMilliSeconds(a.attribs.showTime):"break";if("break"===f)a.type="break",a.attribs.stopSpot=!1,c.tapGoManager.breakBoardHandler().init(a),c.tapGoManager.timeElements.other.push(a);else if("undefined"==typeof c.tapGoManager.timeElements[f]&&(c.tapGoManager.timeElements[f]=[],e.push(f)),a.timeEvent="show",c.tapGoManager.timeElements[f].push(a),""!==a.attribs.duration){f+=makeMilliSeconds(a.attribs.duration),"undefined"==typeof c.tapGoManager.timeElements[f]&&(c.tapGoManager.timeElements[f]=[],e.push(f));var g=$.extend({},a);g.timeEvent="hide",c.tapGoManager.timeElements[f].push(g)}}else c.tapGoManager.timeElements.other.push(a);var h=!0,i=a.attribs;a.background.image||(h=!1);var j;h?(j=$(new Image),j.attr({src:a.background.image})):j=$("<div>"),j.attr("id",a.itemId);for(var k,l,m=Object.keys(i),n=m.length;n--;)k=m[n].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),l=i[m[n]],j.attr("data-"+k,l);if(h||!h&&"goal"==a.type){for(m=Object.keys(a.background.attribs),n=Object.keys(m).length;n--;)k=m[n].replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),l=a.background.attribs[m[n]],j.attr("data-"+k,l);j.attr("data-background-hover",a.background.hover),j.attr("data-background-image",a.background.image),j.attr("data-background-selected",a.background.selected)}switch(j.css("display","none"),a.type){case"goal":j.attr({"data-selected":!1}),j.addClass("vjs-goal").addClass("vjs-tapgo-board").appendTo(d.find(".vjs-tapgo-boards"));break;case"imageSlider":j.addClass("vjs-tapgo-slides").appendTo(d.find(".vjs-tapgo"));break;case"board":case"action":case"break":"break"===a.type&&j.addClass("vjs-tapgo-break"),j.addClass("vjs-tapgo-board").appendTo(d.find(".vjs-tapgo-boards"));break;case"button":a.redirect=!1,j.addClass("vjs-tapgo-button").appendTo(d.find(".vjs-tapgo-buttons"))}},showElement:function(a,b){var e,f=function(){a.attribs.fadeTime=c.tapGoManager.fadeTime(a.attribs.fadeTime),d.find(".vjs-tapgo").trigger({type:"showElement",elId:a.itemId,index:"undefined"!=typeof a.index&&a.index}),d.find("#"+a.itemId).css("z-index",c.tapGoManager.zIndex[a.type]++).fadeIn(a.attribs.fadeTime),a.attribs.stopSpot&&(c.pause(),c.tapGoManager.stopSpotUsed[a.itemId]=!0)};a.groupId?(b=b||c.tapGoManager.groupsTimeouts[a.groupId],e=b.elements.length,b.pendingActionsCount++,b.elements[e]=setTimeout(function(d){f(),b.elements[d]=null,c.tapGoManager.decrementGroupesPendingTimeouts(a.groupId,b)},a.background.attribs.delay||0,parseInt(e,10))):f()},hideElement:function(a){d.find("#"+a.itemId).hide(0,function(){d.find(".vjs-tapgo").trigger({type:"hideElement",elId:a.itemId,index:"undefined"!=typeof a.index&&a.index})}),a.attribs.stopSpot&&c.tapGoManager.stopSpotUsed&&(delete c.tapGoManager.stopSpotUsed[a.itemId],0===Object.keys(c.tapGoManager.stopSpotUsed).length&&c.tapGoManager.hasSpot&&!c.endOfClip&&c.play())},initTapGoEvents:function(a){var b=c.tapGoManager[a.tapGoType][a.tapGoId];b&&"function"==typeof b.initEvents&&(b.initEvents(),c.tapGoManager.handleDebuggerButtons())},hideTapGo:function(a){var b=c.tapGoManager[a.tapGoType][a.tapGoId];b&&"function"==typeof b.clear&&(c.tapGoManager.clearGroupTimeouts(a.groupId),b.clear()),d.find('*[data-group-id="'+a.groupId+'"]').remove()},roundNum:function(a){return Math.round(1e3*a)/1e3},setElementPosition:function(a){var b,e,f,g=c.tapGoManager.vastItem.buttonsGroups[a.groupId].buttons[a.buttonId];g&&(b=c.tapGoManager.getRescaleRatio(),g=d.find("#"+g.itemId),e=this.roundNum(a.attribs.successX),f=this.roundNum(a.attribs.successY),g.attr({"data-x":e,"data-y":f}),e*=b,f*=b,g.css({top:this.roundNum(f)+"px",left:this.roundNum(e)+"px"}))},preventEventAction:function(a){a.preventDefault&&a.preventDefault(),a.preventManipulation&&a.preventManipulation()},getEventDetails:{touch:function(a){for(var b=[],c=0,d=a.originalEvent.changedTouches,e=d.length;c<e;)b.push({id:d[c].identifier,x:d[c].pageX,y:d[c].pageY,force:d[c].force||.5,upEvent:"touchend"}),c++;return b},pointer:function(a){var b=a.originalEvent;return[{id:b.pointerId,x:b.pageX,y:b.pageY,force:b.force||.5,upEvent:"pointerdown"===a.type?"pointerup":"MSPointerUp"}]},mouse:function(a){return[{id:a.button,x:a.pageX,y:a.pageY,force:a.force||.5,upEvent:"mouseup"}]}},getEventData:function(a){return c.tapGoManager.getEventDetails[c.tapGoManager.supportedEvents](a)},getEventToHandleIt:function(a,b){var c={touch:{down:"touchstart."+b,move:"touchmove."+b,up:"touchend."+b},pointer:{down:"MSPointerDown."+b+" pointerdown."+b,move:"MSPointerMove."+b+" pointermove."+b,up:"MSPointerUp."+b+" pointerup."+b},mouse:{down:"mousedown."+b,move:"mousemove."+b,up:"mouseup."+b}};return c[this.supportedEvents][a]},tapGoCanPlay:function(a){function b(){for(var a=c.tapGoManager.timeElements[0]||null,b=a?a.length:0;b--;)if(a[b].attribs&&a[b].attribs.stopSpot)return!0;return!1}function d(){var d=b();return c.trigger("isTapGoReadyInit"),a(),c.tapGoManager.hasSpot?void(!d&&c.paused&&c.play()):void(c.endOfClip=!0)}c.pause(),c.tapGoManager.isTapGoReady?d():c.one("isTapGoReady",d);
},tapGoAppDeactivated:function(){this.isPaused=!0},tapGoAppActivated:function(){c.tapGoManager.endTapGo&&c.tapGoManager.finishTapGo(),this.isPaused=!1,0===Object.keys(this.stopSpotUsed).length&&this.hasSpot&&!c.endOfClip&&(this.isVideoPlaying=!0,c.play())}}},e=function(){var a=this;a.tapGoManager=new d(a)};videojs.plugin("tapGoManager",e)}(window,document,videojs),function(a,b,c,d){"use strict";var e=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a},f=function(a,b,c){var d,e,f=Object.prototype.toString.call(b),g=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c);else if(a.on)a.on(b,c);else{if(!a.attachEvent)throw new Error("object has no mechanism for adding event listeners");a.attachEvent("on"+b,c)}};switch(f){case"[object String]":g(a,b,c);break;case"[object Array]":for(d=0,e=b.length;d<e;d++)g(a,b[d],c);break;case"[object Object]":for(d in b)b.hasOwnProperty(d)&&g(a,d,b[d]);break;default:throw new Error("Unrecognized events parameter type: "+f)}return a},g=function(b){return(a.setImmediate||a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.setTimeout)(b,0)},h=function(b){return(a.clearImmediate||a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.clearTimeout)(b)},i=function(a){a.ads.cancelPlayTimeout||(a.ads.cancelPlayTimeout=g(function(){a.ads.cancelPlayTimeout=null,a.paused()||a.pause()}))},j=function(a){var b=a.el().querySelector(".vjs-tech"),c={src:a.currentSrc(),currentTime:a.currentTime(),type:a.currentType()};return b&&(c.nativePoster=b.poster),c},k=function(a,b){for(var c=a.className.split(/\s+/),d=c.length,e=[];d--;)c[d]!==b&&e.push(c[d]);a.className=e.join(" ")},l=function(a){var b=a.el().querySelector(".vjs-tech");b&&b.removeAttribute("poster")},m={timeout:5e3,prerollTimeout:100,debug:!1},n=function(b){var c,d=this,n=e({},m,b||{});d.ads={state:"content-set",startLinearAdMode:function(){d.trigger("adstart")},endLinearAdMode:function(){d.trigger("adend")}},c=function(b){var c={"content-set":{events:{adsready:function(){this.state="ads-ready",d.trigger("readyforpreroll")},play:function(){this.state="ads-ready?",i(d),l(d)}}},"ads-ready":{events:{play:function(){this.state="preroll?",i(d)}}},"preroll?":{enter:function(){d.el().className+=" vjs-ad-loading",d.ads.timeout=a.setTimeout(function(){d.trigger("adtimeout")},n.prerollTimeout),d.trigger("readyforpreroll")},leave:function(){a.clearTimeout(d.ads.timeout),h(d.ads.cancelPlayTimeout),d.ads.cancelPlayTimeout=null,k(d.el(),"vjs-ad-loading")},events:{play:function(){i(d)},adstart:function(){this.state="ad-playback",d.el().className+=" vjs-ad-playing"},adtimeout:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){d.el().className+=" vjs-ad-loading",d.ads.timeout=a.setTimeout(function(){d.trigger("adtimeout")},n.timeout)},leave:function(){a.clearTimeout(d.ads.timeout),k(d.el(),"vjs-ad-loading")},events:{play:function(){i(d)},adsready:function(){this.state="preroll?"},adtimeout:function(){this.state="ad-timeout-playback"}}},"ad-timeout-playback":{events:{adsready:function(){d.paused()?this.state="ads-ready":this.state="preroll?"},contentupdate:function(){d.paused()?this.state="content-set":this.state="ads-ready?"}}},"ad-playback":{enter:function(){this.snapshot=j(d),l(d)},leave:function(){k(d.el(),"vjs-ad-playing")},events:{adend:function(){this.state="content-playback"}}},"content-playback":{events:{adstart:function(){this.state="ad-playback",d.el().className+=" vjs-ad-playing",l(d)},contentupdate:function(){d.paused()?this.state="content-set":this.state="ads-ready?"}}}};!function(a){var e=function(){};(c[a].events[b.type]||e).apply(d.ads),a!==d.ads.state&&((c[a].leave||e).apply(d.ads),(c[d.ads.state].enter||e).apply(d.ads),n.debug&&videojs.log("ads",a+" -> "+d.ads.state))}(d.ads.state)},f(d,["adtimeout","contentupdate","adsready","adstart","adend"],c),d.ads.contentSrc=d.currentSrc(),function(){var a=function(){var a;"ad-playback"!==d.ads.state&&(a=d.currentSrc(),a!==d.ads.contentSrc&&(d.trigger({type:"contentupdate",oldValue:d.ads.contentSrc,newValue:a}),d.ads.contentSrc=a,d.isIma||!d.previousAdWasIma||d.paused()||$(d.el()).find(".vjs-big-play-button").removeClass("vjs-visible")))};d.on("loadstart",a),g(a)}(),d.paused()||c({type:"play"})};c.plugin("ads",n)}(window,document,videojs),function(a){"use strict";var b=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a},c={debug:!1,timeout:5e3,prerollTimeout:100},d=function(a,b){for(var c=a.className.split(/\s+/),d=c.length,e=[];d--;)c[d]!==b&&e.push(c[d]);a.className=e.join(" ")},e=function(a,e){var f=this,g=$(this.el());f.ima.createAdContainer_=function(){l=f.getChild("controlBar"),m=l.el().parentNode.insertBefore(document.createElement("div"),l.el()),m.className="ima-ad-container",m.style.width=f.width()+"px",m.style.height=f.height()+"px",m.style.display="none",f.ima.createControls_(),u=new google.ima.AdDisplayContainer(m,i)},f.ima.createControls_=function(){n=document.createElement("div"),n.className="ima-controls-div",n.style.width="100%",o=document.createElement("div"),o.className="ima-countdown-div",o.innerHTML="Reklama",o.style.display=j?"block":"none",p=document.createElement("div"),p.className="ima-seek-bar-div",p.style.width="100%",q=document.createElement("div"),q.className="ima-progress-div",r=document.createElement("div"),r.className="ima-play-pause-div",r.className+=" ima-playing",r.addEventListener("click",f.ima.onAdPlayPauseClick_,!1),s=document.createElement("div"),s.className="ima-mute-div",s.className+=" ima-non-muted",s.addEventListener("click",f.ima.onAdMuteClick_,!1),t=document.createElement("div"),t.className="ima-fullscreen-div",t.className+=" ima-non-fullscreen",t.addEventListener("click",f.ima.onAdFullscreenClick_,!1),m.insertBefore(n,"undefined"!=typeof m.childNodes[m.childNodes.length]?m.childNodes[m.childNodes.length]:null),n.insertBefore(o,"undefined"!=typeof n.childNodes[n.childNodes.length]?n.childNodes[n.childNodes.length]:null),n.insertBefore(p,"undefined"!=typeof n.childNodes[n.childNodes.length]?n.childNodes[n.childNodes.length]:null),n.insertBefore(r,"undefined"!=typeof n.childNodes[n.childNodes.length]?n.childNodes[n.childNodes.length]:null),n.insertBefore(s,"undefined"!=typeof n.childNodes[n.childNodes.length]?n.childNodes[n.childNodes.length]:null),n.insertBefore(t,"undefined"!=typeof n.childNodes[n.childNodes.length]?n.childNodes[n.childNodes.length]:null),p.insertBefore(q,"undefined"!=typeof p.childNodes[n.childNodes.length]?p.childNodes[n.childNodes.length]:null)},f.ima.initializeAdDisplayContainer=function(){E=!0,u.initialize()},f.ima.requestAds=function(a){a=a||h.adTagUrl,E||u.initialize();var b=new google.ima.AdsRequest;b.adTagUrl=a,b.linearAdSlotWidth=f.width(),b.linearAdSlotHeight=f.height(),b.nonLinearAdSlotWidth=h.nonLinearWidth||f.width(),b.nonLinearAdSlotHeight=h.nonLinearHeight||f.height()/3,v.requestAds(b,f.currentImaAdData)},f.ima.onAdsManagerLoaded_=function(a){if(w=a.getAdsManager(O,F),x=a.getUserRequestContext(),w.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,f.ima.onAdError_),w.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,f.ima.onAdBreakReady_),w.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,f.ima.onContentPauseRequested_),w.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,f.ima.onContentResumeRequested_),f.currentImaAdData.passbackHandled||x.AdId!==f.currentImaAdData.AdId?window.console&&window.console.warn&&console.warn("IMA SDK: requested ad has loaded but other ad is playing."):w.addEventListener(google.ima.AdEvent.Type.LOADED,f.ima.onAdLoaded_),w.addEventListener(google.ima.AdEvent.Type.STARTED,f.ima.onAdStarted_),w.addEventListener(google.ima.AdEvent.Type.PAUSED,f.ima.onAdPaused_),w.addEventListener(google.ima.AdEvent.Type.RESUMED,f.ima.onAdResumed_),w.addEventListener(google.ima.AdEvent.Type.CLICK,f.ima.onAdPlayPauseClick_),w.addEventListener(google.ima.AdEvent.Type.COMPLETE,f.ima.onAdComplete_),w.addEventListener(google.ima.AdEvent.Type.SKIPPED,f.ima.onAdComplete_),!k)try{w.init(f.width(),f.height(),google.ima.ViewMode.NORMAL);var b=f.muted()?0:f.volume();w.setVolume(b),0===b&&(I=!0,d(s,"ima-non-muted"),s.className+=" ima-muted")}catch(c){f.ima.onAdError_(c)}f.trigger("adsready")},f.ima.start=function(){if(w&&!f.forcedImaError)try{w.init(f.width(),f.height(),google.ima.ViewMode.NORMAL);var a=f.muted()?0:f.volume();w.setVolume(a),0===a&&(I=!0,d(s,"ima-non-muted"),s.className+=" ima-muted"),w.start()}catch(b){f.ima.onAdError_(b)}else PLAYER_DEBUG&&console.error("No adsManager object.")},f.ima.startFromReadyCallback=function(){if(w&&!f.forcedImaError&&k)try{w.init(f.width(),f.height(),google.ima.ViewMode.NORMAL);var a=f.muted()?0:f.volume();w.setVolume(a),0===a&&(I=!0,d(s,"ima-non-muted"),s.className+=" ima-muted"),w.start()}catch(b){f.ima.onAdError_(b)}else PLAYER_DEBUG&&console.error("No adsManager object, or autoPlayAdBreaks is false")},f.ima.onAdsLoaderError_=function(a){w&&w.destroy(),m.style.display="none",f.trigger("adserror")},f.ima.onAdError_=function(a){if("object"==typeof a&&"function"==typeof a.getError&&window.console&&window.console.warn){var b="IMA ad error",c=[b,a.getError()];"function"==typeof a.getUserRequestContext&&(c[0]+=" with context ad: ",c.push(a.getUserRequestContext())),console.warn.apply(console.warn,c)}w.destroy(),m.style.display="none",f.trigger("adserror")},f.ima.onAdBreakReady_=function(a){C(a)},f.ima.playAdBreak=function(){k||w.start()},f.ima.onContentPauseRequested_=function(a){G=!0,H=!0,f.off("ended",Q),a.getAd().getAdPodInfo().getPodIndex()!=-1&&f.ads.startLinearAdMode(),g.addClass("vjs-ima-active"),m.style.display="block",n.style.display="block",l.hide()},f.ima.onContentResumeRequested_=function(a){G=!1,H=!1,f.on("ended",Q),m.style.display="none",g.removeClass("vjs-ima-active"),l.show(),y&&(J||y.getAdPodInfo().getPodIndex()==-1)?f.ads.endLinearAdMode():f.ads.endLinearAdMode(),o.innerHTML=""},f.ima.onAdLoaded_=function(a){return y=a.getAd(),N=y.getDuration(),f.currentImaAdData.Passback.maxDurationTime&&y.getDuration()>f.currentImaAdData.Passback.maxDurationTime?(w.destroy(),m.style.display="none",f.currentImaAdData.Passback.fireTimeError=!0,void f.trigger("adserror")):(f.forcedImaError?window.console&&window.console.warn&&window.console.warn("IMA SDK: ad has been loaded but does not meet TVN requirements."):(f.trigger("loadedImaAd"),f.currentAdTime=y.getDuration(),f.currentImaAdData&&(f.currentImaAdData.Duration=toHHMMSS(y.getDuration())),f.videoAdsHandler.recalculateTotalTimeOfCurrentGroup(),f.remainingWrap.html(f.videoAdsHandler.getRemainingTime(Math.ceil(M))),f.remainingWrap.parent()&&f.remainingWrap.parent().show(),f.ima.playAdBreak()),void(y.isLinear()||f.play()))},f.ima.onAdStarted_=function(a){f.isUserGestureNeededToCallAdvert()||f.endReached||f.currentTime(0),f.videoAdsHandler.recalculateTotalTimeOfCurrentGroup(),y.isLinear()?z=setInterval(f.ima.onAdPlayheadTrackerInterval_,250):m.className="bumpable-ima-ad-container"},f.ima.onAdComplete_=function(a){y.isLinear()&&(clearInterval(z),Q())},f.ima.onAdPaused_=function(a){d(r,"ima-playing"),r.className+=" ima-paused",f.isUserGestureNeededToCallAdvert()||f.pause()},f.ima.onAdResumed_=function(a){d(r,"ima-paused"),r.className+=" ima-playing",f.isUserGestureNeededToCallAdvert()||f.play()},f.ima.onAdPlayheadTrackerInterval_=function(){var a=w.getRemainingTime();N=y.getDuration(),M=N-a,M=M>0?M:0;try{f.trigger("timeupdate")}catch(b){}var c=M/N,d=100*c;q.style.width=d+"%"},f.ima.hideAdControls_=function(){r.style.display="none",s.style.display="none",t.style.display="none",n.style.height="14px"},f.ima.showAdControls_=function(){n.style.height="37px",r.style.display="block",s.style.display="block",t.style.display="block"},f.ima.onAdPlayPauseClick_=function(){H?(d(r,"ima-playing"),r.className+=" ima-paused",w.pause(),H=!1):(d(r,"ima-paused"),r.className+=" ima-playing",w.resume(),H=!0)},f.ima.onAdMuteClick_=function(){I?(d(s,"ima-muted"),s.className+=" ima-non-muted",w.setVolume(1),f.muted(!1),0===f.volume()&&f.volume(.5),I=!1):(d(s,"ima-non-muted"),s.className+=" ima-muted",w.setVolume(0),f.muted(!0),I=!0)},f.ima.onAdFullscreenClick_=function(){f.isFullscreen()?f.exitFullscreen():f.requestFullscreen()},f.ima.onFullscreenChange_=function(){f.isFullscreen()?(d(t,"ima-non-fullscreen"),t.className+=" ima-fullscreen",m.style.width=window.screen.width+"px",m.style.height=window.screen.height+"px",w&&w.resize(window.screen.width,window.screen.height,google.ima.ViewMode.FULLSCREEN)):(d(t,"ima-fullscreen"),t.className+=" ima-non-fullscreen",m.style.width=f.width()+"px",m.style.height=f.height()+"px",w&&w.resize(f.width(),f.height(),google.ima.ViewMode.NORMAL))},f.ima.onVolumeChange_=function(){var a=f.muted()?0:f.volume();w&&w.setVolume(a)},f.ima.seekContentToZero_=function(){f.off("loadedmetadata",f.ima.seekContentToZero_),f.currentTime(0)},f.ima.playContentFromZero_=function(){f.off("loadedmetadata",f.ima.playContentFromZero_),f.currentTime(0),f.play()},f.ima.resetIMA_=function(){w&&w.destroy(),v&&v.contentComplete(),J=!1},f.ima.addEventListener=function(a,b){w&&w.addEventListener(a,b)},f.ima.getAdsManager=function(){return w},f.ima.currentTime=function(a){return"undefined"!=typeof a&&console.warn("IMA SDK: during playing IMA ad setting position is not implemented."),M},f.ima.duration=function(a){return"undefined"!=typeof a&&console.warn("IMA SDK: during playing IMA ad duration setting is not implemented."),a},f.ima.setContent=function(a,b,c){f.ima.resetIMA_(),h.adTagUrl=b?b:h.adTagUrl,f.currentSrc(),a&&f.src(a)},f.ima.addContentEndedListener=function(a){P.push(a)},f.ima.setAdBreakReadyListener=function(a){C=a},f.ima.pauseAd=function(){G&&H&&M>.5&&(w.pause(),H=!1)},f.ima.resumeAd=function(){G&&!H&&M>.5&&(w.resume(),H=!0)},f.ima.setUpPlayerIntervals_=function(){A=setInterval(f.ima.updateCurrentTime,K),B=setInterval(f.ima.checkForSeeking,K)},f.ima.updateCurrentTime=function(){O.seeking||(O.currentTime=f.currentTime())},f.ima.checkForSeeking=function(){var a=f.currentTime(),b=1e3*(a-O.previousTime);Math.abs(b)>K+L?O.seeking=!0:O.seeking=!1,O.previousTime=f.currentTime()},f.ima.setShowCountdown=function(a){j=a,o.style.display=j?"block":"none"};var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D="0.2.0",E=!1,F=null,G=!1,H=!1,I=!1,J=!1,K=1e3,L=100,M=0,N=0,O={currentTime:0,previousTime:0,seeking:!1,duration:0},P=[],Q=function(){v&&!J&&(v.contentComplete(),J=!0);for(var a in P)P[a]();A&&clearInterval(A),B&&clearInterval(B)};if(h=b({},c,a||{}),!h.id)return void window.console.log("Error: must provide id of video.js div");i=document.getElementById(h.id+"_html5_api"),j=!0,h.showCountdown===!1&&(j=!1),k=!0,h.autoPlayAdBreaks===!1&&(k=!1),f.on("ended",Q),f.on("adserror",Q);var R={debug:h.debug,timeout:h.timeout,prerollTimeout:h.prerollTimeout},S=b({},R,a.contribAdsSettings||{});if("function"==typeof f.ads&&f.ads(S),F=new google.ima.AdsRenderingSettings,F.restoreCustomPlaybackStateOnAdBreakComplete=!0,f.isUserGestureNeededToCallAdvert()||(F.useVideoAdUi=!1),h.adsRenderingSettings)for(var T in h.adsRenderingSettings)F[T]=h.adsRenderingSettings[T];h.locale&&google.ima.settings.setLocale(h.locale),f.ima.createAdContainer_(),v=new google.ima.AdsLoader(u),v.getSettings().setVpaidAllowed(!0),h.vpaidAllowed===!1&&v.getSettings().setVpaidAllowed(!1),v.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),h.vpaidAllowed===!1&&v.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED),h.vpaidMode&&v.getSettings().setVpaidMode(h.vpaidMode),h.locale&&v.getSettings().setLocale(h.locale),v.getSettings().setPlayerType("videojs-ima"),v.getSettings().setPlayerVersion(D),v.getSettings().setAutoPlayAdBreaks(k),v.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,f.ima.onAdsManagerLoaded_,!1),v.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,f.ima.onAdsLoaderError_,!1),e||(e=f.ima.startFromReadyCallback),f.on("readyforpreroll",e),f.on("fullscreenchange2",f.ima.onFullscreenChange_),f.on("volumechange",f.ima.onVolumeChange_)};a.plugin("ima",e)}(window.videojs),function(a,b,c){"use strict";var d=function(a){var d,e=a.el(),f=9e4;return a.options().activeMovie?d=a.options().activeMovie:a.options().movieInfo&&(d=JSON.parse(a.options().movieInfo),f=200),{activated:!1,timeout:!1,content:!1,movie:!1,init:function(){var b=this;a.on("useractive",function(){b.stopTimeout()}),a.on("userinactive",function(){b.startTimeout()}),e.appendChild(this.buildBoard())},activate:function(){this.activated=!0},deactivate:function(){this.activated=!1,this.hideBoard()},startTimeout:function(){this.activated&&!a.endReached&&(this.timeout=setTimeout(this.showBoard,f))},stopTimeout:function(){clearTimeout(this.timeout),this.hideBoard()},buildBoard:function(){var a=b.createElement("div"),c=b.createElement("div");return a.className="vjs-sleep-mode-wrapper",c.className="vjs-sleep-mode-inner",c.innerHTML=this.getContent(),a.appendChild(c),a},getContent:function(){var a="",b="",c="",e="",f="",g="";if("undefined"!=typeof d){g='<div class="vjs-sleep-mode-label">Właśnie oglądasz</div>';var h="undefined"!=typeof d.episode&&"0"!==d.episode?"Odcinek "+d.episode:"",i="undefined"!=typeof d.season&&0!==d.season?", Sezon "+d.season:"";"undefined"!=typeof d.episode_name&&d.episode_name.length>1&&(c='<span class="vjs-sleep-mode-subtitle">'+d.episode_name+"</span>"),"undefined"!=typeof d.title&&d.title.length>1&&(b='<div class="vjs-sleep-mode-title">'+d.title+c+"</div>"),(h.length>1||i.length>1)&&(e='<div class="vjs-sleep-mode-season">'+h+i+"</div>"),"undefined"!=typeof d.description&&d.description.length>1&&(f='<div class="vjs-sleep-mode-description">'+d.description+"</div>"),a=g+b+e+f}return a},showBoard:function(){c.addClass(e,"vjs-sleep-mode")},hideBoard:function(){c.removeClass(e,"vjs-sleep-mode")}}},e=function(a){if(a){var b=this;b.sleepMode=new d(b),b.sleepMode.init()}};c.plugin("sleepModePlugin",e)}(window,document,videojs),function(a,b,c){"use strict";var d=function(a){function b(a){var b=new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)?(/(.)*)?(\\?(.)*)?");return null!==b.exec(a)}var c=a.node;return{langData:null,isInitialized:!1,prepareButtons:function(){if("undefined"!=typeof a.controlBar.multiAudioButton){for(var b,d,e,f,g,h=this,i=0;i<h.langData.length;i++)b=h.langData[i],d="undefined"!=typeof b.url&&null!==b.url&&b.url,e="undefined"!=typeof b.label&&null!==b.label&&b.label,f="undefined"!=typeof b["default"]&&null!==b["default"]&&b["default"],d&&e&&(g=c.find('.vjs-multiaudio-button .vjs-menu-item[data-track="'+(i+1)+'"]'),g.attr("data-label",b.label).attr("data-lang",b.lang).attr("src",b.url).html(b.label).removeClass("vjs-hidden"),f&&g.addClass("vjs-selected"));c.find('.vjs-multiaudio-button .vjs-menu-item[data-lang!=""]').length>0&&(c.find(".vjs-multiaudio-button .vjs-menu-item").on("click",function(){var b=$(this),d=b.attr("src"),e=b.attr("data-lang");c.find(".vjs-multiaudio-button .vjs-menu-item").removeClass("vjs-selected"),a.multiAudio.changeLang(d,e),b.addClass("vjs-selected"),a.debug("[MultiAudio] changeLang",e,d)}),a.debug("[MultiAudio] show Button"),a.controlBar.multiAudioButton.show())}},playCurrentLang:function(){var b=c.find(".vjs-multiaudio-button .vjs-menu-content .vjs-selected").attr("data-lang"),d=this;a.debug("[MultiAudio] playCurrentLang");for(var e=0;e<d.langData.length;e++)d.langData[e].lang==b&&d.changeLang(d.langData[e].url)},init:function(){var d=c.attr("data-multiaudio");if(!this.isInitialized&&d){if(b(d)){var e=this;$.ajax({url:d,dataType:"json",async:!1,success:function(a){e.langData=a}})}else try{this.langData=JSON.parse(d)}catch(f){return}null!==this.langData&&(a.debug("[MultiAudio] langData",this.langData),this.prepareButtons(),this.isInitialized=!0)}},changeLang:function(b,c){var d=a.currentTime();a.debug("[MultiAudio] changeLang"),"undefined"!=typeof b&&(a.src(b),a.currentTime(d))},show:function(){a.multiAudio.isInitialized&&(a.debug("[MultiAudio] show"),c.find(".vjs-multiaudio-button.vjs-control").show(),this.playCurrentLang())},hide:function(){a.debug("[MultiAudio] hide"),c.find(".vjs-multiaudio-button.vjs-control").hide()}}},e=function(){var a=this;a.multiAudio=new d(a),a.multiAudio.init()};c.plugin("multiAudio",e)}(window,document,videojs),function(a,b,c){"use strict";var d=function(a){var d=a.el();return{label:{multiAudio:"Lektor",quality:"Jakość",qualityMp4:"Jakość",subtitles:"Napisy"},buttons:{multiAudio:!1,quality:!1,qualityMp4:!1,subtitles:!1},init:function(){this.buildWrapper().bindEvents()},buildWrapper:function(){return this.wrapper=b.createElement("div"),this.wrapper.className="vjs-settings-wrapper vjs-hidden",this.wrapperInner=b.createElement("div"),this.wrapperInner.className="vjs-settings-wrapper-inner",this.closeBtn=b.createElement("div"),this.closeBtn.className="vjs-settings-close",this.wrapper.appendChild(this.closeBtn),this.wrapper.appendChild(this.wrapperInner),d.appendChild(this.wrapper),this},bindEvents:function(){var b=this;this.closeBtn.addEventListener("click",function(){b.hide()}),a.on("qualityButtonsCreated",function(){b.prepareQualityButtons()})},show:function(){c.removeClass.call(this,this.wrapper,"vjs-hidden"),c.addClass(d,"vjs-settings-opened"),this.showMainView()},hide:function(){c.addClass.call(this,this.wrapper,"vjs-hidden"),c.removeClass(d,"vjs-settings-opened")},isVisible:function(){return!c.hasClass(this.wrapper,"vjs-hidden")},toggleVisibility:function(){this.isVisible()?this.hide():this.show()},createItem:function(a,c){var d=b.createElement("div"),e=b.createElement("span");d.className="vjs-settings-item",d.isMainItem=c||!1,c?d.className+=" vjs-settings-main-item":d.className+=" vjs-settings-value-item";for(var f in a)d[f]=a[f];return a.selected===!0&&(d.className+=" vjs-settings-item-active"),d.type=a.type,e.innerHTML=a.label,d.appendChild(e),d},createRow:function(){var a=b.createElement("div");return a.className="vjs-settings-row",a},buildMainViewTemplate:function(){var a=b.createElement("div"),c=b.createElement("div");return a.className="vjs-settings-wrapper-inner vjs-settings-main-view",c.className="vjs-settings-main-pane",a.appendChild(c),a},buildDetailViewTemplate:function(){var a=b.createElement("div"),c=b.createElement("div"),d=b.createElement("div");return a.className="vjs-settings-wrapper-inner vjs-settings-detail-view",c.className="vjs-settings-left-pane",d.className="vjs-settings-right-pane",a.appendChild(c),a.appendChild(d),a},showMainView:function(){var b=this.buildMainViewTemplate(),c=b.getElementsByClassName("vjs-settings-main-pane")[0];this.buttons.quality&&c.appendChild(this.buildRowForType("quality")),a.textTracks_.length&&(this.buttons.subtitles===!1&&this.prepareSubtitlesButtons(),c.appendChild(this.buildRowForType("subtitles"))),this.getResolutionsButton()&&(this.buttons.qualityMp4===!1&&this.prepareQualityMp4Buttons(),c.appendChild(this.buildRowForType("qualityMp4"))),null!==a.multiAudio.langData&&(this.buttons.multiAudio===!1&&this.prepareMultiAudioButtons(),c.appendChild(this.buildRowForType("multiAudio"))),b.appendChild(c),this.bindMainScreenEvents(b),this.wrapperInner.innerHTML="",this.wrapperInner.appendChild(b)},buildRowForType:function(a){var b=this.createRow();return b.appendChild(this.createItem({label:this.label[a],type:a},!0)),b.appendChild(this.createItem({label:this.getCurrentLabelFor(a),type:a},!1)),b},getResolutionsButton:function(){var b=a.controlBar.children_;return!!c.hasClass(b[b.length-1],"vjs-resolutions-button")&&b[b.length-1]},prepareMultiAudioButtons:function(){this.buttons.multiAudio=[];var b=function(){a.multiAudio.changeLang(this.url)};if(null!==a.multiAudio.langData&&a.multiAudio.langData.length>1){for(var c in a.multiAudio.langData)a.multiAudio.langData[c]["default"]===!0&&(a.multiAudio.langData[c].selected=!0),a.multiAudio.langData[c].type="multiAudio",a.multiAudio.langData[c].onClickFn=b.bind(a.multiAudio.langData[c]),this.buttons.multiAudio.push(this.createItem(a.multiAudio.langData[c],!1));this.bindButtonsEvents(this.buttons.multiAudio)}},bindMainScreenEvents:function(a){for(var b=this,c=a.getElementsByClassName("vjs-settings-item"),d=function(){this.isMainItem===!1&&b.showDetailView(this.type)},e=0;e<c.length;e++)c[e].addEventListener("click",d.bind(c[e]))},showDetailView:function(a){var b=this.buildDetailViewTemplate(),c=b.getElementsByClassName("vjs-settings-left-pane")[0],d=b.getElementsByClassName("vjs-settings-right-pane")[0];c.appendChild(this.createItem({label:this.label[a],type:a},!0));for(var e in this.buttons[a])d.appendChild(this.buttons[a][e]);this.wrapperInner.innerHTML="",this.wrapperInner.appendChild(b)},prepareQualityButtons:function(){this.buttons.quality=[];var b=a.dashManager.QS,c=["low","medium","high"],d={},e=function(){a.dashManager.QS.selectQuality(this.quality)};d.type="quality",d.bitrate="auto",d.quality="auto",d.label=this.getLabelForQuality(d.bitrate),d.selected=!0,d.onClickFn=e.bind(d),this.buttons.quality.push(this.createItem(d,!1));for(var f in c)if("undefined"!=typeof b.bitrates[c[f]]){var g={};g.type="quality",g.selected=!1,g.quality=c[f],g.bitrate=b.bitrates[c[f]],g.label=this.getLabelForQuality(g.quality),g.onClickFn=e.bind(g),this.buttons.quality.push(this.createItem(g,!1))}this.bindButtonsEvents(this.buttons.quality)},bindButtonsEvents:function(a){for(var b=this,d=function(d){if(this.isMainItem!==!0&&"SPAN"===d.target.nodeName){this.onClickFn();for(var e=0;e<a.length;e++)a[e].selected=!1,c.removeClass(a[e],"vjs-settings-item-active");this.selected=!0,c.addClass(this,"vjs-settings-item-active"),b.hide()}},e=0;e<a.length;e++)a[e].addEventListener("click",d.bind(a[e]))},getLabelForQuality:function(a){var b="Auto";return"low"===a?b="Niska":"medium"===a?b="Średnia":"high"===a&&(b="Wysoka"),b},getCurrentItemFor:function(a){var b=[];this.buttons[a]!==!1&&(b=this.buttons[a]);for(var c=0;c<b.length;c++)if(b[c].selected===!0)return b[c];return!1},getCurrentLabelFor:function(a){var b=this.getCurrentItemFor(a);return b||(b={},"quality"==a&&(b.label="Auto"),"multiAudio"==a&&(b.label="Wył"),"subtitles"==a&&(b.label="Wył")),b.label},prepareSubtitlesButtons:function(){this.buttons.subtitles=[];for(var b=a.controlBar.getNestedChild("captionsButton"),d=b.items,e=function(){this.originalNode.trigger("click")},f=0;f<d.length;f++){var g={};g.type="subtitles",g.label=d[f].track.label,g.selected=!1,c.hasClass(d[f].el_,"vjs-selected")&&(g.selected=!0),g.originalNode=d[f],g.onClickFn=e.bind(g),c.hasClass(d[f].el_,"vjs-texttrack-settings")||this.buttons.subtitles.push(this.createItem(g,!1))}this.bindButtonsEvents(this.buttons.subtitles)},prepareQualityMp4Buttons:function(){this.buttons.qualityMp4=[];var a=this.getResolutionsButton(),b=function(){this.originalNode.trigger("click")};if(a){for(var d=a.items,e=0;e<d.length;e++){var f={};f.type="qualityMp4",f.label=d[e].options_.label,f.selected=!1,c.hasClass(d[e].el_,"vjs-selected")&&(f.selected=!0),f.originalNode=d[e],f.onClickFn=b.bind(f),this.buttons.qualityMp4.push(this.createItem(f,!1))}this.bindButtonsEvents(this.buttons.qualityMp4)}}}},e=function(a){var b=this;a&&(b.settingsController=new d(b),b.settingsController.init())};c.plugin("settingsController",e)}(window,document,videojs);var hawkEyePlugin=function(){var a=this;a.hawkEye={},a.hawkEye.used=!1;var b={};a.hawkEye.setUsed=function(){a.hawkEye.used=!0},a.hawkEye.isUsed=function(){return!!a.hawkEye.used},a.hawkEye.prepareHawkUrl=function(c){if(a.hawkEye.isHawkVast(c.urlToRedirect)&&a.hawkEye.objectExist()&&tvnHawkEye.hasActiveAsiPlacements()){var d=tvnHawkEye.getAsiPlacements(),e=tvnHawkEye.getAsiAdserver(),f=a.hawkEye.prepareHawkVastUrl(c.urlToRedirect,d[b[c.type]],b[c.type],e);return f}return!1},a.hawkEye.isHawkVast=function(a){return a.indexOf("_ASIKEY_")!==-1||a.indexOf("_ASIBLOB_")!==-1||a.indexOf("_ASIADSERVER_")!==-1||a.indexOf("_ASIASPQ_")!==-1},a.hawkEye.prepareHawkVastUrl=function(b,c,d,e){if(a.hawkEye.isHawkVast(b)&&"undefined"!=typeof c["default"])return b.replace("_ASIKEY_",c["default"].key).replace("_ASIBLOB_",c.blob).replace("_ASIADSERVER_",e).replace("_ASIASPQ_","PQ_"+d+"="+Object.keys(c.data).toString())},a.hawkEye.objectExist=function(){return"undefined"!=typeof tvnHawkEye},a.hawkEye.reset=function(){a.hawkEye.objectExist()&&tvnHawkEye.reset()},a.hawkEye.objectExist()&&(b={Preroll:tvnHawkEye.videoKeys.PreRoll,Midroll_1:tvnHawkEye.videoKeys.MidRoll1,Midroll_2:tvnHawkEye.videoKeys.MidRoll2,Midroll_3:tvnHawkEye.videoKeys.MidRoll3})};videojs.plugin("hawkEye",hawkEyePlugin),VideoAdsHandler.prototype.addGroup=function(a,b){var c,d,e,f,g,h=this;if(c=h.getAdGroupIndex(a),f=0===a?"pre-roll":"end"===a?"post-roll":"mid-roll",g=b.type,h.getAdGroupIndex(a)===!1&&(d={timeStart:a,totalDuration:0,active:!0,type:f,typeName:g,items:[],failedIMAads:[]},isDefined(b.breakNumber)&&(d.breakNumber=b.breakNumber+1),h.player.newAdStock.push(d),c=h.getAdGroupIndex(a)),c!==!1){e=h.getSimpleAdObj(b);var i=makeSeconds(b.Duration);if("undefined"!=typeof b.Sequential&&("undefined"!=typeof b.Sequential.attribs.skipMainVideo&&"true"==b.Sequential.attribs.skipMainVideo&&(i=0,b.Duration="00:00:00"),"undefined"!=typeof b.Sequential.attribs.boardPause&&(b.Sequential.attribs.boardPauseForTotalDuration=2*parseInt(b.Sequential.attribs.boardPause,10),i+=b.Sequential.attribs.boardPauseForTotalDuration),"undefined"!=typeof b.Sequential.elements)){for(var j=0,k=b.Sequential.elements,l=0;k.length>l;l++){var m=makeSeconds(k[l].Duration);j=m>j?m:j}i+=j,b.Sequential.additionalDuration=j}h.player.newAdStock[c].totalDuration+=i,h.player.newAdStock[c].items.push(e)}},VideoAdsHandler.prototype.onFailedCurrentIMAad=function(a){var b,c,d=this.player.getCurrentAd(),e=this.getFirstActiveGroupIndex(),f=this.getFirstActiveItemIndex(),g=this,h=[f,1];d&&d.fullObj.isIMA&&(d.active=!1,"object"==typeof a&&a&&(b=g.getSimpleAdObj(a),b&&(b.isPassback=!0)),b&&h.push(b),c=g.player.newAdStock[e].items.splice.apply(g.player.newAdStock[e].items,h),g.player.newAdStock[e].failedIMAads.push.apply(g.player.newAdStock[e].failedIMAads,c),g.recalculateTotalTimeOfCurrentGroup())},VideoAdsHandler.prototype.getAdGroupIndex=function(a){for(var b=this.player.newAdStock,c=b.length;c--;)if(b[c].timeStart===a)return c;return!1},VideoAdsHandler.prototype.getAdGroupIndexByType=function(a){for(var b=this.player.newAdStock,c=b.length;c--;)if(b[c].type===a||b[c].typeName===a)return c;return!1},VideoAdsHandler.prototype.getFirstActiveGroupIndex=function(){var a=this.player.newAdStock,b=a.length;if(b)for(var c=0;c<b;c++)if(a[c].active===!0)return c;return!1},VideoAdsHandler.prototype.getFirstActiveItemIndex=function(){var a=this.player.newAdStock[this.player.currentAdGroupIndex].items,b=a.length;if(b)for(var c=0;c<b;c++)if(a[c].active===!0)return c;return!1},VideoAdsHandler.prototype.getRemainingTime=function(a){function b(a){return k[a].external?0:"undefined"==typeof k[a].fullObj.TapGo||a!==j.currentAdItemIndex?makeSeconds(k[a].fullObj.Duration):makeSeconds(k[a].fullObj.TapGo.attribs.duration)+k[a].tapGoTime}var c,d,e,f,g,h,i,j=this.player,k=j.getCurrentAdGroup();if(k){for(c=k.totalDuration,i=k.items[j.currentAdItemIndex],g=j.newAdStock.joinedBlocksToPlay.length;g--;)h=j.newAdStock.joinedBlocksToPlay[g],j.newAdStock[h]&&j.newAdStock[h].active&&h!==j.currentAdGroupIndex&&(c+=j.newAdStock[h].totalDuration);if(d=a?parseInt(a,10):parseInt(j.currentTime(),10),i&&i.fullObj.InfoIcon&&1e3*(a?a:j.currentTime())>=makeMilliSeconds(i.fullObj.InfoIcon.attribs.showTime)&&j.video360ad&&j.video360ad.infoIcoHandler(i,!0),f=0,c){for(e=0,k=k.items,g=j.currentAdItemIndex,e+=b(g);g--;)e+=b(g);f=c-e-d+j.currentAdTime,f<0&&(f=0)}return secondsToHms(f)+" "}return!1},VideoAdsHandler.prototype.setJoinedBlocksByGroupType=function(a){a=a||"Preroll";var b=this.player,c=b.newAdStock,d=a.split(" ");c.joinedBlocksToPlay=[],c=c.joinedBlocksToPlay;for(var e in d)c.push(b.videoAdsHandler.getAdGroupIndexByType(d[e]));
},VideoAdsHandler.prototype.checkForJoinedBlocks=function(a){var b,c=this.player,d=c.newAdStock;d.joinedBlocksToPlay=[];for(var e in d)b=parseInt(e,10),!isNaN(b)&&d[b].timeStart<a&&d[b].active===!0&&b!==c.currentAdGroupIndex&&d.joinedBlocksToPlay.push(b)},VideoAdsHandler.prototype.setJoinedBlocksAll=function(){var a=this.player.newAdStock,b=a.length;a.joinedBlocksToPlay=[];for(var c=0;c<b;c++)a.joinedBlocksToPlay.push(c)},VideoAdsHandler.prototype.checkIsActiveJoinedBlocks=function(){for(var a=this.player.newAdStock,b=a.joinedBlocksToPlay.length;b--;)if(a[a.joinedBlocksToPlay[b]].active)return!0;return!1},VideoAdsHandler.prototype.getFirstActiveJoinedBlocks=function(){for(var a=this.player.newAdStock,b=a.joinedBlocksToPlay.length,c=0;c<b;c++)if(a[a.joinedBlocksToPlay[c]].active)return a.joinedBlocksToPlay[c];return!1},VideoAdsHandler.prototype.getJoinedBlocks=function(){return this.player.newAdStock.joinedBlocksToPlay},VideoAdsHandler.prototype.handleTracking=function(){var a=this.player,b=a.currentTime()/a.duration()*100;b>=25&&b<50&&"undefined"==typeof a.trackingFlags.firstQuartile?(a.trackingFlags.firstQuartile=!0,a.trigger("tracking.firstQuartile")):b>=50&&b<74&&"undefined"==typeof a.trackingFlags.midpoint?(a.trackingFlags.midpoint=!0,a.trigger("tracking.midpoint")):b>=75&&b<100&&"undefined"==typeof a.trackingFlags.thirdQuartile&&(a.trackingFlags.thirdQuartile=!0,a.trigger("tracking.thirdQuartile"))},VideoAdsHandler.prototype.recalculateTotalTimeOfCurrentGroup=function(){var a,b,c=this.player.newAdStock[this.player.currentAdGroupIndex];if(c)for(c.totalDuration=0,a=c.items.length;a--;)b=c.items[a].fullObj,"undefined"!=typeof b.Sequential&&("undefined"!=typeof b.Sequential.attribs.boardPause&&(c.totalDuration+=parseInt(b.Sequential.attribs.boardPauseForTotalDuration,10)),c.totalDuration+=parseInt(b.Sequential.additionalDuration,10)),c.totalDuration+=makeSeconds(b.Duration,10)},VideoAdsHandler.prototype.buildAdInfoBlock=function(a){var b=this,c=b.player,d=b.video_wrapper,e=d,f="",g=b.getAdLegal(),h=b.getAdLegalSuffix();d.find(".vjs-control-bar-wrapper").length&&(e=d.find(".vjs-control-bar-wrapper")),"undefined"!=typeof a.ads&&"undefined"!=typeof a.ads.skipAd&&a.ads.skipAd.enabled&&(f=' <a href="#" class="vjs-skipAd-button">Pomiń (za '+a.ads.skipAd.timeOut+" sekund)</a> "),e.find(".vjs-ad-legal").length>0||(e.append('<div class="vjs-ad-legal" data-base-left="0">'+g+f+"</div>"+h),d.find(".vjs-skipAd-button").on("click",function(a){a.preventDefault(),c.skipAllowed&&(c.trigger("customended"),c.skipAllowed=!1)}),e.find(".vjs-ad-legal.vjs-ad-legal-label-suffix").on("click",function(a){c.pause()}),b.buildCTAButton())},VideoAdsHandler.prototype.getDefaultAdvertLabel=function(){var a=this;return a.isAdvertLabelSuffixEnabled()?a.options.ads&&a.options.ads.adLegalLabel&&a.options.ads.adLegalLabel.suffix?a.options.ads.adLegalLabel.suffix.text:a.advertSuffixDefault:a.oldAdvertLabel},VideoAdsHandler.prototype.isAdvertLabelSuffixEnabled=function(){var a=this;return!(a.options.ads&&a.options.ads.adLegalLabel&&a.options.ads.adLegalLabel.suffix)||getBoolean(a.options.ads.adLegalLabel.suffix.enabled)},VideoAdsHandler.prototype.changeAdvertLabelFromVast=function(a){var b,c,d,e=a.fullObj.AdParameters,f=this,g=f.getDefaultAdvertLabel();if(b=f.video_wrapper.find(".vjs-ad-legal.vjs-ad-legal-label-suffix"),b.hasClass("vjs-hidden")&&b.removeClass("vjs-hidden"),e){for(c in e){var h=e[c].split(";");for(d in h){var i=h[d].split("=");"advertLabel"==i[0]&&("{brak}"==i[1]?g="":"string"==typeof i[1]&&(g=i[1]),b.addClass("vjs-hidden"))}}f.video_wrapper.find(".vjs-ad-legal .vjs-ad-legal-label").text(g)}},VideoAdsHandler.prototype.getAdLegal=function(){var a=this,b="",c='<span class="vjs-ad-legal-remaining"></span>',d=a.isAdvertLabelSuffixEnabled(),e='<span class="vjs-ad-legal-label">'+a.getDefaultAdvertLabel()+"</span> ";return b+=d?c+e:e+c},VideoAdsHandler.prototype.getAdLegalSuffix=function(){var a=this,b="",c=a.options.ads.adLegalLabel,d=c.suffix,e=a.isAdvertLabelSuffixEnabled(),f=d.href,g=d.content;return e&&f&&(b+='<div class="vjs-ad-legal vjs-ad-legal-label-suffix" data-base-right="0">',f?b+='<a target="_blank" href="'+f+'">'+g+"</a>":g&&(b+='<span class="vjs-ad-legal-label-suffix">'+g+"</span>"),b+="</div>"),b},VideoAdsHandler.prototype.buildCTAButton=function(){var a=this,b=a.player,c=a.video_wrapper,d=document.createElement("a"),e=document.createElement("div");d.className="vjs-click-through-button vjs-cursor-pointer",d.setAttribute("target","_blank"),e.className="vjs-pause-overlay vjs-hidden","undefined"!=typeof uDevice&&"Desktop"!==uDevice&&(d.className+=" vjs-mobile-ctb",("Tablet"!==uDevice||b.options().isNativeAndroid)&&$(e).insertAfter(c.find(".vjs-tech"))),c.append(d),b.refreshButtonAds(),d.addEventListener("click",function(b){a.onClickCTA(b)}),e.addEventListener("click",function(){b.play(),setTimeout(function(){"Android"==window.uOS&&"MSIE"!==window.uBrowser&&b.pausedCurrentTime!==!1&&Math.round(b.currentTime())!==Math.round(b.pausedCurrentTime)&&b.currentTime(b.pausedCurrentTime)},100)})},VideoAdsHandler.prototype.setCTAButton=function(a){var b=this,c=b.video_wrapper.find(".vjs-click-through-button"),d="block";if(c.removeClass("vjs-cta-url vjs-cta-call vjs-cta-sms"),c.removeAttr("data-href data-action data-phone-number data-text data-stat"),"undefined"!=typeof a.fullObj&&"undefined"!=typeof a.fullObj.VideoClicks){var e=a.fullObj.VideoClicks,f=e.ClickThroughAction.toLowerCase(),g=e.ClickThroughActionPhone,h=e.ClickThroughActionText,i=JSON.stringify(e.ClickThrough);f?c.attr("data-action",f):e.ClickThrough?"object"==typeof e.ClickThrough&&e.ClickThrough[0]&&e.ClickThrough[0].length?(c.attr("data-href",e.ClickThrough[0]),c.attr("data-action","url")):"string"==typeof e.ClickThrough&&e.ClickThrough.length?(c.attr("data-href",e.ClickThrough),c.attr("data-action","url")):d="none":d="none",g&&c.attr("data-phone-number",g),h&&c.attr("data-text",h),i&&"{}"!==i&&c.attr("data-stat",i)}else f="url",a.ClickThrough?(c.attr("data-href",a.ClickThrough),c.attr("data-action","url")):d="none";b.prepareCTAIcon(a,c),"function"==typeof b.player.refreshButtonAds&&b.player.refreshButtonAds(),c.addClass("vjs-cta-"+f).css("display",d)},VideoAdsHandler.prototype.prepareCTAIcon=function(a,b){var c=function(){try{var b=a.fullObj.AdParametersJSON.params.cta.imgScale.replace(",",".");return isNaN(parseFloat(b))?1:b}catch(c){return 1}}();b.attr("data-cta-image-scale",c);try{var d=a.fullObj.AdParametersJSON.params.cta.imgUrl;d.match("jpg|gif|png")&&b.attr("data-cta-image-src",encodeURI(d))}catch(e){b.removeAttr("data-cta-image-src"),b.removeAttr("data-cta-image-scale")}},VideoAdsHandler.prototype.onClickCTA=function(a){var b=this,c=b.player,d=b.video_wrapper.find(".vjs-click-through-button");d.attr("data-action");switch(c.paused()||(c.isWebviewMode()||c.pause(),c.bigPlayButton.removeClass("vjs-hidden").show()),d.attr("data-action")){case"url":var e=d.attr("data-href").replace("_AONOVTMVALUE_",parseInt(c.currentTime(),10));c.isWebviewMode()?a.preventDefault():d.attr("href",e),c.callFromWebview("openUrl",e);break;case"sms":a.preventDefault(),d.attr("data-stat")&&c.runTracking(JSON.parse(d.attr("data-stat"))),c.callFromWebview("openSms",d.attr("data-phone-number")||"",d.attr("data-text")||"");break;case"call":a.preventDefault(),d.attr("data-stat")&&c.runTracking(JSON.parse(d.attr("data-stat"))),c.callFromWebview("openPhone",d.attr("data-phone-number")||"",d.attr("data-text")||"")}},VideoAdsHandler.prototype.handleSkipButton=function(a){var b=this,c=b.player,d=b.video_wrapper;if("undefined"!=typeof a.ads&&"undefined"!=typeof a.ads.skipAd&&a.ads.skipAd.enabled&&c.skipAllowed===!1){var e=a.ads.skipAd.timeOut-c.currentTime();e<=0?(d.find(".vjs-skipAd-button").html("Pomiń teraz"),c.skipAllowed=!0):d.find(".vjs-skipAd-button").html("Pomiń (za "+parseInt(e,10)+" sekund)")}};var P5version="1.9.9 @@BUILD_TIME";(detectIE()||vjs.IS_IPAD)&&($.support.cors=!0);var player5TestDiv=$("<div>",{id:"vjs-cfullscreen-test",style:"width: 100%; height: 100%; left: 0; top: 0; position: fixed; visibility: hidden; z-index: -100;"});$(document).ready(function(){$("body").append(player5TestDiv)});var adHandlers={video360ad:function(){},interactive:function(){},interactive2:function(){},overlay:function(){},sequential:function(){},restboard:function(){},tapGo:{}};videojs.plugin("coreTvn",coreTvn),adHandlers.video360ad=function(a,b){this.videoObj=a,this.player=b,this.video360adInProgress=!1,this.gyroBtn=null;var c=$(b.el()),d=b.playerId.replace("_","")+"ad360",e=!1,f=!1,g=b.tapGoManager;return this.clear=function(){this.unsetBufferingEvents(),f=!1,this.gyroBtn&&(this.gyroBtn.remove(),this.gyroBtn=null);var a=c.find(".vjs-remoteControl"),b=a.find(".vjs-remoteControlSvg");b.find(".vjs-group").off("mouseleave."+d+" "+g.getEventToHandleIt("down",d)),b.off(g.getEventToHandleIt("up",d)),c.off(g.getEventToHandleIt("down",d)+" "+g.getEventToHandleIt("up",d)),a.remove(),c.find(".vjs-infoIcoImg").remove(),this.video360adInProgress=!1,c.find(".vjs-black-video-cover").removeClass("vjs-visible"),"Desktop"==uDevice&&c.find(".vjs-click-through-button").removeClass("vjs-mobile-ctb").css({width:"",height:""})},this.build=function(a){var h=0,i=null,j=null,k=a.fullObj,l=this,m=0,n=0,o=0,p="",q="",r="",s={};if(g.setBrowserSupportedEvents(),e=!1,k.Remote&&(s=k.Remote.attribs),"undefined"==typeof k.Video360)return!1;if(this.video360adInProgress=!0,this.player.video360start(),c.find(".vjs-black-video-cover").removeClass("vjs-visible"),this.handleBufferingEvents(),"Desktop"==uDevice){if(c.find(".vjs-click-through-button").addClass("vjs-mobile-ctb").css({width:"100px",height:"100px"}),k.Remote){s=k.Remote.attribs,r='<a href="javascript:;" class="vjs-remoteControl">'+k.Remote.controls.template+"</a>",this.videoObj.append(r);var t=c.find(".vjs-remoteControl ");"undefined"!=typeof s&&t.css({width:parseInt(s.width,10)+"px",height:parseInt(s.height,10)+"px",position:"absolute","background-size":"contain, contain","background-repeat":"no-repeat","background-image":"url("+k.Remote.backgrounds.bg+"), url("+k.Remote.backgrounds.img+")",top:parseInt(s.y,10)+"px",left:parseInt(s.x,10)+"px"});var u=t.find(".vjs-remoteControlSvg"),v=(u.find(".vjs-remoteUp"),u.find(".vjs-remoteDown"),u.find(".vjs-remoteLeft"),u.find(".vjs-remoteRight"),u.find(".vjs-group")),w=0,x=0;u.on(g.getEventToHandleIt("up",d),function(){j=(new Date).getTime(),h=parseInt(h,10),h+=j-i,f=!1,t.css({"background-image":"url("+k.Remote.backgrounds.bg+"), url("+k.Remote.backgrounds.img+")"})}),v.on("mouseleave."+d,function(){f=!1,t.css({"background-image":"url("+k.Remote.backgrounds.bg+"), url("+k.Remote.backgrounds.img+")"})}),v.on(g.getEventToHandleIt("down",d),function(){function a(){setTimeout(function(){return!!f&&(orbitPlugin.handleRemote(w,x),void a())},10)}i=(new Date).getTime();var b=null;switch(q=this.classList.contains("vjs-remoteLeft")?"left":this.classList.contains("vjs-remoteRight")?"right":this.classList.contains("vjs-remoteUp")?"up":this.classList.contains("vjs-remoteDown")?"down":""){case"left":f=!0,b=k.Remote.backgrounds.left,w=3,x=0;break;case"right":f=!0,b=k.Remote.backgrounds.right,w=-3,x=0;break;case"up":f=!0,b=k.Remote.backgrounds.up,w=0,x=1;break;case"down":f=!0,b=k.Remote.backgrounds.down,w=0,x=-1}t.css({"background-image":"url("+k.Remote.backgrounds.bg+"), url("+b+")"}),a()})}c.on("dragstart."+d,".vjs-remoteControl",function(){return!1})}if("Desktop"!==uDevice&&(b.addClass("vjs-using-native-controls"),c.on(g.getEventToHandleIt("down",d),function(a){p=a.target.tagName.toUpperCase(),"CANVAS"==p&&(m=(new Date).getTime())}),c.on(g.getEventToHandleIt("up",d),function(a){p=a.target.tagName.toUpperCase(),"CANVAS"==p&&(n=(new Date).getTime(),o=n-m,o<90&&(this.player.paused()||this.player.pause()))}),l.buildOptionsButtons()),k.InfoIcon){var y=k.InfoIcon.attribs;if(y.display){var z='<div class="vjs-infoIcoImg"></div>';this.videoObj.append(z),"undefined"!=typeof y&&c.find(".vjs-infoIcoImg").css({width:parseInt(y.width,10)+"px",height:parseInt(y.height,10)+"px",position:"absolute",top:"50%",left:"50%","margin-top":"-"+parseInt(y.height,10)/2+"px","margin-left":"-"+parseInt(y.width,10)/2+"px","background-size":"contain","background-image":"url("+k.InfoIcon.img+")",display:"none","pointer-events":"none"})}}return l.rescale(),!0},this.buildOptionsButtons=function(){this.videoObj.append('<div class="vjs-optionsOverlayGyro"></div>'),this.gyroBtn=c.find(".vjs-optionsOverlayGyro"),b.panoramaPlugin.gyroEnabled&&this.gyroBtn.addClass("active"),this.gyroBtn.on(g.getEventToHandleIt("down",d),function(){b.trigger("toggleGyro"),$(this).toggleClass("active")})},this.handleBufferingEvents=function(){b.on("bufferingAd360Start",function(){b.addClass("vjs-ad360-buffering")}),b.on("bufferingAd360End",function(){b.removeClass("vjs-ad360-buffering")})},this.unsetBufferingEvents=function(){b.off("bufferingAd360Start bufferingAd360End"),b.removeClass("vjs-ad360-buffering")},this.infoIcoHandler=function(a,b){if(b&&!e){e=!0;var d=a.fullObj.InfoIcon.attribs,f=makeMilliSeconds(d.duration);c.find(".vjs-infoIcoImg")&&(c.find(".vjs-infoIcoImg").css({display:"block"}),setTimeout(function(){c.find(".vjs-infoIcoImg").hide(2e3)},f))}},this.rescale=function(){function a(a,b){var c="undefined"!=typeof b.width&&parseInt(b.width,10),d="undefined"!=typeof b.height&&parseInt(b.height,10),g="undefined"!=typeof b.x&&parseInt(b.x,10),h="undefined"!=typeof b.y&&parseInt(b.y,10);c&&d&&a.css({width:c*e.ratio+"px",height:d*e.ratio+"px"}),g&&h&&a.css({left:g*f.ratio+"px",top:h*f.ratio+"px"})}var d=b.getCurrentAd().fullObj,e=b.getAdsRescaleInfo(d.Video360.attribs),f=b.getAdsRescaleInfo({baseWidth:parseInt(d.Video360.attribs.base_width,10),baseHeight:parseInt(d.Video360.attribs.base_height,10),scale_down:"true",scale_up:"true"});d.Remote&&e&&a(c.find(".vjs-remoteControl"),d.Remote.attribs),d.InfoIcon&&e&&a(c.find(".vjs-infoIcoImg"),d.InfoIcon.attribs),this.gyroBtn&&e&&this.gyroBtn.css({height:80*f.ratio+"px",width:80*f.ratio+"px"}),e&&c.find(".vjs-click-through-button").css({height:100*f.ratio+"px",width:100*f.ratio+"px"})},this.send360AdXmlToApp=function(a,c){this.clear();for(var d=0,e=b.currentAdItemIndex,f=a.length-1;f>=e;)a[f].active&&(d+=makeSeconds(a[f].fullObj.Duration)),f--;return b.callFromWebview("ad360xml",{vast:c,timeLeft:d}),!0},this},adHandlers.interactive=function(a,b){this.videoObj=a,this.player=b;var c=$(b.el());return this.clear=function(){c.find(".vjs-interactive").remove()},this.build=function(a){c.find(".vjs-interactive").remove();var d=a.fullObj,e="",f="",g=this;if("undefined"==typeof d.Interactive)return!1;if(!d.Interactive.buttons.length)return!1;for(var h=0;h<d.Interactive.buttons.length;h++){var i=d.Interactive.buttons[h],j=d.Interactive.attribs.width||!1,k=d.Interactive.attribs.height||!1,l="";(j||k)&&(l=' style="',l+=j?"width: "+j+"px;":"",l+=k?"height: "+k+"px;":"",l+='"');var m='<span class="vjs-img-wrapper"'+l+'><img src="'+i.icon+'"/></span>',n='<span class="vjs-int-text-wrapper"><span class="vjs-int-text">'+i.title+"</span></span>";e+='<div class="vjs-action"><a href="'+i.url+'" target="_blank" data-stat='+JSON.stringify(i.statUrl)+">"+n+m+"</a></div>"}c.find(".vjs-ad-legal-label-suffix").length&&(f=' data-base-top="20"');var o='<div class="vjs-interactive"'+f+">"+e+"</div>";this.videoObj.find(".vjs-control-bar-wrapper").length?this.videoObj.find(".vjs-control-bar-wrapper").append(o):this.videoObj.append(o);var p,q=c.find(".vjs-interactive"),r=q.find(".vjs-action");q.show();for(var s=0;s<r.length;s++){$(r[s]).removeClass("vjs-hidden");var t=$(r[s]).find(".vjs-int-text-wrapper .vjs-int-text"),u=""===t.text()?0:t.outerWidth(!1)+12;t.attr("data-width",u).attr("data-base-width",u).css("width",0),$(r[s]).addClass("vjs-hidden"),$(r[s]).find(".vjs-int-text-wrapper").hide()}return g.rescale(),q.on("click","a",function(){var a=$(this),c=a.data("stat");c&&(b.runTracking(c),b.debug("ads","stat",c)),b.paused()||b.pause()}),q.on("mouseenter",".vjs-action",function(){var a=$(this).find(".vjs-int-text");0!==parseInt(a.attr("data-width"),10)&&($(this).find(".vjs-int-text-wrapper").show(0),$(this).addClass("vjs-interactive-btn-hovered"),a.css("width",a.attr("data-width"))),clearTimeout(p)}),q.on("mouseleave",".vjs-action",function(){$(this).removeClass("vjs-interactive-btn-hovered");var a=$(this).find(".vjs-int-text");a.css("width",0);var b=$(this);p=setTimeout(function(){b.find(".vjs-int-text-wrapper").hide()},400)}),function v(a){if(a=a||0,r[a]){var b=($(r[a]).find(".vjs-int-text"),700);0===parseInt(a,10)&&(b=0),setTimeout(function(){$(r[a]).removeClass("vjs-hidden");var b=$(r[a]).find(".vjs-int-text");$(r[a]).find(".vjs-int-text-wrapper").show(),setTimeout(function(){b.css("width",b.attr("data-width")),a++,v(a)},1e3)},2*b)}else setTimeout(function(){for(var a=0;a<r.length;a++){var b=$(r[a]);b.hasClass("vjs-interactive-btn-hovered")||b.find(".vjs-int-text").css("width",0)}},3e3)}(),!0},this.rescale=function(){function a(a){var b=a.find(".vjs-img-wrapper"),c="undefined"!=typeof i.width&&parseInt(i.width,10),d="undefined"!=typeof i.height&&parseInt(i.height,10);"undefined"==typeof a.data("base-margin-top")&&a.data("base-margin-top",parseInt(a.css("margin-top"),10)),"undefined"==typeof b.data("base-padding")&&b.data("base-padding",parseInt(b.css("padding"),10)),c&&d&&(b.css({width:c*j.ratio+"px",height:d*j.ratio+"px",padding:parseInt(b.data("base-padding"),10)*j.ratio}),a.attr("style","margin-top: "+parseInt(a.data("base-margin-top"),10)*j.ratio+"px!important;"))}function b(a){var b=a.find(".vjs-int-text-wrapper");"undefined"==typeof b.data("base-font-size")&&b.data("base-font-size",parseInt(b.css("font-size"),10));var c=b.data("base-font-size");b.css("font-size",Math.round(c*j.ratio)+"px");var d,e=a.is(":visible");e||a.removeClass("vjs-hidden"),a.find(".vjs-int-text-wrapper").show(),a.find(".vjs-int-text").css("width","auto"),d=""===a.find(".vjs-int-text").text()?0:parseInt(a.find(".vjs-int-text").outerWidth(!1)+22,10),"desktop"===uDevice.toLowerCase()&&detectIE()&&11==detectIE()&&g.isEmbed()&&(d=""===a.find(".vjs-int-text").text()?0:parseInt(a.find(".vjs-int-text")[0].clientWidth+22,10)),a.find(".vjs-int-text").attr("data-width",d).css("width",0),a.find(".vjs-int-text-wrapper").hide(),e||a.addClass("vjs-hidden")}function d(){"undefined"==typeof e.attr("data-base-top")&&e.attr("data-base-top",parseInt(e.css("top"),10)),"undefined"==typeof e.attr("data-base-right")&&e.attr("data-base-right",parseInt(e.css("right"),10));var a=e.attr("data-base-right");e.attr("data-base-top");e.css({right:j.horizontalOffset+a*j.ratio,top:j.verticalOffset+e.attr("data-base-top")*j.ratio})}var e=c.find(".vjs-interactive");if(e.length){var f=this,g=f.player,h=$("#vjs-cfullscreen-test");if(g.currentAdGroupIndex!==!1){var i=g.newAdStock[g.currentAdGroupIndex].items[g.currentAdItemIndex].fullObj.Interactive.attribs,j=g.getAdsRescaleInfo(i);g.isFullscreen()&&detectIE()&&$(g.el()).find(".vjs-tech").height()===j.trueHeight&&h.length&&(j.verticalOffset=(h.height()-j.trueHeight)/2);var k=e.find(".vjs-action");if(j){for(var l=0;l<k.length;l++)b($(k[l])),a($(k[l]));d()}}}},this},adHandlers.interactive2=function(a,b){this.videoObj=a,this.player=b;var c=$(b.el());return this.video_wrapper=$(b.el()),this.clear=function(){c.find(".vjs-interactive2").remove()},this.build=function(a){this.clear();var d=this,e=a.fullObj;if("undefined"==typeof e.Interactive2)return!1;var f,g="",h="",i=isDefined(e.Interactive2.attribs.opacity)?parsePercentage(e.Interactive2.attribs.opacity):PLAYER_DEFAULT_OPACITY,j=isDefined(e.Interactive2.attribs["background-color"])?e.Interactive2.attribs["background-color"]:"#ffffff",k=isDefined(e.Interactive2.attribs.width)?e.Interactive2.attribs.width:0,l=isDefined(e.Interactive2.attribs.height)?e.Interactive2.attribs.height:0,m="string"==typeof e.Interactive2.attribs["icon-pulsation"]&&"true"==e.Interactive2.attribs["icon-pulsation"]?" vjs-pulsation":"",n="undefined"!=typeof e.Interactive2.attribs["icon-distance"]?e.Interactive2.attribs["icon-distance"]:0,o=isDefined(e.Interactive2.attribs.offset)?parseInt(e.Interactive2.attribs.offset,10):7,p="undefined"!=typeof e.Interactive2.attribs.color?e.Interactive2.attribs.color:0,q=b.controlBar.getNestedChild("playToggle"),r=!1,s=!1;for(f=0;f<e.Interactive2.buttons.length;f++){var t=e.Interactive2.buttons[f];t.currentNode=f;var u=b.newAdStock[b.currentAdGroupIndex].items[b.currentAdItemIndex].fullObj.Interactive2.attribs,v=b.getAdsRescaleInfo(u);t.rescaleInfo=v,"object"==typeof t.slide.attribs&&adsTemplates.hasOwnProperty("interactive2_"+t.slide.attribs.id)&&(g+=render("interactive2_"+t.slide.attribs.id,t)),h+=render("interactive2_action",{btnItem:t,defaultOpacity:i,defaultColor:j,btnWidth:k,btnHeight:l,pulsation:m,iconDistance:n,offset:o,fontColor:p,videoWrapperHeight:this.video_wrapper.height(),videoControlBarHeight:this.video_wrapper.find(".vjs-control-bar").height()})}var w=p?'style="color: '+p+'"':"",x='<div id="vjs-interactive2_1" class="vjs-interactive2"><div class="vjs-actions">'+h+'</div><div class="vjs-interactive2-main-container"><div class="vjs-fallDown"'+w+'>zwiń</div><div class="vjs-interactive2-inner"><div class="vjs-board">'+g+"</div></div></div></div>";this.videoObj.find(".vjs-control-bar-wrapper").length?this.videoObj.find(".vjs-control-bar-wrapper").append(x):this.videoObj.append(x);var y=c.find(".vjs-interactive2");this.runQuiz(),this.runSurvey();var z=860,A=410;"undefined"!=typeof t.slide.attribs&&("undefined"!=typeof t.slide.attribs.width&&(z=t.slide.attribs.width,y.find(".vjs-board").css("width",t.slide.attribs.width+"px")),"undefined"!=typeof t.slide.attribs.height&&y.find(".vjs-board").css("height",t.slide.attribs.height+"px")),y.find(".vjs-board").css({width:z+"px",height:A+"px"});var B=1;y.find(".vjs-fallDown").css("background-color",hexToRGB_MA(e.Interactive2.attribs["background-color"],B)),y.find(".vjs-board").css("background-color",hexToRGB_MA(e.Interactive2.attribs["background-color"],B)),y.find(".vjs-action").data("active-color",hexToRGB_MA(e.Interactive2.attribs["background-color"],B)),y.find(".vjs-action").each(function(){$(this).css("background",$(this).data("icon-background-color")),$(this).find(".vjs-wrap").css("border-color",$(this).data("border-color"))}),y.find(".vjs-action.vjs-empty, a").on("click",function(){var a=$(this);if(a.hasClass("voteBtnSurvey")||a.hasClass("vjs-voteBtn"))return!1;var c=a.data("stat");return"undefined"==typeof a.data("alreadyVote")&&void(c&&b.runTracking(c))});var C=c.find(".vjs-click-through-button.vjs-mobile-ctb");y.find(".vjs-fallDown").on("click",function(){s||(clearTimeout(D),y.find(".vjs-interactive2-inner").removeClass("vjs-no-transition"),y.data("orgWidth",y.css("width")),y.find(".vjs-fallDown").hide(),$(this).parents(".vjs-board").hide().find(".vjs-itemWrap").removeClass("vjs-ads-active-board"),setTimeout(function(){y.find(".vjs-action").removeClass("vjs-active"),y.find(".vjs-action").each(function(a){$(this).css("background",$(this).data("icon-background-color"))})},500),y.find(".vjs-interactive2-inner").css("width",0),r=!0,b.controlBar.animateMute(!1,function(){b.play(),q&&q.show(),b.interactive2BoardVisible=!1},function(){r=!1}),C.length&&C.show())});var D,E,F,G=2e3;y.find(".vjs-interactive2-inner").on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){0!==y.find(".vjs-interactive2-inner").width()?$(this).addClass("vjs-no-transition"):$(this).removeClass("vjs-no-transition")}),y.find(".vjs-action").on("mouseenter",function(a){var d=$(this);if(d.hasClass("vjs-pulsation")?d.removeClass("vjs-pulsation"):"",clearTimeout(D),clearTimeout(E),clearTimeout(F),b.interactive2BoardVisible=!0,d.hasClass("vjs-empty"))return!1;var e=d.data("stat-2"),f=function(){b.runTracking(e),b.debug("ads","stat",e)};d.hasClass("vjs-active")||(D=setTimeout(f,G));var g=0!==parseInt(d.attr("data-board-width"),10)?d.attr("data-board-width"):"",h=0!==parseInt(d.attr("data-board-height"),10)?d.attr("data-board-height"):"",i=d.data("falldown-color"),j=d.data("board-class");y.find(".vjs-action").removeClass("vjs-active"),y.find(".vjs-itemWrap").removeClass("vjs-ads-active-board"),y.find(".vjs-action").each(function(){var a=$(this);a.css("background",a.data("icon-background-color")),a.find(".vjs-wrap").css("border-color",a.data("border-color"))}),y.find(".vjs-fallDown").css("color",i),y.find(".vjs-fallDown").show(),d.addClass("vjs-active");var k=d.data("default-color"),l=d.data("icon-active-color");d.css("background-color",l),y.find(".vjs-fallDown").css("background-color",k),y.find(".vjs-board").css({"background-color":k,width:g||z+"px",height:h||A+"px"}),y.find(".vjs-interactive2-main-container").css({top:$(this).attr("data-offset-top")+"px"}),""===j?y.find(".vjs-interactive2-main-container").removeAttr("class").addClass("vjs-interactive2-main-container"):y.find(".vjs-interactive2-main-container").addClass(j);var m=parseInt(y.find(".vjs-interactive2-inner").css("width"),10);m>(g||z)?(y.find(".vjs-interactive2-inner").addClass("vjs-no-transition"),y.find(".vjs-interactive2-inner").css({width:(g||z)/2+"px",height:h||A+"px"}),setTimeout(function(){y.find(".vjs-interactive2-inner").removeClass("vjs-no-transition"),y.find(".vjs-interactive2-inner").css({width:g||z+"px",height:h||A+"px"})},20)):y.find(".vjs-interactive2-inner").css({width:g||z+"px",height:h||A+"px"}),y.find(".vjs-board").show(),c.find(".vjs-itemWrap").hide();var n=d.data("item"),o=c.find(".vjs-itemWrap_"+n);o.show().addClass("vjs-ads-active-board"),o.hasClass("vjs-ads-gallery")&&o.trigger("vjs-ads-gallery-activated"),q&&q.hide(),b.paused()||s||(r?b.pause():(s=!0,userVolume=b.volume(),b.controlBar.animateMute(!0,function(){b.pause(),b.bigPlayButton.addClass("vjs-hidden")},function(){s=!1}))),C.length&&C.hide()});var H=!1;y.find(".vjs-action.vjs-empty").on("mouseenter",function(){clearTimeout(E),clearTimeout(F),$(this).addClass("vjs-interactive-btn-hovered"),$(this).find(".vjs-int-text-wrapper").show(0);var a=$(this).find(".vjs-int-text");a.css("width",a.attr("data-width")),q&&q.hide(),b.paused()||s||(r?b.pause():(s=!0,userVolume=b.volume(),b.controlBar.animateMute(!0,function(){H||(b.pause(),b.bigPlayButton.addClass("vjs-hidden"))},function(){s=!1}))),H=!1,y.find(".vjs-interactive2-inner").removeClass("vjs-no-transition"),y.data("orgWidth",y.css("width")),y.find(".vjs-fallDown").hide(),$(this).parents(".vjs-board").hide().find(".vjs-itemWrap").removeClass("vjs-ads-active-board"),E=setTimeout(function(){y.find(".vjs-action").removeClass("vjs-active"),y.find(".vjs-action").each(function(a){var b=$(this);b.hasClass("vjs-empty")||(b.css("background",b.data("icon-background-color")),b.find(".vjs-wrap").css("border-color",b.data("border-color")))})},500),y.find(".vjs-interactive2-inner").css("width",0)}),y.find(".vjs-action.vjs-empty").on("mouseleave",function(){clearTimeout(E),clearTimeout(F),H=!0;var a=$(this);a.removeClass("vjs-interactive-btn-hovered"),a.find(".vjs-int-text").css("width",0),F=setTimeout(function(){q&&q.show(),r=!0,b.controlBar.animateMute(!1,function(){b.play(),b.interactive2BoardVisible=!1},function(){r=!1}),a.find(".vjs-int-text-wrapper").hide()},500)}),y.show();var I,J,K=y.find(".vjs-action"),L=y.find(".vjs-action.vjs-empty");if(L.each(function(){var a,b=$(this);b.show().css("opacity","0"),a=parseInt(b.find(".vjs-int-text").outerWidth(!1)+22,10),b.find(".vjs-int-text").attr("data-width",a).css("width",0),J=b.outerWidth(!1);var c=b.find(".vjs-int-text-wrapper");c.attr("data-base-font-size",parseInt(c.css("font-size"),10)),b.css({width:"",opacity:""}).hide(),b.find(".vjs-int-text-wrapper").hide()}),J)y.find(".vjs-actions, .vjs-actions .vjs-action:not(.vjs-empty)").css("width",J),y.find(".vjs-interactive2-main-container").css({marginRight:J});else{var M=0;$.each(K,function(){$(this).width()>M&&(M=$(this).width())}),y.find(".vjs-actions, .vjs-actions .vjs-action:not(.vjs-empty)").css("width",M),y.find(".vjs-interactive2-main-container").css({marginRight:M})}return b.on("timeupdate",function(){I=this.currentTime();for(var a=0;a<K.length;a++){var b=$(K[a]);I>=b.data("timeStart")&&b.is(":hidden")&&b.fadeIn()}}),d.rescale(),c.find(".vjs-ads-gallery").adsGallerySlider(),!0},this.rescale=function(){function a(a){var b=a.find(".vjs-wrap"),c="undefined"!=typeof h.width&&parseInt(h.width,10),d="undefined"!=typeof h.height&&parseInt(h.height,10);if("undefined"==typeof a.attr("data-base-top")&&a.attr("data-base-top",parseInt(a.css("top"),10)),"undefined"==typeof b.attr("data-base-padding")&&b.attr("data-base-padding",6),c&&d){if(e.find(".actions").css("width",~~(c*l.ratio)),a.css("top",~~(parseInt(a.attr("data-base-top"),10)*l.ratio)),a.hasClass("vjs-empty")){b.css({padding:~~(parseInt(b.attr("data-base-padding"),10)*l.ratio*k)}),a.find("img").css({width:~~(c*l.ratio),height:~~(d*l.ratio)});var f=a.find(".vjs-int-text-wrapper");f.css("font-size",parseInt(f.attr("data-base-font-size"),10)*l.ratio+"px");var g,i=a.is(":visible");!i&&a.show().css("opacity","0"),a.find(".vjs-int-text-wrapper").show(),a.find(".vjs-int-text").css("width","auto"),g=parseInt(a.find(".vjs-int-text").outerWidth(!1)+22,10),a.find(".vjs-int-text").attr("data-width",g).css("width",0),a.find(".vjs-int-text-wrapper").hide(),!i&&a.css({width:"",opacity:""}).hide()}else"undefined"==typeof a.attr("data-base-board-width")&&a.attr("data-base-board-width",parseInt(a.attr("data-board-width"),10)||860),"undefined"==typeof a.attr("data-base-board-height")&&a.attr("data-base-board-height",parseInt(a.attr("data-board-height"),10)||410),a.attr("data-board-width",~~(parseInt(a.attr("data-base-board-width"),10)*l.ratio)),a.attr("data-board-height",~~(parseInt(a.attr("data-base-board-height"),10)*l.ratio)),b.css({width:~~(c*l.ratio),height:~~(d*l.ratio),padding:~~(parseInt(b.attr("data-base-padding"),10)*l.ratio*k)});b.outerWidth(!1)>n&&(n=b.outerWidth(!1)),e.find(".vjs-actions, .vjs-actions .vjs-action:not(.vjs-empty)").css("width",n),e.find(".vjs-interactive2-main-container").css({marginRight:n}),a.hasClass("vjs-active")&&e.find(".vjs-board,.vjs-interactive2-inner").css({width:~~(parseInt(a.attr("data-base-board-width"))*l.ratio),height:~~(parseInt(a.attr("data-base-board-height"))*l.ratio)}),"undefined"==typeof a.attr("data-base-offset-top")&&a.attr("data-base-offset-top",a.attr("data-offset-top"));var j=parseInt(e.find(".vjs-action.vjs-active").attr("data-base-offset-top"),10)*l.ratio;isNaN(j)&&(j=0);var m=~~(a.attr("data-base-offset-top")*l.ratio);a.attr("data-offset-top",m),e.find(".vjs-interactive2-main-container").css({top:m+"px"})}}function b(){if("undefined"==typeof e.attr("data-base-top")){var a=Math.ceil(parseFloat(e.css("top"))*k);e.attr("data-base-top",a)}"undefined"==typeof e.attr("data-base-right")&&e.attr("data-base-right",parseInt(e.css("padding-right"),10));var b=parseInt(e.attr("data-base-right"),10);e.css("padding-right",~~((l.horizontalOffset+b*l.ratio)*k));var c=parseInt(e.attr("data-base-top"),10);e.css("top",~~(l.verticalOffset+c*l.ratio))}function d(){for(var a=e.find(".vjs-board"),b=a.find(".vjs-element"),c=0;c<b.length;c++){var d="undefined"!=typeof $(b[c]).attr("data-base-top")&&parseInt($(b[c]).attr("data-base-top"),10),f="undefined"!=typeof $(b[c]).attr("data-base-left")&&parseInt($(b[c]).attr("data-base-left"),10);d&&f&&$(b[c]).css({top:~~(d*l.ratio),left:~~(f*l.ratio)})}a.css("padding",~~(10*l.ratio*k)),a.find(".vjs-button img,.vjs-element img,.vjs-ads-gallery-button-content img,.vjs-voteBtn img,.vjs-ads-map-button-content img,.voteBtnSurvey img,.vjs-billboard img").each(function(){var a=$(this);"undefined"==typeof a.attr("data-base-width")?a.on("load",function(){a.attr("data-base-width",a[0].naturalWidth),a.width(a.attr("data-base-width")*l.ratio),a.off("load")}):a.width(a.attr("data-base-width")*l.ratio)}),a.find("b,p:not(.vjs-question),span,i,.vjs-half.vjs-left.vjs-voting,.vjs-popup-form-info").each(function(){var a=$(this);"undefined"==typeof a.attr("data-base-font-size")&&a.attr("data-base-font-size",parseInt(a.css("font-size"),10));
var b=a.attr("data-base-font-size")||16;b&&a.css("font-size",b*l.ratio)}),a.find(".vjs-survey select,.vjs-quiz-bar").each(function(){var a=$(this);"undefined"==typeof a.attr("data-base-height")&&a.attr("data-base-height",parseInt(a.css("height"),10)),a.css("height",~~(parseInt(a.attr("data-base-height"),10)*l.ratio*k)),a.css("font-size",16*(i/960)*l.ratio)});var g=k*l.ratio*100>100?100:k*l.ratio*100;a.find(".vjs-survey .vjs-dropdown").each(function(){$(this).css("background-size",g+"% "+g+"%")}),a.find(".vjs-interactive2-quiz li").each(function(){$(this).css("line-height",~~(parseInt($(this).attr("data-base-line-height"),10)*l.ratio*k)+"px");var a=$(this).find(".vjs-radio-0-2"),b=parseInt(a.attr("data-base-size"),10);a.css({width:~~(b*l.ratio*k),height:~~(b*l.ratio*k),backgroundSize:100*l.ratio*k+"% "+100*l.ratio*k+"%"})})}var e=c.find(".vjs-interactive2");if(e.length){var f=this,g=f.player;if(g.currentAdGroupIndex!==!1){var h=g.newAdStock[g.currentAdGroupIndex].items[g.currentAdItemIndex].fullObj.Interactive2.attribs,i=parseInt(h.base_width||h.baseWidth,10),j=960,k=i/j,l=g.getAdsRescaleInfo(h);if(l){var m=e.find(".vjs-action"),n=(e.find(".vjs-board"),0);"undefined"==typeof c.attr("data-base-font-size")&&c.attr("data-base-font-size",parseInt(c.css("font-size"),10)),c.css("font-size",c.attr("data-base-font-size")*l.ratio);for(var o=0;o<m.length;o++)a($(m[o]));b(),d()}}}},this},"undefined"!=typeof $&&!function(a,b,c,d){function e(b,c){this.el=b,this.options=a.extend({},g,c),this.minOffset=0,this.curOffset=0,this.maxOffset=0,this.arrowLeft="",this.arrowRight="",this.playPause="",this.playing=0,this.changeTime=5e3,this.interval="",this.dots=[],this.activeBoardClass="vjs-ads-active-board",this.userPlaying=1,this.hidden="",this.visibilityChange="",this.cssPrefix=this.getCssPrefix(),this.init()}var f="adsGallerySlider",g={};e.prototype={init:function(){var b=this;b.items=a(b.el).find(".vjs-ads-gallery-item"),b.content=a(b.el).find(".vjs-ads-gallery-content"),b.wrapper=a(b.el).find(".vjs-ads-gallery-wrapper"),b.maxOffset=b.getMaxOffset(),b.setVisibilityVars(),b.buildArrows(),b.buildPaginator(),b.initializeEvents()},getCssPrefix:function(){for(var a="transform WebkitTransform MozTransform OTransform msTransform".split(" "),b=0;b<a.length;b++)if(c.createElement("div").style[a[b]]!==d){var e;switch(a[b]){case"transform":e="";break;case"WebkitTransform":e="-webkit-";break;case"MozTransform":e="-moz-";break;case"OTransform":e="-o-";break;case"msTransform":e="-ms-"}return e}return!1},getMaxOffset:function(){return this.items.length-1},setCurOffset:function(b){var c,d=this;return a(d.el).hasClass(d.activeBoardClass)?(b>d.maxOffset&&(b=d.minOffset),b<d.minOffset&&(b=d.maxOffset),d.curOffset=b,c=0===d.curOffset?0:d.curOffset+"00%",d.cssPrefix!==!1?a(d.content).css(d.cssPrefix+"transform","translate(-"+c+",0)"):a(d.content).css("left","-"+c),void(d.dots&&(a(d.dots).removeClass("vjs-dot-active"),a(d.dots[d.curOffset]).addClass("vjs-dot-active")))):void(1===parseInt(d.playing,10)&&d.stopAutoChange())},scrollLeft:function(){var a=this;a.resetAutoChange(),a.setCurOffset(a.curOffset-1)},scrollRight:function(){var a=this;a.resetAutoChange(),a.setCurOffset(a.curOffset+1)},scrollToPosition:function(a){var b=this;b.resetAutoChange(),b.setCurOffset(a)},buildArrows:function(){var b=this;if(b.items.length>1){var c='<div class="vjs-ads-gallery-arrow vjs-ads-gallery-arrow-left"></div><div class="vjs-ads-gallery-arrow vjs-ads-gallery-arrow-right"></div>';a(b.wrapper).append(c),b.arrowLeft=a(b.el).find(".vjs-ads-gallery-arrow-left"),b.arrowRight=a(b.el).find(".vjs-ads-gallery-arrow-right")}},buildPaginator:function(){var b=this;if(b.items.length){for(var c='<div class="vjs-ads-gallery-paginator-wrapper"></div>',d="",e=0;e<b.items.length;e++)d+='<span class="vjs-ads-gallery-paginator-dot" data-index="'+e+'"></span>';var f='<span class="vjs-ads-gallery-paginator-play-pause"></span>';a(b.wrapper).append(a(c).html(d+f)),b.dots=a(b.wrapper).find(".vjs-ads-gallery-paginator-dot"),b.playPause=a(b.wrapper).find(".vjs-ads-gallery-paginator-play-pause"),a(b.dots[0]).addClass("vjs-dot-active")}},startAutoChange:function(){var b=this;return a(b.el).hasClass(b.activeBoardClass)?(b.playing=1,a(b.playPause).removeClass("vjs-ads-gallery-paused"),void(b.interval=setInterval(function(){b.scrollRight()},b.changeTime))):void(1===parseInt(b.playing,10)&&b.stopAutoChange())},stopAutoChange:function(){var b=this;b.playing=0,a(b.playPause).addClass("vjs-ads-gallery-paused"),clearInterval(b.interval),b.interval=null},resetAutoChange:function(){var a=this;a.playing&&(a.stopAutoChange(),a.startAutoChange())},setVisibilityVars:function(){var a=this;"undefined"!=typeof c.hidden?(a.hidden="hidden",a.visibilityChange="visibilitychange"):"undefined"!=typeof c.mozHidden?(a.hidden="mozHidden",a.visibilityChange="mozvisibilitychange"):"undefined"!=typeof c.msHidden?(a.hidden="msHidden",a.visibilityChange="msvisibilitychange"):"undefined"!=typeof c.webkitHidden&&(a.hidden="webkitHidden",a.visibilityChange="webkitvisibilitychange")},initializeEvents:function(){var b=this;a(c).on(b.visibilityChange,function(){b.visibility()}),a(b.arrowLeft).on("click",function(){b.scrollLeft()}),a(b.arrowRight).on("click",function(){b.scrollRight()}),a(b.dots).on("click",function(){b.scrollToPosition(a(this).data("index"))}),a(b.playPause).on("click",function(){b.playing?(b.userPlaying=0,b.stopAutoChange()):(b.userPlaying=1,b.startAutoChange())}),a(b.el).on("vjs-ads-gallery-activated",function(){b.stopAutoChange(),b.userPlaying&&b.startAutoChange()})},visibility:function(){var a=this;c[a.hidden]?a.stopAutoChange():a.userPlaying&&a.startAutoChange()}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document),adHandlers.interactive2.prototype.showResults=function(a){var b,c,d=a.response.questions[0],e=1,f=[],g=a.selectedAnswer;for(b in d.value)e+=parseInt(d.value[b].counter,10);for(b in d.value){var h=d.value[b];c=h.id==g?1:0,f[b]=(parseInt(h.counter,10)+c)/e*100}this.video_wrapper.find(".vjs-interactive2 .vjs-sonda .vjs-results").html(render("interactive2_sonda_results",{colors:a.colors,results:f,rescaleInfo:a.rescaleInfo}))},adHandlers.interactive2.prototype.sendQuizAnswer=function(a){var b={user_form:{}};b.user_form[a.qqeId]=a.answer,b.user_form._id=a.quiz_id;var c=PLAYER_SONDA_SERVER+"/jsonquizsave/";$.ajax(c,{type:"POST",dataType:"json",xhrFields:{withCredentials:!0},data:b,success:function(a){"function"==typeof a.callback&&a.callback(a)},error:function(a){}})},adHandlers.interactive2.prototype.runQuiz=function(){var a=this.video_wrapper,b=this,c=b.player,d=a.find(".vjs-interactive2"),e=c.newAdStock[c.currentAdGroupIndex].items[c.currentAdItemIndex].fullObj.Interactive2.attribs,f=c.getAdsRescaleInfo(e);d.find(".vjs-sonda").each(function(){var d=$(this),e=$(this).data("quiz"),g=PLAYER_SONDA_SERVER+"/quiz/";$.ajax(g,{type:"GET",dataType:"json",xhrFields:{withCredentials:!0},data:{id:e,type:"quiz",referer:document.location.origin},success:function(g){g.colors={color1:d.data("color1"),color2:d.data("color2"),color3:d.data("color3")},g.rescaleInfo=f,d.find(".vjs-voting").each(function(){var f=d.find(".voteBtnSurvey .imgHover");f.length&&f.data("real-hover",f.data("hover")),$(this).prepend(render("interactive2_sonda_question",g));var h=[];for(var i in g.response.questions[0].value)h.push(0);3!==h.length&&$(this).closest(".vjs-itemWrap").find(".vjs-results").addClass("vjs-"+h.length+"-items"),$(this).closest(".vjs-itemWrap").find(".vjs-results").html(render("interactive2_sonda_results",{colors:g.colors,results:h,rescaleInfo:g.rescaleInfo}));var j=d.find(".vjs-empty-form-wrapper"),k=d.find(".vjs-thank-form-wrapper"),l=a.find(".vjs-interactive2-quiz"),m=a.find(".vjs-interactive2-quiz li .vjs-radio-0-2"),n=d.find(".vjs-int2-popup-wrapper"),o=d.find(".vjs-popup-form-close");o.on("click",function(){n.hide()}),m.on("click",function(){l.data("answer",$(this).data("value")),m.removeClass("vjs-active"),$(this).addClass("vjs-active")}),a.find(".vjs-voteBtn").on("click",function(a){a.preventDefault();var d=$(this);if("undefined"!=typeof d.data("alreadyVote"))return!1;var f=l.data("answer"),h=l.data("qqe-id");if(g.selectedAnswer=f,!g.selectedAnswer)return void j.css("display","table");k.css("display","table"),d.data("alreadyVote",!0),d.removeClass("vjs-cursor-pointer");var i=d.find(".imgHover");i.length&&i.attr("src",i.data("real-hover")).removeClass("imgHover");var m=d.data("stat");if(m&&c.runTracking(m),b.showResults(g),""!==f)try{b.sendQuizAnswer({qqeId:h,answer:f,quiz_id:e,callback:function(a){}})}catch(n){console.log(n)}})})},error:function(a){}})})},adHandlers.interactive2.prototype.runSurvey=function(){var a=this.video_wrapper,b=this,c=a.find(".vjs-interactive2"),d=b.player,e=d.newAdStock[d.currentAdGroupIndex].items[d.currentAdItemIndex].fullObj.Interactive2.attribs,f=d.getAdsRescaleInfo(e);c.find(".vjs-survey").each(function(){var a=$(this),c=$(this).data("survey"),e=PLAYER_SONDA_SERVER+"/quiz/";$.ajax(e,{type:"GET",dataType:"json",xhrFields:{withCredentials:!0},data:{id:c,type:"sonda",referer:document.location.origin},success:function(c){c.colors={color1:a.data("color1"),color2:a.data("color2"),color3:a.data("color3")},c.rescaleInfo=f,a.find(".vjs-form-content").each(function(){var e=a.find(".voteBtnSurvey .imgHover");e.length&&e.data("real-hover",e.data("hover")),$(this).html(render("interactive2_survey_question",c)),$(this).find("b,p:not(.vjs-question),span,i").each(function(){var a=$(this);"undefined"==typeof a.attr("data-base-font-size")&&(a.attr("data-base-font-size",parseInt(a.css("font-size"),10)),a.css("font-size",a.attr("data-base-font-size")*f.ratio))});var g=a.find(".vjs-empty-form-wrapper"),h=a.find(".vjs-thank-form-wrapper"),i=a.find(".vjs-int2-popup-wrapper"),j=a.find(".vjs-popup-form-close");j.on("click",function(){i.hide()}),a.find(".voteBtnSurvey").on("click",function(c){c.preventDefault();var e,f,i=$(this).attr("href"),j=$(this).parents(".vjs-survey").data("raw"),k=a.find("form.vjs-survey"),l=k.serializeArray(),m=[],n=!1;for(e in l)if("user_form[_id]"!==l[e].name&&(m.push(l[e].value),""===l[e].value)){n=!0;break}if(n)return void g.css("display","table");if("undefined"==typeof $(this).data("alreadyVote")){m=m.join("");for(f in j.slide.redirects)j.slide.redirects[f].attribs.answers.indexOf(m)!==-1&&(i=j.slide.redirects[f].url);b.sendSurveyAnswer(k.serialize(),function(){}),$(this).data("alreadyVote",!0),$(this).removeClass("vjs-cursor-pointer");var o=$(this).find(".imgHover");o.length&&o.attr("src",o.data("real-hover")).removeClass("imgHover"),h.css("display","table");var p=$(this).data("stat");if(p){for(var q in p)p[q]=p[q].replace("[answers]",m);d.runTracking(p)}i&&window.open(i,"_blank")}})})},error:function(a){}})})},adHandlers.interactive2.prototype.sendSurveyAnswer=function(a,b){var c=PLAYER_SONDA_SERVER+"/jsonquizsave/";$.ajax(c,{type:"POST",dataType:"json",xhrFields:{withCredentials:!0},data:a,success:function(a){"function"==typeof b&&b(a)},error:function(a){}})},adHandlers.sequential=function(a,b){var c=this;c.videoObj=a,c.player=b,c.adAttribs={},c.adHandler=!1,c.fakeCountDownDuration=0,c.fakeCountDownCallback=!1,c.eventPauseOccured=!1,c.remainingWrap=c.videoObj.find(".vjs-ad-legal .vjs-ad-legal-remaining"),c.fakeCountDownInterval=!1,c.splashScreenInitialized=!1,c.skipMainVideo=!1,c.player.on("seqEnded",function(){c.onSeqEnded()}),c.player.on("seqPause",function(){c.onSeqPause()}),c.player.on("seqPlaying",function(){c.onSeqPlaying()}),c.player.on("fakePlaying",function(){c.startFakeCountDown()}),c.player.on("fakePaused",function(){c.pauseFakeCountDown()})},adHandlers.sequential.prototype.clear=function(){var a=this;a.videoObj.find(".vjs-sequential").remove(),a.videoObj.find(".vjs-sequence-btn").remove(),a.player.off("seqPause"),a.player.off("seqEnded"),a.player.off("seqPlaying"),a.player.off("fakePlaying"),a.player.off("fakePaused"),a.player.fakePlayToggle=!1,a.fakeCountDownInterval=!1,a.splashScreenInitialized=!1,a.skipMainVideo=!1},adHandlers.sequential.prototype.build=function(a){var b=this,c=$(b.player.el());if(b.item=a.fullObj,"undefined"==typeof b.item.Sequential)return!1;b.player.sequentialInProgress=!0,b.player.sequentialStage="beginSplash",b.boardPause=b.item.Sequential.attribs.boardPause,b.player.fakePlayToggle=!1,b.adAttribs=b.item.Sequential.attribs,b.adAttribs.scale_up=b.adAttribs.scale_up||"true",b.adAttribs.scale_down=b.adAttribs.scale_down||"true";var d="";for(var e in b.item.Sequential.elements)d+='<div class="vjs-sequence-choose" data-obj=\''+JSON.stringify(b.item.Sequential.elements[e])+"'></div>";var f="";if("undefined"!=typeof b.item.Sequential.Navigation.ButtonReturn){var g=b.item.Sequential.Navigation.ButtonReturn,h=g.StatUrl?"data-stat='"+JSON.stringify(g.StatUrl)+"' ":"";f+='<div class="vjs-sequence-return vjs-sequence-btn" '+h+'data-x="'+g.attribs.x+'" data-y="'+g.attribs.y+'"><img src="'+g.Image+'" data-hover="'+g.ImageHover+'" class="imgHover" /></div>'}if("undefined"!=typeof b.item.Sequential.Navigation.ButtonSkip){var i=b.item.Sequential.Navigation.ButtonSkip,j=i.StatUrl?"data-stat='"+JSON.stringify(i.StatUrl)+"' ":"";f+='<div class="vjs-sequence-skip vjs-sequence-btn" '+j+'data-x="'+i.attribs.x+'" data-y="'+i.attribs.y+'"><img src="'+i.Image+'" data-hover="'+i.ImageHover+'" class="imgHover" /></div>'}var k='<div class="vjs-sequential"><div class="vjs-btnWrapper">'+d+"</div></div>"+f;b.videoObj.append(k),b.adHandler=c.find(".vjs-sequential");var l=b.adHandler.width()/b.item.Sequential.attribs.baseWidth,m=b.adHandler.height()/b.item.Sequential.attribs.baseHeight;b.adHandler.css("background-image","url('"+b.item.Sequential.background+"')"),b.adHandler.css("background-repeat","no-repeat"),b.adHandler.css("background-size","100% auto"),b.adHandler.css("background-position","center center"),b.vjsSeqChoose=c.find(".vjs-sequence-choose"),b.vjsSeqButtons=c.find(".vjs-sequence-btn"),b.vjsSkipBtn=c.find(".vjs-sequence-skip"),b.vjsReturnBtn=c.find(".vjs-sequence-return"),b.returnBtnClicked=!1,b.vjsSeqChoose.each(function(){var a=$(this),b=a.data("obj");a.append('<span class="vjs-cursor-pointer" data-video="'+b.Video+'"><img src="'+b.Image+'" data-hover="'+b.ImageHoover+'" class="imgHover" /></span>'),a.css("left",parseInt(b.attribs.x*l,10)+"px"),a.css("top",parseInt(b.attribs.y*m,10)+"px")}),b.vjsSeqChoose.on("click","span",function(a,c){a.preventDefault(),b.pauseFakeCountDown();var d=jsonRedirectRedcdn($(this).data("video")),e=$(this).parents(".vjs-sequence-choose").data("obj");b.player.getThisItemForEventTracking=e,b.player.src(d),b.player.on("canplay",function(){b.player.trigger("tracking.start"),b.hideSplashScreen(),b.vjsSeqButtons.show(),b.player.trigger("sendImpression"),"undefined"!=typeof c&&"autoChoose"===c||b.player.runTracking(e.StatUrl),b.player.videoAdsHandler.setCTAButton(e),e.Background.length&&b.adHandler.css("background-image","url('"+e.Background+"')"),b.player.off("canplay"),b.item.Duration="00:00:00",b.item.Sequential.additionalDuration=makeSeconds(e.Duration),b.player.currentAdTime=0,b.player.videoAdsHandler.recalculateTotalTimeOfCurrentGroup()})}),b.vjsSeqButtons.each(function(){var a=$(this);a.css("left",a.data("x")*l+"px"),a.css("top",a.data("y")*m*.94+"px"),a.hide()}),b.vjsReturnBtn.on("click",function(){var a=$(this),c=a.data("stat");c&&b.player.runTracking(c),b.returnBtnClicked=!0,b.player.sequentialStage="beginSplash",b.player.trigger("ended")}),b.vjsSkipBtn.on("click",function(){var a=$(this),c=a.data("stat");c&&b.player.runTracking(c),b.pauseFakeCountDown(),b.player.sequentialInProgress=!1,b.player.skipAllowed=!0;var d=function(){b.player.trigger("ended"),b.vjsSeqButtons.hide()};setTimeout(d,50)}),b.rescale=function(){var a=b.player.getAdsRescaleInfo(b.adAttribs);b.vjsSeqButtons.each(function(){var c=$(this);c.find("img").each(function(){b.recalculateImgSize($(this),a)}),c.css("left",c.data("x")*a.ratio+a.horizontalOffset+"px"),c.css("top",c.data("y")*a.ratio*.94+a.verticalOffset+"px")}),b.vjsSeqChoose.each(function(){var c=$(this),d=c.data("obj");c.find("img").each(function(){b.recalculateImgSize($(this),a)}),c.css("left",d.attribs.x*a.ratio+a.horizontalOffset+"px"),c.css("top",d.attribs.y*a.ratio+a.verticalOffset+"px")})},b.recalculateImgSize=function(a,b){var c=!1;"undefined"!=typeof a.data("width")?(c=a.data("width"),a.css("width",c*b.ratio)):(c="undefined"!=typeof a[0].naturalWidth?a[0].naturalWidth:a[0].width,0===c?a.one("load",function(){c="undefined"!=typeof a[0].naturalWidth?a[0].naturalWidth:a[0].width,a.data("width",c),a.css("width",c*b.ratio)}):(a.data("width",c),a.css("width",c*b.ratio)))}},adHandlers.sequential.prototype.onSeqPause=function(){var a=this;a.eventPauseOccured=!0},adHandlers.sequential.prototype.onSeqPlaying=function(){var a=this;a.eventPauseOccured=!1},adHandlers.sequential.prototype.onSeqEnded=function(){var a=this;a.player.sequentialInProgress?(a.player.sendCompleteTrackingEvent(),a.player.getThisItemForEventTracking="",a.showSplashScreen()):(a.player.getThisItemForEventTracking="",a.item.Sequential.additionalDuration=0,a.player.videoAdsHandler.recalculateTotalTimeOfCurrentGroup(),a.hideSplashScreen())},adHandlers.sequential.prototype.showSplashScreen=function(){var a=this;if(a.allowOnPause=!0,!a.splashScreenInitialized){var b=a.player.controlBar.getNestedChild("playToggle");a.splashScreenInitialized=!0,a.player.fakePlayToggle=!0,a.adHandler.show(),a.rescale(a.adHandler),a.vjsReturnBtn.hide(),a.fakeCountDownDuration=0,a.eventPauseOccured?(a.returnBtnClicked&&(a.item.Sequential.attribs.boardPauseForTotalDuration=2*parseInt(a.item.Sequential.attribs.boardPause,10),a.player.videoAdsHandler.recalculateTotalTimeOfCurrentGroup(),a.setSeqRemainingTime()),b.onClick()):a.player.one("pause",function(){a.allowOnPause&&(a.allowOnPause=!1,a.returnBtnClicked&&(a.item.Sequential.attribs.boardPauseForTotalDuration=2*parseInt(a.item.Sequential.attribs.boardPause,10),a.player.videoAdsHandler.recalculateTotalTimeOfCurrentGroup(),a.setSeqRemainingTime()),b.onClick())}),a.skipMainVideo&&(a.player.pause(),b.onClick(),a.skipMainVideo=!1),"beginSplash"===a.player.sequentialStage?(a.player.sequentialStage="endSplash",a.returnBtnClicked&&a.vjsSkipBtn.show(),a.fakeCountDownCallback=function(){if("undefined"!=typeof a.adAttribs.spotRandom&&"true"===a.adAttribs.spotRandom){var b=0===a.vjsSeqChoose.length?0:a.vjsSeqChoose.length-1;$(a.vjsSeqChoose[getRandomInt(0,b)]).children("span").trigger("click","autoChoose")}else $(a.vjsSeqChoose[0]).children("span").trigger("click","autoChoose")}):a.fakeCountDownCallback=function(){a.vjsSkipBtn.trigger("click")}}},adHandlers.sequential.prototype.hideSplashScreen=function(){var a=this;a.player.trackingFlags={},a.splashScreenInitialized=!1,a.player.fakePlayToggle=!1,a.adHandler.hide(),a.pauseFakeCountDown(),a.item.Sequential.attribs.boardPauseForTotalDuration!==parseInt(a.item.Sequential.attribs.boardPause,10)&&(a.item.Sequential.attribs.boardPauseForTotalDuration=parseInt(a.item.Sequential.attribs.boardPause,10),a.player.videoAdsHandler.recalculateTotalTimeOfCurrentGroup()),a.eventPauseOccured=!1,a.returnBtnClicked=!1,a.player.bigPlayButton.addClass("vjs-hidden"),a.player.bigPlayButton.hide()},adHandlers.sequential.prototype.startFakeCountDown=function(){var a=this,b=0,c=$(a.player.el());a.player.fakePlayToggle=!1,a.fakeCountDownInterval=setInterval(function(){c.hasClass("vjs-waiting")&&c.removeClass("vjs-waiting"),a.fakeCountDownDuration++,a.fakeCountDownDuration>=a.boardPause&&(a.pauseFakeCountDown(),"function"==typeof a.fakeCountDownCallback&&a.fakeCountDownCallback()),b=parseInt(makeSeconds(a.remainingWrap.text()),10)-1,b=b<0?0:b,a.remainingWrap.text(secondsToHms(b)+" ")},1e3)},adHandlers.sequential.prototype.pauseFakeCountDown=function(){var a=this;clearInterval(a.fakeCountDownInterval)},adHandlers.sequential.prototype.setSeqRemainingTime=function(){var a=this,b=a.player.newAdStock[a.player.currentAdGroupIndex].totalDuration,c=0,d=0;if(b){for(var e=a.player.newAdStock[a.player.currentAdGroupIndex].items,f=0;f<e.length;f++)e[f].active!==!1&&f!==a.player.currentAdItemIndex||(c+=makeSeconds(e[f].fullObj.Duration));d=b-c+a.player.currentAdTime,d<0&&(d=0)}a.remainingWrap.text(secondsToHms(d)+" ")},adHandlers.overlay=function(a,b,c){this.player=b,this.video_wrapper=a,this.clear=function(){var a=this.video_wrapper.find(".vjs-overlay-container");a.length?a.remove():""};var d=this;return b.one("videoBegin",function(){d.adjustTimeStart()}),this.build=function(a,c){var d=a.src,e="",f="",g="center",h="bottom",i=0,j=0,k=0,l=0,m=0,n=0,o=b.getAdsRescaleInfo(a.attribs);o||(o={ratio:1}),"undefined"==typeof a.attribs.tvn_align_y&&"true"!=a.attribs.tvn_align_y||(e='<span class="vjs-close"></span>'),"undefined"!=typeof a.attribs.tvn_advert_label&&"true"==a.attribs.tvn_advert_label&&(f='<div class="vjs-overlay-legal" style="display: block;">Reklama</div>');var p=buildImgOrSWF(d,"overlay-ad",{width:a.attribs.width*o.ratio,height:a.attribs.height*o.ratio}),q='<div class="vjs-overlay-container"  id="overlay_'+c+'"><div class="vjs-overlay-wrapper" style="width:'+a.attribs.width*o.ratio+"px; height:"+a.attribs.height*o.ratio+'px; ">'+f+e+' <a href="'+a.ClickThrough+'" class="vjs-impression-action" target="_blank">'+p+"</a></div></div>",r=$(q);return"true"==a.attribs.tvn_transparent_background&&r.addClass("vjs-overlay-background"),"undefined"!=typeof a.attribs.tvn_align_x&&(g=a.attribs.tvn_align_x.toLowerCase()),"undefined"!=typeof a.attribs.tvn_align_y&&(h=a.attribs.tvn_align_y.toLowerCase()),"center"==g&&(i=parseInt("-"+a.attribs.width/2,10)*o.ratio),"center"==h&&(j=parseInt("-"+a.attribs.height/2,10)*o.ratio),g="vjs-overlay-x-"+g,h="vjs-overlay-y-"+h,"undefined"!=typeof a.attribs.tvn_margin_top&&(k=this.convertMargin(a.attribs.tvn_margin_top)*o.ratio),"undefined"!=typeof a.attribs.tvn_margin_bottom&&(l=this.convertMargin(a.attribs.tvn_margin_bottom)*o.ratio),"undefined"!=typeof a.attribs.tvn_margin_left&&(m=this.convertMargin(a.attribs.tvn_margin_left)*o.ratio),"undefined"!=typeof a.attribs.tvn_margin_right&&(n=this.convertMargin(a.attribs.tvn_margin_right)*o.ratio),j+=k,j-=l,i+=m,i-=n,r.find(".vjs-overlay-wrapper").css("margin-left",i+"px"),r.css("margin-top",j+"px"),r.find(".vjs-overlay-wrapper").addClass(g),r.addClass(h),r.on("click","span.vjs-close",function(a){a.stopPropagation(),$(a.currentTarget).parents("div.vjs-overlay-container").hide(),b.isShowedOverlay=!1}),r},this.convertMargin=function(b){var c=0;return null!==b&&""!==b&&(c=b.indexOf("%")!=-1?b.replace("%","")*a.height()/100:b.replace("px","")),parseInt(c,10)},this.handleOverlays=function(c){var d=!1;"undefined"==typeof b.isShowedOverlay&&(b.isShowedOverlay=!1);for(var e=0;e<b.newAdStock.overlay.length;e++){var f=b.newAdStock.overlay[e];d=f.attribs.timeStart;var g=a.find("#overlay_"+e);d<=c&&g.data("showed")!==!0&&b.isShowedOverlay===!1&&(b.runTracking(f.Impression),b.isShowedOverlay=!0,g.show(),g.data("showed",!0),g.data("closeTime",b.getInformation().watchingTime+makeSeconds(f.attribs.minSuggestedDuration))),"undefined"!=typeof g.data("closeTime")&&g.data("closeTime")<=b.getInformation().watchingTime&&g.is(":visible")&&(g.hide(),b.isShowedOverlay=!1),"true"===f.attribs.tvn_close_button&&g.find("span.vjs-close").show()}},this.adjustTimeStart=function(){function d(){g==-1?(i=parseInt(b.duration(),10)-makeSeconds(h.substr(1)),f.attribs.timeStart=i):(i=makeSeconds(h.substr(1)),f.attribs.timeStart=i)}for(var e=0;e<b.newAdStock.overlay.length;e++){var f=b.newAdStock.overlay[e],g="-"==f.attribs.timeStart[0]?-1:1,h=f.attribs.timeStart,i=0;if("undefined"!=typeof f.attribs.show_after)if(/Midroll/.test(f.attribs.show_after)){var j=parseInt(f.attribs.show_after.replace("Midroll_",""),10)-1;if("undefined"!=typeof c[j]){var k=c[j];i=makeSeconds(k.time)+makeSeconds(h.substr(1))*g,f.attribs.timeStart=i}else b.newAdStock.overlay.splice(e,1)}else"Middle"==f.attribs.show_after?(i=parseInt(b.duration(),10)/2+makeSeconds(h.substr(1))*g,f.attribs.timeStart=i):(delete f.attribs.show_after,d());else d()}b.newAdStock.overlay=fixTimeShifts(b.newAdStock.overlay);for(var l=0;l<b.newAdStock.overlay.length;l++)a.append(b.overlayHandler.build(b.newAdStock.overlay[l],l))},this.rescale=function(){var b=a.find(".vjs-overlay-container");if(b.length)for(var c=this,d=c.player,e=d.newAdStock.overlay,f=0;e.length>f;f++){var g=e[f],h=a.find("#overlay_"+f),i=g.attribs,j=d.getAdsRescaleInfo(i),k="center",l="bottom",m=0,n=0,o=0,p=0,q=0,r=0;if(j){if(h.find(".vjs-overlay-wrapper").css({width:parseInt(i.width,10)*j.ratio+"px",height:parseInt(i.height,10)*j.ratio+"px"}),h.find("img,video").css({width:parseInt(i.width,10)*j.ratio+"px",height:parseInt(i.height,10)*j.ratio+"px"}),"undefined"!=typeof i.tvn_align_x&&(k=i.tvn_align_x.toLowerCase()),"undefined"!=typeof i.tvn_align_y&&(l=i.tvn_align_y.toLowerCase()),"center"==k&&(m=parseInt("-"+i.width/2,10)*j.ratio),"center"==l&&(n=parseInt("-"+i.height/2,10)*j.ratio),"undefined"!=typeof i.tvn_margin_top&&(o=this.convertMargin(i.tvn_margin_top)*j.ratio),"undefined"!=typeof i.tvn_margin_bottom&&(p=this.convertMargin(i.tvn_margin_bottom)*j.ratio),(videojs.TOUCH_ENABLED||d.options().isMobile)&&d.options().nativeControlsForTouch===!0||d.options().isTablet){var s;if(d.isFullscreen()){s="undefined"==typeof h.attr("data-base-bottom")?h.css("bottom"):h.attr("data-base-bottom"),h.attr("data-base-bottom",s),h.css("bottom",j.verticalOffset+"px");var t=40;d.options().isTablet&&(t=$(d.controlBar.el()).height()+$(d.controlBar.el()).find(".vjs-progress-control").height()),j.verticalOffset<parseInt(t,10)&&h.css({bottom:parseInt(t,10)+"px"})}else h.css({bottom:""})}"undefined"!=typeof i.tvn_margin_left&&(q=this.convertMargin(i.tvn_margin_left)*j.ratio),"undefined"!=typeof i.tvn_margin_right&&(r=this.convertMargin(i.tvn_margin_right)*j.ratio),n+=o,n-=p,m+=q,m-=r,h.find(".vjs-overlay-wrapper").css("margin-left",m+"px"),h.css("margin-top",n+"px")}}},this},adHandlers.restboard=function(a,b,c){function d(a,b){var c=["-webkit-transform","-ms-transform","transform"];for(var d in c)a.find(".vjs-progress-mask.vjs-full").css(c[d],"rotate("+b+"deg)"),a.find(".vjs-progress-fill").not(".vjs-fix").css(c[d],"rotate("+b+"deg)"),a.find(".vjs-progress-fill.vjs-fix").css(c[d],"rotate("+b+"deg)")}this.videoObj=a,this.player=b;var e=$(b.el()),f=this;return this.clear=function(){e.find(".vjs-restboard-container").remove()},this.build=function(){var a=this.player,b="",d="",g="",h="";if(a.newAdStock.restboard){var i="";isDefined(c.playlist)&&(i="-playlist");var j='<span class="vjs-__info'+i+'">REKLAMA</span>';"false"===a.newAdStock.restboard.attribs.tvn_advert_label&&(j="");var k=buildImgOrSWF(a.newAdStock.restboard.src,"vjs-restboard-ad",{width:a.newAdStock.restboard.attribs.width,height:a.newAdStock.restboard.attribs.height,clickTags:a.newAdStock.restboard.AdParameters[0]}),l=a.newAdStock.restboard.ClickThrough&&!isDefined(a.newAdStock.restboard.AdParameters[0])?' href="'+a.newAdStock.restboard.ClickThrough:"";h='<div class="vjs-restboard-wrap'+i+'">'+(""!==i?'<div class="vjs-restboard-ad-wrap-table"><div class="vjs-restboard-ad-wrap-cell">':"")+j+'<div class="vjs-impression-action-wrapper">'+(l.length&&""!==l?'<a class="vjs-impression-action"'+l+'" target="_blank"></a>':"")+k+"</div>"+(""!==i?"</div></div>":"")+"</div>"}if(isDefined(c.playlist)&&a.options().enabledRestboard){var m=a.playlistManager.getCurrentPlaylistAndIndex();d=render("playlist_show_siblings",m),g=render("continue_watching",m),isDefined(c.playlist.playlist.movies[0])&&c.playlist.playlist.movies[0].one_episode===!0&&$(a.el()).addClass("vjs-one-episode"),b=a.newAdStock.restboard?"":render("playlist_show_similar",c.playlist)}if(isDefined(c.playlist)&&a.options().enabledRestboard||a.newAdStock.restboard){var n='<div class="vjs-active-movie-info"></div><div class="vjs-restboard-container">'+h+d+b+g+"</div>";e.append(n);var o=e.find(".vjs-restboard-container");e.find(".vjs-control-bar").height();o.find(".vjs-continue-watching").on("click",function(){window.location.href=$(this).data("href")}),function(){var a=o.find(".vjs-playlist-siblings"),b=a.find("ul"),c=b.find("li").length,d=a.find(".vjs-watching-now"),e=a.find(".vjs-next"),f=a.find(".vjs-prev"),g=b.data("pos"),h=0,i=!1;d.hide(),f.hide(),1!==c&&c!==g+1||e.hide(),0!==parseInt(g,10)&&(f.show(),b.css({left:"-="+330*parseInt(g,10),width:330*c+"px"}),h==c-2&&e.hide(),h=g,d.show()),e.on("click",function(){if(!i){i=!0,f.show();var j=a.width();b.css("left","-="+j),h==c-2&&e.hide(),h++,h==g?d.show():d.hide(),b.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){i=!1})}}),f.on("click",function(){if(!i){i=!0;var j=a.width();b.css("left","+="+j),h--,0===parseInt(h,10)&&f.hide(),c>1&&h<c&&e.show(),h==g?d.show():d.hide(),b.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){i=!1})}})}()}a.newAdStock.restboard&&"true"===a.newAdStock.restboard.attribs.tvn_transparent_background&&o.addClass("vjs-bg-transparent");var p=!1;a.on("pause",function(){if(!a.blockInteraction){var b=a.controlBar.getNestedChild("shareButton");isDefined(b)&&b.shareboardHandler.hasClass("vjs-visible")||(p=!0,a.seeking()||a.endReached!==!1||a.advertInProgress||e.hasClass("vjs-switching")||a.options().isLive!==!1||("undefined"!=typeof a.newAdStock.restboard&&a.runTracking(a.newAdStock.restboard.Impression),f.showElHandler(o)),a.seeking()||a.endReached!==!1||a.advertInProgress||e.hasClass("vjs-switching")||a.options().isLive!==!0||a.bigPlayButton.removeClass("vjs-hidden").addClass("vjs-visible"))}}),a.on("play",function(){var b=a.options().activeMovie,c=e.find(".vjs-active-movie-info");if(a.advertInProgress||isNotDefined(b.title))c.addClass("vjs-hidden");else{var d="undefined"!=typeof b.episode&&"0"!==b.episode?"Odcinek "+b.episode:"",f="undefined"!=typeof b.season&&0!==parseInt(b.season)?", Sezon "+b.season:"",g='<div class="vjs-active-movie-title">'+("undefined"!=typeof b.episode_name&&b.episode_name.length>1?b.episode_name:b.title)+"</div>"+(d.length>1||f.length>1?'<div class="vjs-active-movie-episode">'+d+f+"</div>":"");c.removeClass("vjs-hidden").html(g)}p&&(p=!1,isDefined(o)&&(o.hide(),"undefined"!=typeof a.sleepMode&&a.sleepMode.deactivate(),a.bigPlayButton.addClass("vjs-hidden").removeClass("vjs-visible")))}),a.on("fullscreenchange2",function(){if("undefined"!=typeof o){var a,b=o.find(".vjs-impression-action");a=b.length?b.next().height()+o.find("span.vjs-__info").height():o.find(".vjs-impression-action-wrapper").children().first().height()+o.find("span.vjs-__info").height();var d=(o.height()-a)/2;o.find("div.vjs-restboard-wrap").css({top:d+"px"}),isDefined(c.playlist)?b.css({width:b.next().width(),left:(b.parent().width()-b.next().width())/2+"px"}):b.css({width:b.next().width(),"margin-left":"-"+b.next().width()/2+"px"})}})},this.showElHandler=function(a){if(isNotDefined(a))return!1;e.removeClass("vjs-switching"),a.show(),"undefined"!=typeof b.sleepMode&&b.sleepMode.activate();var d,f=a.find(".vjs-impression-action");d=f.length?f.next().height()+a.find("span.vjs-__info").height():a.find(".vjs-impression-action-wrapper").children().first().height()+a.find("span.vjs-__info").height();var g=(a.height()-d)/2;a.find("div.vjs-restboard-wrap").css({top:g+"px"}),isDefined(c.playlist)?f.css({width:f.next().width(),left:(f.parent().width()-f.next().width())/2+"px"}):f.css({width:f.next().width(),"margin-left":"-"+f.next().width()/2+"px"})},this.handleTimer=function(a){var b=this.player;a.find(".vjs-radial-progress-wrapper").removeClass("vjs-hidden");var c=a.find(".vjs-progress-number").timerCountDown({timerElement:$('[data-tvn-timer="counter"]'),startTime:10,callback:function(b){var c=18*b;d(a,c)},endCallback:function(){return c.reset(),d(a,180),a.find(".vjs-radial-progress-wrapper").addClass("vjs-hidden"),b.resetPlayerAds(),b.playlistManager.breakInProgress?void b.play():(b.options().activeMovie.detail_path=b.options().nextMovie.detail_path+"#play",
void $(b.node).trigger("video.playlistClipEnd"))}});a.find('[data-tvn-timer="pause"]').removeClass("vjs-hidden").on("click",function(){$(this).addClass("vjs-hidden"),a.find('[data-tvn-timer="start"]').removeClass("vjs-hidden")}),a.find('[data-tvn-timer="start"]').on("click",function(){$(this).addClass("vjs-hidden"),a.find('[data-tvn-timer="pause"]').removeClass("vjs-hidden")}).trigger("click")},this},videojs.plugin("debug",function(a){var b=this;b.debug=function(a,b,d){c.addLog(a,b,d)};var c={debugId:PLAYER_DEBUG?b.options().id.replace("player5","debug"):"",addLog:function(a,b,c){if(PLAYER_DEBUG!==!1){console.log(this.debugId),console.log(PLAYER_DEBUG);var d=document.getElementById(this.debugId);if(null!==d){var e=$(d).outerHeight(),f=d.scrollTop,g=d.scrollHeight;$(d).append("<div>"+(new Date).toTimeString().split(" ")[0]+': <span class="vjs-debug-title alert-danger">'+a+'</span> <span class="vjs-debug-subtitle alert-warning">'+b+'</span> <span class="vjs-debug-params alert-info">'+this.arrayToString(c)+"</span></div>"),e+f===g&&$(d).scrollTop(d.scrollHeight)}}},arrayToString:function(a){if("string"==typeof stringValue)return a;var b=[];for(var c in a){var d=c+":"+a[c];b.push(d)}return b.join(", ")}};$(".player-initialized").each(function(){if("undefined"!=typeof DEBUG_VIDEOJS&&1==DEBUG_VIDEOJS){var a=$(this).find("video").first().attr("id").replace("_html5_api","").replace(b.namespace,"");"undefined"!=typeof DEBUG_VIDEOJS&&0===$("#debug_"+a).length&&$(this).after('DEBUG:<div style="max-height: 200px; width: 1024px; overflow-x:hidden; word-break: break-all" class="modal-body" id="debug_'+a+'">')}})}),adHandlers.tapGo.wipe=function(a,b,c){function d(c){c.index&&c.elId===a.buttons[c.data.btnId].itemId&&(c.data.enabled=!0,k.off("showElement.wipeBtn"+b+c.index))}function e(){var c=this,e=a.buttons[c.btnId],f=makeMilliSeconds(e.attribs.showTime)||0;c.enabled=!1,k.find("#"+e.itemId).css({display:"none",visibility:"visible"}),i.tapGoTimer>=f?(c.enabled=!0,i.showElement(e)):k.on("showElement.wipeBtn"+b+c.btnId,null,c,d),h.eventsInitialized&&c.wipe.initEvents()}function f(b){var c,d=this;d.actionsIds.length&&b>=d.actionsIds[0]&&(c=a.target.buttonActions[d.btnId][d.actionsIds[0]],c.showed||(c.showed=!0,i.playAction(a.target.buttonActions[d.btnId][d.actionsIds[0]]),d.actionsIds.splice(0,1)),c.redirect&&(a.buttons[d.btnId].redirect=!0))}function g(b){var c,d=h.successes.indexOf(b.btnId);d<0&&(c=a.target.buttonActions[b.btnId],c=c[c.attribs.endActionIndex]||!1,c&&!c.showed&&i.playAction(c),a.buttons[b.btnId].redirect||h.successes.push(b.btnId),h.successes.length===a.target.attribs.endActionIndex&&a.target.finishAction[0]&&!h.isComplete&&(h.isComplete=!0,i.playAction(a.target.finishAction[0])))}var h=this,i=c.tapGoManager,j=$(c.el()),k=j.find(".vjs-tapgo");return this.setInitialWipeVals=function(){this.upEvent=null,this.eventId=null,this.successes=null,this.brushSize=null,this.tgManager=i,this.eventsInitialized=null,this.isComplete=!1},this.build=function(){this.eventId=c.playerId.replace("_","")+"wipeEvent"+b,this.successes=[],this.isComplete=!1,this.isCleared=!1,this.brushSize=parseInt(a.target.attribs.brushSize,10),isNaN(a.brushSize)&&(this.brushSize=40),a.target.attribs.endActionIndex=parseInt(a.target.attribs.endActionIndex,10),isNaN(a.target.attribs.endActionIndex)&&(a.target.attribs.endActionIndex=1);for(var d,i=a.buttonsIds.length;i--;)d=a.buttonsIds[i],k.find("#"+a.buttons[d].itemId).css({visibility:"hidden",display:"block"}).eraser({completeRatio:a.target.buttonActions[d].endActionIndex,videoWrapper:j,btnId:d,actionsIds:a.target.buttonActions[d].buttonActionsIds.slice().sort(),wipe:h,readyFunction:e,completeFunction:g,progressFunction:f})},this.initEvents=function(){for(var b,c=a.buttonsIds.length;c--;)b=k.find("#"+a.buttons[a.buttonsIds[c]].itemId),b.eraser("initEvents");this.eventsInitialized=!0},this.clearSingleBtn=function(c){k.off("hideElement.wipeBtn"+b+c),k.off("showElement.wipeBtn"+b+c);var d=j.find("#"+a.buttons[c].itemId);d.length&&(d.eraser("disable"),d.eraser("destroy"),d.remove())},this.clear=function(){if(this.isCleared)return!0;this.isCleared=!0,this.upEvent&&$(document).trigger(this.upEvent);for(var b=a.buttonsIds.length;b--;)h.clearSingleBtn(a.buttonsIds[b]);this.setInitialWipeVals(),k.find('*[data-group-id="'+a.index+'"]').remove()},this.setInitialWipeVals(),this.build(),this},adHandlers.tapGo.tapAction=function(a,b,c){var d=this,e=$(c.el()).find(".vjs-tapgo"),f=!1,g=c.tapGoManager,h=c.playerId.replace("_","")+"tapEvent"+b,i=g.breakBoards.group[a.index]?g.breakBoards.group[a.index].boards:[];return this.upEvent=null,this.pressedBtnIndex=null,this.failBtnsIds=[],this.isCleared=null,this.build=function(){var b,c=a.buttonsIds.length;for(a.succeses=0,a.endActionIndex=parseInt(a.target.attribs.endActionIndex,10),this.isCleared=!1;c--;)b=a.buttons[a.buttonsIds[c]],b.failTime=0,b.failTimeLimit=makeMilliSeconds(a.target.buttonActions[b.index].attribs.failTime),b.el=null,b.hoverTimeout=null,b.count=0,b.attribs.tapCount=parseInt(b.attribs.tapCount,10),b.hasBreakBoard=d.hasBreakBoard(b.index)},this.initEvents=function(){e.on(g.getEventToHandleIt("down",h),'.vjs-tapgo-button[data-group-id="'+a.index+'"]',function(a){return g.preventEventAction(a),!d.upEvent&&!f&&void d.buttonPressedEvent(a,$(this))}),$(document).on(g.getEventToHandleIt("up",h),function(a){return g.preventEventAction(a),!(!d.upEvent||f)&&void d.buttonPressEndEvent(a)}),e.on("tapGoTimerUpdateEvent.tapActionFailTime"+b,function(){d.updateBtnsFailTime()})},this.checkBtnFail=function(b){if(b.failTime<b.failTimeLimit)return!1;var e,f=a.target.buttonActions[b.index],h=f[b.count];if(b.failTime=0,!h||"undefined"==typeof h.attribs.onFailGoTo||"null"===h.attribs.onFailGoTo)return d.resetBtnFailTime(b),!1;if(h.statUrlFail&&c.runTracking(h.statUrlFail),e=parseInt(h.attribs.onFailGoTo,10),isNaN(e))return!1;if(b.count===e)return d.resetBtnFailTime(b),!1;for(b.hasBreakBoard&&(g.breakBoardHandler().stop(b.groupId,b.index),g.breakBoardHandler().start(b.groupId,b.index));b.count>e;)h=f[b.count],h&&g.hideElement(h),b.count--;h=f[e],h&&g.playAction(h),0!==e&&h||d.resetBtnFailTime(b)},this.updateBtnsFailTime=function(){for(var b=d.failBtnsIds.length;b--;)a.buttons[d.failBtnsIds[b]].failTime+=g.tapGoTimerFrequency,d.checkBtnFail(a.buttons[d.failBtnsIds[b]])},this.resetBtnFailTime=function(a){a.failTime=0;var b=d.failBtnsIds.indexOf(a.index);b>=0&&d.failBtnsIds.splice(b,1)},this.clearEvents=function(){e.off("tapGoTimerUpdateEvent.tapActionFailTime"+b),e.off(g.getEventToHandleIt("down",h)),$(document).off(g.getEventToHandleIt("up",h));for(var c,d=a.buttonsIds.length;d--;)c=a.buttons[a.buttonsIds[d]],c.hoverTimeout&&(clearTimeout(c.hoverTimeout),c.hoverTimeout=null)},this.buttonPressedEvent=function(b,c){var e=g.getEventData(b)[0];b.type=e.upEvent,b.originalEvent.type=e.upEvent,b.eventIndex=e.id,d.upEvent=b;var f=a.buttons[c.data("index")];return!!f&&(d.resetBtnFailTime(f),d.pressedBtnIndex=f.index,f.hoverTimeout?(clearTimeout(f.hoverTimeout),f.hoverTimeout=null):f.el||(f.el=c),f.hasBreakBoard&&g.breakBoardHandler().stop(f.groupId,f.index),"success"!==f.count&&f.background.hover&&f.el.attr("src",f.background.hover),void d.nextBtnStep(f))},this.buttonPressEndEvent=function(b){var c=g.getEventData(b)[0];if(!d.upEvent||c.id!==d.upEvent.eventIndex)return!1;var e=a.buttons[d.pressedBtnIndex];"success"!==e.count&&(e.hoverTimeout=setTimeout(function(){"success"!==e.count&&e.background.image&&e.el.attr("src",e.background.image)},100),e.failTimeLimit&&d.failBtnsIds.push(e.index)),e.hasBreakBoard&&g.breakBoardHandler().start(e.groupId,e.index),d.pressedBtnIndex=null,d.upEvent=null},this.hasBreakBoard=function(a){return!!i[a]},this.nextBtnStep=function(b){var c=a.target.buttonActions[b.index];if(!c)return b.hasBreakBoard&&(b.hasBreakBoard=!1),!1;if("success"!==b.count){b.count++;var e=c[b.count]||!1;e.redirect&&(b.redirect=!0),b.count===b.attribs.tapCount&&(b.count="success",b.background.selected&&b.el.attr("src",b.background.selected),b.redirect||a.succeses++,b.hasBreakBoard&&(b.hasBreakBoard=!1,g.breakBoardHandler().clearGroup(b.groupId)),d.resetBtnFailTime(b)),e&&g.playAction(e),a.succeses>=a.endActionIndex&&a.target.finishAction[0]&&(a.target.finishAction[0].attribs.endTapGo?(f=!0,g.playAction(a.target.finishAction[0])):(g.playAction(a.target.finishAction[0]),a.target.finishAction.splice(0,1)))}else c["default"]&&g.playAction(c["default"]),b.hasBreakBoard&&(b.hasBreakBoard=!1,g.breakBoardHandler().removeBoard(b.groupId,b.index))},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,this.upEvent&&$(document).trigger(this.upEvent),this.failBtnsIds=[],this.clearEvents(),void e.find('*[data-group-id="'+a.index+'"]').remove())},this.build(),this},adHandlers.tapGo.shape=function(a,b,c){var d=this,e=$(c.el()).find(".vjs-tapgo"),f=!1,g=c.tapGoManager,h=c.playerId.replace("_","")+"shapeEvent"+b,i=g.breakBoards.group[a.index]?g.breakBoards.group[a.index].boards:[];return i=!!i.length||null,this.upEvent=null,this.canvasBack=null,this.canvasFront=null,this.prevPoint={},this.btnIdsCopy=[],this.currentBtnPath=[],this.checkActionsOrder=!1,this.failColor=null,this.baseColor=null,this.isCleared=null,this.midPointBtw=function(a,b){return{x:a.x+(b.x-a.x)/2,y:a.y+(b.y-a.y)/2}},this.drawLineSegment=function(a,b){if(a.moveTo(this.prevPoint.x,this.prevPoint.y),Math.abs(this.prevPoint.x-b.x)>a.lineWidth||Math.abs(this.prevPoint.y-b.y)>a.lineWidth){var c=this.midPointBtw(this.prevPoint,b);a.quadraticCurveTo(c.x,c.y,b.x,b.y)}else a.quadraticCurveTo(this.prevPoint.x,this.prevPoint.y,b.x,b.y);a.stroke()},this.drawFrontLine=function(a){this.checkCollision(a),a.x-=g.offsetLeft,a.y-=g.offsetTop,this.drawLineSegment(this.canvasFront.ctx,a),this.prevPoint={x:a.x,y:a.y}},this.drawBackLine=function(){this.canvasBack.ctx.drawImage(this.canvasFront.el[0],0,0),this.canvasBack.img.src=this.canvasBack.el[0].toDataURL("image/png"),this.canvasFront.ctx.clearRect(0,0,c.width(),c.height())},this.checkCollision=function(a){return!!d.collision(a)&&(d.checkBtnPath()||(d.canvasFront.ctx.strokeStyle=d.failColor),!0)},this.checkBtnPath=function(){function b(a,b){if(d.checkActionsOrder)return l=new RegExp("^"+b+"(,|$)"),l.test(a);for(b=b.split(","),k=b.length;k--;)if(l=new RegExp("(^|,)"+b[k]+"(,|$)"),!l.test(a))return!1;return!0}var c,h,j,k,l,m=d.actionsIdsCopy.length,n=d.checkActionsOrder?d.currentBtnPath:d.currentBtnPath.sort(),o=d.currentBtnPath.length;for(n=n.join();m--;)if(h=d.actionsIdsCopy[m],b(h,n)){if(c=a.target.actions[h],d.canvasFront.ctx.strokeStyle=c.attribs.lineColor||"#000000",n===h){for(d.drawBackLine(),d.actionsIdsCopy.splice(m,1);o--;)j=a.buttons[d.currentBtnPath[o]],!j.selected&&j.background.selected&&(e.find("#"+j.itemId).attr("src",j.background.selected),j.selected=!0);d.currentBtnPath=[],$(document).trigger(d.upEvent),c.redirect||a.succeses++,g.playAction(c),a.succeses>=a.endActionIndex&&a.target.finishAction[0]&&(a.target.finishAction[0].attribs.endTapGo?(f=!0,i&&(g.breakBoardHandler().stop(a.index,0),g.breakBoardHandler().removeBoard(a.index,0),i=null),g.playAction(a.target.finishAction[0])):(g.playAction(a.target.finishAction[0]),a.target.finishAction.splice(0,1)))}return!0}return!1},this.collision=function(b){for(var c,f=d.btnIdsCopy.length;f--;)if(c=a.buttons[d.btnIdsCopy[f]],b.x>=c.minX&&b.x<=c.maxX&&b.y>=c.minY&&b.y<=c.maxY)return!c.selected&&c.background.hover&&e.find("#"+c.itemId).attr("src",c.background.hover),d.currentBtnPath.push(this.btnIdsCopy[f]),d.btnIdsCopy.splice(f,1),!0;return!1},this.cursorDown=function(b){i&&g.breakBoardHandler().stop(a.index,0);var e=g.getEventData(b)[0];d.prevPoint={x:e.x-g.offsetLeft,y:e.y-g.offsetTop},d.currentBtnPath=[],b.type=e.upEvent,b.originalEvent.type=e.upEvent,b.eventIndex=e.id,d.upEvent=b,d.btnIdsCopy=a.buttonsIds.slice(),d.canvasFront.ctx.clearRect(0,0,c.width(),c.height()),d.canvasFront.ctx.beginPath(),d.canvasFront.ctx.lineJoin=d.canvasFront.ctx.lineCap="round",d.canvasFront.ctx.strokeStyle=d.baseColor,d.canvasFront.ctx.moveTo(e.x-g.offsetLeft,e.y-g.offsetTop)},this.cursorMove=function(a){var b=g.getEventData(a)[0];return b.id===d.upEvent.eventIndex&&void this.drawFrontLine(b)},this.cursorUp=function(b){var f,h=g.getEventData(b)[0],j=d.currentBtnPath.length;if(h.id!==d.upEvent.eventIndex)return!1;for(;j--;)f=a.buttons[d.currentBtnPath[j]],!f.selected&&f.background.image&&e.find("#"+f.itemId).attr("src",f.background.image);d.canvasFront.ctx.closePath(),d.canvasFront.ctx.clearRect(0,0,c.width(),c.height()),d.currentBtnPath=[],d.prevPoint={},d.upEvent=null,i&&(g.breakBoardHandler().hide(a.index,0),g.breakBoardHandler().start(a.index,0))},this.initEvents=function(){d.canvasFront.el.on(g.getEventToHandleIt("down",h),function(a){return g.preventEventAction(a),!d.upEvent&&!f&&void d.cursorDown(a)}),d.canvasFront.el.on(g.getEventToHandleIt("move",h),function(a){return g.preventEventAction(a),!(!d.upEvent||f)&&void d.cursorMove(a)}),$(document).on(g.getEventToHandleIt("up",h),function(a){return g.preventEventAction(a),!(!d.upEvent||f)&&void d.cursorUp(a)})},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,this.upEvent&&$(document).trigger(this.upEvent),this.canvasFront.el.off(g.getEventToHandleIt("down",h)),this.canvasFront.el.off(g.getEventToHandleIt("move",h)),this.canvasFront.ctx=null,this.canvasFront.el.remove(),this.canvasFront=null,this.canvasBack.ctx=null,this.canvasBack.img=null,this.canvasBack.el.remove(),this.canvasBack=null,this.checkActionsOrder=!1,this.failColor=null,this.baseColor=null,this.prevPoint={},e.off("tapGoRescaleEvent.shape"+b),$(document).off(g.getEventToHandleIt("up",h)),i&&(g.breakBoardHandler().stop(a.index,0),g.breakBoardHandler().removeBoard(a.index,0)),e.find('*[data-group-id="'+a.index+'"]').remove(),void(d=i=e=f=g=h=null))},this.handleResize=function(b){if("undefined"!=typeof b&&b)for(var d,e,f,h=a.buttonsIds.length;h--;)d=a.buttons[a.buttonsIds[h]],e=.15*d.realWidth,f=.15*d.realHeight,d.minX=g.roundNum(d.minX+e),d.maxX=g.roundNum(d.maxX-e),d.minY=g.roundNum(d.minY+f),d.maxY=g.roundNum(d.maxY-f);this.canvasBack.el[0].width=this.canvasFront.el[0].width=c.width(),this.canvasBack.el[0].height=this.canvasFront.el[0].height=c.height(),this.canvasBack.ctx.lineWidth=this.canvasFront.ctx.lineWidth=8*g.getRescaleRatio(),this.canvasBack.img.src&&""!==this.canvasBack.img.src&&this.canvasBack.ctx.drawImage(this.canvasBack.img,0,0,this.canvasBack.el[0].width,this.canvasBack.el[0].height)},this.initCanvases=function(){e.append('<canvas id="shape_back_'+b+'" class="tg_shape_canvas" style="z-index: '+(40090+b)+'"/>');var a=e.find("#shape_back_"+b);this.canvasBack={el:a,ctx:a[0].getContext("2d"),img:new Image},e.append('<canvas id="shape_front_'+b+'" class="tg_shape_canvas" style="z-index: '+(40091+b)+'"/>'),a=e.find("#shape_front_"+b),this.canvasFront={el:a,ctx:a[0].getContext("2d")},a=null,this.handleResize()},this.build=function(){a.succeses=0,a.endActionIndex=parseInt(a.target.attribs.endActionIndex,10),this.actionsIdsCopy=a.target.actionsIds.slice(),this.failColor=a.target.attribs.failColor||"#ff0000",this.baseColor=a.target.attribs.baseColor||"#ffffff",this.isCleared=!1,a.target.attribs.checkActionsOrder&&"true"===a.target.attribs.checkActionsOrder&&(this.checkActionsOrder=!0),this.initCanvases(),e.on("tapGoRescaleEvent.shape"+b,function(){d.handleResize(!0)})},this.build(),this},adHandlers.tapGo.shakeBlow=function(a,b,c){var d=this,e=$(c.el()).find(".vjs-tapgo"),f=c.tapGoManager,g=f.breakBoards.group[a.index]?f.breakBoards.group[a.index].boards:[];return g=!!g[0],this.initVals=function(a){var d="undefined"!=typeof a&&a;d&&(c.callFromWebview("stopListenOutsourceData"),e.off("tapGoTimerUpdateEvent.blowShake"+b),c.isWebviewMode()||window.isMobileDevice||e.off("tapGoTimerUpdateEvent.blowShakeTraffic"+b)),this.innerTimerInterval=!1,this.innerTimerValue=0,this.trafficInterval=!0,this.TGcurrentLevel=0,this.TGactionStarted=!1,this.type=null,this.actionsType=null,this.separationTime=0,this.breakTime=0,this.failTime=0,this.backgroundBoard=null,this.endActionIndex=null,this.runData={startTime:null,isPaused:!0,pausedTime:null,active:!1,currentAction:0,nextAction:!1,update:null,pausedStart:null,enableActions:!1},this.minLevel=null,this.limit={time:200,lastActionTime:null}},this.build=function(){var b=a.target;this.type=a.attribs.type,this.actionsType=b.attribs.actionsType,this.separationTime=makeMilliSeconds(b.attribs.separationTime),this.failTime=makeMilliSeconds(b.attribs.failTime),this.endActionIndex=b.attribs.endActionIndex,this.minLevel="blow"==this.type?47:1.55,this.isCleared=!1},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,this.initVals(!0),void e.find('*[data-group-id="'+a.index+'"]').remove())},this.setOutsourceData=function(a){this.run(parseFloat(a))},this.start=function(){if(this.runData.active=!0,c.callFromWebview("startListenOutsourceData",d.type,250),"time"===d.actionsType&&e.on("tapGoTimerUpdateEvent.blowShake"+b,function(){d.innerTimerInterval&&(d.innerTimerValue+=f.tapGoTimerFrequency,d.checkActions())}),!c.isWebviewMode()&&!window.isMobileDevice){e.on("tapGoTimerUpdateEvent.blowShakeTraffic"+b,function(){d.trafficInterval&&d.run(d.TGcurrentLevel)});var a=function(){var a=new Date;return a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()};$(e).dblclick(function(){d.TGactionStarted||(f.debug("%c START - "+a(),1),d.TGactionStarted=!0,d.TGcurrentLevel=76)}),$(e).click(function(){d.TGactionStarted&&(f.debug("%c STOP - "+a(),1),d.TGactionStarted=!1,d.TGcurrentLevel=0)})}},this.checkPause=function(){if(!this.runData.active)return void f.debug("-- FINISHED -- ");if(this.runData.isPaused&&this.runData.startTime){if(this.runData.pausedTime>this.failTime)return void this.badPaused();"quantity"==this.actionsType&&this.runData.enableActions&&this.checkActions(),this.runData.pausedTime=this.runData.pausedStart-this.runData.update}},this.isTargetAchieved=function(){return this.runData.currentAction==this.endActionIndex?(e.off("tapGoTimerUpdateEvent.blowShake"+b),c.isWebviewMode()||window.isMobileDevice||e.off("tapGoTimerUpdateEvent.blowShakeTraffic"+b),this.runData.active=!1,this.trafficInterval=!1,this.innerTimer().pause(),c.callFromWebview("stopListenOutsourceData"),g&&(f.breakBoardHandler().stop(a.index,0),f.breakBoardHandler().removeBoard(a.index,0),g=!1),void f.playAction(a.target.finishAction[0])):void this.runData.currentAction++},this.checkActions=function(){var b,c,d=this.innerTimerValue,e=!1,g=!1;0===this.runData.currentAction&&(f.debug("> Trwa akcja 1"),this.runData.currentAction=1),this.runData.enableActions&&(b=this.getCurrentAction(),g="quantity"==this.actionsType&&this.runData.pausedTime&&this.runData.pausedTime>50&&this.runData.startTime,b?(c=!!b.attribs.actionTime&&makeMilliSeconds(b.attribs.actionTime),e="time"==this.actionsType&&c&&d>=c&&!b.showed,(e||g&&!b.showed)&&(g&&(this.runData.enableActions=!1,this.runData.pausedTime=0),f.playAction(b),a.target.actions[b.index].showed=!0,f.debug("SUKCES ["+this.runData.currentAction+"] - wyświetlam zawartość akcji",!0),f.debug("> Trwa akcja  "+(this.runData.currentAction+1)),this.isTargetAchieved())):g&&(this.runData.enableActions=!1,this.runData.pausedTime=0,f.debug("Brak zdefiniowanej akcji o indeksie "+this.runData.currentAction,!0),f.debug("> Trwa akcja  "+(this.runData.currentAction+1)),this.isTargetAchieved()))},this.badPaused=function(){var b=this.getCurrentAction();if(!b)return f.debug("FAIL ["+this.runData.currentAction+"] - akcja nie określona w VAST. Zostaje w miejscu, bez trackingu"),this.runData.pausedStart=Date.now(),this.runData.pausedTime=0,void(this.runData.update=Date.now());var h,i,j,k=parseInt(b.attribs.onFailGoTo,10);if(isNaN(k))this.runData.countFail&&(f.debug("-- FAIL -- ["+this.runData.currentAction+"] - zostaje w miejscu"),c.runTracking(b.statUrlFail),this.runData.countFail=!1);else{for(f.debug("-- FAIL -- ["+this.runData.currentAction+"] - goTo ["+k+"]"),this.runData.lastFailAction!=this.runData.currentAction&&(this.runData.countFail=!0,this.runData.lastFailAction=this.runData.currentAction),this.runData.countFail&&c.runTracking(b.statUrlFail),h=a.target.actions[k],h&&this.runData.countFail&&(this.runData.lastFailAction=k+1,f.playAction(h),f.debug("Wyświetlam akcję "+h.attribs.index),this.runData.countFail=!1,g&&(f.breakBoardHandler().hide(a.index,0),f.breakBoardHandler().start(a.index,0)),"time"===this.actionsType&&h.attribs.actionTime&&(this.innerTimerValue=makeMilliSeconds(h.attribs.actionTime),f.debug("- - FAIL ["+this.runData.currentAction+"] - ustawiam czas na "+this.innerTimerValue))),j=d.runData.currentAction;j>k;)i=a.target.actions[j],i&&(i.showed=!1,e.find("#"+i.itemId).hide()),j--;this.runData.currentAction=k+1,f.debug("> Trwa akcja "+this.runData.currentAction)}this.runData.pausedStart=Date.now(),this.runData.pausedTime=0,this.runData.update=Date.now()},this.run=function(b){if(!this.runData.active)return void f.debug("-- FINISHED -- ");if(this.limit.lastActionTime<Date.now()-this.limit.time){if(this.runData.isPaused&&b<=this.minLevel||"time"==this.actionsType&&(this.runData.pausedTime=0),b>this.minLevel){if(g&&(f.breakBoardHandler().hide(a.index,0),f.breakBoardHandler().start(a.index,0)),null===this.runData.startTime&&(this.runData.startTime=Date.now()),this.runData.isPaused){switch(this.actionsType){case"time":this.runData.enableActions=this.runData.pausedTime<=this.separationTime,this.innerTimer().start();break;case"quantity":this.runData.enableActions=!0}this.runData.isPaused=!1}this.runData.update=Date.now()}else b<=this.minLevel&&(this.runData.isPaused||(this.runData.isPaused=!0,this.innerTimer().pause()),this.runData.pausedStart=Date.now());this.checkPause(),this.limit.lastActionTime=Date.now()}},this.innerTimer=function(){return{start:function(){d.innerTimerInterval=!0},pause:function(){d.innerTimerInterval=!1},reset:function(){this.pause(),d.innerTimerValue=0}}},this.getCurrentAction=function(){return a.target.actions[this.runData.currentAction]||!1},this.getAction=function(b){return a.target.actions[b]||!1},this.initEvents=function(){this.start()},this.initVals(),this.build(),this},adHandlers.tapGo.multitouch=function(a,b,c){var d=this,e=c.tapGoManager,f=$(c.el()).find(".vjs-tapgo"),g=a.buttonsIds,h=a.buttons;return this.clearData=function(){this.upEvent=null,this.pressedBtns=null,this.succeedActions=null,this.cursors=null,this.eventId=null,this.isFinishActionDone=null,this.lastAction=null},this.arrGetBtn=function(a){return h[g[a]]},this.initData=function(){for(var e,h=g.length;h--;)e=d.arrGetBtn(h),e.currState="image",e.el=f.find("#"+e.itemId);this.eventId=c.playerId.replace("_","")+"multiEvent"+b,this.isCleared=!1,this.upEvent={},this.pressedBtns=[],this.succeedActions={count:0},this.cursors={ids:[],empty:!0,list:{}},this.isFinishActionDone=!1,a.target.attribs.endActionIndex=parseInt(a.target.attribs.endActionIndex,10)},this.setBtnImage=function(a,b){return!!a.el&&(a.currState=b,a.el.attr("src",a.background[b]),!0)},this.setButtonStateImage=function(a){a.pressed?"image"===a.currState&&a.background.hover&&this.setBtnImage(a,"hover"):"hover"===a.currState&&a.background.image&&this.setBtnImage(a,"image")},this.unsetCursor=function(a){var b=this.cursors.ids.indexOf(a);this.cursors.ids.splice(b,1),this.cursors.list[a]=null,this.upEvent[a]=null},this.whichButtonsArePressed=function(){var a,b,c,e,f=this.cursors.ids.slice(),h=this.cursors.list,i=g.length;for(this.pressedBtns=[];i--;){for(b=d.arrGetBtn(i),b.pressed=!1,a=f.length;a--;)if(c=h[f[a]].x,e=h[f[a]].y,c>=b.minX&&c<=b.maxX&&e>=b.minY&&e<=b.maxY){b.pressed=!0,this.pressedBtns.push(b.index),f.splice(a,1);break}this.setButtonStateImage(b)}this.pressedBtns.length&&this.pressedBtns.sort()},this.checkActions=function(){var b,c=this.pressedBtns.join();return c!==this.lastAction&&(this.lastAction=c,b=a.target.actions[c],b&&(this.succeedActions[c]||(this.succeedActions[c]=!0,b.redirect||this.succeedActions.count++),e.playAction(b)),void(!this.isFinishActionDone&&this.succeedActions.count>=a.target.attribs.endActionIndex&&(this.isFinishActionDone=!0,b=parseInt(a.target.finishActionsIds[0],10),isNaN(b)||e.playAction(a.target.finishAction[b]))))},this.cursorDown=function(a){var b,c=e.getEventData(a),d=c.length;for(a.type=c[0].upEvent,a.originalEvent.type=c[0].upEvent;d--;)b=c[d],this.cursors.list[b.id]?this.cursors.list[b.id]=b:(a.eventIndex=b.id,this.cursors.ids.push(b.id),this.cursors.list[b.id]=b,this.upEvent[b.id]=a);this.cursors.empty=!1,this.whichButtonsArePressed(),this.checkActions()},this.cursorMove=function(a){for(var b,c=e.getEventData(a),d=c.length,f=this.cursors.list,g=!1;d--;)b=c[d],f[b.id]&&(f[b.id]=b,g=!0);g&&(this.whichButtonsArePressed(),this.checkActions())},this.cursorUp=function(a){for(var b,c=e.getEventData(a),d=c.length,f=this.cursors.list,g=!1;d--;)b=c[d],f[b.id]&&(this.unsetCursor(b.id),g=!0);this.cursors.ids.length||(this.cursors.empty=!0),g&&this.whichButtonsArePressed(),this.lastAction=this.pressedBtns.join()},this.initEvents=function(){f.on(e.getEventToHandleIt("down",this.eventId),function(a){e.preventEventAction(a),d.cursorDown(a)}),f.on(e.getEventToHandleIt("move",this.eventId),function(a){return e.preventEventAction(a),!!d.cursors.empty||void d.cursorMove(a)}),$(document).on(e.getEventToHandleIt("up",this.eventId),function(a){return e.preventEventAction(a),!!d.cursors.empty||void d.cursorUp(a)})},this.build=function(){this.clearData(),this.initData()},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,e.triggerSingleTapGoUpEvent(e.multitouch[b]),f.off(e.getEventToHandleIt("down",this.eventId)),f.off(e.getEventToHandleIt("move",this.eventId)),$(document).off(e.getEventToHandleIt("up",this.eventId)),f.find('*[data-group-id="'+a.index+'"]').remove(),void this.clearData())},this.build(),this},adHandlers.tapGo.hold=function(a,b,c){var d=this,e=$(c.el()).find(".vjs-tapgo"),f=!1,g=c.tapGoManager,h=c.playerId.replace("_","")+"holdEvent"+b,i=g.breakBoards.group[a.index]?g.breakBoards.group[a.index].boards:[];return this.upEvent=null,this.pressedBtnIndex=null,this.holdIntervalFreq=g.tapGoTimerFrequency,this.failBtnsIds=[],this.sumUpDuration=null,this.isCleared=null,this.build=function(){a.succeses=0,a.endActionIndex=parseInt(a.target.attribs.endActionIndex,10),a.btnsActonsTime=[],this.sumUpDuration=!1,this.isCleared=!1;for(var b,c,e,f,g,h=a.buttonsIds.length;h--;)for(c=a.target.buttonActions[a.buttonsIds[h]].buttonActionsIds,b=c.length,a.btnsActonsTime[a.buttonsIds[h]]=[],g=a.buttons[a.buttonsIds[h]],g.hoverTimeout=null,g.holdTime=0,g.lastAction=0,g.attribs.holdDuration=1e3*parseFloat(g.attribs.holdDuration),g.hasBreakBoard=d.hasBreakBoard(g.index),g.failTime=0,g.failTimeLimit=makeMilliSeconds(a.target.buttonActions[g.index].attribs.failTime);b--;)"default"!==c[b]&&(e=a.target.buttonActions[a.buttonsIds[h]][c[b]],f=e.attribs.actionTime?makeMilliSeconds(e.attribs.actionTime):0,a.btnsActonsTime[a.buttonsIds[h]][f]=c[b])},this.initEvents=function(){e.on(g.getEventToHandleIt("down",h),'.vjs-tapgo-button[data-group-id="'+a.index+'"]',function(a){return g.preventEventAction(a),!d.upEvent&&!f&&void d.buttonPressedEvent(a,$(this))}),$(document).on(g.getEventToHandleIt("up",h),function(a){return g.preventEventAction(a),!(!d.upEvent||f)&&void d.buttonPressEndEvent(a)}),e.on("tapGoTimerUpdateEvent.holdEvent"+b,function(){d.nextBtnStep()}),e.on("tapGoTimerUpdateEvent.holdFailTime"+b,function(){d.updateBtnsFailTime()})},this.checkBtnFail=function(b){if(b.failTime<b.failTimeLimit)return!1;var e,f,h,i,j=a.target.buttonActions[b.index],k=j[b.lastAction];if(b.failTime=0,!k||"undefined"==typeof k.attribs.onFailGoTo||"null"===k.attribs.onFailGoTo)return d.resetBtnFailTime(b),!1;if(k.statUrlFail&&c.runTracking(k.statUrlFail),e=parseInt(k.attribs.onFailGoTo,10),isNaN(e))return!1;if(b.lastAction===e)return d.resetBtnFailTime(b),!1;if(b.hasBreakBoard&&(g.breakBoardHandler().stop(b.groupId,b.index),g.breakBoardHandler().start(b.groupId,b.index)),k=j[e]){for(b.lastAction=e,f=k.attribs.actionTime?makeMilliSeconds(k.attribs.actionTime):0,i=a.btnsActonsTime[b.index];b.holdTime>f;)h=i[b.holdTime]||null,null!==h&&g.hideElement(j[h]),b.holdTime-=g.tapGoTimerFrequency;g.playAction(k)}0!==e&&k||d.resetBtnFailTime(b)},this.updateBtnsFailTime=function(){for(var b=d.failBtnsIds.length;b--;)a.buttons[d.failBtnsIds[b]].failTime+=g.tapGoTimerFrequency,d.checkBtnFail(a.buttons[d.failBtnsIds[b]])},this.resetBtnFailTime=function(a){a.failTime=0;var b=d.failBtnsIds.indexOf(a.index);b>=0&&d.failBtnsIds.splice(b,1)},this.clearEvents=function(){e.off("tapGoTimerUpdateEvent.holdFailTime"+b),e.off("tapGoTimerUpdateEvent.holdEvent"+b),e.off(g.getEventToHandleIt("down",h)),$(document).off(g.getEventToHandleIt("up",h));for(var c,d=a.buttonsIds.length;d--;)c=a.buttons[a.buttonsIds[d]],c.hoverTimeout&&(clearTimeout(c.hoverTimeout),c.hoverTimeout=null)},this.buttonPressedEvent=function(b,c){var e=g.getEventData(b)[0];b.type=e.upEvent,b.originalEvent.type=e.upEvent,b.eventIndex=e.id,d.upEvent=b;var f=a.buttons[c.data("index")];return!!f&&(d.resetBtnFailTime(f),f.hoverTimeout?(clearTimeout(f.hoverTimeout),f.hoverTimeout=null):f.el||(f.el=c),f.hasBreakBoard&&g.breakBoardHandler().stop(f.groupId,f.index),"success"!==f.holdTime&&f.background.hover&&f.el.attr("src",f.background.hover),void(d.pressedBtnIndex=f.index))},this.hasBreakBoard=function(a){return!!i[a]},this.buttonPressEndEvent=function(b){var c=g.getEventData(b)[0];if(!d.upEvent||c.id!==d.upEvent.eventIndex)return!1;var e=a.buttons[d.pressedBtnIndex];"success"!==e.holdTime&&(d.sumUpDuration||(e.holdTime=0),e.hoverTimeout=setTimeout(function(){"success"!==e.holdTime&&e.background.image&&e.el.attr("src",e.background.image)},100),e.failTimeLimit&&d.failBtnsIds.push(e.index)),e.hasBreakBoard&&g.breakBoardHandler().start(e.groupId,e.index),d.pressedBtnIndex=null,d.upEvent=null},this.nextBtnStep=function(){if(null===this.pressedBtnIndex)return!1;var c,h,i=a.buttons[this.pressedBtnIndex],j=a.target.buttonActions[i.index];return i&&j?void("success"!==i.holdTime?(h=a.btnsActonsTime[i.index][i.holdTime]||null,c=null!==h&&j[h],i.holdTime>=i.attribs.holdDuration?(i.holdTime="success",i.background.selected&&i.el.attr("src",i.background.selected),c&&!c.redirect&&a.succeses++,i.hasBreakBoard&&(i.hasBreakBoard=!1,g.breakBoardHandler().clearGroup(i.groupId)),d.resetBtnFailTime(i)):i.holdTime+=d.holdIntervalFreq,c&&(i.lastAction=c.index,g.playAction(c)),a.succeses>=a.endActionIndex&&a.target.finishAction[0]&&(a.target.finishAction[0].attribs.endTapGo?(f=!0,e.off("tapGoTimerUpdateEvent.holdEvent"+b),g.playAction(a.target.finishAction[0])):(g.playAction(a.target.finishAction[0]),a.target.finishAction.splice(0,1)))):(j["default"]&&(g.playAction(j["default"]),$(document).trigger(this.upEvent)),i.hasBreakBoard&&(i.hasBreakBoard=!1,g.breakBoardHandler().removeBoard(i.groupId,i.index)))):(i.hasBreakBoard&&(i.hasBreakBoard=!1),!1)},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,this.upEvent&&$(document).trigger(this.upEvent),this.clearEvents(),e.find('*[data-group-id="'+a.index+'"]').remove(),this.upEvent=null,this.failBtnsIds=[],this.pressedBtnIndex=null,void(this.sumUpDuration=null))},this.build(),this},adHandlers.tapGo.move=function(a,b,c){this.eventId=c.playerId.replace("_","")+"moveEvent"+b,this.group=a,this.isCleared=null;var d,e,f=0,g=0,h=0,i=0,j=c.tapGoManager,k=$(c.el()),l=k.find(".vjs-tapgo"),m=this;return this.build=function(){this.lastZIndex=c.tapGoManager.zIndex.button+a.buttonsIds.length,this.selected=null,this.isCleared=!1},this.drag_init=function(a,b){m.selected=a,m.setCursorPos[j.supportedEvents](b),h=f-m.selected.offsetLeft,i=g-m.selected.offsetTop},this.getPositions=function(a){var b,c,d;return b=$(a).position(),c=$(a).width(),d=$(a).height(),[[b.left,b.left+c],[b.top,b.top+d]]},this.comparePositions=function(a,b){var c,d;return c=a[0]<b[0]?a:b,d=a[0]<b[0]?b:a,c[1]>d[0]||c[0]===d[0]},this.collision=function(a,b){var c=m.getPositions(a),d=m.getPositions(b);return m.comparePositions(c[0],d[0])&&m.comparePositions(c[1],d[1]);
},this.setCursorPos={touch:function(a){var b=a.originalEvent.touches[0];f=b.pageX,g=b.pageY},pointer:function(a){var b=a.originalEvent;f=b.pageX,g=b.pageY},mouse:function(a){f=a.pageX,g=a.pageY}},this.nextStep=function(b){function c(a){if(this.indexOf(a)>=0)return!0}var d=a.target,e=[];b.attr({src:b.data("background-image")});for(var f,g,h=a.goalsIds.length,i=a.goalsIds,k=a.goals;h--;){var l=$("#"+k[i[h]].itemId);m.collision(b,l)&&(f=b.data("index")+l.data("index"),g=d.actions[f],g&&(j.playAction(g),b.attr({src:b.data("background-selected")})));for(var n=a.buttonsIds.length,o=a.buttonsIds,p=a.buttons;n--;){var q=$("#"+p[o[n]].itemId);m.collision(l,q)&&(f=q.data("index")+l.data("index"),g=d.actions[f],g&&"undefined"==typeof g.Url&&e.push(f))}}for(var r=d.finishActionsIds.length;r--;){var s=d.finishAction[d.finishActionsIds[r]].index.split(",");if(s.every(c,e)){if(d.finishAction[d.finishActionsIds[r]].fire)continue;d.finishAction[d.finishActionsIds[r]]&&(d.finishAction[d.finishActionsIds[r]].attribs.endTapGo?j.playAction(d.finishAction[d.finishActionsIds[r]]):(j.playAction(d.finishAction[d.finishActionsIds[r]]),d.finishAction[d.finishActionsIds[r]].fire=!0))}}},this.initEvents=function(){k.on(j.getEventToHandleIt("down",m.eventId),'.vjs-tapgo-button[data-group-id="'+a.index+'"]',function(a){j.preventEventAction(a);var b=$(this);if(!b.attr("data-selected"))return m.lastZIndex++,b.css({"z-index":m.lastZIndex}),m.drag_init(this,a),!1}),k.on(j.getEventToHandleIt("up",m.eventId),'.vjs-tapgo-button[data-group-id="'+a.index+'"]',function(a){j.preventEventAction(a),d=l.find(".vjs-goal"),e=l.find(".vjs-tapgo-button");var b=$(this);b.attr("data-selected")||(b.attr({src:b.data("background-hover")}),m.selected=null,m.nextStep(b))}),k.on(j.getEventToHandleIt("move",m.eventId),'.vjs-tapgo-button[data-group-id="'+a.index+'"]',function(a){j.preventEventAction(a),null!==m.selected&&(m.setCursorPos[j.supportedEvents](a),m.selected.style.left=f-h+"px",m.selected.style.top=g-i+"px")})},this.clearEvents=function(){k.off(j.getEventToHandleIt("down",m.eventId)),k.off(j.getEventToHandleIt("up",m.eventId)),k.off(j.getEventToHandleIt("move",m.eventId))},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,this.clearEvents(),void l.find('*[data-group-id="'+a.index+'"]').remove())},this.build(),this},adHandlers.tapGo.imageSlider=function(a,b,c){var d=this,e=$(c.el()).find(".vjs-tapgo"),f=!1,g=c.tapGoManager,h=c.playerId.replace("_","")+"slideEvent"+b;return this.upEvent=null,this.line=null,this.element=null,this.pressedBtnIndex=null,this.failBtnsIds=[],this.currSide=!1,this.slideCount=0,this.isCleared=null,this.build=function(){d.buildView(),a.succeses=0,a.endActionIndex=parseInt(a.target.attribs.endActionIndex,10),d.element=$("#"+a.slides.itemId).find(".image:first"),d.element.css({width:"50%"}),this.isCleared=!1},this.buildView=function(){a.slides.attribs.groupId=a.index,g.buildItem(a.slides);for(var b=a.slidesIds,c=b.length||0,d=$("#"+a.slides.itemId);c--;){var e=a.slides[b[c]];console.log(e);var f=$('<div class="image" />');f.addClass(e.attribs.position);var h=$(new Image);h.attr({src:e.background.image}),f.css({top:0,left:0}),"right"==e.attribs.position?f.css({"z-index":"-1"}):f.css({border:"1px"}),f.append(h),d.append(f),d.find(".left").css({color:"#333",width:"50%"})}var i=$('<div class="vjs-tapgo-line">');i.css({background:a.slides.attribs.lineColor,position:"absolute","z-index":"1"}),i.attr({"data-group-id":a.index}),"vertical"==a.slides.attribs.orientation?i.css({width:a.slides.attribs.lineWidth+"px",height:"100%",left:"50%"}):i.css({height:a.slides.attribs.lineWidth+"px",width:"100%",top:"50%"}),d.append(i)},this.initEvents=function(){e.on(g.getEventToHandleIt("down",h),'.vjs-tapgo-line[data-group-id="'+a.index+'"]',function(a){return g.preventEventAction(a),console.log("tap"),!d.upEvent&&!f&&void d.buttonPressedEvent(a,$(this))}),e.on(g.getEventToHandleIt("move",h),function(a){return g.preventEventAction(a),!(!d.upEvent||f)&&void d.sliderMove(a)}),$(document).on(g.getEventToHandleIt("up",h),function(a){return console.log(d.slideCount),g.preventEventAction(a),!(!d.upEvent||f)&&void d.buttonPressEndEvent(a)})},this.clearEvents=function(){e.off("tapGoTimerUpdateEvent.initSlideAction"+b),e.off(g.getEventToHandleIt("down",h)),$(document).off(g.getEventToHandleIt("up",h))},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,void this.clearEvents())},this.sliderMove=function(b){var c=g.getEventData(b)[0];return c.id===d.upEvent.eventIndex&&(c.x-=g.offsetLeft+2*a.slides.attribs.x,c.y-=g.offsetTop+2*a.slides.attribs.y,console.log(c),void("vertical"==a.slides.attribs.orientation?(c.x>=0&&c.x<=a.slides[1].realWidth-a.slides.attribs.lineWidth&&(d.line.css({left:c.x+"px"}),d.element.css({width:c.x+"px"})),c.x<=a.slides.attribs.lineWidth&&"left"!=d.currSide&&(d.currSide="left",d.slideCount++),c.x>=a.slides[1].realWidth-a.slides.attribs.lineWidth&&"right"!=d.currSide&&(d.currSide="right",d.slideCount++)):(d.line.css({top:c.y+"px"}),d.element.css({height:c.y+"px"}))))},this.buttonPressedEvent=function(a,b){var c=g.getEventData(a)[0];a.type=c.upEvent,a.originalEvent.type=c.upEvent,a.eventIndex=c.id,d.upEvent=a,d.line=b},this.buttonPressEndEvent=function(a){var b=g.getEventData(a)[0];return!(!d.upEvent||b.id!==d.upEvent.eventIndex)&&void(d.upEvent=null)},this.build(),this},adHandlers.tapGo.draw=function(a,b,c){var d,e=this,f=$(c.el()).find(".vjs-tapgo"),g=!1,h=c.tapGoManager,i=c.playerId.replace("_","")+"drawEvent"+b,j=!(!h.breakBoards.group[a.index]||!h.breakBoards.group[a.index].boards[0])||null;return this.clearVars=function(){this.canvas=null,this.brush=null,this.brushData=null,this.upEvent=null,this.prevPoint=null,this.showEraser=null,this.drawTime=null,this.actionsTimes=null},this.setColor=function(a){return!!this.brushData.colors[a]&&(this.canvas.ctx.globalCompositeOperation="source-over",this.canvas.ctx.strokeStyle=this.brushData.colors[a],this.brush.color=this.brushData.colors[a],!0)},this.changeColor=function(a){this.setColor(a.data("id"))&&(d.find(".tg_draw_eraser.selected").removeClass("selected"),d.find(".tg_draw_brush_colors").addClass("selected"),d.find(".tg_draw_brush_color.selected").removeClass("selected"),a.addClass("selected"))},this.setBrushSize=function(a){return!!this.brushData.sizes[a]&&(this.canvas.ctx.lineWidth=this.brushData.sizes[a],this.brush.size=this.brushData.sizes[a],this.brush.sizeId=a,!0)},this.changeBrushSize=function(a){this.setBrushSize(a.data("id"))&&(f.find('.tg_draw_wrapper[data-ad-id="'+b+'"] .tg_draw_brush_size').removeClass("selected"),a.addClass("selected"))},this.changeToEraser=function(){this.canvas.ctx.globalCompositeOperation="destination-out",d.find(".tg_draw_brush_colors.selected").removeClass("selected"),d.find(".tg_draw_brush_color.selected").removeClass("selected"),d.find(".tg_draw_eraser").addClass("selected")},this.calculateEventData=function(a){a.x-=this.canvas.minX,a.y-=this.canvas.minY},this.isCursorOnTheCanvas=function(a){return a.x>=this.canvas.minX&&a.x<=this.canvas.maxX&&a.y>=this.canvas.minY&&a.y<=this.canvas.maxY},this.drawLine=function(a){this.canvas.ctx.moveTo(this.prevPoint.x,this.prevPoint.y),this.canvas.ctx.quadraticCurveTo(this.prevPoint.x,this.prevPoint.y,a.x,a.y),this.canvas.ctx.stroke()},this.saveCanvasAsImage=function(){this.canvas.img.src=this.canvas.el[0].toDataURL("image/png")},this.setElementDataAttribs=function(a,b,c,d,e){a.addClass("vjs-tapgo-board").attr({"data-x":b,"data-y":c,"data-width":d,"data-height":e})},this.getDataAttribsText=function(a,b,c,d){return'data-x="'+a+'" data-y="'+b+'" data-width="'+c+'" data-height="'+d+'"'},this.createListElem=function(b,c,d){var e=$('<li class="'+b+(0===c?" selected":"")+'" data-group-id="'+a.index+'"></li>');return this.setElementDataAttribs(e,0,0,60,60),"tg_draw_brush_color"===b?e.attr("data-id",c).append('<span class="vjs-tapgo-board" data-x="0" data-y="0" data-width="38" data-height="38" style="background: '+d[c]+'"></span>'):e.attr("data-id",d[c]).append('<span class="vjs-tapgo-board" data-x="0" data-y="0" data-width="'+d[c]+'" data-height="'+d[c]+'"></span>'),e},this.createDrawInterface=function(a){function c(a,b){var c=l("div","tg_draw_panel_box "+a)+l("div","tg_draw_panel_link","link_left")+l("span","tg_draw_icon "+b,"link_ico")+"</span></div>";return"eraser"!==b&&(c+=l("div","tg_draw_panel_link","link_right")+l("span","tg_draw_icon arrow","link_arrow")+"</span></div><ul></ul>"),c+"</div>"}var g,h,i,j,k=0,l=function(){var a={panel:e.getDataAttribsText(0,0,80,406),link_left:e.getDataAttribsText(0,0,60,60),link_right:e.getDataAttribsText(0,0,20,60),link_ico:e.getDataAttribsText(0,0,40,40),link_arrow:e.getDataAttribsText(0,0,13,19)};return function(b,c,d){return"<"+b+' class="'+c+(d?' vjs-tapgo-board" '+a[d]:'"')+" >"}}();for(g=$('<div data-ad-id="'+b+'" class="tg_draw_wrapper"></div>').css({"z-index":50900+b}).hide(),g.append('<canvas class="tg_draw_canvas"/>'+l("div","tg_draw_panel tg_draw_panel_"+("undefined"!=typeof a?a:"left"),"panel")+"</div>"),i=g.find(".tg_draw_panel"),i.append(c("tg_draw_brush_colors selected","pen")),i.append(c("tg_draw_brush_sizes","line_size")),this.showEraser&&i.append(c("tg_draw_eraser","eraser")),i=g.find(".tg_draw_brush_sizes ul"),h=this.brushData.ids.length,k;k<h;k++)j=this.createListElem("tg_draw_brush_size",k,this.brushData.ids),i.append(j);for(i=g.find(".tg_draw_brush_colors ul"),h=this.brushData.colors.length,k=0;k<h;k++)j=this.createListElem("tg_draw_brush_color",k,this.brushData.colors),i.append(j);f.append(g),d=f.find('.tg_draw_wrapper[data-ad-id="'+b+'"]'),j=d.find(".tg_draw_canvas"),this.canvas.el=j,this.canvas.ctx=j[0].getContext("2d"),this.setColor(0)},this.handleResize=function(){function a(a){a.el[0].width=parseInt(a.width*c,10),a.el[0].height=parseInt(a.height*c,10),a.el.css({left:parseInt(a.x*c,10),top:parseInt(a.y*c,10)}),a.img.src&&""!==a.img.src&&a.ctx.drawImage(a.img,0,0,a.el[0].width,a.el[0].height),a.minX=h.offsetLeft+parseInt(a.el.css("left"),10),a.maxX=a.minX+a.el[0].width,a.minY=h.offsetTop+parseInt(a.el.css("top"),10),a.maxY=a.minY+a.el[0].height}function b(a){for(var b=a.ids.length;b--;)a.sizes[a.ids[b]]=parseInt(a.ids[b]*c,10);e.setBrushSize(e.brush.sizeId)}var c=h.getRescaleRatio();a(this.canvas),b(this.brushData)},this.parseActionsTimes=function(){var b,c,d=a.target.actionsIds?a.target.actionsIds.length:0;if(d)for(this.actionsTimes={};d--;)b=a.target.actions[a.target.actionsIds[d]],c=b.attribs.actionTime?makeMilliSeconds(b.attribs.actionTime):0,this.actionsTimes[c]=a.target.actionsIds[d]},this.init=function(){var b=a.target.attribs.brushSizes&&a.target.attribs.brushSizes.length?a.target.attribs.brushSizes.split(/\s*[;,]\s*/):[8],c=a.target.attribs.interfaceSide?a.target.attribs.interfaceSide.toLowerCase():"left",d=h.getRescaleRatio(),e=b.length;for(this.canvas={img:new Image,x:a.target.attribs.x?parseInt(a.target.attribs.x,10):0,y:a.target.attribs.y?parseInt(a.target.attribs.y,10):0,width:a.target.attribs.width?parseInt(a.target.attribs.width,10):720,height:a.target.attribs.height?parseInt(a.target.attribs.height,10):405},this.brushData={sizes:{},ids:[]},this.brushData.colors=a.target.attribs.brushColors&&a.target.attribs.brushColors.length?a.target.attribs.brushColors.split(/\s*[;,]\s*/):["#000000"];e--;)b[e]=parseInt(b[e],10);b.sort(function(a,b){return a>b}),e=b.length;for(var f=0;f<e;f++)this.brushData.sizes[b[f]]=parseInt(b[f]*d,10),this.brushData.ids.push(b[f]);this.brush={size:this.brushData.ids[0],sizeId:this.brushData.ids[0],color:this.brushData.colors[0]},this.prevPoint={x:null,y:null},this.drawTime={enabled:!1,time:0},this.parseActionsTimes(),this.createDrawInterface(c),this.handleResize()},this.checkDrawTimeAction=function(b){this.actionsTimes[b]&&h.playAction(a.target.actions[this.actionsTimes[b]])},this.pointerDown=function(b){var c=h.getEventData(b)[0],f=d.find(".tg_draw_panel_box.tg_draw_dropdown_open");return j&&h.breakBoardHandler().stop(a.index,0),f.length?(f.each(function(){e.hidePanelDropDownMenu($(this))}),!0):(b.type=c.upEvent,b.originalEvent.type=c.upEvent,b.eventIndex=c.id,e.upEvent=b,void(e.isCursorOnTheCanvas(c)?(e.calculateEventData(c),e.canvas.ctx.beginPath(),e.canvas.ctx.lineJoin=e.canvas.ctx.lineCap="round",e.canvas.ctx.strokeStyle=e.brush.color,e.prevPoint={x:c.x-.1,y:c.y},e.drawLine(c),e.drawTime.time+=h.tapGoTimerFrequency,e.actionsTimes&&e.checkDrawTimeAction(e.drawTime.time),e.drawTime.enabled=!0):(e.drawTime.enabled=!1,e.prevPoint={x:null,y:null})))},this.pointerMove=function(a){if(!e.upEvent)return!1;var b=h.getEventData(a)[0];return b.id===e.upEvent.eventIndex&&void(e.isCursorOnTheCanvas(b)?(e.drawTime.enabled=!0,e.calculateEventData(b),e.prevPoint.x&&e.prevPoint.y?(e.drawLine(b),e.prevPoint={x:b.x,y:b.y}):(e.prevPoint={x:b.x,y:b.y},e.canvas.ctx.beginPath())):(e.drawTime.enabled=!1,e.prevPoint={x:null,y:null},e.canvas.ctx.closePath()))},this.pointerUp=function(b){if(!e.upEvent)return!1;var c=h.getEventData(b)[0];return c.id===e.upEvent.eventIndex&&(e.drawTime.enabled=!1,e.upEvent=null,e.canvas.ctx.closePath(),e.prevPoint={x:null,y:null},e.saveCanvasAsImage(),void(j&&h.breakBoardHandler().start(a.index,0)))},this.showPanelDropDownMenu=function(a){var b=a.find("ul"),c=b.css({opacity:"0",visibility:"hidden",width:"auto"}).width();a.addClass("tg_draw_dropdown_open"),b.css({width:"0",opacity:"1",visibility:"visible"}).animate({width:c},200)},this.hidePanelDropDownMenu=function(a){a.find("ul").animate({width:"0"},200,function(){a.removeClass("tg_draw_dropdown_open")})},this.panelBoxPressed=function(a){a.siblings(".tg_draw_dropdown_open").each(function(){e.hidePanelDropDownMenu($(this))}),a.hasClass("tg_draw_eraser")?this.changeToEraser():a.hasClass("tg_draw_dropdown_open")?this.hidePanelDropDownMenu(a):this.showPanelDropDownMenu(a)},this.initEvents=function(){d.on(h.getEventToHandleIt("down",i),function(a){return h.preventEventAction(a),!e.upEvent&&!g&&void e.pointerDown(a)}),d.on(h.getEventToHandleIt("move",i),function(a){return h.preventEventAction(a),!(!e.upEvent||g)&&void e.pointerMove(a)}),$(document).on(h.getEventToHandleIt("up",i),function(a){return h.preventEventAction(a),!(!e.upEvent||g)&&void e.pointerUp(a)}),$(document).on(h.getEventToHandleIt("down","tgDrawPanel"+i),".tg_draw_panel_box",function(a){h.preventEventAction(a),a.stopPropagation(),e.panelBoxPressed($(this))}),d.on(h.getEventToHandleIt("down","tgDrawChangeColor"+b),".tg_draw_brush_color",function(a){a.stopPropagation(),h.preventEventAction(a),e.hidePanelDropDownMenu(d.find(".tg_draw_brush_colors")),e.changeColor($(this))}),d.on(h.getEventToHandleIt("down","tgDrawChangeSize"+b),".tg_draw_brush_size",function(a){a.stopPropagation(),h.preventEventAction(a),e.hidePanelDropDownMenu(d.find(".tg_draw_brush_sizes")),e.changeBrushSize($(this))}),d.fadeIn(500)},this.build=function(){this.clearVars(),this.showEraser=!0,this.isCleared=!1,this.init(),f.on("tapGoRescaleEvent.tapGoDraw"+b,function(){e.handleResize()}),this.actionsTimes&&f.on("tapGoTimerUpdateEvent.tapGoDrawTime"+b,function(a){e.drawTime.enabled&&(e.drawTime.time+=h.tapGoTimerFrequency,e.checkDrawTimeAction(e.drawTime.time))})},this.clearEvents=function(){f.off("tapGoTimerUpdateEvent.tapGoDrawTime"+b),d.off(h.getEventToHandleIt("down",i)),d.off(h.getEventToHandleIt("move",i)),$(document).off(h.getEventToHandleIt("up",i)),f.off("tapGoRescaleEvent.tapGoDraw"+b)},this.removeDomElements=function(){this.canvas.ctx=null,this.canvas.img=null,this.canvas.el=null,f.find('.tg_draw_wrapper[data-ad-id="'+b+'"]').remove(),f.find('*[data-group-id="'+a.index+'"]').remove(),d=null},this.clear=function(){return!!this.isCleared||(this.isCleared=!0,this.upEvent&&$(document).trigger(this.upEvent),this.clearEvents(),this.removeDomElements(),void this.clearVars())},this.build(),this},adHandlers.tapGo.forcetouch=function(a,b,c){var d=this,e=c.tapGoManager,f=$(c.el()).find(".vjs-tapgo");return this.eventId="tapGoForceTouch"+b,this.pressedBtn=null,this.eventData=null,this.succeses=null,this.finished=null,this.upEvent=null,this.isCleared=null,this.build=function(){for(var b,c,d,e=a.buttonsIds.length;e--;){for(b=a.buttons[a.buttonsIds[e]],b.count=0,b.enabled=!0,b.attribs.speedRatio=parseInt((b.attribs.speedRatio,.1)),c=a.target.buttonActions[b.index].buttonActionsIds,b.actionsList=[],b.el=f.find("#"+b.itemId),b.hoverTimeout=null,d=c.length;d--;)"default"!==c[d]&&b.actionsList.push(parseInt(c[d],10));b.actionsList.sort(function(a,b){return a-b})}a.target.attribs.endActionIndex=parseInt(a.target.attribs.endActionIndex,10),this.succeses=0,this.isCleared=!1},this.checkBtnAction=function(b){return!!b.enabled&&(b.actionsList[0]<=b.count&&(e.playAction(a.target.buttonActions[b.index][b.actionsList[0]]),b.actionsList.splice(0,1)),b.actionsList.length||(this.succeses++,b.enabled=!1),void(this.succeses>=a.target.attribs.endActionIndex&&(this.finished=!0,b.enabled||!b.enabled&&b.background.selected&&b.el.attr("src",b.background.selected),e.playAction(a.target.finishAction[0]))))},this.updateBtnsTime=function(){if(this.pressedBtn){var a=e.getEventData(this.eventData)[0];this.pressedBtn.count+=this.pressedBtn.attribs.speedRatio*(1+a.force),this.checkBtnAction(this.pressedBtn)}},this.cursorDown=function(a,b){if(!b.enabled)return d.pressedBtn=null,!1;b.enabled&&b.background.hover&&b.el.attr("src",b.background.hover);var c=e.getEventData(a)[0];a.type=c.upEvent,a.originalEvent.type=c.upEvent,a.eventIndex=c.id,this.upEvent=a,this.pressedBtn=b,this.eventData=a},this.cursorUp=function(a){var b=e.getEventData(a)[0];if(b.id!==this.upEvent.eventIndex)return!1;var c=this.pressedBtn;c.enabled||!c.enabled&&c.background.selected&&c.el.attr("src",c.background.selected),c.enabled&&(c.hoverTimeout&&(clearTimeout(c.hoverTimeout),c.hoverTimeout=null),c.hoverTimeout=setTimeout(function(){c.enabled&&c.background.image&&c.el.attr("src",c.background.image)},100)),this.pressedBtn=null,this.eventData=null,this.upEvent=null},this.initEvents=function(){this.finished=!1,f.on(e.getEventToHandleIt("down",this.eventId),'.vjs-tapgo-button[data-group-id="'+a.index+'"]',function(b){return e.preventEventAction(b),d.finished?(d.pressedBtn=null,f.off(e.getEventToHandleIt("down",this.eventId)),!1):!d.upEvent&&void d.cursorDown(b,a.buttons[$(this).data("index")])}),$(document).on(e.getEventToHandleIt("up",this.eventId),function(a){return d.finished?(d.pressedBtn=null,$(document).off(e.getEventToHandleIt("up",this.eventId)),!1):!!d.upEvent&&void d.cursorUp(a)}),f.on("tapGoTimerUpdateEvent.forceTouchEvent"+b,function(){return d.finished?(d.pressedBtn=null,f.off("tapGoTimerUpdateEvent.forceTouchEvent"+b),!1):void d.updateBtnsTime()})},this.clear=function(){if(this.isCleared)return!0;this.isCleared=!0;for(var c=a.buttonsIds.length;c--;)btn=a.buttons[a.buttonsIds[c]],btn.hoverTimeout&&(clearTimeout(btn.hoverTimeout),btn.hoverTimeout=null);f.off(e.getEventToHandleIt("down",this.eventId)),$(document).off(e.getEventToHandleIt("up",this.eventId)),f.off("tapGoTimerUpdateEvent.forceTouchEvent"+b),f.find('*[data-group-id="'+a.index+'"]').remove()},this.build(),this};