var Native=function(a){var a=a||{},b=a.name,c=a.legacy,d=a.protect,e=a.implement,f=a.generics,g=a.initialize,i=a.afterImplement||function(){},a=g||c,f=!1!==f;a.constructor=Native;a.$family={name:"native"};if(c&&g)a.prototype=c.prototype;a.prototype.constructor=a;if(b)b=b.toLowerCase(),a.prototype.$family={name:b},Native.typize(a,b);var h=function(a,b,c,e){if(!d||e||!a.prototype[b])a.prototype[b]=c;f&&Native.genericize(a,b,d);i.call(a,b,c);return a};a.alias=function(a,b,c){if("string"==typeof a&&(a=
this.prototype[a]))return h(this,b,a,c);for(var d in a)this.alias(d,a[d],b);return this};a.implement=function(a,b,c){if("string"==typeof a)return h(this,a,b,c);for(var d in a)h(this,d,a[d],b);return this};e&&a.implement(e);return a};Native.genericize=function(a,b,c){if((!c||!a[b])&&"function"==typeof a.prototype[b])a[b]=function(){var c=Array.prototype.slice.call(arguments);return a.prototype[b].apply(c.shift(),c)}};Native.implement=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c].implement(b)};
Native.typize=function(a,b){if(!a.type)a.type=function(a){return $type(a)===b}};
(function(){var a={Array:Array,Date:Date,Function:Function,Number:Number,RegExp:RegExp,String:String},b;for(b in a)new Native({name:b,initialize:a[b],protect:!0});b={"boolean":Boolean,"native":Native,object:Object};for(var c in b)Native.typize(b[c],c);c={Array:"concat,indexOf,join,lastIndexOf,pop,push,reverse,shift,slice,sort,splice,toString,unshift,valueOf".split(","),String:"charAt,charCodeAt,concat,indexOf,lastIndexOf,match,replace,search,slice,split,substr,substring,toLowerCase,toUpperCase,valueOf".split(",")};for(var d in c)for(b=
c[d].length;b--;)Native.genericize(a[d],c[d][b],!0)})();var Hash=new Native({name:"Hash",initialize:function(a){"hash"==$type(a)&&(a=$unlink(a.getClean()));for(var b in a)this[b]=a[b];return this}});function $A(a){if(a.item){for(var b=a.length,c=Array(b);b--;)c[b]=a[b];return c}return Array.prototype.slice.call(a)}function $arguments(a){return function(){return arguments[a]}}function $chk(a){return!!(a||0===a)}function $clear(a){clearTimeout(a);clearInterval(a);return null}
function $defined(a){return void 0!=a}function $each(a,b,c){var d=$type(a);("arguments"==d||"collection"==d||"array"==d?Array:Hash).each(a,b,c)}function $empty(){}function $extend(a,b){for(var c in b||{})a[c]=b[c];return a}function $H(a){return new Hash(a)}function $lambda(a){return"function"==$type(a)?a:function(){return a}}function $merge(){var a=Array.slice(arguments);a.unshift({});return $mixin.apply(null,a)}
function $mixin(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];if("object"==$type(d))for(var e in d){var f=d[e],g=a[e];a[e]=g&&"object"==$type(f)&&"object"==$type(g)?$mixin(g,f):$unlink(f)}}return a}function $pick(){for(var a=0,b=arguments.length;a<b;a++)if(void 0!=arguments[a])return arguments[a];return null}function $random(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function $splat(a){var b=$type(a);return b?"array"!=b&&"arguments"!=b?[a]:a:[]}var $time=Date.now||function(){return+new Date};
function $try(){for(var a=0,b=arguments.length;a<b;a++)try{return arguments[a]()}catch(c){}return null}function $type(a){if(void 0==a)return!1;if(a.$family)return"number"==a.$family.name&&!isFinite(a)?!1:a.$family.name;if(a.nodeName)switch(a.nodeType){case 1:return"element";case 3:return/\S/.test(a.nodeValue)?"textnode":"whitespace"}else if("number"==typeof a.length){if(a.callee)return"arguments";if(a.item)return"collection"}return typeof a}
function $unlink(a){var b;switch($type(a)){case "object":b={};for(var c in a)b[c]=$unlink(a[c]);break;case "hash":b=new Hash(a);break;case "array":b=[];c=0;for(var d=a.length;c<d;c++)b[c]=$unlink(a[c]);break;default:return a}return b}
Function.implement({extend:function(a){for(var b in a)this[b]=a[b];return this},create2:function(a){var b=this,a=a||{};return function(c){var d=a.arguments,d=void 0!=d?$splat(d):Array.slice(arguments,a.event?1:0);a.event&&(d=[c||window.event].extend(d));var e=function(){return b.apply(a.bind||null,d)};return a.delay?setTimeout(e,a.delay):a.periodical?setInterval(e,a.periodical):a.attempt?$try(e):e()}},run:function(a,b){return this.apply(b,$splat(a))},pass:function(a,b){return this.create2({bind:b,
arguments:a})},bind:function(a,b){return this.create2({bind:a,arguments:b})},bindWithEvent:function(a,b){return this.create2({bind:a,arguments:b,event:!0})},attempt:function(a,b){return this.create2({bind:b,arguments:a,attempt:!0})()},delay:function(a,b,c){return this.create2({bind:b,arguments:c,delay:a})()},periodical:function(a,b,c){return this.create2({bind:b,arguments:c,periodical:a})()}});
function Class(a){a instanceof Function&&(a={initialize:a});var b=function(){Object.reset(this);if(b._prototyping)return this;this._current=$empty;var a=this.initialize?this.initialize.apply(this,arguments):this;delete this._current;delete this.caller;return a}.extend(this);b.implement(a);b.constructor=Class;return b.prototype.constructor=b}Function.prototype.protect=function(){this._protected=!0;return this};
Object.reset=function(a,b){if(null==b){for(var c in a)Object.reset(a,c);return a}delete a[b];switch($type(a[b])){case "object":c=function(){};c.prototype=a[b];c=new c;a[b]=Object.reset(c);break;case "array":a[b]=$unlink(a[b])}return a};
(new Native({name:"Class",initialize:Class})).extend({instantiate:function(a){a._prototyping=!0;var b=new a;delete a._prototyping;return b},wrap:function(a,b,c){if(c._origin)c=c._origin;return function(){if(c._protected&&null==this._current)throw Error('The method "'+b+'" cannot be called.');var a=this.caller,e=this._current;this.caller=e;this._current=arguments.callee;var f=c.apply(this,arguments);this._current=e;this.caller=a;return f}.extend({_owner:a,_origin:c,_name:b})}});
Class.implement({implement:function(a,b){if("object"==$type(a)){for(var c in a)this.implement(c,a[c]);return this}if(c=Class.Mutators[a])if(b=c.call(this,b),null==b)return this;c=this.prototype;switch($type(b)){case "function":if(b._hidden)break;c[a]=Class.wrap(this,a,b);break;case "object":var d=c[a];"object"==$type(d)?$mixin(d,b):c[a]=$unlink(b);break;case "array":c[a]=$unlink(b);break;default:c[a]=b}return this}});
Class.Mutators={Extends:function(a){this.parent=a;this.prototype=Class.instantiate(a);this.implement("parent",function(){var a=this.caller._name,c=this.caller._owner.parent.prototype[a];if(!c)throw Error('The method "'+a+'" has no parent.');return c.apply(this,arguments)}.protect())},Implements:function(a){$splat(a).each(function(a){a instanceof Function&&(a=Class.instantiate(a));this.implement(a)},this)}};
var Model=function(){this.initialize=function(){this.initializeModel()};this.proxyMap={};this.registerProxy=function(a){this.proxyMap[a.getProxyName()]=a;a.onRegister()};this.retrieveProxy=function(a){return this.proxyMap[a]};this.hasProxy=function(a){return null!=this.proxyMap[a]};this.removeProxy=function(a){var b=this.proxyMap[a];b&&(delete this.proxyMap[a],b.onRemove());return b};this.initializeModel=function(){}};
Model.getInstance=function(){if(void 0==Model.instance){var a=new Class(new Model);Model.instance=new a}return Model.instance};
var View=function(){this.mediatorMap={};this.observerMap={};this.registerObserver=function(a,b){var c=this.observerMap[a];c?c.push(b):this.observerMap[a]=[b]};this.notifyObservers=function(a){var b=a.getName();if(null!=this.observerMap[b])for(var b=this.observerMap[b].concat(),c=b.length,d=0;d<c;d++)b[d].notifyObserver(a)};this.removeObserver=function(a,b){for(var c=this.observerMap[a],d=c.length;d--;)if(c[d].compareNotifyContext(b)){c.splice(d,1);break}c.length||delete this.observerMap[a]};this.registerMediator=
function(a){var b=a.getMediatorName();if(!this.mediatorMap[b]){this.mediatorMap[b]=a;var b=a.listNotificationInterests(),c=b.length;if(c)for(var d=new Observer(a.handleNotification,a),e=0;e<c;e++)this.registerObserver(b[e],d);a.onRegister()}};this.retrieveMediator=function(a){return this.mediatorMap[a]};this.removeMediator=function(a){var b=this.mediatorMap[a];if(b){for(var c=b.listNotificationInterests(),d=c.length;d--;)this.removeObserver(c[d],b);delete this.mediatorMap[a];b.onRemove()}return b};
this.hasMediator=function(a){return null!=this.mediatorMap[a]}};View.getInstance=function(){if(void 0==View.instance){var a=new Class(new View);View.instance=new a}return View.instance};
var Controller=function(){this.view=null;this.commandMap={};this.initialize=function(){this.initializeController()};this.initializeController=function(){this.view=View.getInstance()};this.executeCommand=function(a){var b=this.commandMap[a.getName()];b&&(new b).execute(a)};this.registerCommand=function(a,b){this.commandMap[a]||this.view.registerObserver(a,new Observer(this.executeCommand,this));this.commandMap[a]=b};this.hasCommand=function(a){return null!=this.commandMap[a]};this.removeCommand=function(a){this.hasCommand(a)&&
(this.view.removeObserver(a,this),delete this.commandMap[a])}};Controller.getInstance=function(){if(void 0==Controller.instance){var a=new Class(new Controller);Controller.instance=new a}return Controller.instance};
var Notifier=function(){this.facade=null;this.initialize=function(){this.facade=Facade.getInstance()};this.sendNotification=function(a,b,c){this.facade.sendNotification(a,b,c)}},Notifier=new Class(new Notifier),Mediator=function(){this.Extends=Notifier;this.viewComponent=this.mediatorName=null;this.initialize=function(a,b){this.parent();this.mediatorName=a||Mediator.NAME;this.viewComponent=b};this.listNotificationInterests=function(){return[]};this.getMediatorName=function(){return this.mediatorName};
this.getViewComponent=function(){return this.viewComponent};this.setViewComponent=function(a){this.viewComponent=a};this.handleNotification=function(){};this.onRegister=function(){};this.onRemove=function(){}},Mediator=new Class(new Mediator);Mediator.NAME="Mediator";
var Proxy=function(){this.Extends=Notifier;this.data=this.proxyName=null;this.initialize=function(a,b){this.parent();this.proxyName=a||Proxy.NAME;this.data=b};this.getProxyName=function(){return this.proxyName};this.setData=function(a){this.data=a};this.getData=function(){return this.data};this.onRegister=function(){};this.onRemove=function(){}},Proxy=new Class(new Proxy);Proxy.NAME="Proxy";
var Facade=function(){this.controller=this.model=this.view=null;this.initialize=function(){this.initializeFacade()};this.initializeFacade=function(){this.initializeModel();this.initializeController();this.initializeView()};this.initializeModel=function(){this.model=Model.getInstance()};this.initializeController=function(){this.controller=Controller.getInstance()};this.initializeView=function(){this.view=View.getInstance()};this.registerCommand=function(a,b){this.controller.registerCommand(a,b)};this.removeCommand=
function(a){this.controller.removeCommand(a)};this.hasCommand=function(a){return this.controller.hasCommand(a)};this.registerProxy=function(a){this.model.registerProxy(a)};this.retrieveProxy=function(a){return this.model.retrieveProxy(a)};this.removeProxy=function(a){this.model.removeProxy(a)};this.hasProxy=function(a){return this.model.hasProxy(a)};this.registerMediator=function(a){this.view.registerMediator(a)};this.retrieveMediator=function(a){return this.view.retrieveMediator(a)};this.removeMediator=
function(a){return this.view.removeMediator(a)};this.hasMediator=function(a){return this.view.hasMediator(a)};this.sendNotification=function(a,b,c){this.notifyObservers(new Notification(a,b,c))};this.notifyObservers=function(a){this.view.notifyObservers(a)}};Facade.getInstance=function(){if(void 0==Facade.instance){var a=new Class(new Facade);Facade.instance=new a}return Facade.instance};
var Notification=function(){this.type=this.body=this.name=null;this.initialize=function(a,b,c){this.name=a;this.body=b;this.type=c};this.getName=function(){return this.name};this.setBody=function(a){this.body=a};this.getBody=function(){return this.body};this.setType=function(a){this.type=a};this.getType=function(){return this.type};this.toString=function(){var a="Notification Name: "+this.getName(),a=a+("\nBody:"+(null==this.body?"null":this.body.toString()));return a+="\nType:"+(null==this.type?
"null":this.type)}},Notification=new Class(new Notification),Observer=function(){this.context=this.notify=null;this.initialize=function(a,b){this.notify=a;this.context=b};this.setNotifyMethod=function(a){this.notify=a};this.setNotifyContext=function(a){this.context=a};this.getNotifyMethod=function(){return this.notify};this.getNotifyContext=function(){return this.context};this.notifyObserver=function(a){this.notify.apply(this.context,[a])};this.compareNotifyContext=function(a){return a===this.context}},
Observer=new Class(new Observer),MacroCommand=function(){this.Extends=Notifier;this.subCommands=[];this.initialize=function(){this.initializeMacroCommand()};this.initializeMacroCommand=function(){};this.addSubCommand=function(a){this.subCommands.push(a)};this.execute=function(a){for(var b=this.subCommands.length,c=0;c<b;c++)(new this.subCommands[c]).execute(a)}},MacroCommand=new Class(new MacroCommand),SimpleCommand=function(){this.Extends=Notifier;this.initialize=function(){this.parent()};this.execute=
function(){}},SimpleCommand=new Class(new SimpleCommand),UIEvent=function(){this.target=this.type=null;this.initialize=function(a,b){this.type=a;this.data=b};this.data=null},UIEvent=new Class(new UIEvent),UIComponent=function(){this.eventsArray={};this.addEventListener=function(a,b,c){b=[b,c];this.eventsArray.hasOwnProperty(a)||(this.eventsArray[a]=[]);this.eventsArray[a].push(b)};this.dispatchEvent=function(a){if(this.eventsArray.hasOwnProperty(a.type))for(var b=0;b<this.eventsArray[a.type].length;b++){a.target=
this;var c=this.eventsArray[a.type][b];if(void 0!=c[0])c[0].call(c[1],a);else throw"Callback function for UIEvent.type: [ "+a.type+" ] is undefined. Please check your addEventListener statement.";}}},UIComponent=new Class(new UIComponent),ApplicationFacade=function(){this.Extends=new Class(new Facade);this.initializeController=function(){this.parent();"undefined"!==typeof OF.InitCommentatorCommand&&this.registerCommand(ApplicationFacade.OF_INIT_COMMENTATOR_STARTAPP,OF.InitCommentatorCommand);this.registerCommand(ApplicationFacade.OF_INIT_READER_STARTAPP,
OF.InitReaderCommand);this.registerCommand(ApplicationFacade.OF_INIT_SEARCH_STARTAPP,OF.InitSearchCommand);this.registerCommand(ApplicationFacade.OF_INIT_ABUSE_STARTAPP,OF.InitAbuseCommand);this.registerCommand(ApplicationFacade.OF_INIT_MY_COMMENTS_STARTAPP,OF.InitMyCommentsCommand)}};ApplicationFacade.getInstance=function(){if("undefined"==typeof Facade.instance){var a=new Class(new ApplicationFacade);Facade.instance=new a}return Facade.instance};ApplicationFacade.OF_INIT_COMMENTATOR_STARTAPP="OF_INIT_COMMENTATOR_STARTAPP";
ApplicationFacade.OF_INIT_READER_STARTAPP="OF_INIT_READER_STARTAPP";ApplicationFacade.OF_INIT_SEARCH_STARTAPP="OF_INIT_SEARCH_STARTAPP";ApplicationFacade.OF_INIT_ABUSE_STARTAPP="OF_INIT_ABUSE_STARTAPP";ApplicationFacade.OF_INIT_MY_COMMENTS_STARTAPP="OF_INIT_MY_COMMENTS_STARTAPP";
