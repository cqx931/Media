/* 2016-05-27 12:23:17 */(function(){var a,b,c,d,e,f,g,h,i,j;b=window.device,a={},window.device=a,d=window.document.documentElement,j=window.navigator.userAgent.toLowerCase(),a.ios=function(){return a.iphone()||a.ipod()||a.ipad()},a.iphone=function(){return!a.windows()&&e("iphone")},a.ipod=function(){return e("ipod")},a.ipad=function(){return e("ipad")},a.android=function(){return!a.windows()&&e("android")},a.androidPhone=function(){return a.android()&&e("mobile")},a.androidTablet=function(){return a.android()&&!e("mobile")},a.blackberry=function(){return e("blackberry")||e("bb10")||e("rim")},a.blackberryPhone=function(){return a.blackberry()&&!e("tablet")},a.blackberryTablet=function(){return a.blackberry()&&e("tablet")},a.windows=function(){return e("windows")},a.windowsPhone=function(){return a.windows()&&e("phone")},a.windowsTablet=function(){return a.windows()&&e("touch")&&!a.windowsPhone()},a.mac=function(){return e("mac")},a.macPhone=function(){return!1},a.macTablet=function(){return!1},a.fxos=function(){return(e("(mobile;")||e("(tablet;"))&&e("; rv:")},a.fxosPhone=function(){return a.fxos()&&e("mobile")},a.fxosTablet=function(){return a.fxos()&&e("tablet")},a.meego=function(){return e("meego")},a.cordova=function(){return window.cordova&&"file:"===location.protocol},a.nodeWebkit=function(){return"object"==typeof window.process},a.mobile=function(){return a.androidPhone()||a.iphone()||a.ipod()||a.windowsPhone()||a.blackberryPhone()||a.fxosPhone()||a.meego()},a.tablet=function(){return a.ipad()||a.androidTablet()||a.blackberryTablet()||a.windowsTablet()||a.fxosTablet()},a.desktop=function(){return!a.tablet()&&!a.mobile()},a.television=function(){var a;for(television=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","roku","pov_tv","hbbtv","ce-html"],a=0;a<television.length;){if(e(television[a]))return!0;a++}return!1},a.portrait=function(){return window.innerHeight/window.innerWidth>1},a.landscape=function(){return window.innerHeight/window.innerWidth<1},a.noConflict=function(){return window.device=b,this},e=function(a){return-1!==j.indexOf(a)},g=function(a){var b;return b=new RegExp(a,"i"),d.className.match(b)},c=function(a){var b=null;g(a)||(b=d.className.replace(/^\s+|\s+$/g,""),d.className=b+" "+a)},i=function(a){g(a)&&(d.className=d.className.replace(" "+a,""))},a.ios()?a.ipad()?c("ios ipad tablet"):a.iphone()?c("ios iphone mobile"):a.ipod()&&c("ios ipod mobile"):a.android()?c(a.androidTablet()?"android tablet":"android mobile"):a.blackberry()?c(a.blackberryTablet()?"blackberry tablet":"blackberry mobile"):a.mac()?c(a.macTablet()?"mac tablet":a.macPhone()?"mac mobile":"mac desktop"):a.windows()?c(a.windowsTablet()?"windows tablet":a.windowsPhone()?"windows mobile":"windows desktop"):a.fxos()?c(a.fxosTablet()?"fxos tablet":"fxos mobile"):a.meego()?c("meego mobile"):a.nodeWebkit()?c("node-webkit"):a.television()?c("television"):a.desktop()&&c("desktop"),a.cordova()&&c("cordova"),f=function(){a.landscape()?(i("portrait"),c("landscape")):(i("landscape"),c("portrait"))},h=Object.prototype.hasOwnProperty.call(window,"onorientationchange")?"orientationchange":"resize",window.addEventListener?window.addEventListener(h,f,!1):window.attachEvent?window.attachEvent(h,f):window[h]=f,f(),"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?module.exports=a:window.device=a}).call(this),function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define(b):this[a]=b()}("$script",function(){function a(a,b){for(var c=0,d=a.length;d>c;++c)if(!b(a[c]))return i;return 1}function b(b,c){a(b,function(a){return!c(a)})}function c(f,g,h){function i(a){return a.call?a():m[a]}function k(){if(!--s){m[r]=1,q&&q();for(var c in o)a(c.split("|"),i)&&!b(o[c],i)&&(o[c]=[])}}f=f[j]?f:[f];var l=g&&g.call,q=l?g:h,r=l?f.join(""):g,s=f.length;return setTimeout(function(){b(f,function a(b,c){return null===b?k():(b=c||-1!==b.indexOf(".js")||/^https?:\/\//.test(b)||!e?b:e+b+".js",p[b]?(r&&(n[r]=1),2==p[b]?k():setTimeout(function(){a(b,!0)},0)):(p[b]=1,r&&(n[r]=1),void d(b,k)))})},0),c}function d(a,b){var c,d=g.createElement("script");d.onload=d.onerror=d[l]=function(){d[k]&&!/^c|loade/.test(d[k])||c||(d.onload=d[l]=null,c=1,p[a]=2,b())},d.async=1,d.src=f?a+(-1===a.indexOf("?")?"?":"&")+f:a,h.insertBefore(d,h.lastChild)}var e,f,g=document,h=g.getElementsByTagName("head")[0],i=!1,j="push",k="readyState",l="onreadystatechange",m={},n={},o={},p={};return c.get=d,c.order=function(a,b,d){!function e(f){f=a.shift(),a.length?c(f,e):c(f,b,d)}()},c.path=function(a){e=a},c.urlArgs=function(a){f=a},c.ready=function(d,e,f){d=d[j]?d:[d];var g=[];return!b(d,function(a){m[a]||g[j](a)})&&a(d,function(a){return m[a]})?e():!function(a){o[a]=o[a]||[],o[a][j](e),f&&f(g)}(d.join("|")),c},c.done=function(a){c([null],a)},c}),function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b(require,exports,module):a.ouibounce=b()}(this,function(a,b,c){return function(a,b){"use strict";function c(a,b){return"undefined"==typeof a?b:a}function d(a){var b=24*a*60*60*1e3,c=new Date;return c.setTime(c.getTime()+b),"; expires="+c.toUTCString()}function e(){k()||(y.addEventListener("mouseleave",f),y.addEventListener("mouseenter",g),y.addEventListener("keydown",h))}function f(a){a.clientY>p||(x=setTimeout(l,r))}function g(){x&&(clearTimeout(x),x=null)}function h(a){z||a.metaKey&&76===a.keyCode&&(z=!0,x=setTimeout(l,r))}function i(a,b){return j()[a]===b}function j(){for(var a=document.cookie.split("; "),b={},c=a.length-1;c>=0;c--){var d=a[c].split("=");b[d[0]]=d[1]}return b}function k(){return i(v,"true")&&!o}function l(){k()||(a&&(a.style.display="block"),s(),m())}function m(a){var b=a||{};"undefined"!=typeof b.cookieExpire&&(t=d(b.cookieExpire)),b.sitewide===!0&&(w=";path=/"),"undefined"!=typeof b.cookieDomain&&(u=";domain="+b.cookieDomain),"undefined"!=typeof b.cookieName&&(v=b.cookieName),document.cookie=v+"=true"+t+u+w,y.removeEventListener("mouseleave",f),y.removeEventListener("mouseenter",g),y.removeEventListener("keydown",h)}var n=b||{},o=n.aggressive||!1,p=c(n.sensitivity,20),q=c(n.timer,1e3),r=c(n.delay,0),s=n.callback||function(){},t=d(n.cookieExpire)||"",u=n.cookieDomain?";domain="+n.cookieDomain:"",v=n.cookieName?n.cookieName:"viewedOuibounceModal",w=n.sitewide===!0?";path=/":"",x=null,y=document.documentElement;setTimeout(e,q);var z=!1;return{fire:l,disable:m,isDisabled:k}}}),function(){"use strict";if("object"!=typeof window.limk&&("string"!=typeof window.limk||"disabled"!==window.limk)){window.limk={app:{bootstrap:function(){limk.time.boot(),limk.logger.shiny("Limk Related Content Widget initializing!"),limk.settings.isDebuggable()===!0&&(limk.logger.log("[App] Enabling debug messages for production!"),limk.settings.logOnProduction=!0),limk.environment.set(),limk.logger.log("[Environment] Environment is set to: {"+limk.environment.get()+"}"),limk.environment.setProtocol(),limk.logger.log("[Environment] Environment protocol is set to: {"+limk.environment.getProtocol()+"}"),limk.loader.jquery.initialize()},run:function(){try{limk.platform.detect(),limk.key.unlock(limkClientKey),limk.data.parse(limkClientData),limk.settings.parseUserSettings(limkClientSettings),limk.cache.run(),limk.logger.log("[Cache] TTL: "+(0===limk.cache.ttl()?"Expired!":limk.cache.ttl()+" seconds to expire.")),limk.platform.platformDomInjection(),limk.dom.responsiveWidgetDomInjection(),limk.dom.customWidgetDomInjection(),limk.device.guess(),limk.trackers.initialize(),limk.loader.loadHammerJS(),limk.loader.loadFeatherlight(),limk.loader.loadImageScale(),limk.loader.loadCss("//fonts.googleapis.com/css?family=Source+Sans+Pro:600,700"),limk.loader.loadCss(limk.environment.cdnUrl()+"assets/shared/css/widgets.min.css"),limk.loader.loadCustomCssFiles(),limk.settings.widgets.responsive.isEnabled===!0?(limk.logger.log("[App] Attempting to fetch responsive widget's code. Widget ID: {"+limk.key.applicationKey.responsive+"}"),limk.API.fetchWidget(limk.key.applicationKey.responsive)):limk.API.fetchArticles()}catch(a){limk.app.handleException(a.message)}},finalize:function(){try{limk.loader.loadApplication()}catch(a){limk.app.handleException(a.message)}},handleException:function(a){limk.logger.log("[Exception] "+a)}},settings:{cacheDuration:6e5,exitIntentCooldown:18e5,forceNoCache:!1,logOnProduction:!1,enableTracking:!0,widgets:{responsive:{articleAmount:3,allowAds:1,isEnabled:!1},mobile:{articleAmount:4,allowAds:1,isEnabled:!1},vertical:{articleAmount:4,headline:"",allowAds:1},horizontal:{articleAmount:6,articlePerLine:3,headline:"",allowAds:1},custom:[]},customWidgetInfoExists:function(a){return"undefined"!=typeof limk.settings.widgets.custom[a]},isDebuggable:function(){return/[?&]limk_debug=/.test(location.href)===!0},getRequiredApiCalls:function(){return this.widgets.responsive.isEnabled===!0?2:1},parseUserSettings:function(a){limk.logger.log("[Settings] Attempting to parse user settings."),a.hasOwnProperty("horizontal_article_amount")&&(limk.logger.log("[Settings] User overrided the horizontal.article_amount with {"+a.horizontal_article_amount+"}"),limk.settings.widgets.horizontal.articleAmount=a.horizontal_article_amount),a.hasOwnProperty("horizontal_article_per_line")&&(limk.logger.log("[Settings] User overrided the horizontal.article_per_line with {"+a.horizontal_article_per_line+"}"),limk.settings.widgets.horizontal.articlePerLine=a.horizontal_article_per_line),a.hasOwnProperty("horizontal_headline")&&(limk.logger.log("[Settings] User overrided the horizontal.article_headline with {"+a.horizontal_headline+"}"),limk.settings.widgets.horizontal.headline=a.horizontal_headline),a.hasOwnProperty("horizontal_target")&&(limk.logger.log("[Settings] Horizontal target has been set to {"+a.horizontal_target+"}"),limk.platform.blogger.horizontal.target=a.horizontal_target),a.hasOwnProperty("horizontal_allow_ads")&&(limk.logger.log("[Settings] User overrided the horizontal.allow_ads with {"+a.horizontal_allow_ads+"}"),limk.settings.widgets.horizontal.allowAds=a.horizontal_allow_ads),a.hasOwnProperty("vertical_article_amount")&&(limk.logger.log("[Settings] User overrided the vertical.article_amount with {"+a.vertical_article_amount+"}"),limk.settings.widgets.vertical.articleAmount=a.vertical_article_amount),a.hasOwnProperty("vertical_headline")&&(limk.logger.log("[Settings] User overrided the vertical.article_headline with {"+a.vertical_headline+"}"),limk.settings.widgets.vertical.headline=a.vertical_headline),a.hasOwnProperty("vertical_allow_ads")&&(limk.logger.log("[Settings] User overrided the vertical.allow_ads with {"+a.vertical_allow_ads+"}"),limk.settings.widgets.vertical.allowAds=a.vertical_allow_ads),a.hasOwnProperty("responsive_is_enabled")&&(limk.logger.log("[Settings] User overrided the responsive.is_enabled with {"+a.responsive_is_enabled+"}"),limk.settings.widgets.responsive.isEnabled=1===a.responsive_is_enabled?!0:!1,limk.settings.widgets.mobile.isEnabled=1===a.responsive_is_enabled?!0:!1),a.hasOwnProperty("responsive_allow_ads")&&(limk.logger.log("[Settings] User overrided the responsive.allow_ads with {"+a.responsive_allow_ads+"}"),limk.settings.widgets.responsive.allowAds=a.responsive_allow_ads,limk.settings.widgets.mobile.allowAds=a.responsive_allow_ads),a.hasOwnProperty("custom")&&limk.jQuery.each(a.custom,function(a,b){limk.logger.log("[Settings] User added the custom["+a+"] with {"+JSON.stringify(b)+"}"),limk.settings.widgets.custom[a]=b}),limk.settings.enableTracking=!!a.enable_tracking,limk.logger.log("[Settings] User overrided the enable_tracking with {"+!!a.enable_tracking+"}"),limk.logger.log("[Settings] Parsing completed.")}},platform:{detected:"standard",blogger:{horizontal:{target:0}},detect:function(){limk.jQuery("#Blog1.widget.Blog").length>0&&(this.detected="blogger"),limk.logger.log("[Platform] Platform has been set to {"+this.detected+"}")},getPlatform:function(){return this.detected},platformDomInjection:function(){"blogger"===this.getPlatform()&&(limk.logger.log("[Platform] Injecting on-the-fly divs for {"+this.detected+"}"),limk.dom.insertBloggerHorizontalDivs(this.blogger.horizontal.target)),limk.logger.log("[Platform] [BACKWARDS-COMPATIBILITY] Replacing all the horizontal ID occurences with classes."),limk.dom.replaceIdWithClass()}},trackers:{initialize:function(){return limk.cache.isUserOptedOut()===!0?void limk.logger.log("[Trackers] User is opted out. Not tracking."):limk.settings.enableTracking===!1?void limk.logger.log("[Trackers] Site owner disabled cookie based tracking. Not tracking."):(this.quantcast(),"Uncategorized"===limk.data.getCategoryName()?void limk.logger.log("[Trackers] This site is uncategorized. Not tracking."):(limk.device.isDesktop()===!0&&this.eyeota(),void this.lotame()))},quantcast:function(){window._qevents=window._qevents||[],limk.logger.log("[Trackers] Tracking Quantcast.");var a=document.createElement("script");a.src=("https:"===document.location.protocol?"https://secure":"http://edge")+".quantserve.com/quant.js",a.async=!0,a.type="text/javascript";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b),window._qevents.push({qacct:"p-USH5YgkCFNTVM"})},eyeota:function(){limk.logger.log("[Trackers] Tracking Eyeota."),limk.jQuery("<iframe>",{src:limk.environment.getProtocol()+"//ps.eyeota.net/pixel?pid=c4b2cjv&t=iframe&sid=LIMK&pubID="+limk.data.getPublisherID()+"&cat="+limk.data.getCategoryName(),frameborder:0,scrolling:"no",height:0,width:0}).appendTo("body").hide()},lotame:function(){limk.logger.log("[Trackers] Tracking Lotame.");var a=document.createElement("script");a.id="LOTCC_6953",a.src=limk.environment.getProtocol()+"//tags.crwdcntrl.net/c/6953/cc.js?ns=_cc6953",a.async=!0,a.type="text/javascript",a.onload=function(){var a=setInterval(function(){window.LOTCC.loaded!==!1&&(clearInterval(a),window.LOTCC.add("act","read article"),window.LOTCC.add("genp","android device : "+limk.device.isMobile()===!0?"mobile":"desktop"),window.LOTCC.add("int",limk.data.getCategoryName()),window.LOTCC.bcp())},200)};var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}},helpers:{threeDots:function(a,b){var c="...";return a.length>b&&(a=a.slice(0,b)+c),a}},key:{applicationKey:null,siteID:null,unlock:function(a){limk.logger.log("[Key] Client key successfully set."),this.applicationKey=a,this.siteID=a.siteID}},data:{applicationData:null,parse:function(a){limk.logger.log("[Data] Client data successfully set."),this.applicationData=a},getPublisherID:function(){return this.applicationData.publisher_id},getCategoryName:function(){return this.applicationData.iab}},dom:{insertBloggerHorizontalDivs:function(a){return 2===a?(limk.logger.log("[DOM] Disabling automatic horizontal widget resolution."),!1):(1===a&&(limk.logger.log("[DOM] Adding blogger widgets under first entry."),limk.jQuery(".post-body.entry-content").first().append(limk.jQuery("<div/>",{"class":"js-limk_horizontal_widget_placeholder"}))),0===a&&(limk.logger.log("[DOM] Adding blogger widgets under each entry."),limk.jQuery(".post-body.entry-content").append(limk.jQuery("<div/>",{"class":"js-limk_horizontal_widget_placeholder"}))),void(0===limk.dom.getHorizontalWidgetAmount()&&limk.dom.replaceIdWithClass()))},customWidgetDomInjection:function(){Object.getOwnPropertyNames(limk.settings.widgets.custom).length>0&&(limk.logger.log("[DOM] Injecting on-the-fly divs for custom widgets."),limk.settings.widgets.custom.filter(function(a){return 1===a.custom_trigger_type}).forEach(function(a){return limk.cache.exitIntentCooldownPassed()===!1?void limk.logger.log("[DOM] Exit-Intent is on cooldown."):0===parseInt(a.custom_is_enabled,10)?void limk.logger.log("[DOM] Exit-Intent is inactive."):(limk.logger.log("[DOM] Added Exit-Intent DOM entry for widget {"+a.custom_name+"}"),void limk.jQuery("<div/>",{"class":"js-limk_custom_widget_placeholder","data-widget-id":a.id,"data-trigger-type":a.custom_trigger_type}).prependTo("body"))}))},responsiveWidgetDomInjection:function(){limk.settings.widgets.responsive.isEnabled===!0&&limk.jQuery("body").append(limk.jQuery("<div/>",{id:"limk_responsive_widget_placeholder"}))},replaceIdWithClass:function(){limk.logger.log("[DOM] Replacing horizontal ID's with classes.."),limk.jQuery("#limk_horizontal_widget_placeholder").replaceWith(limk.jQuery("<div/>",{"class":"js-limk_horizontal_widget_placeholder"}))},getHorizontalWidgetAmount:function(){return limk.jQuery(".js-limk_horizontal_widget_placeholder").length},getCustomWidgetAmount:function(){return limk.jQuery(".js-limk_custom_widget_placeholder").length},isVerticalWidgetLoaded:function(){return limk.jQuery("#limk_vertical_widget_placeholder").length>0},isResponsiveWidgetLoaded:function(){return limk.jQuery("#limk_responsive_widget_placeholder").length>0},renderedInIframe:function(){try{return window.self!==window.top}catch(a){return!0}},isElementInViewport:function(a){try{var b=a[0],c=b.getBoundingClientRect();return c.bottom>=0&&c.right>=0&&c.top<=limk.jQuery(window).height()&&c.left<=limk.jQuery(window).width()}catch(d){return!1}}},device:{deviceJS:null,type:null,os:null,guess:function(){limk.logger.log("[Device] Attempting to detect device type."),this.deviceJS=device.noConflict(),this.deviceJS.mobile()===!0?this.setDeviceType("mobile"):this.deviceJS.tablet()===!0?this.setDeviceType("tablet"):this.setDeviceType("desktop"),this.deviceJS.ios()===!0?this.setOsType("ios"):this.deviceJS.android()===!0?this.setOsType("android"):this.deviceJS.mac()===!0?this.setOsType("mac"):this.deviceJS.windows()===!0?this.setOsType("windows"):this.setOsType("unknown")},setDeviceType:function(a){limk.logger.log("[Device] Device type set to {"+a+"}"),this.type=a},setOsType:function(a){limk.logger.log("[Device] Operating system set to {"+a+"}"),this.os=a},isMobile:function(){return"mobile"===this.type},isMobileOrTablet:function(){return"mobile"===this.type||"tablet"===this.type},isDesktop:function(){return!this.isMobileOrTablet()},getDeviceInformation:function(){var a=limk.jQuery("html").attr("class").split(" ").filter(function(a){return-1!==["mobile","tablet","desktop"].indexOf(a)});return limk.jQuery.isArray(a)===!0?a:[]},getOsInformation:function(){var a=limk.jQuery("html").attr("class").split(" ").filter(function(a){return-1!==["ios","android","mac","windows"].indexOf(a)});return limk.jQuery.isArray(a)===!0?a:[]}},browser:{supports:function(){},guess:function(){},version:function(){},ancient:function(){}},versionComparer:{v1parts:null,v2parts:null,initialize:function(a,b){return this.v1parts=a.split("."),this.v2parts=b.split("."),this.run()},run:function(){for(;this.v1parts.length<this.v2parts.length;)this.v1parts.push("0");for(;this.v2parts.length<this.v1parts.length;)this.v2parts.push("0");this.v1parts=this.v1parts.map(Number),this.v2parts=this.v2parts.map(Number);for(var a=0;a<this.v1parts.length;++a){if(this.v2parts.length===a)return"bigger";if(this.v1parts[a]!==this.v2parts[a])return this.v1parts[a]>this.v2parts[a]?"bigger":"smaller"}return this.v1parts.length!==this.v2parts.length?"smaller":"equals"}},logger:{messages:[],styling:"background: #d23636; color: #fff",log:function(a){("production"!==limk.environment.get()||limk.settings.logOnProduction!==!1)&&(a="["+limk.time.getElapsedTime().second()+"]"+a,limk.logger.messages.push(a),console.log(a))},shiny:function(a){return console.log("%c"+a,limk.logger.styling)},getLogs:function(){var a=[];return this.messages.forEach(function(b){a.push(b+"<br>")}),a},dump:function(){console.log(this.getLogs())}},time:{bootDate:0,boot:function(){return this.bootDate=this.getTimestamp(),this.bootDate},getElapsedTime:function(){var a=this.getTimestamp()-this.bootDate;return{milisecond:function(){return a.toFixed(5)+"ms"},second:function(){return(a/1e3).toFixed(3)+"s"}}},getTimestamp:function(){return Date.now()||(new Date).getTime()}},environment:{environment:null,protocol:null,environments:{local:["limkrelated.dev","wordpress.dev","related.llimk.com"]},set:function(){var a=document.domain;return~this.environments.local.indexOf(a)?void(this.environment="local"):void(this.environment="production")},setProtocol:function(){"https:"===window.location.protocol?this.protocol="https:":this.protocol="http:"},get:function(){return this.environment},getProtocol:function(){return this.protocol},cdnUrl:function(){return"local"===this.get()?this.getProtocol()+"//limkrelated.dev/":"production"===this.get()?this.getProtocol()+"//cdn.limk.com/":void 0},apiUrl:function(){return"local"===this.get()?this.getProtocol()+"//api.limkrelated.dev/":"production"===this.get()?this.getProtocol()+"//api.limk.com/":void 0},goUrl:function(){return"local"===this.get()?this.getProtocol()+"//api.limkrelated.dev/":"production"===this.get()?this.getProtocol()+"//go.limk.com/":void 0},imgUrl:function(){return"local"===this.get()?this.getProtocol()+"//image.limkrelated.dev/":"production"===this.get()?this.getProtocol()+"//cdn2.limk.com/public/":void 0}},API:{version:"v1",jsonCode:{},fetchAmount:{responsiveAmt:0,horizontalAmt:0,verticalAmt:0,customAmt:0,getTotal:function(){return this.responsiveAmt+this.horizontalAmt+this.verticalAmt+this.customAmt}},collection:{hasSponsoredContent:!1,articles:{responsive:[],vertical:[],horizontal:[],custom:[]},take:function(a,b){for(var c=[],d=0;b>d;d++)c.push(this.articles[a].pop());return c},add:function(a,b){this.articles[a].push(b)},countAll:function(){var a=0;return a+=this.articles.responsive.length,a+=this.articles.vertical.length,a+=this.articles.horizontal.length,a+=this.articles.custom.length}},fetchArticles:function(){var a=[];limk.dom.isResponsiveWidgetLoaded()===!0&&(limk.device.isMobileOrTablet()?limk.API.fetchAmount.responsiveAmt+=limk.settings.widgets.mobile.articleAmount:limk.API.fetchAmount.responsiveAmt+=limk.settings.widgets.responsive.articleAmount),limk.dom.isVerticalWidgetLoaded()===!0&&(limk.API.fetchAmount.verticalAmt+=limk.settings.widgets.vertical.articleAmount),limk.dom.getHorizontalWidgetAmount()>0&&(limk.API.fetchAmount.horizontalAmt+=limk.settings.widgets.horizontal.articleAmount*limk.dom.getHorizontalWidgetAmount()),limk.dom.getCustomWidgetAmount()>0&&limk.jQuery(".js-limk_custom_widget_placeholder").each(function(b,c){var d=limk.jQuery(c).data("widget-id");if(limk.settings.customWidgetInfoExists(d)!==!1){var e=parseInt(limk.settings.widgets.custom[d].custom_article_amount,10);a.push({widgetID:d,articleAmt:e}),limk.API.fetchAmount.customAmt+=e}}),limk.logger.log("[Event.jQueryOnReady] Articles to fetch: (responsive: "+limk.API.fetchAmount.responsiveAmt+", horizontal: "+limk.API.fetchAmount.horizontalAmt+", vertical: "+limk.API.fetchAmount.verticalAmt+", custom: "+limk.API.fetchAmount.customAmt+")"),limk.logger.log("[API] Requesting to fetch {"+this.fetchAmount.getTotal()+"} articles from our API."),limk.jQuery.ajax({url:limk.environment.apiUrl()+limk.API.version+"/site/"+limk.key.siteID+"/articles",type:"GET",jsonp:"callback",dataType:"jsonp",data:{domain:document.domain,currentPage:document.URL,platform:limk.platform.getPlatform(),deviceInfo:limk.device.getDeviceInformation(),osInfo:limk.device.getOsInformation(),widgets:{amounts:{total:limk.API.fetchAmount.getTotal(),responsive:limk.API.fetchAmount.responsiveAmt,vertical:limk.API.fetchAmount.verticalAmt,horizontal:limk.API.fetchAmount.horizontalAmt,custom:limk.API.fetchAmount.customAmt},responsive:{allowAds:limk.settings.widgets.responsive.allowAds},vertical:{allowAds:limk.settings.widgets.vertical.allowAds},horizontal:{allowAds:limk.settings.widgets.horizontal.allowAds,articlesPerWidget:limk.settings.widgets.horizontal.articleAmount},custom:a}}}).done(function(a){if("number"==typeof a.errcode)throw limk.logger.log("[API] Fail: "+a.message),new Error("[API] Fetch error: {"+a.message+"}");limk.logger.log("[API] Fetch success! {"+a.recommendationsAmt+"} articles are fetched with {"+a.algorithm+"} algorithm."),limk.jQuery.each(a.responsive,function(a,b){limk.API.collection.add("responsive",b)}),limk.jQuery.each(a.vertical,function(a,b){limk.API.collection.add("vertical",b)}),limk.jQuery.each(a.horizontal,function(a,b){limk.jQuery.each(b,function(a,b){limk.API.collection.add("horizontal",b)})}),limk.jQuery.each(a.custom,function(a,b){limk.jQuery.each(b,function(a,b){limk.API.collection.add("custom",b)})}),limk.logger.log("[Collection] Collection received {"+limk.API.collection.countAll()+"} articles."),limk.jQuery.each([limk.API.collection.articles.responsive,limk.API.collection.articles.vertical,limk.API.collection.articles.horizontal,limk.API.collection.articles.custom],function(){limk.jQuery.each(this,function(a,b){b.getId=function(){return this.id},b.getType=function(){return this.type},b.isSponsored=function(){return"creative"===this.getType()||"fake"===this.getType()},b.isInternal=function(){return"article"===this.getType()},b.hasImage=function(){return"NO_IMAGE"!==this.image},b.is=function(a){return this.getType()===a},b.getImage=function(){var a=arguments.length<=0||void 0===arguments[0]?0:arguments[0],b=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return this.isSponsored()===!1?this.image:(limk.logger.log("[Collection] Sending sponsored content image to our image compressor service with width "+b+" height "+a),"local"===limk.environment.get()?this.image:limk.environment.imgUrl()+"img.php?src="+this.image+"&optimize=1&width="+b+"&height="+a)},b.hasVideo=function(){return 1===this.has_video},b.isSponsored()&&(limk.API.collection.hasSponsoredContent=!0)})}),limk.event.apiCallComplete("api.articles.fetch")})},fetchWidget:function(a){limk.cache.has()===!1||limk.settings.forceNoCache===!0||limk.time.getTimestamp()-limk.cache.getTimestamp()>=limk.settings.cacheDuration?(limk.logger.log("[API] There is either no cache, or settings.forceNoCache is enabled, or cache duration expired."),limk.logger.log("[API] Attempting to fetch the widget code again."),limk.jQuery.ajax({url:limk.environment.apiUrl()+this.version+"/widget/"+a,type:"GET",jsonp:"callback",dataType:"jsonp",data:{domain:document.domain}}).done(function(a){if("number"==typeof a.errcode)throw limk.logger.log("[API] Fail: "+a.message),new Error("[API] Fetch error: {"+a.message+"}");limk.logger.log("[API] Fetch success! {"+a+"}"),limk.API.jsonCode=JSON.parse(a),limk.cache.put(limk.API.jsonCode),limk.loader.loadpluginShareText(),limk.loader.loadpluginShareImage(),limk.event.apiCallComplete("api.widget.fetch"),limk.API.fetchArticles()})):(limk.logger.log("[API] Using the json value in cache."),limk.API.jsonCode=JSON.parse(limk.cache.get()),limk.loader.loadpluginShareText(),limk.loader.loadpluginShareImage(),limk.event.apiCallComplete("api.widget.cachedValueUsed"),limk.API.fetchArticles())}},event:{loaded:[],apiCalls:[],apiCallComplete:function(a){limk.logger.log("[Event] { "+a+"} API call completed."),this.apiCalls.push(a),limk.event.callback()},onjQueryReady:function(){return"function"!=typeof jQuery||"undefined"==typeof jQuery?(limk.logger.log("[Event] Sorry, couldn't load jquery from CDN"),!1):(limk.loader.jquery.requiresBackup===!0?(limk.logger.log("[Event] jQuery requires a backup. Enabling jQuery.noConflict mode."),limk.jQuery=jQuery.noConflict(),limk.logger.log("[Event] Reverting global versions to their instances."),window.$=limk.loader.jquery.theirInstance,window.jQuery=limk.loader.jquery.theirInstance):(limk.logger.log("[Event] jQuery is installed - referencing window.jQuery as version is suitable."),limk.jQuery=window.jQuery),limk.event.loaded.push("jQuery"),void limk.app.run())},onHammerJsReady:function(){limk.logger.log("[Event] HammerJS is installed!"),limk.event.loaded.push("hammerJS"),limk.event.callback()},onFeatherlightReady:function(){limk.logger.log("[Event] Featherlight is installed!"),limk.event.loaded.push("featherlight"),limk.event.callback()},onImageScaleReady:function(){limk.logger.log("[Event] imageScale is installed!"),limk.event.loaded.push("imageScale"),limk.event.callback()},onPluginShareTextReady:function(){limk.logger.log("[Event] pluginShareText is installed!"),limk.event.loaded.push("pluginShareText"),limk.event.callback()},onPluginShareImageReady:function(){limk.logger.log("[Event] pluginShareImage is installed!"),limk.event.loaded.push("pluginShareImage"),limk.event.callback()},callback:function(){return this.apiCalls.length===limk.settings.getRequiredApiCalls()&&(1===limk.settings.getRequiredApiCalls()&&4===this.loaded.length||2===limk.settings.getRequiredApiCalls()&&6===this.loaded.length)?(limk.logger.log("[Event] All requirements installed - executing application!"),void limk.app.finalize()):void limk.logger.log("[Event] Waiting for other dependencies. Loaded: {"+this.loaded+"}, API Calls: {"+this.apiCalls.length+"}")}},cache:{handler:null,run:function(){return limk.logger.log("[Cache] Initializing..."),this.can.first()===!1?void limk.logger.log("[Cache] This browser doesn't support any caches we support. Continuing without caches."):"localStorage"===this.can.first()?(limk.logger.log("[Cache] LocalStorage support available. Handler: {LocalStorageHandlerInstance}."),void(this.handler=new a)):void 0},can:{first:function(){return this.localStorage()===!0?"localStorage":!1},localStorage:function(){return"undefined"!=typeof Storage}},ttl:function(){var a=limk.time.getTimestamp(),b=limk.cache.getTimestamp(),c=limk.settings.cacheDuration;return a-b>=c?0:Math.ceil((c-(a-b))/1e3)},has:function(){return this.handler.has()},isUserOptedOut:function(){return this.handler.isUserOptedOut()},exitIntentCooldownPassed:function(){return this.handler.exitIntentCooldownPassed()},setExitIntentCooldownTimestamp:function(){return this.handler.setExitIntentCooldownTimestamp()},get:function(){return this.handler.get()},getTimestamp:function(){return this.handler.getTimestamp()},put:function(a){return this.handler.put(a)},flush:function(){return this.handler.flush()}},loader:{jquery:{version:"1.0",path:"//ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js",theirInstance:null,requiresBackup:!1,initialize:function(){"undefined"!=typeof jQuery&&(limk.logger.log("[Loader] This page has jQuery."),this.version=String(jQuery.fn.jquery),this.theirInstance=jQuery),this.load()},load:function(){var a=limk.versionComparer.initialize(this.version,"1.7");return"bigger"===a||"equals"===a?(limk.logger.log("[Loader] This page have version "+this.version+" - no need to do anything."),this.requiresBackup=!1,void limk.event.onjQueryReady()):(limk.logger.log("[Loader] Fetching jQuery from path {"+limk.environment.getProtocol()+this.path+"}"),this.requiresBackup=!0,void $script(limk.environment.getProtocol()+this.path,limk.event.onjQueryReady))}},loadHammerJS:function(){return limk.device.isMobileOrTablet()===!0?void $script([limk.environment.getProtocol()+"//cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.4/hammer.min.js"],limk.event.onHammerJsReady):void limk.event.onHammerJsReady()},loadFeatherlight:function(){$script([limk.environment.cdnUrl()+"assets/shared/plugins/featherlight/featherlight.1.3.5.min_limk.js"],limk.event.onFeatherlightReady)},loadImageScale:function(){$script([limk.environment.cdnUrl()+"assets/shared/plugins/imagescale/image-scale.min_limk.js"],limk.event.onImageScaleReady)},loadpluginShareText:function(){return 1!==limk.API.jsonCode.pluginShareText?(limk.logger.log("[Loader] No need to load pluginShareText."),void limk.event.onPluginShareTextReady()):(limk.logger.log("[Loader] Loading pluginShareText"),this.loadCss(limk.environment.cdnUrl()+"assets/shared/plugins/shareText/css/tooltipster.min.css"),void $script([limk.environment.cdnUrl()+"assets/shared/plugins/shareText/js/jquery.tooltipster.min_limk.js",limk.environment.cdnUrl()+"assets/shared/plugins/shareText/js/contentshare_limk.js"],limk.event.onPluginShareTextReady))},loadpluginShareImage:function(){return 1!==limk.API.jsonCode.pluginShareImage?(limk.logger.log("[Loader] No need to load pluginShareImage."),void limk.event.onPluginShareImageReady()):(limk.logger.log("[Loader] Loading pluginShareImage"),
this.loadCss(limk.environment.cdnUrl()+"assets/shared/plugins/shareImage/css/sti.min.css"),void $script([limk.environment.cdnUrl()+"assets/shared/plugins/shareImage/js/sti_limk.js"],limk.event.onPluginShareImageReady))},loadCustomCssFiles:function(){limk.logger.log("[Loader] Loading custom css files.");var a=String(limk.key.siteID).slice(0,-2);""===a&&(a=0),limk.loader.loadCss(limk.environment.cdnUrl()+"user-styles/"+a+"/"+limk.key.siteID+".user.css"),limk.loader.loadCss(limk.environment.cdnUrl()+"user-styles/"+a+"/"+limk.key.siteID+".admin.css")},loadApplication:function(){$script([limk.environment.cdnUrl()+"assets/shared/js/limk-related-widget.min.js"],"application")},loadCss:function(a){if(document.createStyleSheet)return void document.createStyleSheet(a);var b=document.createElement("link");b.href=a,b.rel="stylesheet",b.media="screen",b.setAttribute("class","limkrelated");var c=document.getElementsByTagName("head")[0];b.onload=b.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(b.onload=b.onreadystatechange=null)},c.appendChild(b)}}};var a=function(){this.has=function(){return"undefined"!=typeof localStorage.jsonCode},this.isUserOptedOut=function(){return"undefined"!=typeof localStorage.limk_optout},this.exitIntentCooldownPassed=function(){if("undefined"==typeof localStorage.limkExitIntentCooldownTimestamp)return limk.logger.log("[LocalStorageHandlerInstance] Exit-intent is undefined, so Exit-intent cooldown passed."),!0;var a=localStorage.limkExitIntentCooldownTimestamp,b=limk.time.getTimestamp(),c=limk.settings.exitIntentCooldown;if(b-a>=c)return limk.logger.log("[LocalStorageHandlerInstance] Exit-intent cooldown passed."),!0;var d=Math.ceil((c-(b-a))/1e3);return limk.logger.log("[LocalStorageHandlerInstance] Exit-intent is still on cooldown. Remaining: "+d+" seconds."),!1},this.setExitIntentCooldownTimestamp=function(){localStorage.setItem("limkExitIntentCooldownTimestamp",limk.time.getTimestamp())},this.get=function(){return limk.logger.log("[LocalStorageHandlerInstance] Getting local storage value: "+localStorage.jsonCode),localStorage.jsonCode},this.getTimestamp=function(){return"undefined"!=typeof localStorage.jsonCode?localStorage.timestamp:0},this.put=function(a){return limk.logger.log("[LocalStorageHandlerInstance] Putting local storage value: "+a),localStorage.setItem("jsonCode",JSON.stringify(a)),localStorage.setItem("timestamp",limk.time.getTimestamp()),!0},this.flush=function(){return localStorage.removeItem("jsonCode"),localStorage.removeItem("timestamp"),!0}};limk.app.bootstrap()}}();