//!     uuid.js
//!     Copyright (c) 2010-2012 Robert Kieffer
//!     MIT License - http://opensource.org/licenses/mit-license.php
(function(){function e(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=c[e])});i<16;)t[r+i++]=0;return t}function t(e,t){var n=t||0,r=s;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function n(e,n,i){var o=n&&i||0;"string"==typeof e&&(n="binary"==e?new a(16):null,e=null),e=e||{};var s=e.random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,n)for(var c=0;c<16;c++)n[o+c]=s[c];return n||t(s)}var r,i=this,o=new Array(16);r=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o};for(var a=Array,s=[],c={},u=0;u<256;u++)s[u]=(u+256).toString(16).substr(1),c[s[u]]=u;var d=n;d.v4=n,d.parse=e,d.unparse=t,d.BufferClass=a;var l=i.uuid;d.noConflict=function(){return i.uuid=l,d},i.uuid=d}).call(this),function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(2),o=n(3),a=n(7),s=n(12),c=n(15),u=r(c),d=n(20),l=r(d),p=n(13),f=r(p),h=n(23),g=r(h);window.Kx=window.Kx||{},window.Kx.log=function(){return f.default}(),window.Kx.Request=function(){return g.default}(),window.Kx.Markup=function(){return{getViewPixel:a.getViewPixel,appendUTMParameter:a.appendUTMParameter}}(),window.Kx.Helper=window.Kx.Helper||{},window.Kx.Helper.Util=function(){var e={};return e.mergeObjects=n(21).default,e.isRealObject=n(5).isRealObject,e.compactArray=n(6).default,e.wordCount=n(24).default,e.uniqueID=function(){return uuid.v4()},e.hasOnlyWhitespaces=n(4).default,e.findStringInText=n(18).default,e.domReady=n(25).default,e.replacePlaceholder=n(8).default,e.sortByKeyDESC=n(26).sortByKeyDESC,e}(),window.Kx.Helper.DOM=function(){return{nodesBySelector:i.nodesBySelector,firstChild:i.firstChild,nextSibling:i.nextSibling,nodeType:i.nodeType,isTextNode:i.isTextNode,nodeName:i.nodeName,textContent:i.textContent,parentNode:i.parentNode,nodeValue:i.nodeValue,setNodeValue:i.setNodeValue,addAttributeToNode:i.addAttributeToNode,hasKxAttribute:i.hasKxAttribute}}(),window.Kx.Helper.NodeFilter=function(){return{containsValidText:o.containsValidText,isMarked:o.isMarked,isContentNode:o.isContentNode,hasEnoughWords:o.hasEnoughWords}}(),window.Kx.Helper.ContentParser=function(){return{findPossibleKeywords:l.default}}(),window.Kx.Helper.Strategy=function(){return{getCampaignById:s.getCampaignById}}(),window.Kx.Strategy=window.Kx.Strategy||{},window.Kx.Strategy.Xtraffic=window.Kx.Strategy.Xtraffic||{},window.Kx.Strategy.Xtraffic=function(){return u.default}()},function(e,t){"use strict";function n(e){var t=document.querySelectorAll(e),n=[].slice.call(t);return n}function r(e){return e.firstChild}function i(e){return e.nextSibling}function o(e){return e.nodeType}function a(e){return 3===o(e)}function s(e){return e.nodeName.toLowerCase()}function c(e){return e.textContent}function u(e){return e.parentNode}function d(e){return e.nodeValue}function l(e,t){e.nodeValue=t}function p(e,t){var n=document.createAttribute(t.name);return n.value=t.value,e.setAttributeNode(n),e}function f(e){return 8!==o(e)&&e.hasAttribute("data-kx")}Object.defineProperty(t,"__esModule",{value:!0}),t.nodesBySelector=n,t.firstChild=r,t.nextSibling=i,t.nodeType=o,t.isTextNode=a,t.nodeName=s,t.textContent=c,t.parentNode=u,t.nodeValue=d,t.setNodeValue=l,t.addAttributeToNode=p,t.hasKxAttribute=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=(0,c.nodeValue)(e);return!(null===t||(0,d.default)(t))}function o(e){return(0,c.hasKxAttribute)(e)}function a(e,t){var n=(0,c.nodeName)(e);return t.indexOf(n)>-1}function s(e,t){var n=(0,c.textContent)(e),r=(0,p.default)(n.split(/\s/));return r.length>=t}Object.defineProperty(t,"__esModule",{value:!0}),t.containsValidText=i,t.isMarked=o,t.isContentNode=a,t.hasEnoughWords=s;var c=n(2),u=n(4),d=r(u),l=n(6),p=r(l)},function(e,t,n){"use strict";function r(e){return!(0,i.isString)(e)||0===e.trim().length}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5)},function(e,t){"use strict";function n(e){return"undefined"==typeof e}function r(e){return null===e}function i(e){return"string"==typeof e}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e){return"function"==typeof e}function s(e){return!a(e)&&(n(e)||r(e)||0===e.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.isUndefined=n,t.isNull=r,t.isString=i,t.isRealObject=o,t.isFunction=a,t.isEmpty=s},function(e,t){"use strict";function n(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t="x"+window.Kx.Helper.Util.uniqueID(),n=document.createElement("span");n.className="kx-rlink-container "+t;var r=document.createElement("a"),i=void 0;e.campaign.keywords.forEach(function(t){t.name===e.keyword&&(i=t)}),Kx.log("keywordObject: Xtraffic: ",i),r.href=i.targetURL;var a="";i.tags&&i.tags.length>0&&(a=i.tags.join(","));var c=(0,u.default)(i.clickTrackingURL,{pid:e.publisherId,cid:e.campaign.id,format:"rlink",keyword:e.keyword,sessionid:e.sessionId,ref:e.referrer,target:o(i.targetURL,e.campaign.utm,e.keyword),tags:a});if(r.setAttribute("onclick",'this.href="'+c+'"'),i.tooltip&&(r.title=i.tooltip),r.target="_self",r.rel="nofollow",r.className="kx-ad-link",r.appendChild(document.createTextNode(e.keyword)),n.appendChild(r),i.iconURL&&i.iconURL.length>0){var d={cssNamespace:t};i.tooltip&&(d.tooltip=i.tooltip),d.iconHeight=e.kxObject.config.iconSize,d.iconURL=i.iconURL;var l=s(d);r.appendChild(l)}return n}function o(e,t,n){if(t){var r=[];Object.keys(t).forEach(function(e){t.hasOwnProperty(e)&&("term"===e?r.push("utm_"+e+"="+(0,u.default)(t[e],{keyword:n})):r.push("utm_"+e+"="+encodeURIComponent(t[e])))});var i=document.createElement("a");return i.href=e,r.unshift(i.search),i.search=r.join("&"),i.href}return e}function a(e){var t=document.createElement("img");return t.src=e.replace(/(\[timestamp\]|\{timestamp\})/,(new Date).getTime()),t.height=1,t.width=1,t.style.opacity=.01,t.style.position="absolute",t.style.left="-10000px",t}function s(e){function t(e){return setTimeout(function(){e.className="kx-ad-logo"},1e3)}var n=!1,r=void 0,i=void 0,o=document.createElement("img");o.className="kx-ad-logo kx-init",o.style.opacity=.01,o.alt=e.tooltip,o.onload=function(a){if(!n){n=!0;var s=a.target;t(s);var c=s.width/s.height,u=e.iconHeight*c,d=u<27?"-2px":"-4px";Kx._css.addRules([{selector:"."+e.cssNamespace+".kx-rlink-container .kx-logo-container",declarations:{height:"10px",width:u+2+"px"}},{selector:"."+e.cssNamespace+".kx-rlink-container .kx-ad-logo",declarations:{height:e.iconHeight+"px",bottom:d,left:"2px",width:"auto"}},{selector:"."+e.cssNamespace+".kx-rlink-container .kx-ad-logo.kx-init",declarations:{height:2.35*e.iconHeight+"px"}},{selector:"."+e.cssNamespace+".kx-rlink-container .kx-ad-link:hover .kx-ad-logo",declarations:{height:2.35*e.iconHeight+"px"}}]),r||(i=!0),!r&&i?(i=!1,r=o.complete||4===o.readyState,setTimeout(function(){var e=(0,f.default)("load");n=!1,s.dispatchEvent(e)},500)):s.style.opacity=1}},(0,l.default)(e.iconURL)?o.src=e.iconURL:o.src="//kkastatic.s3.amazonaws.com/"+e.iconURL,r=o.complete||4===o.readyState;var a=document.createElement("span");if(a.className="kx-logo-container",a.appendChild(o),o.complete||4===o.readyState){var s=(0,f.default)("load");o.dispatchEvent(s)}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkFragment=i,t.appendUTMParameter=o,t.getViewPixel=a,t.getImageElement=s;var c=n(8),u=r(c),d=n(10),l=r(d),p=n(11),f=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=(0,a.default)(n),i=new RegExp("(%"+r+"%|%25"+r+"%25)","g");e=e.replace(i,encodeURIComponent(t[n]))}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(9),a=r(o)},function(e,t){"use strict";function n(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e){var t=e.toLowerCase();return 0===t.indexOf("http")||0===t.indexOf("//")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e){var t=void 0;try{t=new Event(e)}catch(n){t=document.createEvent("Event"),t.initEvent(e,!0,!0)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=void 0;return t.campaigns.forEach(function(t){t.id===e&&(n=t)}),n}function o(e,t){var n=e.keywordResult[0],r=n.keyword.slice(0,-1),i=n.index,o=(0,l.nodeValue)(e.node),a=(0,u.getLinkFragment)({keyword:r,campaign:e.campaign,publisherId:e.publisherId,sessionId:e.sessionId,referrer:e.referrer,kxObject:t.kxObject}),s=[];if(0===n.index){s.push(a);var c=o.substring(i+r.length,o.length);s.push(document.createTextNode(c))}else{var p=o.substring(0,i);if(s.push(document.createTextNode(p)),s.push(a),o.length!==i+r.length){var f=o.substring(i+r.length,o.length);s.push(document.createTextNode(f))}}e.node.nodeValue="";var h=e.node.nextSibling;h?s.forEach(function(e){h.parentNode.insertBefore(e,h)}):s.forEach(function(t){e.node.parentNode.appendChild(t)}),t.maxKeywordsInspector.addKey("keyword");var g=void 0;e.campaign.keywords.forEach(function(e){e.name===r&&(g=e)});var x={event_type:"placement.rlink",campaign_id:e.campaign.id+"",ad_format:"rlink",keywords:[r]};if(g.tags&&g.tags.length>0&&(x.tags=g.tags),Kx._tracker.track(x),Kx._is_pi_with_placement_tracked||(Kx._tracker.track({event_type:"pi-with-placement"}),Kx._is_pi_with_placement_tracked=!0),(0,d.viewPixelUriIsSet)(e.campaign)){var y=(0,u.getViewPixel)(e.campaign.impressionTrackingURL);document.body.appendChild(y)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getCampaignById=i,t.setKeywordLink=o;var a=n(6),s=(r(a),n(9)),c=(r(s),n(13)),u=(r(c),n(7)),d=n(14),l=n(2)},function(e,t){"use strict";function n(){var e=document.cookie.split(";"),t=e.indexOf("KX-Debug=Deiyah3b");if(t>=0){var n;(n=console).log.apply(n,arguments)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e){return void 0!==e.impressionTrackingURL&&null!==e.impressionTrackingURL&&""!==e.impressionTrackingURL}Object.defineProperty(t,"__esModule",{value:!0}),t.viewPixelUriIsSet=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(16),s=r(a),c=n(17),u=r(c),d=n(13),l=r(d),p=n(18),f=r(p),h=n(19),g=n(2),x=n(12),y=(n(7),function(){function e(t,n){i(this,e),(0,s.default)(t),(0,s.default)(n),this.kxObject=t,this.parser=n,this.maxKeywordsInspector=new u.default(3),(0,l.default)("XTRAFFIK"),this.run()}return o(e,[{key:"run",value:function(){var e=this;(0,l.default)("RUN"),this.parser.parserResult.paragraphs.forEach(function(t){return 0===t.possibleKW.length?void(0,l.default)(t.possibleKW):void t.possibleKW.forEach(function(n){var r=(0,x.getCampaignById)(n.campaignId,e.kxObject);if((0,h.isXtrafficCampaign)(r)){var i=(0,g.nodesBySelector)(t.selector)[0];e.parser.traverseDomTree(i,function(t){function o(e,t){return e=e||[],t.forEach(function(t){e.push(t)}),e}if((0,g.isTextNode)(t)){for(var a=[],s=["-","–","~"],c=[" ",".",",",";",":","!","?",'"'],u=function(e){var r=(0,g.nodeValue)(t);a=a.concat((0,f.default)(n.name+c[e],r)).filter(function(e){var t=r[e.index-1];return s.every(function(e){return t!==e})})},d=0;d<c.length;d++)u(d);if((0,l.default)("before result empty",a),0!==a.length&&((0,l.default)("before parent check"),(0,g.parentNode)(t)===i)){if(e.maxKeywordsInspector.hitLimit("keyword"))return void(0,l.default)("maxKeywordsInspector");var p=e.kxObject.config.styles||{},h=o(p.rlink||[],[{selector:".kx-rlink-container",declarations:{position:"relative",display:"inline","font-size":"inherit !important"}},{selector:".kx-rlink-container .kx-ad-link, .kx-rlink-container .kx-logo-container",declarations:{position:"relative",display:"inline-block"}},{selector:".kx-rlink-container .kx-ad-logo",declarations:{position:"absolute",transition:"all .5s","max-width":"none !important","max-height":"none","min-width":"0","min-height":"0",margin:"0",padding:"0",border:"0"}}]);Kx._css.addRules(h),(0,x.setKeywordLink)({node:t,keywordResult:a,campaign:r,publisherId:e.kxObject.id,sessionId:Kx._sessionId,referrer:document.location.href},e)}}})}})})}}]),e}());t.default=y},function(e,t){"use strict";function n(e){if(void 0===e||null===e)throw new Error("Passed argument is undefined")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this.limit=t,this.store={}}return r(e,[{key:"addKey",value:function(e){this.store[e]=this.store[e]?this.store[e]+1:1}},{key:"hitLimit",value:function(e){return this.store[e]>=this.limit}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=new RegExp((0,a.default)(e),"g"),r=[],i=void 0;do i=n.exec(t),i&&r.push({keyword:i[0],index:i.index});while(i);return r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(9),a=r(o)},function(e,t){"use strict";function n(e){return"xtraffic"===e.type.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.isXtrafficCampaign=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=[];return t.forEach(function(t){t.keywords&&1===t.keywords.length&&"matchAny"===t.keywords[0].name?n.push({campaignId:t.id,name:"matchAny"}):t.keywords.forEach(function(r){var i=(0,s.default)(r.name,(0,o.textContent)(e));i.forEach(function(){var e=(0,u.default)(r,{campaignId:t.id});n.push(e)})})}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(2),a=n(18),s=r(a),c=n(21),u=r(c)},function(e,t,n){"use strict";function r(e){var t=Array.prototype.slice.call(arguments);for(t=t.reverse(),e=t.pop(),(0,o.throwIfNoRealObject)(e);t.length>0;){var n=t[t.length-1];(0,o.throwIfNoRealObject)(n);for(var a in n)(0,i.isRealObject)(n[a])&&(0,i.isRealObject)(e[a])?e[a]=r(e[a],n[a]):e[a]=n[a];t.pop()}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),o=n(22)},function(e,t,n){"use strict";function r(e){if((0,a.isUndefined)(e)||(0,a.isNull)(e))throw new TypeError("Passed argument is undefined or null")}function i(e,t){if((0,a.isString)(e)&&e.length<t)throw new Error("Passed string is too short")}function o(e){if(!(0,a.isRealObject)(e))throw new TypeError("[object Object] expected")}Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfUndefinedOrNull=r,t.throwIfStringTooShort=i,t.throwIfNoRealObject=o;var a=n(5)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){return n(this,e),this.config=t,this}return r(e,[{key:"send",value:function(e){function t(){for(var e=!1,t=0;t<r.length;t++){try{e=r[t]()}catch(e){continue}break}return e}var n=this,r=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=t();i.open(this.config.verb,this.config.url,1),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","application/json"),i.onreadystatechange=function(){i.readyState>3&&(i.status>=200&&i.status<400?n.config.successCb(i.responseText):n.config.errorCb(i.responseText))},i.send(e)}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e||"";return(0,a.default)(t.split(" ")).length}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(6),a=r(o)},function(e,t){"use strict";/*!
	 * contentloaded.js
	 *
	 * Author: Diego Perini (diego.perini at gmail.com)
	 * Summary: cross-browser wrapper for DOMContentLoaded
	 * Updated: 20101020
	 * License: MIT
	 * Version: 1.2
	 *
	 * URL:
	 * http://javascript.nwbox.com/ContentLoaded/
	 * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE
	 *
	 */
function n(e,t){var n=!1,r=!0,i=e.document,o=i.documentElement,a=i.addEventListener,s=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",u=a?"":"on",d=function r(o){"readystatechange"==o.type&&"complete"!=i.readyState||(("load"==o.type?e:i)[c](u+o.type,r,!1),!n&&(n=!0)&&t.call(e,o.type||o))},l=function e(){try{o.doScroll("left")}catch(t){return void setTimeout(e,50)}d("poll")};if("complete"==i.readyState)t.call(e,"lazy");else{if(!a&&o.doScroll){try{r=!e.frameElement}catch(e){}r&&l()}i[s](u+"DOMContentLoaded",d,!1),i[s](u+"readystatechange",d,!1),e[s](u+"load",d,!1)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t){return e<t?-1:e>t?1:0}function r(e,t){return e<t?1:e>t?-1:0}function i(e,t,n){return e.sort(function(e,r){return n(e[t],r[t])})}function o(e,t){return i(e,t,n)}function a(e,t){return i(e,t,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.sortByKey=i,t.sortByKeyASC=o,t.sortByKeyDESC=a}]);var Kx=Kx||{};Kx.Strategy=function(e){return e}(Kx.Strategy||{});var Kx=Kx||{};Kx.Strategy.DefaultRLink=function(e){function t(e){return void 0!==e.impressionTrackingURL&&""!=e.impressionTrackingURL}var n=Kx.Helper.DOM,r=Kx.Helper.Util,i=Kx.Markup,o=Kx.Helper.Strategy;e=function(e,t){if(void 0===e)throw new TypeError("kxObject expected");if(void 0===t)throw new TypeError("parser expected");this.type="rLink",this.kxObject=e,this.parser=t;var n=e.config.displayRules.rlink;n&&(this.maxKeywordsInspector=new Kx.RuleInspector(n.max),this.maxEqualKeywordsInspector=new Kx.RuleInspector(2),this.maxEqualLogosInspector=new Kx.RuleInspector(n.maxLogos),this.maxLogosPerKeywordsInspector=new Kx.RuleInspector(n.maxLogosPerKw)),Kx.log("RLINK"),this.run()};var a;return e.prototype.run=function(){function e(e,t){return e=e||[],t.forEach(function(t){e.push(t)}),e}Kx.log("run"),Kx.log("rlp",this.parser),this.parser.parserResult.paragraphs.forEach(function(e){return 0===e.possibleKW.length?void Kx.log(e.possibleKW):void e.possibleKW.forEach(function(t){var i=o.getCampaignById(t.campaignId,this.kxObject);if(Kx.log(i),!(i&&i.formats[0].toLowerCase()!==this.type.toLowerCase()||"xtraffic"===i.type.toLowerCase())){var s=n.nodesBySelector(e.selector)[0];this.parser.traverseDomTree(s,function(e){function o(e,t){var n=e.host+e.pathname,r=t.host+t.pathname;return n==r}if(n.isTextNode(e)){for(var c=[],u=["-","–","~"],d=[" ",".",",",";",":","!","?",'"'],l=0;l<d.length;l++){var p=n.nodeValue(e);c=c.concat(r.findStringInText(t.name+d[l],p).filter(function(e){var t=p[e.index-1];return u.every(function(e){return t!==e})}))}if(Kx.log("before result empty",c),0!==c.length&&(Kx.log("before parent check"),n.parentNode(e)===s)){var f=document.createElement("a");if(f.href=i.targetURL,o(document.location,f))return void Kx.log("TargetURL is the same as the current URL.");if(this.maxKeywordsInspector&&this.maxKeywordsInspector.hitLimit("keyword"))return void Kx.log("maxKeywordsInspector");if(this.maxEqualKeywordsInspector&&this.maxEqualKeywordsInspector.hitLimit(t.name))return void Kx.log("maxEqualKeywordsInspector");var h=(this.getKeywordFromCampaignByName(i,t.name),i.iconURL);if(this.maxEqualLogosInspector&&this.maxEqualLogosInspector.hitLimit(h))return void Kx.log("maxEqualLogosInspector");if(this.maxLogosPerKeywordsInspector&&this.maxLogosPerKeywordsInspector.hitLimit(h+"_"+t.name))return void Kx.log("maxLogosPerKeywordsInspector");var g=this.kxObject.config.iconSize,x=this.setKeywordLink(e,c,h,i,g);x&&(a=x)}}},this)}},this)},this);var t=Kx._css,i=(this.kxObject.config.iconSize,this.kxObject.config.styles||{}),s=e(i.rlink||[],[{selector:".kx-rlink-container",declarations:{position:"relative",display:"inline","font-size":"inherit !important"}},{selector:".kx-rlink-container .kx-ad-link, .kx-rlink-container .kx-logo-container",declarations:{position:"relative",display:"inline-block",float:"none !important"}},{selector:".kx-rlink-container .kx-ad-logo",declarations:{position:"absolute",transition:"all .5s","max-width":"none !important","max-height":"none","min-width":"0","min-height":"0",margin:"0",padding:"0",border:"0"}}]);t.addRules(s)},e.prototype.getKeywordFromCampaignByName=function(e,t){var n;return e.keywords.forEach(function(e){e.name===t&&(n=e)}),n},e.prototype.setKeywordLink=function(e,r,o,s,c){var r=r[0],u=r.keyword.slice(0,-1),d=r.index,l=n.nodeValue(e),p=this.getRLinkHtml({keyword:u,campaignIcon:o,campaign:s,iconHeight:c}),f=[];if(0===r.index){f.push(p);var h=l.substring(d+u.length,l.length);f.push(document.createTextNode(h))}else{var g=l.substring(0,d);if(f.push(document.createTextNode(g)),f.push(p),l.length!==d+u.length){var x=l.substring(d+u.length,l.length);f.push(document.createTextNode(x))}}e.nodeValue="";var y=e.nextSibling,m=document.createElement("span");m.style.opacity=0,m.style.height=0,m.style.width=0,m.style.display="inline-block",this.kxObject.config.displayRules.rlink;var v=0;this.kxObject.config.displayRules.rlink&&(v=this.kxObject.config.displayRules.rlink.minVerticalSpacing);var k=!0;if(y){if(a){y.parentNode.insertBefore(m,y);var w=m.getBoundingClientRect();y.parentNode.removeChild(m),a.getBoundingClientRect().top+v>w.top&&(k=!1)}}else if(a){e.parentNode.appendChild(m);var w=m.getBoundingClientRect();e.parentNode.removeChild(m),a.getBoundingClientRect().top+v>w.top&&(k=!1)}if(k||f.forEach(function(e,t){e===p&&(f[t]=document.createTextNode(e.textContent))}),y?f.forEach(function(e){y.parentNode.insertBefore(e,y)}):f.forEach(function(t){e.parentNode.appendChild(t)}),k){if(this.maxKeywordsInspector&&this.maxKeywordsInspector.addKey("keyword"),this.maxEqualKeywordsInspector&&this.maxEqualKeywordsInspector.addKey(u),this.maxEqualLogosInspector&&this.maxEqualLogosInspector.addKey(o),this.maxLogosPerKeywordsInspector&&this.maxLogosPerKeywordsInspector.addKey(o+"_"+u),Kx._tracker.track({event_type:"placement.rlink",campaign_id:s.id+"",ad_format:"rlink",keywords:[u]}),Kx._is_pi_with_placement_tracked||(Kx._tracker.track({event_type:"pi-with-placement"}),Kx._is_pi_with_placement_tracked=!0),t(s)){var K=i.getViewPixel(s.impressionTrackingURL);document.body.appendChild(K)}return p}},e.prototype.getRLinkHtml=function(e){function t(e){return setTimeout(function(){e.className="kx-ad-logo"},1e3)}var n="x"+r.uniqueID(),o=document.createElement("span");o.className="kx-rlink-container kka-active "+n;var a=document.createElement("a"),s=e.campaign.targetURL;e.campaign.clickTrackingURL&&""!=e.campaign.clickTrackingURL&&(s=r.replacePlaceholder(e.campaign.clickTrackingURL,{pid:this.kxObject.id,cid:e.campaign.id,format:"rlink",keyword:e.keyword,sessionid:Kx._sessionId,ref:document.location.href,target:r.replacePlaceholder(i.appendUTMParameter(e.campaign.targetURL,e.campaign.utm,e.keyword),{pid:this.kxObject.id,keyword:e.keyword,ref:document.location.href})})),a.setAttribute("onclick",["this.href='",s,"'"].join("")),a.href=e.campaign.targetURL,a.title=e.campaign.tooltip||"",a.target="_blank",a.rel="nofollow",a.className="kx-ad-link",a.appendChild(document.createTextNode(e.keyword)),o.appendChild(a),Kx.log("kx:",e.keyword);var c,u,d=!1,l=document.createElement("img");if(l.className="kx-ad-logo kx-init",l.style.opacity=.01,l.alt=e.campaign.tooltip,l.onload=function(r){if(!d){d=!0;var i=r.target;t(i);var o=i.width/i.height,a=e.iconHeight*o;Kx.log("RLINK: iconHeight, imageRation",e.iconHeight,o),Kx._css.addRules([{selector:"."+n+".kx-rlink-container",declarations:{float:"none !important"}},{selector:"."+n+".kx-rlink-container .kx-logo-container",declarations:{height:"10px",width:a+2+"px"}},{selector:"."+n+".kx-rlink-container .kx-ad-logo",declarations:{height:e.iconHeight+"px",bottom:"-2px",left:"2px",width:"auto"}},{selector:"."+n+".kx-rlink-container .kx-ad-logo.kx-init",declarations:{height:2.35*e.iconHeight+"px"}},{selector:"."+n+".kx-rlink-container .kx-ad-link:hover .kx-ad-logo",declarations:{height:2.35*e.iconHeight+"px"}}]),c||(u=!0),!c&&u?(u=!1,c=l.complete||4===l.readyState,setTimeout(function(){var e;try{e=new Event("load")}catch(t){e=document.createEvent("Event"),e.initEvent("load",!0,!0)}d=!1,i.dispatchEvent(e)},500)):i.style.opacity=1}},e.campaignIcon&&e.campaignIcon.length>0){l.src=e.campaignIcon,c=l.complete||4===l.readyState;var p=document.createElement("span");p.className="kx-logo-container",p.appendChild(l),a.appendChild(p)}if(l.complete||4===l.readyState){var f;try{f=new Event("load")}catch(e){f=document.createEvent("Event"),f.initEvent("load",!0,!0)}l.dispatchEvent(f)}return o},e}(Kx.Strategy.DefaultRLink),function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){e.exports=n(27)},27:function(e,t,n){"use strict";window.Kx=window.Kx||{},window.Kx.Strategy=window.Kx.Strategy||{},window.Kx.Strategy.DefaultIWidget=window.Kx.Strategy.DefaultIWidget||{},window.Kx.Strategy.DefaultIWidget=function(e){var t=Kx.Helper.DOM,r=Kx.Helper.Util,i=n(28).default,o=Kx.Markup,a=Kx.Helper.Strategy,s=new i;return e=function(e,t){if(void 0===e)throw new TypeError("kxObject expected");if(void 0===t)throw new TypeError("parser expected");this.kxObject=e,this.parser=t,this.type="iWidget",this.maxPlacementsInspector=new Kx.RuleInspector(1),this.run()},e.prototype.run=function(){function e(e){return function(t){return t.weight===e}}function n(e){return Math.floor(Math.random()*e)}function i(e,t){return e[t(e.length)]}var o=[],s=t.nodesBySelector(this.kxObject.config.contentSelector),c=[];if(s.forEach(function(e){c.push(t.textContent(e))}),this.parser.parserResult.paragraphs.forEach(function(e){var n=t.nodesBySelector(e.selector)[0];o.push(n)}),Kx.log("default_iwidget:possibleNodes",o),!(o<=0)){this.parser.parserResult.paragraphs.forEach(function(e){0!==e.possibleKW.length&&e.possibleKW.forEach(function(e){var t=a.getCampaignById(e.campaignId,this.kxObject);t&&t.formats[0].toLowerCase()!==this.type.toLowerCase()},this)},this);var u,d=this.getCampaignsByFormat("iWidget"),l=r.sortByKeyDESC(d,"weight"),p=l.filter(e(l[0].weight));u=1===p.length?p[0]:i(p,n),Kx.log("iwidget:highestWeightCampaigns",p,"used campaign",u);var f=this.kxObject.config.displayRules.iwidget||{};f.skipParagraphs||(f.skipParagraphs=1);var h;f.skipParagraphs<0?(h=o.length+f.skipParagraphs,h<=0&&(h=1)):(h=f.skipParagraphs-1,h>=o.length&&(h=o.length-1)),void 0!==o[h]&&(this.maxPlacementsInspector.hitLimit("iwidget")||(this.setIWidget(o[h],u),this.maxPlacementsInspector.addKey("iwidget")))}},e.prototype.getCampaignsByFormat=function(e){var t=[];return this.kxObject.campaigns.forEach(function(n){n.formats[0]===e.toLowerCase()&&t.push(n)}),t},e.prototype.setIWidget=function(e,t){function n(e){return void 0!==e.impressionTrackingURL&&""!=e.impressionTrackingURL}function i(e,t){return e=e||[],t.forEach(function(t){e.push(t)}),e}var a=this.kxObject.config.displayRules.iwidget||{},c=document.createElement("iframe");c.className="kx-iwidget-iframe";for(var u=0,d=[],l=0;l<t.keywords.length;l++)u<(a.maxItems||2)&&(d.push(t.keywords[l].name),u+=1);c.style.opacity=.01,c.height=0,c.width="100%";var p=r.replacePlaceholder(t.targetURL,{pid:this.kxObject.id,cid:t.id,sessionId:Kx._sessionId,keyword:d.join(","),ref:document.location.href,jwt:t.jwt}),f=document.createElement("a");if(f.setAttribute("href",t.targetURL),s.sub("size.set",function(n){0===n.height?(Kx.log("iWidget empty"),e.parentNode.removeChild(c)):(c.height=n.height,c.style.display="block",c.style.opacity=1,Kx._tracker.track({event_type:"placement.iwidget",campaign_id:t.id+"",ad_format:"iwidget",keywords:d}),Kx._is_pi_with_placement_tracked||(Kx._tracker.track({event_type:"pi-with-placement"}),Kx._is_pi_with_placement_tracked=!0))},document.location.protocol+"//"+f.hostname),s.sub("items.set",function(n){0===n.items?(Kx.log("iWidget empty"),e.parentNode.removeChild(c)):(c.height=48*n.items,c.style.display="block",c.style.opacity=1,Kx._tracker.track({event_type:"placement.iwidget",campaign_id:t.id+"",ad_format:"iwidget",keywords:d}))},document.location.protocol+"//a.ktxtr.com"),c.height=48*u,e.nextSibling?e.parentNode.insertBefore(c,e.nextSibling):e.parentNode.appendChild(c),c.src=p,n(t)){var h=o.getViewPixel(t.impressionTrackingURL);document.body.appendChild(h)}var g=Kx._css,x=this.kxObject.config.styles||{},y=i(x.iwidget||[],[{selector:".kx-iwidget-iframe",declarations:{border:"0","margin-bottom":"19px"}}]);g.addRules(y)},e}(window.Kx.Strategy.DefaultIWidget)},28:function(e,t,n){"use strict";function r(){}function i(e){var t=void 0;try{t=JSON.stringify(e)}catch(e){t=null}return t}Object.defineProperty(t,"__esModule",{value:!0});var o=n(29);r.prototype.pub=function(e,t,n,r){var o=void 0;o="undefined"==typeof r?e:e+"|"+i(r),t.postMessage(o,n)},r.prototype.sub=function(e,t,n){(0,o.bindEvent)(window,"message",function(r){var i=void 0;if(r.origin===n){var o=r.data.split("|"),a=o[0];e===a&&(2===o.length&&(i=JSON.parse(o[1])),t(i))}})},t.default=r},29:function(e,t){"use strict";function n(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):window.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function r(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):window.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}function i(e){var t=void 0;try{t=new Event(e)}catch(n){t=document.createEvent("Event"),t.initEvent(e,!0,!0)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.bindEvent=n,t.unbindEvent=r,t.createEvent=i}});var Kx=Kx||{};Kx.AppConfig={},Kx.AppConfig.trackingUrl="//t.ktxtr.com/track.json",Kx.AppConfig.scriptUrl="//a.ktxtr.com/api/publishers/";var Kx=Kx||{};Kx.version="production.20170217103118.e933ae9.HEAD";var Kx=Kx||{};Kx.Tracker=function(e){var t=Kx.Helper.Util,e=function(e){this.baseData=e||{},this.payload=[],this.payloadDump=[];var t=this,n=function(){t.payloadDump=[]},r=function(){t.payloadDump.forEach(function(e){this.payload.push(e)},t)};this.request=new Kx.Request({url:Kx.AppConfig.trackingUrl,verb:"POST",successCb:n,errorCb:r})};return e.prototype.getBaseData=function(){var e={client_timestamp:this.getCurrentTimestamp()};return t.mergeObjects(e,this.baseData)},e.prototype.getCurrentTimestamp=function(){return(new Date).getTime()},e.prototype.mergeWithBaseData=function(e){return t.mergeObjects(this.getBaseData(),e)},e.prototype.track=function(e){var t=this.mergeWithBaseData(e);this.payload.push(this.convertEvent(t)),this.watch()},e.prototype.convertEvent=function(e){var t=["publisher_id","campaign_id","session_id"];for(var n in e)t.indexOf(n)!==-1&&(e[n]=String(e[n]));return e},e.prototype.watch=function(){this.send()},e.prototype.send=function(){this.payloadDump=this.payload,this.payload=[];var e={events:this.payloadDump};this.request.send(JSON.stringify(e))},e}(Kx.Tracker);var Kx=Kx||{};Kx.UserToken=function(e){var t=Kx.Helper.Util,e=function(e){if(void 0===e)throw new TypeError("config expected");e.config.sendUserToken===!0&&(this.setCookie=!0)};return e.prototype.getOrSetToken=function(){return this.userToken=document.cookie.replace(/(?:(?:^|.*;\s*)ktxtrToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),""!==this.userToken?this.userToken:this.setCookie?this.setToken():null},e.prototype.setToken=function(){this.userToken=t.uniqueID(),Kx.log(this.userToken);var e=new Date;return e.setTime(+e+31536e6),document.cookie="ktxtrUID="+this.userToken+"; expires="+e.toGMTString()+"; path=/",this.userToken},e}(Kx.UserToken);var Kx=Kx||{};Kx.ContentParser=function(e){var t=Kx.Helper.DOM,n=Kx.Helper.Util,r=Kx.Helper.NodeFilter,i=Kx.Helper.ContentParser,e=function(e){if(void 0===e)throw new TypeError("config expected");if(void 0===e.config.contentSelector)throw new TypeError("contentSelector expected");var t={paragraphWordThreshold:8,parentAwayFromTextThreshold:3,contentNodes:["p","section","article"]};this.config=n.mergeObjects(t,e||{}),Kx.log(this.config),void 0!==e.config.contentNodes&&(this.config.contentNodes=e.config.contentNodes),Kx.log(this.config),this.parserResult={selector:e.config.contentSelector,paragraphs:[]}};return e.prototype.getParserResult=function(){return this.parserResult},e.prototype.parse=function(){Kx.log(this.config.config.contentSelector);var e=t.nodesBySelector(this.config.config.contentSelector);if(this.config.config.excludeSelector&&this.config.config.excludeSelector.length>0){var n=t.nodesBySelector(this.config.config.excludeSelector);e=e.filter(function(e){return n.indexOf(e)===-1})}return e.forEach(function(e){var t=e;return void 0===t?void Kx.log("NULL"):void this.traverseDomTree(t,this.processNodeIfValid,this)},this),Kx.log("cppr: ",this.parserResult),this.parserResult},e.prototype.traverseDomTree=function(e,n,r){for(r=r||this,n.call(r,e),e=t.firstChild(e);e;)this.traverseDomTree(e,n,r),e=t.nextSibling(e)},e.prototype.processNodeIfValid=function(e){this.isNodeValid(e)&&this.processNode(e)},e.prototype.isNodeValid=function(e){if(!r.containsValidText(e))return!1;var t=this.getValidParentNode(e);return"undefined"!=typeof t&&r.hasEnoughWords(t,this.config.paragraphWordThreshold)&&!r.isMarked(t)},e.prototype.getValidParentNode=function(e){for(var n=0;n<this.config.parentAwayFromTextThreshold;)if(n++,e=t.parentNode(e),r.isContentNode(e,this.config.contentNodes))return e},e.prototype.processNode=function(e){var r=this.getValidParentNode(e),o=n.uniqueID();this.markNodeWithValue(r,o);var a=i.findPossibleKeywords(r,this.config.campaigns);this.parserResult.paragraphs.push({id:o,selector:"[data-kx='"+o+"']",type:t.nodeName(r),wordCount:n.wordCount(t.textContent(r)),possibleKW:a})},e.prototype.markNodeWithValue=function(e,n){t.addAttributeToNode(e,{name:"data-kx",value:n})},e}(Kx.ContentParser);var Kx=Kx||{};Kx.ContentManager=function(e){var e=(Kx.Helper.Util,function(e,t){if(void 0===e)throw new TypeError("kxObject expected");if(void 0===t)throw new TypeError("parser expected");this.kxObject=e,this.parser=t,this.usedStrategies=[],this.strategies=this.getStrategies(e)});return e.prototype.getStrategies=function(e){var t=[];if(!e.campaigns)return t;var n=[];return e.campaigns.forEach(function(e){if(n.indexOf(e.formats[0]+e.type)<0){Kx.log(e);var r={format:e.formats[0],type:e.type,strategy:this.getPublisherStrategy(e.formats[0].toLowerCase(),e.type.toLowerCase()),ruleset:this.getPublisherRuleset(e.formats[0].toLowerCase())};t.push(r),n.push(e.formats[0]+e.type)}},this),t},e.prototype.getPublisherStrategy=function(e,t){return Kx.log("getPublisherStrategy",e,t),"rlink"===e&&"xtraffic"===t?"Xtraffic":"rlink"===e&&"xtraffic"!==t?"DefaultRLink":"iwidget"===e?"DefaultIWidget":void 0},e.prototype.getPublisherRuleset=function(e){return Kx.log("getPublisherRuleset",e),this.kxObject.config.displayRules[e]},e.prototype.decideWhichStrategies=function(){this.strategies.forEach(function(e){if(this.strategyTypeNotUsed(e.format,e.type)&&this.isStrategyDefined(e.strategy)){this.run(e.strategy);this.usedStrategies.push(e.format+e.type)}},this)},e.prototype.isStrategyDefined=function(e){return void 0!==Kx.Strategy[e]},e.prototype.run=function(e){var t=new Kx.Strategy[e](this.kxObject,this.parser);return t},e.prototype.strategyTypeNotUsed=function(e,t){return this.usedStrategies.indexOf(e+t)<0},e}(Kx.ContentManager);var Kx=Kx||{};Kx.CSS=function(e){return e=function(){this.styleSheet=void 0,this.hasStyleSheet()||this.createStyleSheet()},e.prototype.hasStyleSheet=function(){return void 0!==this.styleSheet},e.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.type="text/css",e.rel="stylesheet",e.id="kx-style-sheet",document.head.appendChild(e),this.styleSheet=e.sheet,this.styleSheet},e.prototype.addRules=function(e){e.forEach(function(e){this.addRule(e)},this)},e.prototype.addRule=function(e){var t=e.selector+" { ",n=e.declarations;for(var r in e.declarations)n.hasOwnProperty(r)&&(t+=r+": "+n[r]+";");t+="}",this.styleSheet.insertRule(t,this.nextIndex)},e.prototype.nextIndex=function(){return this.styleSheet.cssRules.length},e}(Kx.CSS);var Kx=Kx||{};Kx.RuleInspector=function(e){return e=function(e){this.limit=e,this.store={}},e.prototype.addKey=function(e){this.store[e]=this.store[e]?this.store[e]+1:1},e.prototype.hitLimit=function(e){return this.store[e]>=this.limit},e}(Kx.RuleInspector);var Kx=Kx||{};Kx=function(e){var t=window.Kx.Helper.Util,n=window.ktxtrPublisherId||window.kka_publisher_id;return e._css=void 0,e._tracker=void 0,e.run=function(){this._css=new Kx.CSS,this._sessionId=t.uniqueID(),this._is_pi_with_placement_tracked=!1;var e={session_id:this._sessionId,publisher_id:n+"",url:window.location.href,source_url:document.referrer};this._tracker=new Kx.Tracker(e),this._tracker.track({event_type:"pi"});var r=new Kx.Request({url:Kx.AppConfig.scriptUrl+n,verb:"GET",successCb:function(t){if("undefined"==typeof t||null===t||0===t.length)return void Kx.log("Response was some kind of empty");t=JSON.parse(t);var n=function(){try{var n=new Kx.UserToken(t);Kx._userToken=n.getOrSetToken(),null!==Kx._userToken&&(Kx._tracker=new Kx.Tracker(Object.assign({},e,{user_token:Kx._userToken})),Kx._tracker.track({event_type:"userpi"}))}catch(e){Kx.log("CATCHED",e)}},r=function(){n();try{if(t.campaigns){var e=new Kx.ContentParser(t);e.parse();var r=new Kx.ContentManager(t,e);r.decideWhichStrategies()}else Kx.log("NO CAMPAIGNS",t)}catch(e){Kx.log("CATCHED",e)}};t.waitForContent?Kx.Helper.Util.domReady(window,r):r()}.bind(this),errorCb:function(){}});r.send()},e}(Kx),function(){function e(e){return null!=window.navigator.userAgent.match(e)}Kx.log("DEV-VERSION-10.02.2017-1"),e("MSIE 8")||e("MSIE 9")||Kx.run()}();