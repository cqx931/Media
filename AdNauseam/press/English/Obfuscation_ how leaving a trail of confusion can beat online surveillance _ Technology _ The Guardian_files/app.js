define("common/modules/analytics/foresee-survey",["common/utils/config","common/utils/cookies","common/utils/detect"],function(e,t,n){function o(){require(["js!foresee.js"])}function i(){var i="Network Front"===e.page.contentType,s=n.isBreakpoint({max:"mobile"})?.008:.006,a=Math.random()<=s,r=/forceForesee/.test(location.hash);t.get("GU_TEST")||i||!(window.openForeseeWhenReady||a||r)||o(),window.guardian&&(window.guardian.openForesee=o)}return{load:i}}),define("common/modules/analytics/livestats",["common/utils/cookies","common/utils/storage","common/modules/analytics/beacon","common/modules/experiments/ab"],function(e,t,n,o){function i(){var e="gu.session";return"undefined"!=typeof a?a:(t.session.get(e)?a=!1:(t.session.set(e,"true"),a=!0),a)}function s(e,t){var n,o=[];for(n in e)o.push(n+"="+encodeURIComponent(e[n]));return t+"?"+o.join("&")}var a;return{log:function(){var e=o.getAbLoggableObject();i()?e.type="session":e.type="view",n.fire(s(e,"/ab.gif"))}}}),define("common/modules/analytics/media-listener",["bean","common/utils/mediator"],function(e,t){return function(){if(window.matchMedia){var e=window.matchMedia("print");e.addListener(function(){e.matches&&t.emit("module:clickstream:interaction","print")})}}}),define("common/modules/analytics/register",["common/utils/mediator","common/modules/experiments/ab","common/utils/_"],function(e,t,n){function o(e){c.push({name:e,status:"unfinished"})}function i(e){n.where(c,{name:e}).forEach(function(e){e.status="completed",e.endTime=Date.now()-l+"ms"})}function s(e){n.where(c,{name:e}).forEach(function(e){e.status="failed",e.endTime=Date.now()-l+"ms"})}function a(){require(["ophan/ng"],function(e){e.record({register:c,abTestRegister:t.getAbLoggableObject()})})}function r(){e.on("register:begin",o),e.on("register:end",i),e.on("register:error",s),window.setTimeout(a.bind(),5e3)}var c=[],l=Date.now();return{initialise:r,begin:o,end:i,error:s}}),define("common/modules/analytics/scrollDepth",["common/utils/_","common/utils/mediator"],function(e,t){function n(t){this.opts=e.assign(this.opts,t),e.bindAll(this,"assertScrolling","hasDataChanged"),this.opts.isContent&&(this.opts.contentEl=this.contentEl||document.getElementById("article")||document.getElementById("live-blog")),this.init()}return n.prototype.opts={changeThreshold:10,isContent:!1,pageEl:document.body},n.prototype.data={page:{start:(new Date).getTime(),depth:0,duration:0},content:{depth:0}},n.prototype.timeSince=function(e){return(new Date).getTime()-e},n.prototype.getPercentageInViewPort=function(e){var t=e.getBoundingClientRect(),n=window.innerHeight||document.body.clientHeight;return t.bottom<0||t.bottom<n?100:t.top>n?0:t.top>0?100/(t.height||1)*(n-t.top):100/(t.height||1)*(Math.abs(t.top)+n)},n.prototype.isInViewport=function(e){var t=e.getBoundingClientRect();return t.top<(window.innerHeight||document.body.clientHeight)&&t.left<(window.innerWidth||document.body.clientWidth)},n.prototype.setData=function(e){var t,n=this.opts[e+"El"];return n?(t=this.getPercentageInViewPort(n),t-this.data[e].depth>this.opts.changeThreshold?(this.data[e].depth=t,"number"==typeof this.data[e].duration&&(this.data[e].duration=this.timeSince(this.data[e].start)),!0):!1):!1},n.prototype.hasDataChanged=function(){var e=this.setData("page"),t=this.opts.isContent?this.setData("content"):!1;(e||t)&&this.log()},n.prototype.assertScrolling=function(){function e(){t.emit("scrolldepth:inactive")}"number"==typeof this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(e.bind(this),1e3)},n.prototype.log=function(){t.emit("scrolldepth:data",this.data)},n.prototype.init=function(){t.on("window:throttledScroll",e.debounce(this.assertScrolling,200)),t.on("scrolldepth:inactive",this.hasDataChanged),t.on("module:clickstream:click",this.hasDataChanged)},n}),define("common/utils/scan",["common/utils/_"],function(e){return function(t,n,o){return e.reduce(t,function(t,o){return t.concat(n(e.last(t),o))},[o])}}),define("common/modules/analytics/css-logging",["Promise","common/utils/_","common/utils/config","common/utils/ajax","common/utils/detect","common/utils/url","common/utils/scan","common/utils/mediator","common/modules/analytics/beacon"],function(e,t,n,o,i,s,a,r,c){function l(e){var n=e?e.cssRules||e.rules:null;return n?t.values(n):e}function d(e){return e&&e.selectorText&&e.selectorText.replace(y,"").split(k)}function u(e){var t=e.match(/\.[^\s\.]+\.[^\s]+/g)||[];return t.forEach(function(t){e=e.replace(t,m(t))}),e.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")}function m(e){return t.sortBy(e.split(".")).join(".")}function h(e){var n,o,i=t.chain(p()).map(l).flatten().map(l).flatten().map(d).flatten().compact().uniq().map(u).value();return e?i:(o=i.length,n=t.random(0,o),i.slice(n,n+w).concat(o>n+w?[]:i.slice(0,(n+w)%o)))}function p(){return t.chain(document.styleSheets).filter(function(e){return e&&t.values(e.rules||e.cssRules).length>0&&e.ownerNode&&"STYLE"===e.ownerNode.nodeName&&e.ownerNode.className.indexOf(S)>-1}).value()}function g(e){return o({url:e.href,crossOrigin:!0}).then(function(e){var t=document.createElement("style");t.className=S,t.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(t)})}function f(){return e.all(t.chain(document.styleSheets).filter(function(e){return e&&e.href&&e.href.match(/\/\/(localhost|assets\.guim\.co\.uk)/)&&(!e.media||"print"!==e.media.mediaText)&&-1===e.ownerNode.className.indexOf(_)}).forEach(function(e){e.ownerNode.className+=" "+_}).map(g).value())}function v(e){f().then(function(){c.postJson("/css",JSON.stringify({selectors:t.chain(h(e)).reduce(function(e,n){return t.isUndefined(e[n])&&(e[n]=!!document.querySelector(n)),e},{}).value(),contentType:n.page.contentType||"unknown",breakpoint:i.getBreakpoint()||"unknown"}),e)})}function b(e){return t.debounce(function(n){(!n||n.samePage)&&setTimeout(function(){v(e)},e?0:t.random(0,3e3))},500)}var w=500,y=new RegExp(/:+[^\s\,]+/g),k=new RegExp(/\s*,\s*/g),S="js-loggable",_="js-inlined",C=!1;return function(e){var n;e=e||"#csslogging"===window.location.hash,(e||1===t.random(1,2500))&&(n=b(e),n(),C||(r.on("module:clickstream:interaction",n),r.on("module:clickstream:click",n),C=!0))}}),define("common/utils/filterPairs",["common/utils/_"],function(e){return function(t){return e.chain(t).filter(function(e){return e[1]}).map(function(e){return e[0]}).value()}}),define("common/modules/analytics/simple-metrics",["common/utils/filterPairs","common/utils/mediator","common/modules/analytics/beacon"],function(e,t,n){return function(){navigator.sendBeacon&&(n.beaconCounts("sm-page-view"),t.on("module:clickstream:click",function(t){var o=e([["sm-interaction-on-same-page",t.samePage],["sm-another-guardian-page",!t.samePage&&t.sameHost],["sm-clicked-related-content",/related-content/.test(t.tag)],["sm-clicked-series-component",/\| series \|/.test(t.tag)],["sm-clicked-most-popular-component",/\| most popular \|/.test(t.tag)]]);o.length>0&&n.beaconCounts(o)}))}}),define("common/modules/navigation/navigation",["bean","qwery","fastdom","common/utils/mediator","common/utils/detect","common/utils/$"],function(e,t,n,o,i,s){var a={init:function(){this.jsEnableFooterNav(),this.copyMegaNavMenu(),this.enableMegaNavToggle(),this.replaceAllSectionsLink(),i.isIOS()&&i.getUserAgent.version>5&&n.write(function(){s(".navigation__scroll").css({"-webkit-overflow-scrolling":"touch"})})},jsEnableFooterNav:function(){n.write(function(){s(".navigation-container--default").removeClass("navigation-container--default").addClass("navigation-container--collapsed")})},copyMegaNavMenu:function(){var e=s.create(s(".js-mega-nav").html()),t=s(".js-mega-nav-placeholder");n.write(function(){s(".global-navigation",e).addClass("global-navigation--top"),t.append(e)})},replaceAllSectionsLink:function(){s(".js-navigation-header .js-navigation-toggle").attr("href","#nav-allsections")},enableMegaNavToggle:function(){e.on(document,"click",".js-navigation-toggle",function(e){var t=s("."+e.currentTarget.getAttribute("data-target-nav"));e.preventDefault(),n.write(function(){t.toggleClass("navigation-container--expanded navigation-container--collapsed"),o.emit(t.hasClass("navigation-container--expanded")?"modules:nav:open":"modules:nav:close")})})}};return a}),define("common/modules/commercial/donot-use-adblock",["common/utils/_","common/utils/config","common/utils/detect","common/utils/storage","common/utils/template","common/modules/commercial/user-features","common/modules/ui/message","common/modules/experiments/ab","common/modules/navigation/navigation","text!common/views/membership-message.html","common/views/svgs"],function(e,t,n,o,i,s,a,r,c,l,d){function u(){var r=o.local.get("gu.alreadyVisited")||0,c="https://membership.theguardian.com/supporter",u=e.sample([{id:"monthly",messageText:"We notice you're using an ad-blocker. Perhaps you'll support us another way? Become a Supporter from just £5 per month",linkText:"Find out more"},{id:"annual",messageText:"We notice you're using an ad-blocker. Perhaps you'll support us another way? Become a Supporter for just £50 per a year",linkText:"Find out more"},{id:"weekly",messageText:"We notice you're using an ad-blocker. Perhaps you'll support us another way? Become a Supporter for less than £1 per week",linkText:"Find out more"},{id:"no-price",messageText:"We notice you're using an ad-blocker. Perhaps you'll support us another way?",linkText:"Become a supporter today"}]);"mobile"!==n.getBreakpoint()&&n.adblockInUse()&&t.switches.adblock&&r>1&&!s.isPayingMember()&&new a("adblock-message",{pinOnHide:!1,siteMessageLinkName:"adblock message variant "+u.id,siteMessageCloseBtn:"hide"}).show(i(l,{linkHref:c+"?INTCMP=adb-mv-"+u.id,messageText:u.messageText,linkText:u.linkText,arrowWhiteRight:d("arrowWhiteRight")}))}return{init:u}}),define("common/utils/formatters",[],function(){return{integerCommas:function(e){var t,n,o,i=parseInt(e,10);if(!isNaN(i)){for(t=i.toFixed(0).split(""),o=t.length,n=t.length-1;n>=1;n--)(o-n)%3===0&&t.splice(n,0,",");return t.join("")}}}}),define("text!common/views/discussion/comment-count.html",[],function(){return'<a class="fc-trail__count fc-trail__count--commentcount" href="<%=url%>" data-link-name="Comment count"><%=icon%> <%=count%></a>\n'}),define("text!common/views/discussion/comment-count--content.html",[],function(){return'<a href="<%=url%>" data-link-name="Comment count" class="commentcount2 tone-colour">\n    <h3 class="commentcount2__heading"><%=icon%> Comments</h3>\n    <span class="commentcount2__value tone-colour"><%=count%></span>\n</a>\n'}),define("common/modules/discussion/comment-count",["bonzo","fastdom","qwery","common/utils/$","common/utils/_","common/utils/ajax","common/utils/formatters","common/utils/mediator","common/utils/template","common/views/svgs","text!common/views/discussion/comment-count.html","text!common/views/discussion/comment-count--content.html"],function(e,t,n,o,i,s,a,r,c,l,d,u){function m(t){var o=n("["+b+"]",t);return i.groupBy(o,function(t){return e(t).attr(b)})}function h(e){return i.chain(e).keys().uniq().sortBy().join(",").value()}function p(e){var t=e.getElementsByTagName("a")[0];return(t?t.pathname:"")+"#comments"}function g(o,s){o.forEach(function(o){i.forEach(s[o.id],function(i){var s,r,d,u,m=e(i),h=m.attr("data-discussion-url")||p(i);("true"!==m.attr("data-discussion-closed")||0!==o.count)&&(s=m.data("commentcount-format"),u=c(y[s]||k,{url:h,icon:l("commentCount16icon",["inline-tone-fill"]),count:a.integerCommas(o.count)}),d=n(".js-item__meta",i),r=d.length?e(d):m,t.write(function(){r.append(u),m.removeAttr(b),m.removeClass("u-h")}))})}),t.write(function(){r.emit("modules:commentcount:loaded",o)})}function f(e){t.read(function(){var t=m(e||document.body),n=h(t);s({url:w+n,type:"json",method:"get",crossOrigin:!0,success:function(e){e&&e.counts&&g(e.counts,t)}})})}function v(){document.body.querySelector("[data-discussion-id]")&&f(document.body),r.on("modules:related:loaded",f)}var b="data-discussion-id",w="/discussion/comment-counts.json?shortUrls=",y={content:u},k=d;return{init:v,getCommentCounts:f,getContentIds:h,getElementsIndexedById:m}}),define("common/modules/identity/facebook-authorizer",[],function(){function e(e){this.appId=e,this.onConnected=new t,this.onFBScriptLoaded=new t,this.onUserDataLoaded=new t,this.onNotAuthorized=new t,this.onNotLoggedIn=new t,this.cancelledLogin=new t}function t(){this.callbacks=[]}var n="facebook-jssdk";return e.DEFAULT_PERMISSIONS={scope:"email,publish_actions,publish_stream"},e.prototype.onConnected=null,e.prototype.onFBScriptLoaded=null,e.prototype.onUserDataLoaded=null,e.prototype.onNotAuthorized=null,e.prototype.onNotLoggedIn=null,e.prototype.cancelledLogin=null,e.accessToken=null,e.userId=null,e.userData=null,e.prototype.login=function(t,n){return(n||!this.accessToken&&!this.loginPending)&&(this.cancelledLogin.reset(),this.onConnected.reset(),this.loginPending=!0,this._loadFacebookAPI().then(function(n){n.login(this._handleGotLoginStatus.bind(this,!0),t||e.DEFAULT_PERMISSIONS)}.bind(this))),this.onConnected},e.prototype.getLoginStatus=function(t){return this.loginStatusPending||(this.loginStatusPending=!0,this._loadFacebookAPI().then(function(n){n.getLoginStatus(this._handleGotLoginStatus.bind(this,!1),t||e.DEFAULT_PERMISSIONS)}.bind(this))),this.onConnected},e.prototype._handleGotLoginStatus=function(e,t){switch(this.loginStatusPending=!1,this.loginPending=!1,t.status){case"connected":this.accessToken=t.authResponse.accessToken,this.userId=t.authResponse.userID,this._getUserData(),this.onConnected.resolve(FB,t.authResponse);break;case"not_authorized":this._getUserData(),this.onNotAuthorized.resolve(this);break;default:e&&this.cancelledLogin.resolve(),this.onNotLoggedIn.resolve()}},e.prototype._getUserData=function(){FB.api("/me",this._handleGotUserData.bind(this))},e.prototype._handleGotUserData=function(e){e&&!e.error&&(this.userData=e,this.onUserDataLoaded.resolve(e))},e.prototype._loadFacebookAPI=function(){return window.FB?this.onFBScriptLoaded.resolve(window.FB):document.getElementById(n)||this._requiredAlready||(this._requiredAlready=!0,this._loadFacebookScript()),this.onFBScriptLoaded},e.prototype._loadFacebookScript=function(){guardian.config.page.isPreview||require(["js!facebook.js"],this._handleScriptLoaded.bind(this))},e.prototype._handleScriptLoaded=function(){FB&&(FB.init({appId:this.appId,status:!0,cookie:!0,xfbml:!0}),this.onFBScriptLoaded.resolve(FB))},t.prototype.resolve=function(){this.args=Array.prototype.slice.apply(arguments);var e,t=this.callbacks.length;for(e=0;t>e;e++)this.callbacks[e].apply(null,this.args);this.callbacks=[]},t.prototype.then=function(e){void 0!==this.args?e.apply(null,this.args):this.callbacks.push(e)},t.prototype.reset=function(){this.args=void 0},e}),define("common/modules/navigation/profile",["bean","bonzo","fastdom","common/utils/config","common/utils/_","common/utils/ajax","common/utils/mediator","common/modules/identity/api"],function(e,t,n,o,i,s,a,r){function c(e){this.opts=i.assign(this.opts,e),this.dom.container=document.body.querySelector("."+c.CONFIG.classes.container),this.dom.content=this.dom.container.querySelector("."+c.CONFIG.classes.content),this.dom.popup=document.body.querySelector("."+c.CONFIG.classes.popup),this.dom.register=document.body.querySelector("."+c.CONFIG.classes.register),this.dom.commentActivity=document.body.querySelector("."+c.CONFIG.classes.commentActivity)}return c.CONFIG={eventName:"modules:profilenav",classes:{container:"js-profile-nav",content:"js-profile-info",popup:"js-profile-popup",register:"js-profile-register",commentActivity:"js-comment-activity",action:"brand-bar__item--action"}},c.prototype.opts={url:"https://profile.theguardian.com"},c.prototype.dom={},c.prototype.init=function(){this.setFragmentFromCookie()},c.prototype.setFragmentFromCookie=function(){var e=r.getUserFromCookie(),o=t(this.dom.container),i=t(this.dom.content),s=t(this.dom.register),a=t(this.dom.commentActivity);e&&(o.hasClass("is-signed-in")||n.write(function(){i.text(e.displayName),o.addClass("is-signed-in"),s.hide()}),a.removeClass("u-h"),a.attr("href",this.opts.url+"/user/id/"+e.id)),this.emitLoadedEvent(e)},c.prototype.emitLoadedEvent=function(e){a.emit(c.CONFIG.eventName+":loaded",e)},c.prototype.emitErrorEvent=function(){a.emit(c.CONFIG.eventName+":error")},c}),define("common/modules/identity/autosignin",["bonzo","common/utils/ajax","common/utils/config","common/utils/time","common/modules/analytics/omniture","common/modules/identity/api","common/modules/identity/facebook-authorizer","common/modules/navigation/profile","common/modules/ui/message","common/modules/ui/toggles"],function(e,t,n,o,i,a,r,c,l,d){function u(){var e=this;e.header=document.body,this.init=function(){if(a.shouldAutoSigninInUser()){var t=n.page.fbAppId,i=new r(t);i.getLoginStatus(),i.onConnected.then(function(t,n){i.onUserDataLoaded.then(function(t){t.email&&e.signin(n,t.name)})}),i.onNotLoggedIn.then(function(){var e=o.currentDate();a.setNextFbCheckTime(e.setDate(e.getDate()+1))}),i.onNotAuthorized.then(function(){var e=o.currentDate();a.setNextFbCheckTime(e.setMonth(e.getMonth()+1))})}},this.signin=function(o,a){t({url:n.page.idWebAppUrl+"/jsapi/facebook/autosignup",cache:!1,crossOrigin:!0,type:"jsonp",data:{signedRequest:o.signedRequest,accessToken:o.accessToken},success:function(t){if(e.welcome(a),"ok"===t.status){var o=new c({url:n.page.idUrl});o.init(),(new d).init(),i.populateEventProperties("Social signin auto"),s.eVar13="facebook auto",s.linkTrackVars+=",eVar13",s.tl(this,"o","Social signin auto")}}})},this.welcome=function(e){var t='<p class="site-message__message" data-test-id="facebook-auto-sign-in-banner">Welcome '+e+', you’re signed in to the Guardian using Facebook. <a data-link-name="fb auto : sign out" href="'+n.page.idUrl+'/signout"/>Sign out</a>.</p>';new l("fbauto",{important:!0}).show(t)}}return u}),define("common/modules/identity/cookierefresh",["common/modules/identity/api","common/utils/storage"],function(e,t){function n(){this.init=function(){if(t.local.isStorageAvailable()&&e.isUserLoggedIn()){var n=t.local.get(e.lastRefreshKey),o=(new Date).getTime();this.shouldRefreshCookie(n,o)&&(e.getUserFromApiWithRefreshedCookie(),t.local.set(e.lastRefreshKey,o))}},n.prototype.shouldRefreshCookie=function(e,t){return!e||t>parseInt(e,10)+2592e6}}return n}),define("common/utils/load-css-promise",["Promise"],function(e){return new e(function(e){window.guardian.css.loaded?e():window.guardian.css.onLoad=e})}),define("common/modules/ui/smartAppBanner",["fastdom","common/utils/$","common/utils/cookies","common/utils/detect","common/utils/storage","common/utils/template","common/utils/load-css-promise","common/modules/user-prefs","common/modules/ui/message"],function(e,t,n,o,i,s,a,r,c){function l(){return(o.isIOS()||o.isAndroid())&&!o.isFireFoxOSApp()}function d(){return 4>b}function u(){a.then(function(){var i=o.isIOS()?"ios":"android",a=new c(i),r=w+("mobile"===o.getBreakpoint()?"":y);a.show(s(r,f[i.toUpperCase()])),n.add(g,b+1),e.read(function(){var e=t(".site-message--ios, .site-message--android"),n=e.dim().height;0!==window.scrollY&&window.scrollTo(window.scrollX,window.scrollY+n)})})}function m(){l()&&d()&&u()}function h(){return"block"===t(".site-message--android").css("display")||"block"===t(".site-message--ios").css("display")}function p(){return t(".site-message--android").dim().height||t(".site-message--ios").dim().height}var g="GU_SMARTAPPBANNER",f={IOS:{LOGO:"http://assets.guim.co.uk/images/apps/ios-logo.png",SCREENSHOTS:"http://assets.guim.co.uk/images/apps/ios-screenshots.jpg",LINK:"https://app.adjust.com/w97upi?deep_link=gnmguardian://root?contenttype=front&source=adjust",STORE:"on the App Store"},ANDROID:{LOGO:"http://assets.guim.co.uk/images/apps/android-logo-2x.png",SCREENSHOTS:"http://assets.guim.co.uk/images/apps/ios-screenshots.jpg",LINK:"https://app.adjust.com/642i3r?deep_link=x-gu://www.theguardian.com/?source=adjust",STORE:"in Google Play"}},v=n.get(g),b=v&&!isNaN(v)?parseInt(v,10):0,w='<img src="<%=LOGO%>" class="app__logo" alt="Guardian App logo" /><div class="app__cta"><h4 class="app__heading">The Guardian app</h4><p class="app__copy">Instant alerts. Offline reading.<br/>Tailored to you.</p><p class="app__copy"><strong>FREE</strong> – <%=STORE%></p></div><a href="<%=LINK%>" class="app__link">View</a>',y='<img src="<%=SCREENSHOTS%>" class="app__screenshots" alt="screenshots" />';return{init:m,isMessageShown:h,getMessageHeight:p}}),define("common/modules/navigation/sticky",["bean","qwery","fastdom","common/utils/$","common/utils/_","common/utils/config","common/utils/detect","common/utils/mediator","common/modules/experiments/ab","common/modules/ui/smartAppBanner"],function(e,t,n,o,i,s,a,r,c,l){function d(){this.breakpoint=a.getBreakpoint(),"mobile"===this.breakpoint&&s.switches.disableStickyNavOnMobile||o(".adfreesurvey-wrapper").length||(this.$els={},this.config={showHeaderDepth:.5,showHeaderAppleDepth:.3,showNavigationDepth:150,distance:0,direction:"down",showNavigation:!1,thresholdMobile:400,firstLoadDepth:500,isNavigationLocked:!1},this.isMobile=i.contains(this.breakpoint,"mobile"),this.isTablet=i.contains(this.breakpoint,"tablet"),this.isAppleCampaign=s.page.hasBelowTopNavSlot,this.isSensitivePage="childrens-books-site"===s.page.section||s.page.shouldHideAdverts,this.isProfilePage="identity"===s.page.section,this.isAdblockInUse=a.adblockInUse(),i.bindAll(this,"updatePositionMobile","updatePositionAdblock","updatePositionApple","updatePosition"))}return d.prototype.init=function(){"mobile"===this.breakpoint&&s.switches.disableStickyNavOnMobile||o(".adfreesurvey-wrapper").length||(this.$els.header=o(".js-header"),this.$els.bannerDesktop=o(".js-top-banner-above-nav"),this.$els.bannerMobile=o(".js-top-banner-mobile"),this.$els.bannerBelowNav=o(".js-top-banner-below-nav"),this.$els.main=o(".js-maincontent"),this.$els.navHeader=o(".js-navigation-header"),this.$els.burgerIcon=o(".js-navigation-toggle",this.$els.navHeader),this.$els.navigation=o(".js-navigation",this.$els.navHeader),this.$els.navigationGlobal=o(".js-global-navigation"),this.$els.popupSearch=o(".js-popup--search"),this.$els.window=o(window),n.read(function(){this.headerBigHeight=this.$els.navHeader.height(),this.navigationClassList=this.$els.navigation.attr("class")}.bind(this)),this.$els.window.scrollTop()>this.config.firstLoadDepth&&(this.isAppleCampaign?n.read(this.updatePositionApple):n.read(this.updatePosition)),this.updateMethod=this.getUpdateMethod(),this.isProfilePage?this.updatePositionProfile():r.on("window:throttledScroll",this[this.updateMethod]),r.on("modules:nav:open",function(){this.lockStickyNavigation()}.bind(this)),r.on("modules:nav:close",function(){this.unlockStickyNavigation()}.bind(this)),r.on("modules:search",function(){this.$els.popupSearch.hasClass("is-off")?this.unlockStickyNavigation():this.lockStickyNavigation()}.bind(this)))},d.prototype.getUpdateMethod=function(){return this.isMobile?"updatePositionMobile":this.isAdblockInUse?"updatePositionAdblock":this.isAppleCampaign?"updatePositionApple":"updatePosition"},d.prototype.unlockStickyNavigation=function(){this.config.isNavigationLocked=!1,n.write(function(){this.$els.navigationGlobal.removeClass("navigation__expandable--sticky").attr("height","auto")}.bind(this))},d.prototype.lockStickyNavigation=function(){this.config.isNavigationLocked=!0,n.read(function(){if(this.$els.header.hasClass("l-header--is-slim")||this.isMobile||this.isTablet){var e=window.innerHeight-o(".js-mega-nav-placeholder")[0].getBoundingClientRect().top;n.write(function(){this.$els.navigationGlobal.addClass("navigation__expandable--sticky").css("height",e)}.bind(this))}}.bind(this))},d.prototype.setScrollDirection=function(e){this.config.direction=e>this.config.prevScroll?"down":"up",this.config.prevScroll=e},d.prototype.shouldShowNavigation=function(e){"up"===this.config.direction&&0===this.config.distance&&(this.config.distance=e),this.config.showNavigation=Math.abs(e-this.config.distance)>this.config.showNavigationDepth},d.prototype.showNavigation=function(o){this.shouldShowNavigation(o),"up"===this.config.direction&&this.config.showNavigation?n.write(function(){this.isTablet||this.isMobile?this.$els.navigation.removeClass("animate-down-mobile").addClass("animate-up-mobile"):this.isSensitivePage?this.$els.navigation.css("display","block"):this.$els.navigation.removeClass("animate-down-desktop").addClass("animate-up-desktop")}.bind(this)):(this.config.showNavigation&&(this.config.distance=0,this.$els.navHeader.hasClass("navigation-container--expanded")&&e.fire(t(".js-navigation-toggle")[0],"click")),n.write(function(){this.isTablet||this.isMobile?this.$els.navigation.removeClass("animate-up-mobile").addClass("animate-down-mobile"):this.isSensitivePage?this.$els.navigation.css("display","none"):this.$els.navigation.removeClass("animate-up-desktop").addClass("animate-down-desktop")}.bind(this)))},d.prototype.setNavigationDefault=function(){n.write(function(){this.$els.navigation.removeAttr("class"),this.$els.navigation.attr("class",this.navigationClassList)}.bind(this))},d.prototype.updatePosition=function(){var e=0,t=window.pageYOffset;this.isSensitivePage||(e=this.$els.bannerDesktop.height()||128),this.setScrollDirection(t);var i=o(".site-message--ios, .site-message--android"),a=i.height();t>=this.headerBigHeight+e*this.config.showHeaderDepth+a&&!this.config.isNavigationLocked?(n.write(function(){this.$els.header.css({position:"fixed",top:0,width:"100%","z-index":"1020","margin-top":0,"backface-visibility":"hidden"}),this.$els.bannerDesktop.css({position:"absolute",width:"100%",top:this.headerBigHeight+a}),this.$els.main.css("margin-top",this.headerBigHeight+e),this.$els.header.addClass("l-header--is-slim"),this.$els.header.css({"-webkit-transform":"translateY(0%)","-ms-transform":"translateY(0%)",transform:"translateY(0%)"})}.bind(this)),this.config.isNavigationLocked||"Interactive"===s.page.contentType||this.showNavigation(t)):t>=this.headerBigHeight+a?(n.write(function(){this.$els.bannerDesktop.css({position:"absolute",width:"100%",top:this.headerBigHeight+a,"z-index":"1019"}),this.config.isNavigationLocked||this.$els.header.addClass("l-header--is-slim")}.bind(this)),this.config.isNavigationLocked||("up"===this.config.direction?n.write(function(){this.$els.header.css({"-webkit-transform":"translateY(-100%)","-ms-transform":"translateY(-100%)",transform:"translateY(-100%)"})}.bind(this)):n.write(function(){this.$els.header.css({position:"absolute","margin-top":e,"-webkit-transform":"translateY(-500%)","-ms-transform":"translateY(-500%)",transform:"translateY(-500%)","z-index":"1018"}),this.$els.main.css("margin-top",this.headerBigHeight+e)}.bind(this)))):(n.write(function(){window.scrollY>a?(this.$els.bannerDesktop.css({position:"fixed",top:0,width:"100%","z-index":"1019","backface-visibility":"hidden"}),"Interactive"!==s.page.contentType&&this.$els.header.removeClass("l-header--is-slim"),this.$els.header.css({position:"relative",width:"100%","margin-top":e,"-webkit-transform":"translateY(0%)","-ms-transform":"translateY(0%)",transform:"translateY(0%)","z-index":"1018"}),this.$els.main.css("margin-top",0),this.isSensitivePage&&this.$els.navigation.css("display","block")):(this.$els.bannerDesktop.css({position:"",top:"",width:"","z-index":"","backface-visibility":""}),this.$els.header.css({position:"",width:"","margin-top":"","-webkit-transform":"","-ms-transform":"",transform:"","z-index":""}),this.$els.main.css("margin-top",""),this.isSensitivePage&&this.$els.navigation.css("display",""))}.bind(this)),this.setNavigationDefault()),o(".gssb_c").length>0&&n.write(function(){o(".gssb_c").hide()})},d.prototype.updatePositionProfile=function(){var e=this.$els.header.height();n.write(function(){this.$els.header.css({position:"fixed",top:0,width:"100%","z-index":"1020","margin-top":0,"backface-visibility":"hidden"}),this.$els.main.css("padding-top",e)}.bind(this))},d.prototype.updatePositionAdblock=function(){var e=this.$els.header.height(),t=window.pageYOffset;this.setScrollDirection(t),t>=e?(n.write(function(){this.$els.header.css({position:"fixed",top:0,width:"100%","z-index":"1000","margin-top":0,"-webkit-transform":"translateY(-100%)","-ms-transform":"translateY(-100%)",transform:"translateY(-100%)","backface-visibility":"hidden"}),this.$els.header.addClass("l-header--is-slim"),this.$els.header.css({"-webkit-transform":"translateY(0%)","-ms-transform":"translateY(0%)",transform:"translateY(0%)"}),this.$els.main.css("margin-top",this.headerBigHeight)}.bind(this)),this.showNavigation(t)):(n.write(function(){this.$els.header.removeClass("l-header--is-slim"),this.$els.header.css({position:"static",width:"100%","margin-top":0,"-webkit-transform":"translateY(0%)","-ms-transform":"translateY(0%)",transform:"translateY(0%)","z-index":"998"}),this.$els.main.css("margin-top",0)}.bind(this)),this.setNavigationDefault())},d.prototype.updatePositionApple=function(){var e=this.$els.bannerBelowNav.height()||336,t=window.pageYOffset;this.setScrollDirection(t),t>=e*this.config.showHeaderAppleDepth?(n.write(function(){this.$els.header.css({position:"fixed",top:0,width:"100%","z-index":"1020","margin-top":0,"-webkit-transform":"translateY(-100%)","-ms-transform":"translateY(-100%)",transform:"translateY(-100%)","backface-visibility":"hidden"}),this.$els.bannerBelowNav.css({position:"static",top:null,width:"100%","z-index":"1019"}),this.$els.header.addClass("l-header--is-slim"),this.$els.header.css({"-webkit-transform":"translateY(0%)","-ms-transform":"translateY(0%)",transform:"translateY(0%)"})}.bind(this)),this.showNavigation(t)):(n.write(function(){this.$els.header.removeClass("l-header--is-slim"),this.$els.header.css({position:"static",width:"100%","margin-top":0,"-webkit-transform":"translateY(0%)","-ms-transform":"translateY(0%)",transform:"translateY(0%)","z-index":"1018"})}.bind(this)),this.setNavigationDefault())},d.prototype.fixedBannerMobile=function(e,t){n.write(function(){this.$els.header.css({position:"fixed",top:e,width:"100%","z-index":"1021","margin-top":0,"backface-visibility":"hidden"}),this.$els.bannerMobile.css({position:"fixed",top:this.headerBigHeight+e,width:"100%","z-index":"1019","backface-visibility":"hidden"}),this.$els.main.css("margin-top",this.headerBigHeight+t)}.bind(this))},d.prototype.updatePositionMobile=function(){var e=this.$els.bannerMobile.height(),t=window.pageYOffset,o=l.getMessageHeight();n.write(function(){this.setScrollDirection(t),l.isMessageShown()?o>t?n.write(function(){this.$els.header.css({position:"static",top:null,width:"100%","z-index":"1021","margin-top":0}),this.$els.bannerMobile.css({position:"static",top:null,width:"100%","z-index":"1019"}),this.$els.main.css("margin-top",0)}.bind(this)):t>o&&t<this.config.thresholdMobile?(n.write(function(){this.fixedBannerMobile(0,e)}.bind(this)),this.setNavigationDefault()):t>this.config.thresholdMobile&&(n.write(function(){this.$els.bannerMobile.css({position:"absolute",top:this.config.thresholdMobile+this.headerBigHeight})}.bind(this)),this.showNavigation(t)):t<this.config.thresholdMobile?(n.write(function(){this.fixedBannerMobile(0,e)}.bind(this)),this.setNavigationDefault()):(n.write(function(){this.$els.bannerMobile.css({position:"absolute",top:this.config.thresholdMobile+this.headerBigHeight})}.bind(this)),this.showNavigation(t))}.bind(this))},new d}),define("common/modules/navigation/search",["bean","fastdom","common/utils/_","common/utils/$","common/utils/config","common/utils/detect","common/utils/mediator"],function(e,t,n,o,i,s,a){var r=function(){var r,c,l,d,u,m=this;i.switches.googleSearch&&i.page.googleSearchUrl&&i.page.googleSearchId&&(c=i.page.googleSearchUrl+"?cx="+i.page.googleSearchId,l="identity"===i.page.section?3:10,r=n.throttle(function(){m.load()}),e.on(document,"click",".js-search-toggle",function(e){r(),m.checkResults(),m.focusSearchField(),e.preventDefault(),a.emit("modules:search")}),e.on(document,"keydown",".gsc-input",function(){
t.read(function(){var e=o(".gssb_c"),n=e.css("top"),i=o(window).scrollTop();t.write(function(){e.css({top:parseInt(n,10)+i,"z-index":"1030"})})})}),e.on(document,"click",".search-results",function(e){var t=e.target;"a"===t.nodeName.toLowerCase()&&(t.target="_self")})),this.focusSearchField=function(){var e=o("input.gsc-input");e.length>0&&(e.focus(),i.switches.viewability&&"Interactive"!==i.page.contentType&&(clearInterval(u),u=setInterval(m.checkResults,250)))},this.checkResults=function(){if(o(".gsc-resultsbox-visible").length>0){var e=o(".js-popup--search");t.write(function(){e.css("height","auto"),o(".gsc-results",e).css({height:"auto","overflow-y":"visible"})}),(o(".l-header--is-slim").length>0||"mobile"===s.getBreakpoint())&&t.read(function(){var n=window.innerHeight-e[0].getBoundingClientRect().top;t.write(function(){e.css("height",n),o(".gsc-results",e).css({height:n-150,"overflow-y":"auto"})})}),clearInterval(u)}},this.load=function(){var e,n;d=document.body.querySelector(".js-search-placeholder"),window.__gcse={callback:m.focusSearchField},Array.prototype.forEach.call(document.querySelectorAll(".js-search-placeholder"),function(e){e!==d&&t.write(function(){e.innerHTML=""})}),d.innerHTML||(t.write(function(){d.innerHTML='<div class="search-box" role="search"><gcse:searchbox></gcse:searchbox></div><div class="search-results" data-link-name="search"><gcse:searchresults webSearchResultSetSize="'+l+'" linkTarget="_self"></gcse:searchresults></div>'}),e=document.createElement("script"),e.async=!0,e.src=c,n=document.getElementsByTagName("script")[0],t.write(function(){n.parentNode.insertBefore(e,n)}))},this.init=function(){}};return r}),define("common/modules/onward/more-tags",["common/utils/$","bean"],function(e,t){function n(){this.init=function(){var n=e(".js-more-tags");0!==n.length&&(n.removeClass("modern-hidden"),t.on(document.querySelector(".js-more-tags__link"),"click",function(){e(".modern-hidden-tag").removeClass("modern-hidden"),n.addClass("modern-hidden")}))}}return n}),define("common/modules/onward/tech-feedback",["bean","fastdom","common/utils/_","common/utils/$","common/utils/detect"],function(e,t,n,o,i){function s(e){return n.reduce(e,function(e,t,n){return e+n+": "+t+"\n"},"")}function a(e){return n.reduce(e,function(e,t,n){return e+"&"+encodeURIComponent(n)+"="+encodeURIComponent(t)},"")}function r(e){return function(t){return function(){var o=t.attr("href"),i={page:window.location,width:window.innerWidth},s=a(n.extend(i,e));t.attr("href",o+"#"+s.substring(1))}}}function c(e){return function(t){return function(){var o=t.attr("href"),a={browser:window.navigator.userAgent,page:window.location,width:window.innerWidth,adBlock:i.adblockInUse(),devicePixelRatio:window.devicePixelRatio},r="\r\n\r\n\r\n\r\n------------------------------\r\nAdditional technical data about your request - please do not edit:\r\n\r\n"+s(n.extend(a,e))+"\r\n\r\n";t.attr("href",o+"?body="+encodeURIComponent(r))}}}function l(t,n){var i=o(t);i.length&&e.on(i[0],"click",n(i))}function d(e){var t=e.substring(1).split("&");return n.reduce(t,function(e,t){var o=t.split("="),i={};return o[0]&&o[1]?(i[decodeURIComponent(o[0])]=decodeURIComponent(o[1]),n.extend(e,i)):e},{})}return function(){var e=d(window.location.hash);this.getValuesFromHash=d,l(".js-tech-feedback-report",r(e)),l(".js-tech-feedback-mailto",c(e)),l(".js-userhelp-mailto",c(e)),l("[href=mailto:crosswords.beta@theguardian.com]",c(e))}}),define("common/modules/ui/accessibility-prefs",["common/utils/_","common/utils/$","common/modules/user-prefs"],function(e,t,n){function o(e){var n=e+"(100%)";t("body").css({"-webkit-filter":n,filter:n})}return function(){e.forEach(["sepia","grayscale","invert","contrast","saturate","opacity"],function(e){n.isOn(e)&&o(e)})}}),define("common/modules/ui/clickstream",["bean","common/utils/_","common/utils/mediator","common/modules/experiments/ab"],function(e,t,n,o){var i=function(i){i=i||{};var s=i.filter||[],a=function(e){return s.filter(function(t){return t===e})},r=function(e){var t,n,o,i;return e=e||"",t=e.match(/:\/\/(.[^\/]+)/),t&&(t=t[1],n=e.match(/^(https?:)\/\//),n=n?n[1]:void 0,o=window.location.hostname,i=window.location.protocol),0===e.indexOf("mailto:")?!1:!t||t===o&&n===i},c=function(e,n){if(!e.el)return!1;var o,i=e.el,s=i.tagName.toLowerCase(),l=i.getAttribute("data-link-name");if(l&&e.tag.unshift(l),"body"===s)return e.tag=e.tag.join(" | "),delete e.el,e.validTarget&&i.getAttribute("data-link-test")&&(e.tag=i.getAttribute("data-link-test")+" | "+e.tag),e;var d=JSON.parse(i.getAttribute("data-custom-event-properties")||"{}");return e.customEventProperties=t.merge(d,e.customEventProperties),e.validTarget||(e.validTarget=a(s).length>0||!!n,e.validTarget&&(e.target=i,o=i.getAttribute("href"),e.samePage=o&&0===o.indexOf("#")||"button"===s||i.hasAttribute("data-is-ajax"),e.sameHost=e.samePage||r(o))),!e.linkContext&&i.getAttribute("data-link-context-path")&&(e.linkContextPath=i.getAttribute("data-link-context-path"),e.linkContextName=i.getAttribute("data-link-context-name")),e.el=i.parentNode,c(e)};return i.addListener!==!1&&e.add(document.body,"click",function(e){var i,s={el:e.target,tag:[]};s.target=e.target,s=c(s),i=o.getActiveTestsEventIsApplicableTo(s),void 0!==i&&i.length>0&&(s.tag=t.map(i,function(e){var t=o.getTestVariantId(e);return"AB,"+e+","+t+","+s.tag}).join(",")),n.emit("module:clickstream:click",s)}),{getClickSpec:c}};return i}),define("common/modules/ui/dropdowns",["common/utils/$","bonzo","bean"],function(e,t,n){function o(){n.on(document.body,"click",s.button,function(n){var o=t(e.ancestor(n.currentTarget,s.container.substring(1)));o.toggleClass("dropdown--active"),i(o)})}function i(n){n.each(function(n){var o=t(n).hasClass("dropdown--active");e(s.content,n).attr("aria-hidden",!o),e(s.button,n).attr("aria-expanded",o),e(s.content,n).attr("aria-expanded",o)})}var s={container:".dropdown",button:".dropdown__button",content:".dropdown__content"};return{init:o,updateAria:i}}),define("common/modules/ui/faux-block-link",["bean","bonzo","fastdom","common/utils/$"],function(e,t,n,o){var i=".u-faux-block-link__overlay",s="u-faux-block-link--hover";return function(){var t=function(e){n.write(function(){o(e.currentTarget).parent().addClass(s)})},a=function(e){n.write(function(){o(e.currentTarget).parent().removeClass(s)})};e.on(document.body,"mouseenter",i,t),e.on(document.body,"mouseleave",i,a)}}),define("common/modules/ui/cookiesBanner",["common/utils/config","common/utils/$","common/utils/cookies","common/utils/detect","common/utils/storage","common/utils/template","common/modules/user-prefs","common/modules/ui/message"],function(e,t,n,o,i,s,a,r){function c(){if(e.switches.euCookieMsg&&("UK"===e.page.edition||"INT"===e.page.edition)){var t="GU_EU_MSG",o=n.get(t);if(!o||"seen"!=o){var i="https://www.theguardian.com/info/cookies",s='Welcome to the Guardian. This site uses cookies, read our policy <a href="'+i+'" class="cookie-message__link">here</a>',a={important:!0},c=365,l=new r("cookies");l.show(s,a),n.add(t,"seen",c)}}}return{init:c}}),define("common/modules/ui/relativedates",["common/utils/$","common/utils/config","common/utils/mediator","bonzo"],function(e,t,n,o){function i(){return new Date((new Date).getTime()-k)}function s(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}function a(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e]}function r(e){return 10>e?"0"+e:e}function c(e){var t=i();return e&&e.toDateString()===t.toDateString()}function l(e){var t=i();return e&&e.valueOf()>t.valueOf()-864e5}function d(e,t){var n=i();return e&&e.valueOf()>n.valueOf()-1e3*(t||0)}function u(e){var t=i(),n=i();return n.setDate(t.getDate()-1),e.toDateString()===n.toDateString()}function m(e){var t=i().valueOf()-6048e5;return e.valueOf()>=t}function h(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())}function p(e,t,n){var o,i={s:{"short":["s"],med:["s ago"],"long":[" second ago"," seconds ago"]},m:{"short":["m"],med:["m ago"],"long":[" minute ago"," minutes ago"]},h:{"short":["h"],med:["h ago"],"long":[" hour ago"," hours ago"]},d:{"short":["d"],med:["d ago"],"long":[" day ago"," days ago"]}};return i[e]?(o=i[e][t],1===n?o[0]:o[o.length-1]):""}function g(e,t){t=t||{};var n,o,r,d,g=new Date(Number(e)),v=i(),b=t.format||"short",w="short"===t.format||"med"===t.format;return h(g)?(d=parseInt((v.getTime()-g)/1e3,10),0>d?!1:t.notAfter&&d>t.notAfter?!1:55>d?d+p("s",b,d):3300>d?(n=Math.round(d/60,10),n+p("m",b,n)):c(g)||w&&l(g)?(o=Math.round(d/3600),o+p("h",b,o)):w&&m(g)?(r=Math.round(d/3600/24),r+p("d",b,r)):u(g)?"Yesterday"+f(g):432e3>d?[s(g.getDay()),g.getDate(),a(g.getMonth()),g.getFullYear()].join(" ")+(t.showTime?f(g):""):[g.getDate(),a(g.getMonth()),g.getFullYear()].join(" ")+(t.showTime?f(g):"")):!1}function f(e){return" "+e.getHours()+":"+r(e.getMinutes())}function v(){return e(".js-timestamp, .js-item__timestamp")}function b(){var t="js-locale-timestamp";e("."+t).each(function(e){var n,i=o(e),s=parseInt(i.attr("data-timestamp"),10);s&&(n=new Date(s),e.innerHTML=r(n.getHours())+":"+r(n.getMinutes()),i.removeClass(t))})}function w(e){e=e||{},v().each(function(t){var n,i=o(t),s=parseInt(i.attr("data-timestamp"),10)||i.attr("datetime"),a=new Date(s),r=g(a.getTime(),{showTime:o(i.parent()).hasClass("block-time"),format:i.attr("data-relativeformat"),notAfter:e.notAfter});r?(n=i[0].querySelector(".timestamp__text")||i[0],n.getAttribute("title")||n.setAttribute("title",o(n).text()),n.innerHTML=r):e.notAfter&&i.addClass("modern-hidden")})}function y(e){w(e),b(e)}var k=t.page&&t.page.renderTime?Math.max(0,new Date-new Date(t.page.renderTime)):0;return["related","autoupdate"].forEach(function(e){n.on("modules:"+e+":render",w)}),{makeRelativeDate:g,isWithinSeconds:d,init:y}}),define("text!common/views/breaking-news.html",[],function(){return'<div class="js-breaking-news__item breaking-news__item" data-breaking-article-id="<%=id%>">\n    <div class="breaking-news__item-content">\n        <div class="breaking-news__item-header">\n            <%=marque36icon%>\n            <em class="breaking-news__item-kicker">Breaking news</em>\n            <div class="breaking-news__item-headline"><%=headline%></div>\n        </div>\n        <div class="breaking-news__item-options">\n            <button class="js-breaking-news__item__close button button--tertiary u-faux-block-link__promote"\n                    aria-label="Dismiss"\n                    data-link-name="close button"><%=closeIcon%></button>\n        </div>\n    </div>\n    <a class="u-faux-block-link__overlay" href="/<%=id%>"></a>\n</div>\n'}),define("common/modules/onward/breaking-news",["bean","bonzo","common/utils/$","fastdom","qwery","common/utils/_","common/utils/ajax","common/utils/config","common/utils/storage","common/utils/template","common/modules/ui/relativedates","common/modules/analytics/omniture","common/views/svgs","text!common/views/breaking-news.html"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h){function p(e,t){var n={};return s.forEach(e,function(e){n[e]=t[e]||!1}),n}var g,f,v,b,w=1200,y={sport:"sport",football:"sport"},k="/breaking-news/lite.json",S="gu.breaking-news.hidden",_=1;return function(){var C=r.page,I=c.local.get(S)||{};C&&I[C.pageId]!==!0&&a({url:k,type:"json",crossOrigin:!0}).then(function(a){var r,k=(a.collections||[]).filter(function(e){return s.isArray(e.content)&&e.content.length}).map(function(e){return e.href=(e.href||"").toLowerCase(),e}),T=(C.edition||"").toLowerCase(),A=y[C.section],x=s.chain([k.filter(function(e){return"global"===e.href}).map(function(e){return e.content}),k.filter(function(e){return e.href===T}).map(function(e){return e.content}),k.filter(function(e){return A&&e.href===A}).map(function(e){return e.content})]).flatten().filter(function(e){var t=e.frontPublicationDate;return t&&d.isWithinSeconds(new Date(t),w)}).value(),N=x.map(function(e){return e.id}),M=3e3;N.indexOf(C.pageId)>-1&&(I[C.pageId]=!0),c.local.set(S,p(N,I)),r=s.chain(x).filter(function(e){return I[e.id]!==!0}).first(_).value(),r.length&&(g=g||t(i(".js-breaking-news-placeholder")),v=m("marque36icon"),b=m("closeCentralIcon"),s.forEach(r,function(i){var s;i.marque36icon=v,i.closeIcon=b,s=t.create(l(h,i)),e.on(n(".js-breaking-news__item__close",s)[0],"click",function(){o.write(function(){n("[data-breaking-article-id]").hide()}),I[i.id]=!0,c.local.set(S,p(N,I))}),o.write(function(){g.append(s)}),I[i.id]===!1&&(M=0)}),setTimeout(function(){var e,n="breaking news alert shown"+(M?"":" 2 or more times");f=f||t(document.body),e=t(t.create(g[0])).addClass("breaking-news--spectre").removeClass("breaking-news--hidden"),o.write(function(){f.append(e)}),M||o.write(function(){g.removeClass("breaking-news--fade-in")}),o.write(function(){g.removeClass("breaking-news--hidden")}),u.trackLink(this,n)},M))})}}),define("common/modules/social/pinterest",["fastdom","bean","common/utils/$"],function(e,t,n){function o(t){t.preventDefault(),n("img:not(.gu-image):not(.responsive-img):not(.gallery2__img)").each(function(t){e.write(function(){n(t).attr("data-pin-nopin","true")})}),require(["js!https://assets.pinterest.com/js/pinmarklet.js?r="+(new Date).getTime()])}var i,s=".social__item--pinterest";return function(){i=i||n(s),i.each(function(e){t.on(e,"click",o)})}}),define("text!common/views/save-for-later/save-link.html",[],function(){return'<a class="button button--medium button--tertiary save-for-later__button js-save-for-later__button save-for-later__button--<%= isSaved ? \'saved\' : \'save\' %>"\n   data-link-name="Save | <%= position %>"\n   data-component="save-for-later"\n   href="<%= url %>">\n    <%= icon %>\n    <!-- Not logged in -->\n    <span class="save-for-later__label save-for-later__label--save">Save for later</span>\n    <span class="save-for-later__label save-for-later__label--saved">Article saved</span>\n</a>\n'}),define("text!common/views/save-for-later/save-button.html",[],function(){return"<button class=\"button button--medium button--tertiary save-for-later__button js-save-for-later__button save-for-later__button--<%= isSaved ? 'saved' : 'save' %>\"\n   data-link-name=\"<%= isSaved ? 'Unsave' : 'Save' %> | <%= position %>\"\n   data-component=\"save-for-later\"\n   <%= !isSaved ? 'data-custom-event-properties=\\'{ \"prop74\": \"' + config.page.contentType + 'Save:' + config.page.pageId + '\" }\\'' : '' %>>\n    <%= icon %>\n    <span class=\"save-for-later__label save-for-later__label--save\">Save for later</span>\n    <span class=\"save-for-later__label save-for-later__label--saved\">Article saved</span>\n</button>\n"}),define("common/modules/save-for-later",["qwery","bonzo","bean","fastdom","common/utils/_","common/utils/$","common/utils/detect","common/utils/config","common/utils/mediator","common/utils/template","common/modules/identity/api","common/views/svgs","text!common/views/save-for-later/save-link.html","text!common/views/save-for-later/save-button.html"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h){function p(){this.classes={saveThisArticle:".js-save-for-later",saveThisVideo:".js-save-for-later-video",saveThisArticleButton:".js-save-for-later__button",onwardContainer:".js-onward",relatedContainer:".js-related",showMoreContainer:".js-show-more",itemMeta:".js-item__meta",itemSaveLink:".js-save-for-later-link",itemSaveLinkHeading:".save-for-later-link__heading",fcItemIsSaved:"fc-save-for-later--is-saved",profileDropdownLink:".brand-bar__item--saved-for-later",identityProfileItem:".js-profile-nav"},this.attributes={containerItemShortUrl:"data-loyalty-short-url",containerItemDataId:"data-id"},this.isContent=!/Network Front|Section|Tag/.test(r.page.contentType),this.userData={},i.bindAll(this,"save","delete","onSaveArticle","onDeleteArticle","createSaveFaciaItemHandler","createDeleteFaciaItemHandler","signUserInToSaveArticle")}var g=u("bookmark",["rounded-icon"]),f=(r.page.shortUrl||"").replace("http://gu.com",""),v="web:"+a.getUserAgent.browser+":"+a.getBreakpoint(),b=function(e){var t=r.page.contentType.match(/^Network Front|Section$/)?"Front":"Content";return{prop74:t+"ContainerSave:"+e}};return p.prototype.init=function(){var e=d.isUserLoggedIn();if(e)d.getSavedArticles().then(function(e){var t={message:"Not found",description:"Resource not found"};if("error"===e.status&&e.errors[0].message===t.message&&e.errors[0].description===t.description){var n=(new Date).toISOString().replace(/\.[0-9]+Z/,"+00:00");this.userData={version:n,articles:[]},this.saveIntroArticle()}else this.userData=e.savedArticles;this.updateSavedCount(),this.prepareFaciaItemLinks(!0),this.isContent&&this.renderSaveButtonsInArticle()}.bind(this));else if(this.isContent){var t=l("<%= idUrl%>/save-content?INTCMP=DOTCOM_ARTICLE_SFL&returnUrl=<%= returnUrl%>&shortUrl=<%= shortUrl%>&platform=<%= platform%>",{idUrl:r.page.idUrl,returnUrl:encodeURIComponent(document.location.href),shortUrl:f,platform:v});this.renderArticleSaveButton({url:t,isSaved:!1})}},p.prototype.renderSaveButtonsInArticle=function(){this.getSavedArticle(f)?this.renderArticleSaveButton({isSaved:!0}):this.renderArticleSaveButton({isSaved:!1})},p.prototype.renderArticleSaveButton=function(o){var s=t(e(this.classes.saveThisArticle));s.each(function(e){var s=t(e);s.css("display","block");var a={icon:g,isSaved:o.isSaved,position:s.attr("data-position"),config:r};o.url?s.html(l(m,i.assign({url:o.url},a))):(s.html(l(h,a)),n.one(s[0],"click",this.classes.saveThisArticleButton,this[o.isSaved?"deleteArticle":"saveArticle"].bind(this,r.page.pageId,f)))}.bind(this))},p.prototype.getElementsIndexedById=function(n){var o=e("["+this.attributes.containerItemShortUrl+"]",n);return i.forEach(o,function(e){return t(e).attr(this.attributes.containerItemShortUrl)}.bind(this))},p.prototype.prepareFaciaItemLinks=function(e){this.renderFaciaItemLinks(e,document.body),c.once("modules:tonal:loaded",function(){this.renderFaciaItemLinks(e,this.classes.onwardContainer)}.bind(this)),c.once("modules:onward:loaded",function(){this.renderFaciaItemLinks(e,this.classes.onwardContainer)}.bind(this)),c.once("modules:tonal:loaded",function(){this.renderFaciaItemLinks(e,this.classes.onwardContainer)}.bind(this)),c.once("modules:related:loaded",function(){this.renderFaciaItemLinks(e,this.classes.relatedContainer)}.bind(this)),c.on("modules:show-more:loaded",function(){this.renderFaciaItemLinks(e,this.classes.showMoreContainer),s(this.classes.showMoreContainer).removeClass("js-show-more")}.bind(this))},p.prototype.renderFaciaItemLinks=function(e,t){var a=this.getElementsIndexedById(t);i.forEach(a,function(t){var i=s(t),a=s(this.classes.itemSaveLink,t),r=t.getAttribute(this.attributes.containerItemShortUrl),c=t.getAttribute(this.attributes.containerItemDataId),l=e?this.getSavedArticle(r):!1;e?this[l?"createDeleteFaciaItemHandler":"createSaveFaciaItemHandler"](a[0],c,r):n.one(a[0],"click",function(e,t){this.signUserInToSaveArticle(e,t)}.bind(this,c,r)),o.write(function(){if(l)a.addClass(this.classes.fcItemIsSaved);else{var e=s(s.ancestor(a[0],"fc-item")).attr("data-id");a.attr("data-custom-event-properties",JSON.stringify(b(e)))}a.attr("data-link-name",l?"Unsave":"Save"),i.addClass("fc-item--has-metadata"),a.removeClass("is-hidden")}.bind(this))}.bind(this))},p.prototype.save=function(e,t,n){var o=(new Date).toISOString().replace(/\.[0-9]+Z/,"+00:00"),i={id:e,shortUrl:t,date:o,read:!1,platform:v};this.userData.articles.push(i),d.saveToArticles(this.userData).then(function(e){n("error"!==e.status)})},p.prototype["delete"]=function(e,t,n){this.userData.articles=i.filter(this.userData.articles,function(e){return e.shortUrl!==t}),d.saveToArticles(this.userData).then(function(e){n("error"!==e.status)})},p.prototype.saveArticle=function(e,t){this.save(e,t,this.onSaveArticle)},p.prototype.onSaveArticle=function(e){this.renderArticleSaveButton({isSaved:e}),e&&this.updateSavedCount()},p.prototype.deleteArticle=function(e,t){this["delete"](e,t,this.onDeleteArticle)},p.prototype.onDeleteArticle=function(e){this.renderArticleSaveButton({isSaved:!e}),e&&this.updateSavedCount()},p.prototype.saveFaciaItem=function(e,t){this.save(e,t,this.onSaveFaciaItem)},p.prototype.onSaveFaciaItem=function(n,i,s,a){var r=this;a?(this.createDeleteFaciaItemHandler(n,i,s),this.updateSavedCount(),o.write(function(){t(n).addClass(r.classes.fcItemIsSaved).attr("data-link-name","Unsave").attr("data-custom-event-properties","")})):(this.createSaveFaciaItemHandler(n,i,s),o.write(function(){t(e(r.classes.itemSaveLinkHeading,n)[0]).html("Error Saving")}))},p.prototype.deleteFaciaItem=function(e,t){this.save(e,t,this.onDeleteFaciaItem)},p.prototype.onDeleteFaciaItem=function(n,i,a,r){var c=this;r?(this.createSaveFaciaItemHandler(n,i,a),this.updateSavedCount(),o.write(function(){var e=s(s.ancestor(n,"fc-item")).attr("data-id");t(n).removeClass(c.classes.fcItemIsSaved).attr("data-link-name","Save").attr("data-custom-event-properties",JSON.stringify(b(e)))})):(this.createDeleteFaciaItemHandler(n,i,a),o.write(function(){t(e(c.classes.itemSaveLinkHeading,n)[0]).html("Error Removing")}))},p.prototype.createSaveFaciaItemHandler=function(e,t,o){n.one(e,"click",this.save.bind(this,t,o,this.onSaveFaciaItem.bind(this,e,t,o)))},p.prototype.signUserInToSaveArticle=function(e,t){var n=l("<%= idUrl%>/save-content?returnUrl=<%= returnUrl%>&shortUrl=<%= shortUrl%>&platform=<%= platform%>&articleId=<%= articleId %>&INTCMP=SFL-SO",{idUrl:r.page.idUrl,returnUrl:encodeURIComponent(document.location.href),shortUrl:t,platform:v,articleId:e});window.location=n},p.prototype.createDeleteFaciaItemHandler=function(e,t,o){n.one(e,"click",this["delete"].bind(this,t,o,this.onDeleteFaciaItem.bind(this,e,t,o)))},p.prototype.getSavedArticle=function(e){return i.some(this.userData.articles,function(t){return t.shortUrl.indexOf(e)>-1})},p.prototype.updateSavedCount=function(){var e=s(this.classes.profileDropdownLink),t=s(this.classes.identityProfileItem),n=this.userData.articles?this.userData.articles.length:0;n>0?(e.attr("data-saved-content-count",n),t.addClass("has-saved-articles")):(e.removeAttr("data-saved-content-count",n),t.removeClass("has-saved-articles"))},p.prototype.saveIntroArticle=function(){var e="help/insideguardian/2015/jul/21/introducing-save-for-later",t="/p/4ab7x";this.saveArticle(e,t)},p}),define("common/modules/commercial/membership-messages",["common/utils/config","common/utils/storage","common/utils/template","common/modules/ui/message","text!common/views/membership-message.html","common/views/svgs","common/modules/commercial/commercial-features"],function(e,t,n,o,i,s,a){function r(){var n=t.local.get("gu.alreadyVisited")||0;return a.membershipMessages&&"UK"===e.page.edition&&n>10}function c(){new o("membership-message-uk",{pinOnHide:!1,siteMessageLinkName:"membership message",siteMessageCloseBtn:"hide"}).show(n(i,{messageText:["Thank you for reading The Guardian.","Help keep our journalism free and independent by becoming a Supporter for just £5 a month."].join(" "),linkHref:"https://membership.theguardian.com/supporter?INTCMP=MEMBERSHIP_SUPPORTER_BANNER_UK",linkText:"Join",arrowWhiteRight:s("arrowWhiteRight")}))}function l(){r()&&c()}return{init:l}}),define("text!common/views/international-message.html",[],function(){return'<p class="site-message__message" id="site-message__message">\n    You are viewing the Guardian’s international edition.\n</p>\n<ul class="site-message__actions u-unstyled">\n    <li class="site-message__actions__item">\n        <i class="i i-back"></i>\n        <a class="js-main-site-link" rel="nofollow" href="/preference/edition/uk" data-link-name="opt-out">Opt out and visit the UK edition instead</a>\n    </li>\n</ul>\n'}),define("bootstraps/identity-common",["common/utils/robust","common/modules/identity/api"],function(e,t){function n(e){t.init(e),t.isUserLoggedIn()&&(document.documentElement.className=document.documentElement.className.replace(/\bid--signed-out\b/,"id--signed-in"))}return function(){e.catchErrorsAndLog("i-css-class",n)}}),define("bootstraps/common",["fastdom","bean","bonzo","qwery","common/utils/_","common/utils/$","common/utils/config","common/utils/cookies","common/utils/detect","common/utils/mediator","common/utils/template","common/utils/url","common/utils/robust","common/utils/storage","common/modules/analytics/foresee-survey","common/modules/analytics/livestats","common/modules/analytics/media-listener","common/modules/analytics/omniture","common/modules/analytics/register","common/modules/analytics/scrollDepth","common/modules/analytics/css-logging","common/modules/analytics/simple-metrics","common/modules/commercial/user-ad-targeting","common/modules/commercial/donot-use-adblock","common/modules/commercial/user-features","common/modules/discussion/comment-count","common/modules/experiments/ab","common/modules/identity/autosignin","common/modules/identity/cookierefresh","common/modules/navigation/navigation","common/modules/navigation/sticky","common/modules/navigation/profile","common/modules/navigation/search","common/modules/onward/history","common/modules/onward/more-tags","common/modules/onward/tech-feedback","common/modules/ui/accessibility-prefs","common/modules/ui/clickstream","common/modules/ui/dropdowns","common/modules/ui/faux-block-link","common/modules/ui/message","common/modules/ui/cookiesBanner","common/modules/ui/relativedates","common/modules/ui/smartAppBanner","common/modules/ui/tabs","common/modules/ui/toggles","common/modules/user-prefs","common/modules/onward/breaking-news","common/modules/social/pinterest","common/modules/save-for-later","common/modules/commercial/membership-messages","text!common/views/international-message.html","bootstraps/identity-common"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,g,f,v,b,w,y,k,S,_,C,I,T,A,x,N,M,D,j,L,F,B,$,U,P,E,O,H,R,q,Y,z,G,W,V,K,J,Z,X){var Q={initialiseTopNavItems:function(){var e,t=new j,n=document.getElementById("header");n&&a.switches.idProfileNavigation&&(e=new D({url:a.page.idUrl}),e.init()),t.init(n)},initialiseNavigation:function(){N.init()},initialiseStickyHeader:function(){!a.switches.viewability||a.page.isProd&&"Interactive"===a.page.contentType||"Crossword"===a.page.contentType||"offline-page"===a.page.pageId||M.init()},showTabs:function(){var e=new Y;["modules:popular:loaded","modules:geomostpopular:ready"].forEach(function(t){l.on(t,function(t){e.init(t)})})},showToggles:function(){var e=new z;e.init(document),e.reset(),P.init()},showRelativeDates:function(){var e=R;e.init(),l.on("fragment:ready:dates",function(t){e.init(t)})},initClickstream:function(){new U({filter:["a","button"]})},showAdblockMessage:function(){_.init()},logLiveStats:function(){g.log()},loadAnalytics:function(){v.go(),a.switches.ophan&&require(["ophan/ng"],function(e){a.switches.scrollDepth&&(l.on("scrolldepth:data",e.record),new w({isContent:/Article|LiveBlog/.test(a.page.contentType)}))})},cleanupCookies:function(){r.cleanUp(["mmcore.pd","mmcore.srv","mmid","GU_ABFACIA","GU_FACIA","GU_ALPHA","GU_ME","at"])},updateHistory:function(){"Network Front"!==a.page.contentType&&L.logSummary(a.page),"Video"===a.page.contentType&&L.logHistory(a.page)},showHistoryInMegaNav:function(){a.switches.historyTags&&l.once("modules:nav:open",function(){L.showInMegaNav()})},initAutoSignin:function(){a.switches.facebookAutosignin&&"mobile"!==c.getBreakpoint()&&(new A).init()},idCookieRefresh:function(){a.switches.idCookieRefresh&&(new x).init()},windowEventListeners:function(){["resize","scroll","orientationchange"].forEach(function(e){t.on(window,e,l.emit.bind(l,"window:"+e))})},throttledScrollEvent:function(){var t=!1;window.addEventListener("scroll",function(){t||(t=!0,e.read(function(){l.emitEvent("window:throttledScroll"),t=!1}))})},checkIframe:function(){window.self!==window.top&&s("html").addClass("iframed")},runForseeSurvey:function(){a.switches.foresee&&p.load()},startRegister:function(){a.page.isSSL||b.initialise()},showMoreTagsLink:function(){(new F).init()},initDiscussion:function(){a.switches.discussion&&I.init()},testCookie:function(){var e=u.getUrlVars();e.test&&r.addSessionCookie("GU_TEST",encodeURIComponent(e.test))},adTestCookie:function(){var e=u.getUrlVars();"clear"===e.adtest?r.remove("adtest"):e.adtest&&r.add("adtest",encodeURIComponent(e.adtest),10)},initOpenOverlayOnClick:function(){var e;t.on(document.body,"click","[data-open-overlay-on-click]",function(t){var o=n(t.currentTarget).data("open-overlay-on-click");e=document.body.scrollTop,n(document.body).addClass("has-overlay"),s("#"+o).addClass("overlay--open").appendTo(document.body)}),t.on(document.body,"click",".js-overlay-close",function(t){var o=s.ancestor(t.target,"overlay");o&&n(o).removeClass("overlay--open"),n(document.body).removeClass("has-overlay"),e&&window.setTimeout(function(){document.body.scrollTop=e,e=null},1)})},loadBreakingNews:function(){a.switches.breakingNews&&"identity"!==a.page.section&&W()},runCssLogging:function(){a.switches.cssLogging&&y()},initPublicApi:function(){window.guardian.api={logCss:y}},internationalSignposting:function(){"INT"===a.page.edition&&"international"===a.page.pageId&&new O("international-with-survey-new",{pinOnHide:!0}).show(d(Z,{}))},initPinterest:function(){/Article|LiveBlog|Gallery|Video/.test(a.page.contentType)&&V()},saveForLater:function(){if(a.switches.saveForLater){var e=new K;e.init()}},showMembershipMessages:function(){J.init()}};return{init:function(){i.forEach(m.makeBlocks([["c-analytics",Q.loadAnalytics],["c-cookies-banner",H.init],["c-identity",X],["c-adverts",S.requestUserSegmentsFromId],["c-discussion",Q.initDiscussion],["c-test-cookie",Q.testCookie],["c-ad-cookie",Q.adTestCookie],["c-event-listeners",Q.windowEventListeners],["c-throttled-scroll-event",Q.throttledScrollEvent],["c-breaking-news",Q.loadBreakingNews],["c-block-link",E],["c-iframe",Q.checkIframe],["c-tabs",Q.showTabs],["c-top-nav",Q.initialiseTopNavItems],["c-init-nav",Q.initialiseNavigation],["c-sticky-header",Q.initialiseStickyHeader],["c-toggles",Q.showToggles],["c-dates",Q.showRelativeDates],["c-clickstream",Q.initClickstream],["c-history",Q.updateHistory],["c-sign-in",Q.initAutoSignin],["c-id-cookie-refresh",Q.idCookieRefresh],["c-history-nav",Q.showHistoryInMegaNav],["c-forsee",Q.runForseeSurvey],["c-start-register",Q.startRegister],["c-tag-links",Q.showMoreTagsLink],["c-smart-banner",q.init],["c-adblock",Q.showAdblockMessage],["c-log-stats",Q.logLiveStats],["c-cookies",Q.cleanupCookies],["c-overlay",Q.initOpenOverlayOnClick],["c-css-logging",Q.runCssLogging],["c-public-api",Q.initPublicApi],["c-simple-metrics",k],["c-tech-feedback",B],["c-media-listeners",f],["c-accessibility-prefs",$],["c-international-signposting",Q.internationalSignposting],["c-pinterest",Q.initPinterest],["c-save-for-later",Q.saveForLater],["c-show-membership-messages",Q.showMembershipMessages],["c-user-features",C.refresh]]),function(e){e()}),window.console&&window.console.log&&!a.page.isDev&&window.console.log("##::::: ##: ########::::::: ###:::: ########:: ########:::: ##:::: ##: ####: ########:: ####: ##::: ##:: ######::\n##: ##: ##: ##.....::::::: ## ##::: ##.... ##: ##.....::::: ##:::: ##:. ##:: ##.... ##:. ##:: ###:: ##: ##... ##:\n##: ##: ##: ##::::::::::: ##:. ##:: ##:::: ##: ##:::::::::: ##:::: ##:: ##:: ##:::: ##:: ##:: ####: ##: ##:::..::\n##: ##: ##: ######:::::: ##:::. ##: ########:: ######:::::: #########:: ##:: ########::: ##:: ## ## ##: ##:: ####\n##: ##: ##: ##...::::::: #########: ##.. ##::: ##...::::::: ##.... ##:: ##:: ##.. ##:::: ##:: ##. ####: ##::: ##:\n##: ##: ##: ##:::::::::: ##.... ##: ##::. ##:: ##:::::::::: ##:::: ##:: ##:: ##::. ##::: ##:: ##:. ###: ##::: ##:\n ###. ###:: ########:::: ##:::: ##: ##:::. ##: ########:::: ##:::: ##: ####: ##:::. ##: ####: ##::. ##:. ######::\n\nEver thought about joining us?\nhttp://developers.theguardian.com/join-the-team.html")}}}),define("common/utils/page",["common/utils/$","common/utils/config","common/utils/_"],function(e,t,n){function o(e,t,n,o){return e?t?t(o||e):o||e:n?n():!1}function i(e,i){
var s=t.referencesOfType("pa-football-team"),a=t.page.footballMatch||{};return n.assign(a,{date:t.webPublicationDateAsUrlPart(),teams:s,isLive:t.page.isLive,pageType:n.find([["minbymin",t.page.isLiveBlog],["report",t.hasTone("Match reports")],["preview",t.hasSeries("Match previews")],["stats",a.id],[null,!0]],function(e){return e[1]===!0})[0]}),o(a.id||a.pageType&&2===a.teams.length,e,i,a)}function s(t,n){var i=(e(".js-football-competition").attr("data-link-name")||"").replace("keyword: football/","");return o(i,t,n)}function a(e,n){return o(t.hasSeries("Clockwatch"),e,n)}function r(e,n){return a(function(){return o(t.page.isLive,e,n)},n)}function c(e,n){return o(t.page.hasOwnProperty("footballMatch"),e,n)}function l(t,n){var i=e(".js-after-article")[0],s=i?"none"!==window.getComputedStyle(i).getPropertyValue("display"):!1;return o(s,t,n,i)}return{isMatch:i,isCompetition:s,isClockwatch:a,isLiveClockwatch:r,isFootballStatsPage:c,belowArticleVisible:l}}),define("common/modules/charts/doughnut",["common/utils/_","common/utils/$"],function(e,t){function n(e){return t.create(document.createElementNS("http://www.w3.org/2000/svg",e))}function o(e){return"translate("+e+")"}var i=function(i,s){s=e.assign({percentCutout:35,unit:"",showValues:!1},s||{});var a,r,c,l,d,u,m,h,p,g,f=s.width,v=s.height||f,b=Math.min(v/2,f/2),w=b*(s.percentCutout/100),y=i.reduce(function(e,t){return{value:e.value+t.value}}).value,k=Math.PI/2,S=2*Math.PI,_=[f/2,v/2],C={x:f/2,y:v/2},I=t.create('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="chart chart--doughnut"></svg>').attr({width:f,height:v,viewbox:"0 0 "+[f,v].join(" ")}),T=-k;return i.forEach(function(e){a=e.value/y*S,r=T+a,c=(r-T)%S>Math.PI?1:0,l={start:{x:C.x+Math.cos(T)*b,y:C.y+Math.sin(T)*b},end:{x:C.x+Math.cos(r)*b,y:C.y+Math.sin(r)*b}},d={start:{x:C.x+Math.cos(r)*w,y:C.y+Math.sin(r)*w},end:{x:C.x+Math.cos(T)*w,y:C.y+Math.sin(T)*w}},u=(w+b)/2,m=(T+r)/2,h=["M",l.start.x,l.start.y,"A",b,b,0,c,1,l.end.x,l.end.y,"L",d.start.x,d.start.y,"A",w,w,0,c,0,d.end.x,d.end.y,"Z"],p=n("g").attr("class","chart__arc").append(n("path").attr({d:h.join(" "),fill:e.color})),g=n("text").attr("class","chart__label"),s.showValues?g.append(n("tspan").attr("class","chart__label-text").text(e.label).attr({x:0,dy:"0"})).append(n("tspan").attr("class","chart__label-value").text(e.value).attr({x:0,dy:"1em"})):g.text(e.label),g.attr({transform:o([Math.cos(m)*u+C.x,Math.sin(m)*u+C.y])}).appendTo(p),p.appendTo(I),T+=e.value/y*S}),I.append(n("text").attr("class","chart__unit").text(s.unit).attr({transform:o(_),dy:"0.4em"}))};return i}),define("common/modules/charts/table-doughnut",["bonzo","common/utils/$","common/modules/charts/doughnut"],function(e,t,n){var o=function(){};return o.prototype.render=function(o){var i,s,a=o.scrollWidth||o.getAttribute("data-chart-width"),r=t("th",o),c=t("td",o).map(function(e,t){return{label:r[t].innerHTML,value:parseInt(e.getAttribute("data-chart-value"),10),color:e.getAttribute("data-chart-color")}});return e(o).addClass("u-h"),i=new n(c,{showValues:"true"===o.getAttribute("data-chart-show-values"),unit:o.getAttribute("data-chart-unit"),width:a}),s=i.attr("class"),i.attr("class",s+" "+o.getAttribute("data-chart-class")).insertAfter(o)},o}),define("text!common/views/sport/score-container.html",[],function(){return'<div class="score-container">\n    <div class="score__loading <%=loadingState%>">\n        <div class="loading__text">Fetching the scores…</div>\n        <div class="is-updating"></div>\n    </div>\n</div>'}),define("common/modules/sport/score-board",["bonzo","common/utils/detect","common/utils/$","common/utils/template","common/modules/component","text!common/views/sport/score-container.html"],function(e,t,n,o,i,s){function a(n){this.pageType=n.pageType,this.parent=n.parent,this.placeholder=e.create(o(s,{loadingState:"report"!==this.pageType?" score__loading--live":""}))[0],"report"===this.pageType?n.parent.after(this.placeholder):n.parent.addClass("u-h").before(this.placeholder),this.endpoint=n.endpoint,this.autoupdated=n.autoupdated,this.responseDataKey=n.responseDataKey,this.updateEvery=t.isBreakpoint({min:"desktop"})?30:60}return i.define(a),a.prototype.componentClass="match-summary",a.prototype.prerender=function(){var e=n(".score__loading",n(this.placeholder));e.length&&e.remove()},a.prototype.ready=function(){this.setState(this.pageType)},a.prototype.load=function(){this.fetch(this.placeholder)},a.prototype.loadFromJson=function(e){this.template=e,this.render(this.placeholder)},a.prototype.error=function(){this.placeholder.innerHTML="",this.parent.removeClass("u-h")},a}),define("bootstraps/sport",["bonzo","bean","common/utils/$","common/utils/template","common/utils/ajax","common/utils/config","common/utils/detect","common/utils/page","common/modules/charts/table-doughnut","common/modules/component","common/modules/sport/score-board","common/modules/ui/rhc"],function(e,t,n,o,i,s,a,r,c,l,d,u){function m(){var e,t,o=s.page.cricketMatch;o&&(e=new l,t=n(".js-cricket-score")[0],e.endpoint="/sport/cricket/match/"+o+".json",e.fetch(t,"summary"))}function h(){var e="";if(s.page.isLiveBlog?e="minbymin":s.hasTone("Match reports")&&(e="report"),s.page.rugbyMatch&&e){var t=n(".js-score"),i=new d({pageType:e,parent:t,autoupdated:s.page.isLive,responseDataKey:"matchSummary",endpoint:s.page.rugbyMatch+".json?page="+encodeURIComponent(s.page.pageId)});i.fetched=function(e){n(".content--liveblog").addClass("content--liveblog--rugby"),n.create(e.nav).first().each(function(e){2===n(".tabs__tab",e).length&&(n(".js-sport-tabs").empty(),n(".js-sport-tabs").append(e))});var t=e.scoreEvents;if(a.isBreakpoint({max:"mobile"})){var i=n.create(o(e.dropdown)({name:"Score breakdown",content:t}));s.page.isLiveBlog&&i.addClass("dropdown--key-events"),i.addClass("dropdown--active"),n(".js-after-article").append(i)}else{var r=n.create(t);r.addClass("hide-on-mobile"),n(".rugby-stats").remove(),n(".score-container").after(r)}n(".match-stats__container").remove(),n.create('<div class="match-stats__container">'+e.matchStat+"</div>").each(function(e){n(".js-chart",e).each(function(e){(new c).render(e)});var t=[];t[0]={name:"Match stats",importance:3,content:e,ready:!0},p(t)}),n(".js-football-table").remove(),n.create('<div class="js-football-table" data-link-name="football-table-embed">'+e.groupTable+"</div>").each(function(e){var t=[];t[0]={name:"Table",importance:3,content:e,ready:!0},p(t)})},i.load()}}function p(e,o){e=e.filter(function(e){return e});var i=0===e.filter(function(e){return e.ready===!1}).length;i&&r.belowArticleVisible(function(){var i;n(".js-after-article").append(n.create('<div class="football-extras"></div>').each(function(t){e.forEach(function(e,a){o?n.create(o).each(function(t){s.page.isLiveBlog&&n(t).addClass("dropdown--key-events"),n(".dropdown__label",t).append(e.name),n(".dropdown__content",t).append(e.content),n(".dropdown__button",t).attr("data-link-name","Show dropdown: "+e.name).each(function(e){0===a&&(i=e)})}).appendTo(t):t.appendChild(e.content)})})),i&&t.fire(i,"click")},function(){e.forEach(function(e){u.addComponent(e.content,e.importance)})})}function g(){m(),s.switches.rugbyWorldCup&&h()}return{init:g}}),define("bootstraps/app",["fastdom","bean","qwery","raven","common/utils/$","common/utils/config","common/utils/detect","common/utils/mediator","common/utils/user-timing","bootstraps/common","bootstraps/sport"],function(e,t,n,o,i,s,a,r,c,l,d){var u=function(e,t){o.context({tags:{feature:e}},t.init,[])},m=function(){if(c.mark("App Begin"),u("common",l),s.page.isFront&&require(["bootstraps/facia"],function(e){u("facia",e)}),"lifeandstyle"===s.page.section&&"Sudoku"===s.page.series&&require(["bootstraps/sudoku"],function(e){u("sudoku",e)}),"Article"===s.page.contentType&&require(["bootstraps/article","bootstraps/image-content"],function(e,t){u("article",e),u("article : image-content",t)}),"LiveBlog"===s.page.contentType&&require(["bootstraps/liveblog","bootstraps/image-content"],function(e,t){u("liveBlog",e),u("liveBlog : image-content",t)}),(s.isMedia||"Interactive"===s.page.contentType)&&require(["bootstraps/trail"],function(e){u("media : trail",{init:e})}),(s.isMedia||n("video, audio").length)&&require(["bootstraps/media"],function(e){u("media",e)}),"Gallery"===s.page.contentType&&require(["bootstraps/gallery","bootstraps/image-content"],function(e,t){u("gallery",e),u("gallery : image-content",t)}),"ImageContent"===s.page.contentType&&require(["bootstraps/image-content","bootstraps/trail"],function(e,t){u("image-content",e),u("image-content : trail",{init:t})}),"football"===s.page.section&&require(["bootstraps/football"],function(e){u("football",e)}),"sport"===s.page.section&&u("sport",d),"identity"===s.page.section&&require(["bootstraps/profile"],function(e){u("profile",e)}),s.page.isPreferencesPage&&require(["bootstraps/preferences"],function(e){u("preferences",e)}),s.switches.offlinePage){var o=window.navigator;if(o&&o.serviceWorker&&o.serviceWorker.register("/service-worker.js"),"offline-page"===s.page.pageId){var a=i(".js-open-crossword-btn");t.on(a[0],"click",function(){e.write(function(){i(".js-crossword-container").removeClass("is-hidden"),a.remove()})})}}"help/accessibility-help"===s.page.pageId&&require(["bootstraps/accessibility"],function(e){u("accessibility",e)}),c.mark("App End")};return{go:m}});
//# sourceMappingURL=app.js.map